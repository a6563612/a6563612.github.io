(function(){"use strict";var e={83662:function(e,a,l){var t=l(45130),o=l(92261),n=l(23876),r=l(94373),s=l(40892),u=l(56768),i=l(20014),d=l(90144);const c=(0,o.nY)("theme",(()=>{const e=(0,d.KR)("light"),a=localStorage.getItem("app-theme");if(a&&["light","dark"].includes(a))e.value=a;else{const a=window.matchMedia("(prefers-color-scheme: dark)").matches;e.value=a?"dark":"light"}const l=()=>{e.value="light"===e.value?"dark":"light"},t=a=>{["light","dark"].includes(a)&&(e.value=a)},o=()=>{const a=document.documentElement;"dark"===e.value?(a.classList.add("dark-theme"),a.classList.remove("light-theme")):(a.classList.add("light-theme"),a.classList.remove("dark-theme")),a.setAttribute("data-theme",e.value)};(0,u.wB)(e,(e=>{o(),localStorage.setItem("app-theme",e),console.log(`ä¸»é¡Œå·²åˆ‡æ›ç‚º: ${e}`)}),{immediate:!0});const n=()=>"dark"===e.value,r=()=>"light"===e.value;return{currentTheme:e,toggleTheme:l,setTheme:t,applyTheme:o,isDark:n,isLight:r}}));var p=l(24570),m=l.n(p);l(17221);function v(e,a={}){const l="number"===typeof a.interval?a.interval:3e4;let t=!1,o=null,n=null;async function r(a=!1){if(!t&&(a||"visible"===document.visibilityState))try{n?.abort(),n=new AbortController;const a=await fetch("/version.json",{cache:"no-store",signal:n.signal});if(!a.ok)return;const l=await a.json(),o=l&&l.version;if(!o)return;console.log("currentVersion:",e,"notified:",t)}catch{}}const s=()=>r(!0),u=()=>"visible"===document.visibilityState&&r(!0);return o=setInterval(r,l),r(!0),window.addEventListener("focus",s),document.addEventListener("visibilitychange",u),()=>{o&&clearInterval(o),window.removeEventListener("focus",s),document.removeEventListener("visibilitychange",u),n?.abort()}}var b={__name:"App",setup(e){const a="1.2.3";v(a,{interval:3e4});const l=v(a,{interval:3e4}),t=(0,i.n)(),o=c();return(0,u.sV)((async()=>{o.applyTheme();const e=m().get("userId");if(e&&!t.isLogin)try{await t.autoLogin()}catch(a){console.error("è‡ªå‹•é‡æ–°ç™»å…¥å¤±æ•—:",a)}})),(0,u.hi)((()=>l?.())),(e,a)=>{const l=(0,u.g2)("Toast"),t=(0,u.g2)("router-view");return(0,u.uX)(),(0,u.CE)(u.FK,null,[(0,u.bF)(l,{pt:{closeButton:{autofocus:!1}}}),(0,u.bF)(t)],64)}}};const g=b;var y=g,f=l(77440),h=l(80027),k=l(38208),_=(l(4188),l(18199)),w=l(31602),F=l(84135),C=l(81387),D=l(51219),L=(l(44114),l(24232)),R=(l(17642),l(58004),l(33853),l(45876),l(32475),l(15024),l(31698),l(98992),l(54520),l(3949),l(81454),l.p+"img/DAE.c9954ca5.png");function V(){return[{label:"ç¸½ç¶“ç†å®¤",icon:"pi pi-chart-bar",value:"Board",requiredRoles:["RO9999"],items:[{label:"æ¥­ç¸¾è³‡è¨Š",icon:"pi pi-file",value:"PerformanceInfo",items:[{label:"å¹´åº¦æ¥­ç¸¾",icon:"pi pi-file",value:"PerformanceDashboard",command:()=>mA.push({name:"PerformanceDashboard"})}]}]},{label:"äººå“¡ç®¡ç†",icon:"pi pi-chart-bar",value:"EmployeeManagement",items:[]},{label:"è¡¨å–®ç”³è«‹",icon:"pi pi-file",value:"Workflow",items:[{label:"äººäº‹è–ªè³‡",icon:"pi pi-folder",value:"HumanResources",items:[{label:"è£œåˆ·å¡å–®",icon:"pi pi-file",value:"CorrectionForm",command:()=>mA.push({name:"CorrectionForm"})},{label:"åŠ ç­å–®",icon:"pi pi-file",value:"OvertimeRequestForm",command:()=>mA.push({name:"OvertimeRequestForm"})},{label:"è«‹å‡å–®",icon:"pi pi-file",value:"LeaveRequestForm",command:()=>mA.push({name:"LeaveRequestForm"})},{label:"éŠ·å‡å–®",icon:"pi pi-file",value:"LeaveCancellationForm",command:()=>mA.push({name:"LeaveCancellationForm"})}]}]},{label:"æ´»å‹•æˆ–çµ±è¨ˆ",icon:"pi pi-chart-bar",value:"EventsAndStatistics",items:[{label:"åˆé¤çµ±è¨ˆ",icon:"pi pi-money-bill",value:"Lunch"},{label:"MACè¡¨å–®å¡«å¯«",icon:"pi pi-desktop",value:"MACForm",command:()=>mA.push({name:"MacForm"})},{label:"é›»è…¦æ¸…å–®ç›¤æŸ¥å¡«å¯«",icon:"pi pi-desktop",value:"ComputerInventory",command:()=>mA.push({name:"ComputerInventory"})}]},{label:"ç®¡ç†éƒ¨",icon:"pi pi-briefcase",value:"Administration",items:[{label:"ç³»çµ±èª²",icon:"pi pi-wrench",value:"System"}]},{label:"ç ”ç™¼éƒ¨",icon:"pi pi-cog",value:"RD",items:[{label:"ç”¢å“ä¼åŠƒèª²",icon:"pi pi-pencil",value:"ProductPlanning"},{label:"ç¡¬é«”èª²",icon:"pi pi-desktop",value:"Hardware"},{label:"è»Ÿé«”èª²",icon:"pi pi-code",value:"Software"},{label:"ç”ŸæŠ€èª²",icon:"pi pi-heart",value:"Biotechnology"},{label:"å“ä¿èª²",icon:"pi pi-shield",value:"QualityAssurance"}]},{label:"è£½é€ éƒ¨",icon:"pi pi-wrench",value:"Manufacturing",items:[{label:"ç”Ÿç®¡èª²",icon:"pi pi-sync",value:"ProductionControl"},{label:"æŽ¡è³¼èª²",icon:"pi pi-shopping-cart",value:"Purchasing"},{label:"å¤–åŒ…èª²",icon:"pi pi-users",value:"Outsourcing"},{label:"å€‰ç®¡èª²",icon:"pi pi-box",value:"Warehouse"},{label:"ç”¢ç·šèª²",icon:"pi pi-sliders-h",value:"ProductionLine"},{label:"ç¶­ä¿®èª²",icon:"pi pi-wrench",value:"Maintenance"},{label:"å“ç®¡èª²",icon:"pi pi-check-square",value:"QualityControl"}]},{label:"åœ‹å…§æ¥­å‹™éƒ¨",icon:"pi pi-map",value:"DomesticBusiness",items:[{label:"å…¨ç‡Ÿæ¥­å€",icon:"pi pi-globe",value:"AllBusinessArea",items:[{label:"ç‡Ÿé‹èª²",icon:"pi pi-chart-line",value:"Operations"},{label:"å·¥ç¨‹èª²",icon:"pi pi-cog",value:"Engineering"},{label:"ç”¢å“æ‡‰ç”¨èª²",icon:"pi pi-box",value:"ProductApplication"},{label:"å·¥ç¨‹è»Ÿé«”èª²",icon:"pi pi-code",value:"EngineeringSoftware"},{label:"å®¢æœèª²",icon:"pi pi-comments",value:"CustomerService"}]},{label:"åŒ—ä¸­å—ç‡Ÿæ¥­å€",icon:"pi pi-map-marker",value:"RegionalBusiness",items:[{label:"æ¥­å‹™èª²",icon:"pi pi-money-bill",value:"Sales"},{label:"å·¥ç¨‹èª²",icon:"pi pi-cog",value:"Engineering"}]},{label:"å®¢æˆ¶ç®¡ç†",icon:"pi pi-map-marker",value:"CustomerCategory",items:[{label:"å®¢æˆ¶è¿½è¹¤",icon:"pi pi-map-marker",value:"CustomerInfo",command:()=>{mA.push({name:"CustomerInfo"})}}]},{label:"æ¡ˆä»¶ç®¡ç†",icon:"pi pi-map-marker",value:"CaseCategory",items:[{label:"æ¡ˆä»¶è¿½è¹¤",icon:"pi pi-map-marker",value:"CaseTracking",command:()=>{mA.push({name:"CaseTracking"})}}]},{label:"æ¥­ç¸¾ç®¡ç†",icon:"pi pi-map-marker",value:"PerformanceManagement",items:[{label:"å¹´åº¦æ¥­ç¸¾",icon:"pi pi-map-marker",value:"PerformanceDashboard",command:()=>{mA.push({name:"PerformanceDashboard"})}},{label:"æ¥­ç¸¾å ±è¡¨",icon:"pi pi-map-marker",value:"PerformanceReport",command:()=>{mA.push({name:"PerformanceReport"})}},{label:"å€‹äººæ¥­ç¸¾",icon:"pi pi-map-marker",value:"PersonalGoals",command:()=>{mA.push({name:"PersonalGoals"})}}]},{label:"é™Œé–‹ç®¡ç†",icon:"pi pi-map-marker",value:"ColdCallingManagement",items:[{label:"é™Œé–‹å ±è¡¨",icon:"pi pi-map-marker",value:"ColdCallingReport",command:()=>{mA.push({name:"ColdCallingReport"})}},{label:"å®¢æˆ¶æ‹œè¨ª",icon:"pi pi-map-marker",value:"CustomerReport",command:()=>{mA.push({name:"CustomerReport"})}}]}]},{label:"æ­£èˆªè³‡è¨Š",icon:"pi pi-chart-bar",value:"ChingHangInformation",items:[{label:"éŠ·è²¨è³‡è¨Š",icon:"pi pi-shopping-cart",value:"SalesInfo",items:[{label:"éŠ·è²¨æŸ¥è©¢",icon:"pi pi-search",value:"SalesQuery",command:()=>mA.push("/SalesQuery")}]}]},{label:"è²¡å‹™éƒ¨",icon:"pi pi-dollar",requiredRoles:["RO0013"],value:"Finance",items:[{label:"äººè³‡èª²",icon:"pi pi-users",value:"HR"},{label:"ç¸½å‹™èª²",icon:"pi pi-inbox",value:"GeneralAffairs"},{label:"æœƒè¨ˆèª²",icon:"pi pi-calculator",value:"Accounting",items:[{label:"è–ªè³‡çµæ§‹",icon:"pi pi-calculator",value:"Salary",command:()=>{mA.push({name:"SalaryStructure"})}},{label:"è€ƒå‹¤æŸ¥è©¢",icon:"pi pi-calendar",value:"AttendanceRecord",command:()=>{mA.push({name:"SalarySlip"})}},{label:"æ¯æ—¥è€ƒå‹¤",icon:"pi pi-calendar",value:"DailyAttendanceRecord",command:()=>{mA.push({name:"DailyAttendanceRecord"})}},{label:"èª¤é¤åŠ ç¸½",icon:"pi pi-chart-bar",value:"MealAllowanceSummary",command:()=>{mA.push({name:"MealAllowanceSummary"})}},{label:"ç‰¹ä¼‘æ—¥æ•¸",icon:"pi pi-calendar-times",value:"AnnualLeaveSummary",command:()=>{mA.push({name:"AnnualLeaveSummary"})}},{label:"åŠ ç­é é¢è³‡è¨Š",icon:"pi pi-clock",value:"OvertimePageInfo",command:()=>{mA.push({name:"OvertimePageInfo"})}},{label:"è«‹å‡é é¢è³‡è¨Š",icon:"pi pi-calendar-times",value:"LeavePageInfo",command:()=>{mA.push({name:"LeavePageInfo"})}}]},{label:"è²¡å‹™èª²",icon:"pi pi-wallet",value:"Finance"}]},{label:"è·å®‰å®¤",icon:"pi pi-shield",value:"OccupationalSafety",items:[{label:"åŒ—ç‡Ÿæ¥­å€",icon:"pi pi-map-marker",value:"NorthArea"},{label:"ä¸­ç‡Ÿæ¥­å€",icon:"pi pi-map-marker",value:"CentralArea"},{label:"å—ç‡Ÿæ¥­å€",icon:"pi pi-map-marker",value:"SouthArea"}]},{label:"å…¶ä»–",icon:"pi pi-briefcase",value:"Others",items:[]},{label:"ç³»çµ±ç®¡ç†",icon:"pi pi-map",value:"SystemManagement",requiredRoles:["RO0000"],items:[{label:"é›»è…¦ç®¡ç†",icon:"pi pi-globe",value:"MACForm",items:[{label:"MACè¡¨å–®ç¶­è­·",icon:"pi pi-globe",value:"MACForm",command:()=>mA.push({name:"sys_MacForm",params:{sys:"true"}})},{label:"é›»è…¦æ¸…å–®ç›¤æŸ¥ç¶­è­·",icon:"pi pi-map-marker",value:"ComputerInventory",command:()=>mA.push({name:"sys_ComputerInventory",params:{sys:"true"}})},{label:"è¨­å‚™/ä¸»æ©Ÿç®¡ç†",icon:"pi pi-server",value:"DeviceHostManagement",command:()=>mA.push({name:"DeviceHostManagement",params:{sys:"true"}})}]},{label:"äººå“¡ç®¡ç†",icon:"pi pi-map",value:"DAE_Management",requiredRoles:["RO0000"],items:[{label:"äººå“¡ç®¡ç†",icon:"",value:"sys_DAE_Data_Management",command:()=>mA.push({name:"sys_DAE_Data_Management",params:{sys:"true"}})}]},{label:"ç°½æ ¸ç®¡ç†",icon:"pi pi-map",value:"WF_Management",requiredRoles:["RO0000"],items:[{label:"ç°½æ ¸å–®æ“šç®¡ç†",icon:"",value:"sys_WF_Management",command:()=>mA.push({name:"sys_WF_Management",params:{sys:"true"}})}]},{label:"è¡¨å–®ç®¡ç†",icon:"pi pi-file-edit",value:"FormTemplate_Management",requiredRoles:["RO0000"],items:[{label:"å‹•æ…‹è¡¨å–®ç®¡ç†",icon:"pi pi-file-edit",value:"FormTemplateManagement",command:()=>mA.push({name:"FormTemplateManagement",params:{sys:"true"}})}]}]}]}var I=l(575),x=l(70111),E=l(22653),A=l(96126),T=l(13830),W=l(79802),S=l(64783);const U={class:"flex flex-column px-5 py-5 gap-4",style:{"border-radius":"12px","background-image":"radial-gradient(circle at left top, var(--p-sky-800), var(--p-teal-300), var(--p-cyan-900))"}},$={class:"inline-flex flex-column gap-2"},N={class:"inline-flex flex-column gap-2"},X={class:"flex align-items-center gap-3"};var K={__name:"login-dialog",props:{visible:{type:Boolean,default:!1}},emits:["update:visible","login-success"],setup(e,{emit:a}){const l=e,o=a,n=(0,u.EW)({get:()=>l.visible,set:e=>o("update:visible",e)}),r=(0,S.k)(),s=(0,d.KR)(""),i=(0,d.KR)(""),c=(0,d.KR)(""),p=(0,d.KR)(""),v=(0,d.KR)(""),b=(0,d.KR)(""),g=(0,d.KR)(!1),y=(0,T.d)();let f;(0,u.wB)((()=>r.userId),(e=>{e||(s.value=null)}));const h=()=>{const e=m().get("userId"),a=m().get("userName"),l=m().get("departmentId"),t=m().get("departmentName"),o=m().get("dpt_title_Id");e&&(s.value=e,r.setUserInfo(a,l,t,e,o)),c.value=m().get("userName")||c.value,p.value=m().get("departmentId")||p.value,v.value=m().get("departmentName")||v.value,b.value=m().get("dpt_title_Id")||b.value,r.checkCookies()},k=async e=>{try{const a={userId:s.value,userPwd:i.value};console.log("userCredentials:",a);const l=await W.A.login_JWT(a);if(await(0,u.dY)(),c.value=r.userName,b.value=r.userDeptName+" "+r.dpt_title_Id,r.checkCookies(),"Login Success"===l){const a=m().get("userName"),l=m().get("departmentId"),t=m().get("departmentName"),n=m().get("userId"),s=m().get("dpt_title_Id");r.setUserInfo(a,l,t,n,s),y.add({severity:"success",summary:"Success",detail:"ç™»å…¥æˆåŠŸ!",life:3e3}),e(),o("login-success")}else console.error("Error logging"),g.value=!0,y.add({severity:"error",summary:"Error",detail:"ç™»å…¥å¤±æ•—!",life:3e3})}catch(a){console.error("Error logging in:",a),g.value=!0,y.add({severity:"error",summary:"Error",detail:"ç™»å…¥å¤±æ•—!",life:3e3})}},_=()=>{f&&clearInterval(f)};return(0,u.sV)((()=>{h()})),(0,u.xo)((()=>{_()})),(e,a)=>{const l=(0,u.gN)("focus");return(0,u.uX)(),(0,u.CE)(u.FK,null,[n.value?((0,u.uX)(),(0,u.Wv)((0,d.R1)(I.A),{key:0,visible:n.value,"onUpdate:visible":a[2]||(a[2]=e=>n.value=e),"pt:root:class":"!border-0 !bg-transparent","pt:mask:class":"backdrop-blur-sm",modal:""},{container:(0,u.k6)((({closeCallback:e})=>[(0,u.Lk)("div",U,[(0,u.Lk)("div",$,[a[3]||(a[3]=(0,u.Lk)("svg",{width:"120",height:"120",viewBox:"0 0 120 120",class:"block mx-auto"},[(0,u.Lk)("image",{href:R,x:"0",y:"0",width:"120",height:"120"})],-1)),a[4]||(a[4]=(0,u.Lk)("label",{for:"userId",class:"text-primary-50 font-semibold"},"å¸³è™Ÿ",-1)),(0,u.bo)((0,u.bF)((0,d.R1)(x.A),{id:"userId",modelValue:s.value,"onUpdate:modelValue":a[0]||(a[0]=e=>s.value=e),class:"bg-white-alpha-20 border-none p-3 text-primary-50 w-20rem",onKeyup:(0,t.jR)((a=>k(e)),["enter"])},null,8,["modelValue","onKeyup"]),[[l]])]),(0,u.Lk)("div",N,[a[5]||(a[5]=(0,u.Lk)("label",{for:"password",class:"text-primary-50 font-semibold"},"å¯†ç¢¼",-1)),(0,u.bF)((0,d.R1)(x.A),{id:"password",modelValue:i.value,"onUpdate:modelValue":a[1]||(a[1]=e=>i.value=e),class:"bg-white-alpha-20 border-none p-3 text-primary-50 w-20rem",type:"password",onKeyup:(0,t.jR)((a=>k(e)),["enter"])},null,8,["modelValue","onKeyup"])]),a[6]||(a[6]=(0,u.Lk)("label",{for:"userId",class:"text-primary-50 font-semibold"},"(å¯æŒ‰ä¸‹Enteré€²è¡Œç™»å…¥)",-1)),(0,u.Lk)("div",X,[(0,u.bF)((0,d.R1)(E.A),{label:"ç™»å…¥",onClick:a=>k(e),text:"",class:"p-3 w-full text-primary-50 border-1 border-white-alpha-30 hover:bg-white-alpha-10"},null,8,["onClick"]),(0,u.bF)((0,d.R1)(E.A),{label:"å–æ¶ˆ",onClick:e,text:"",class:"p-3 w-full text-primary-50 border-1 border-white-alpha-30 hover:bg-white-alpha-10"},null,8,["onClick"])])])])),_:1},8,["visible"])):(0,u.Q3)("",!0),(0,u.bF)((0,d.R1)(A.A))],64)}}};const M=K;var P=M,O=l(35931);const z={class:"language-selecter",style:{display:"flex","align-items":"center"}},B={class:"flex items-center"},j=["src"];var Y={__name:"language-selecter",setup(e){const{locale:a}=(0,O.s9)(),l=(0,d.KR)(a.value);(0,u.sV)((()=>{const e=localStorage.getItem("locale");e&&(a.value=e,l.value=e)}));const t=[{code:"zh-TW",label:"ä¸­æ–‡",img:"https://primefaces.org/cdn/primevue/images/flag/flag_tw.png"},{code:"en-US",label:"English",img:"https://primefaces.org/cdn/primevue/images/flag/flag_us.png"}];return(0,u.wB)(l,(e=>{a.value=e,console.log("locale changed:",e),localStorage.setItem("locale",e)})),(e,a)=>{const o=(0,u.g2)("el-option"),n=(0,u.g2)("el-select");return(0,u.uX)(),(0,u.CE)("div",z,[(0,u.Lk)("div",null,[(0,u.bF)(n,{modelValue:l.value,"onUpdate:modelValue":a[0]||(a[0]=e=>l.value=e),placeholder:"Select a Language","popper-class":"custom-select-popper",style:{width:"100px"},teleported:!1},{default:(0,u.k6)((()=>[((0,u.uX)(),(0,u.CE)(u.FK,null,(0,u.pI)(t,(e=>(0,u.bF)(o,{key:e.code,label:e.label,value:e.code},{default:(0,u.k6)((()=>[(0,u.Lk)("div",B,[(0,u.Lk)("img",{src:e.img,alt:"",style:{width:"20px","margin-right":"5px"}},null,8,j),(0,u.Lk)("span",null,(0,L.v_)(e.label),1)])])),_:2},1032,["label","value"]))),64))])),_:1},8,["modelValue"])])])}}};const Q=Y;var H=Q,q=l(73964),J=l(57477);function G(e){return window.google&&window.google.maps?Promise.resolve(window.google.maps):new Promise(((a,l)=>{const t=document.createElement("script");t.src=`https://maps.googleapis.com/maps/api/js?key=${e}&libraries=places`,t.async=!0,t.onload=()=>a(window.google.maps),t.onerror=()=>l(new Error("Google Maps è¼‰å…¥å¤±æ•—")),document.head.appendChild(t)}))}async function Z(e,a,l){try{const a={type:e,latitude:l.latitude,longitude:l.longitude,address:"",timestamp:new Date(Date.now()+288e5).toISOString(),timeZoneId:"Asia/Taipei",timeZoneName:"Taiwan Standard Time",dstOffset:0,rawOffset:28800};console.log("punch payload:",a),D.nk.success("ðŸŽ‰ æ‰“å¡æˆåŠŸï¼")}catch(t){console.error("Punch Error:",t),D.nk.error(t.message||"æ‰“å¡å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦")}}const ee={key:0,class:"punch-clock-container"},ae={class:"punch-buttons"},le={class:"button-content"},te={class:"button-time"},oe={class:"button-content"},ne={class:"button-time"},re={key:0,class:"punch-status"},se={class:"status-text"};var ue={__name:"PunchClock",setup(e){const a="AIzaSyDRTs9gWnVfvm6g9UCD2qtsqniWMxIzJWU",l=(0,d.KR)(!1),t=(0,d.KR)(""),o=(0,d.KR)(""),n=(0,d.KR)(""),r=(0,i.n)(),s=(0,S.k)(),c=()=>{const e=new Date;o.value=e.toLocaleTimeString("zh-TW",{hour:"2-digit",minute:"2-digit",second:"2-digit"})};let p=null;(0,u.sV)((()=>{c(),p=setInterval(c,1e3)})),(0,u.hi)((()=>{p&&clearInterval(p)}));const m=(0,u.EW)((()=>r.user.permissions?.includes("sys")||!1));async function v(e){l.value=!0,t.value=e;try{const l=await G(a),t=new l.Geocoder,r=await new Promise(((e,a)=>{navigator.geolocation.getCurrentPosition((a=>{e(a.coords)}),(e=>{a(e)}),{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})}));let u="";try{const e={lat:r.latitude,lng:r.longitude},a=await t.geocode({location:e});u=a&&a.results&&a.results[0]?a.results[0].formatted_address:"ç„¡æ³•å–å¾—åœ°å€ (ç„¡çµæžœ)"}catch(o){console.warn("Geocoding failed:",o),u="ç„¡æ³•å–å¾—åœ°å€ (API éŒ¯èª¤)"}D.nk.success(`å–å¾—åœ°å€ï¼š${u}`),await Z(e,s.userId,{latitude:r.latitude,longitude:r.longitude,address:u});const i=new Date,d=i.toLocaleString("zh-TW");n.value=`${"In"===e?"ä¸Šç­":"ä¸‹ç­"} - ${d}`,D.nk.success(("In"===e?"ä¸Šç­":"ä¸‹ç­")+"æ‰“å¡æˆåŠŸï¼")}catch(r){console.error("Punch Error:",r),D.nk.error(r.message||"æ‰“å¡å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦")}finally{l.value=!1,t.value=""}}return(e,a)=>{const r=(0,u.g2)("el-icon"),s=(0,u.g2)("el-button");return m.value?((0,u.uX)(),(0,u.CE)("div",ee,[(0,u.Lk)("div",ae,[(0,u.bF)(s,{onClick:a[0]||(a[0]=e=>v("In")),type:"success",disabled:l.value,loading:l.value&&"In"===t.value,size:"default",class:"punch-button punch-in"},{default:(0,u.k6)((()=>[(0,u.Lk)("div",le,[(0,u.bF)(r,{class:"button-icon"},{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.CaretTop))])),_:1}),a[2]||(a[2]=(0,u.Lk)("span",{class:"button-text"},"ä¸Šç­æ‰“å¡",-1)),(0,u.Lk)("span",te,(0,L.v_)(o.value),1)])])),_:1},8,["disabled","loading"]),(0,u.bF)(s,{onClick:a[1]||(a[1]=e=>v("Out")),type:"warning",disabled:l.value,loading:l.value&&"Out"===t.value,size:"default",class:"punch-button punch-out"},{default:(0,u.k6)((()=>[(0,u.Lk)("div",oe,[(0,u.bF)(r,{class:"button-icon"},{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.CaretBottom))])),_:1}),a[3]||(a[3]=(0,u.Lk)("span",{class:"button-text"},"ä¸‹ç­æ‰“å¡",-1)),(0,u.Lk)("span",ne,(0,L.v_)(o.value),1)])])),_:1},8,["disabled","loading"])]),n.value?((0,u.uX)(),(0,u.CE)("div",re,[(0,u.Lk)("p",se,"ä¸Šæ¬¡æ‰“å¡ï¼š"+(0,L.v_)(n.value),1)])):(0,u.Q3)("",!0)])):(0,u.Q3)("",!0)}}},ie=l(71241);const de=(0,ie.A)(ue,[["__scopeId","data-v-f89ffe42"]]);var ce=de;const pe={class:"user-info-top-right"},me={class:"user-info-container"},ve={class:"user-info-top-right flex items-center gap-2 px-3 py-2 rounded cursor-pointer",style:{color:"aliceblue"}},be={key:0,class:"span-name"},ge={class:"flex flex-col gap-4"},ye={class:"user-info flex items-center"},fe={class:"pr-3 pl-2 pt-3"},he={class:"flex flex-col gap-2"},ke={class:"user-details flex items-center gap-2"},_e={class:"font-bold"},we={class:"theme-switch-item"},Fe={key:0};var Ce={__name:"HeaderOption",setup(e){const a=(0,i.n)(),t=a.user.permissions||[],o=(0,C.rd)(),n=c(),r=(0,d.KR)(n.isDark());(0,u.wB)((()=>n.currentTheme),(e=>{r.value="dark"===e}));const s=e=>{n.setTheme(e?"dark":"light"),D.nk.success(`å·²åˆ‡æ›è‡³${e?"æ·±è‰²":"äº®è‰²"}æ¨¡å¼`)},p=(0,S.k)(),v=(0,d.KR)(!1),b=(0,d.KR)(!1),g=()=>{o.push({name:"Login"})},y=()=>{o.push({name:"PersonalInformation"})},f=()=>{o.push({name:"PersonalAttendanceRecord"}),b.value=!1},h=(0,u.EW)((()=>p.userName||""));(0,u.wB)((()=>p.userName),(e=>{e||(v.value=!1,b.value=!1)}));const k=()=>{v.value=!0,b.value=!1},_=async()=>{try{const{stopPresenceHub:e}=await Promise.resolve().then(l.bind(l,98815)),{stopOnlineHub:a}=await Promise.resolve().then(l.bind(l,11826));await Promise.all([e(),a()]),console.log("SignalR é€£ç·šå·²æ­£ç¢ºæ–·é–‹")}catch(e){console.error("æ–·é–‹ SignalR é€£ç·šæ™‚ç™¼ç”ŸéŒ¯èª¤:",e)}p.clearUserInfo(),m().remove("userId"),m().remove("userName"),m().remove("departmentId"),m().remove("departmentName"),m().remove("dpt_title_Id"),m().remove("titleId"),m().remove("titleName"),m().remove("email"),localStorage.removeItem("auth"),b.value=!1,g()},w=()=>{v.value=!1};return(e,a)=>{const l=(0,u.g2)("el-icon"),o=(0,u.g2)("el-avatar"),n=(0,u.g2)("el-divider"),i=(0,u.g2)("el-menu-item"),c=(0,u.g2)("Sunny"),m=(0,u.g2)("el-switch"),F=(0,u.g2)("Setting"),C=(0,u.g2)("Message"),D=(0,u.g2)("SwitchButton"),R=(0,u.g2)("el-menu"),V=(0,u.g2)("el-popover");return(0,u.uX)(),(0,u.CE)(u.FK,null,[(0,u.Lk)("div",pe,[(0,u.Lk)("div",me,[(0,d.R1)(p).userId?((0,u.uX)(),(0,u.Wv)(V,{key:0,placement:"bottom-end",width:400,trigger:"click",persistent:"","popper-class":"fixed-popover",visible:b.value,"onUpdate:visible":a[1]||(a[1]=e=>b.value=e)},{reference:(0,u.k6)((()=>[(0,u.Lk)("div",ve,[(0,d.R1)(p).userId?((0,u.uX)(),(0,u.CE)("span",be,(0,L.v_)(h.value),1)):((0,u.uX)(),(0,u.CE)("span",{key:1,onClick:k},"ç™»å…¥")),(0,u.bF)(l,{class:"dialogButton"},{default:(0,u.k6)((()=>[((0,u.uX)(),(0,u.Wv)((0,u.$y)(b.value?"ArrowUp":"ArrowDown")))])),_:1})])])),default:(0,u.k6)((()=>[(0,u.Lk)("div",ge,[(0,u.Lk)("div",ye,[(0,u.Lk)("div",fe,[(0,u.bF)(o,{size:60,src:(0,d.R1)(p).userAvatar||"https://cube.elemecdn.com/3/7c/3ea6beec64369c2642b92c6726f1epng.png"},null,8,["src"])]),(0,u.Lk)("div",he,[(0,u.Lk)("div",ke,[(0,u.Lk)("span",_e,(0,L.v_)(h.value),1),(0,u.bF)(H,{style:{"margin-left":"7.2rem"}}),h.value?(0,u.Q3)("",!0):((0,u.uX)(),(0,u.CE)("span",{key:0,class:"text-gray-500 cursor-pointer",onClick:k},"è«‹å…ˆç™»å…¥"))])])]),(0,u.bF)(n,{style:{"margin-top":"0rem","margin-bottom":"0rem"}}),(0,u.bF)(R,{class:"border-none"},{default:(0,u.k6)((()=>[(0,u.bF)(ce),(0,u.bF)(i,{index:"4",onClick:f},{default:(0,u.k6)((()=>a[3]||(a[3]=[(0,u.Lk)("span",null,"è€ƒå‹¤æ™‚é–“/å€‹äººå‡åˆ¥",-1)]))),_:1}),(0,d.R1)(t).includes("dev")?((0,u.uX)(),(0,u.Wv)(i,{key:0,index:"0"},{default:(0,u.k6)((()=>[(0,u.Lk)("div",we,[(0,u.bF)(l,null,{default:(0,u.k6)((()=>[(0,u.bF)(c)])),_:1}),a[6]||(a[6]=(0,u.Lk)("span",null,"ä¸»é¡Œ",-1)),(0,u.bF)(m,{modelValue:r.value,"onUpdate:modelValue":a[0]||(a[0]=e=>r.value=e),onChange:s,"active-color":"#1f2937","inactive-color":"#f59e0b",size:"small",style:{"margin-left":"auto","--el-switch-on-color":"#1f2937","--el-switch-off-color":"#f59e0b"}},{"active-action":(0,u.k6)((()=>a[4]||(a[4]=[(0,u.Lk)("span",{style:{"font-size":"10px"}},"ðŸŒ™",-1)]))),"inactive-action":(0,u.k6)((()=>a[5]||(a[5]=[(0,u.Lk)("span",{style:{"font-size":"12px"}},"â˜€ï¸",-1)]))),_:1},8,["modelValue"])])])),_:1})):(0,u.Q3)("",!0),(0,u.bF)(i,{index:"1",onClick:y},{default:(0,u.k6)((()=>[(0,u.bF)(l,null,{default:(0,u.k6)((()=>[(0,u.bF)(F)])),_:1}),a[7]||(a[7]=(0,u.Lk)("span",null,"è¨­å®š",-1))])),_:1}),(0,u.bF)(i,{index:"2"},{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(q.A),{value:"0",size:"small",severity:"danger",class:"badge-top-right"}),(0,u.bF)(l,{style:{position:"relative",top:"2px"}},{default:(0,u.k6)((()=>[(0,u.bF)(C)])),_:1}),a[8]||(a[8]=(0,u.Lk)("span",null,"è¨Šæ¯",-1))])),_:1}),(0,u.bF)(i,{index:"3",onClick:_},{default:(0,u.k6)((()=>[(0,u.bF)(l,{class:"switchButton",style:{"font-size":"1rem"}},{default:(0,u.k6)((()=>[(0,u.bF)(D)])),_:1}),(0,d.R1)(p).userName?((0,u.uX)(),(0,u.CE)("span",Fe,"ç™»å‡º")):(0,u.Q3)("",!0)])),_:1})])),_:1})])])),_:1},8,["visible"])):((0,u.uX)(),(0,u.CE)("div",{key:1,class:"user-info-top-right flex items-center gap-2 px-3 py-2 rounded cursor-pointer",style:{height:"3rem","background-color":"rgba(255, 255, 255, 0.5)"},onClick:g},a[9]||(a[9]=[(0,u.Lk)("i",{class:"pi pi-user"},null,-1),(0,u.Lk)("span",null,"ç™»å…¥",-1)])))])]),(0,u.bF)(P,{visible:v.value,"onUpdate:visible":a[2]||(a[2]=e=>v.value=e),onLoginSuccess:w},null,8,["visible"])],64)}}};const De=(0,ie.A)(Ce,[["__scopeId","data-v-2f36833f"]]);var Le=De;const Re=["onKeydown","aria-expanded","aria-haspopup"],Ve={class:"menu-text"};var Ie={__name:"RecursiveMenuItem",props:{item:{type:Object,required:!0},activeKey:{type:String,default:null},level:{type:Number,default:0}},emits:["item-click","update:activeKey"],setup(e,{emit:a}){const l=e,o=a,n=(0,d.KR)(null),r=(0,d.KR)(null),s=(0,u.EW)((()=>l.item.items&&l.item.items.length>0)),i=(0,u.EW)((()=>l.activeKey===c)),c=l.item.value||l.item.label,p=(0,d.KR)({});function m(){s.value&&(o("update:activeKey",c),(0,u.dY)((()=>{b(),setTimeout((()=>{g()}),100)})))}function v(){s.value&&(n.value.contains(document.activeElement)||document.querySelector(".teleport-menu:hover")||o("update:activeKey",null))}function b(){if(!n.value)return;const e=n.value.getBoundingClientRect(),a=window.innerWidth,t=window.innerHeight,o=Math.max(200,1.2*e.width),r=Math.min(400,50*(l.item.items?.length||1)+20),s=document.querySelector(".modern-header-container"),u=s?s.offsetHeight:0,i=window.scrollY||document.documentElement.scrollTop||0,d=window.scrollX||document.documentElement.scrollLeft||0,c=i+u+5;if(0===l.level){let l=e.left+d,n=e.bottom+i;e.left+o>a&&(l=e.right+d-o,l=Math.max(d+10,l)),e.bottom+r>i+t&&(n=e.top+i-r,n<c&&(n=c)),p.value={position:"fixed",top:n-i+"px",left:l-d+"px",zIndex:1e3}}else{let l=e.right+d,n=e.top+i;if(e.right+o>a&&(l=e.left+d-o+10,l=Math.max(d+10,l)),e.top+r>i+t){const e=i+t-r;n=Math.max(c,Math.min(n,e))}n<c&&(n=c),p.value={position:"fixed",top:n-i+"px",left:l-d+"px",zIndex:1001}}}function g(){if(!n.value||!i.value)return;const e=document.querySelectorAll(".teleport-menu");if(0===e.length)return;const a=e[e.length-1];if(!a)return;const t=n.value.getBoundingClientRect(),o=a.getBoundingClientRect(),r=window.innerWidth,s=window.innerHeight,u=document.querySelector(".modern-header-container"),d=u?u.offsetHeight:80;let c=t.left,m=t.bottom,v=!1;0===l.level?(t.bottom+o.height>s&&(m=t.top-o.height,m<d+5&&(m=d+5),v=!0),t.left+o.width>r&&(c=t.right-o.width,c=Math.max(10,c),v=!0),p.value={position:"fixed",top:m+"px",left:c+"px",zIndex:1e3}):(c=t.right,m=t.top,t.right+o.width>r&&(c=t.left-o.width+10,c=Math.max(10,c),v=!0),t.top+o.height>s&&(m=s-o.height,m<d+5&&(m=d+5),v=!0),p.value={position:"fixed",top:m+"px",left:c+"px",zIndex:1001})}const y=(0,u.EW)((()=>0===l.level?i.value?J.ArrowDownBold:J.ArrowDown:i.value?J.ArrowRightBold:J.DArrowRight));function f(e){o("item-click",e),o("update:activeKey",null),r.value=null}function h(e){e?.stopPropagation();const a=e?.currentTarget;if(a&&(a.classList.add("clicking"),setTimeout((()=>{a.classList.remove("clicking")}),150)),s.value){const e=i.value?null:c;o("update:activeKey",e),i.value&&(r.value=null)}else try{l.item.command&&"function"===typeof l.item.command&&l.item.command(),o("item-click",l.item),o("update:activeKey",null),r.value=null}catch(t){console.error("åŸ·è¡Œé¸å–®å‘½ä»¤æ™‚ç™¼ç”ŸéŒ¯èª¤:",t)}}return(a,l)=>{const o=(0,u.g2)("el-icon"),d=(0,u.g2)("RecursiveMenuItem",!0);return(0,u.uX)(),(0,u.CE)("div",{class:(0,L.C4)(["modern-menu-item",{"has-children":s.value,"is-active":i.value}]),ref_key:"itemRef",ref:n,onMouseenter:m,onMouseleave:v},[(0,u.Lk)("div",{class:"menu-content",onClick:h,onKeydown:[(0,t.jR)(h,["enter"]),(0,t.jR)((0,t.D$)(h,["prevent"]),["space"])],tabindex:"0",role:"menuitem","aria-expanded":s.value?i.value:void 0,"aria-haspopup":s.value},[(0,u.Lk)("span",Ve,(0,L.v_)(e.item.label),1),s.value?((0,u.uX)(),(0,u.Wv)(o,{key:0,class:"menu-arrow"},{default:(0,u.k6)((()=>[((0,u.uX)(),(0,u.Wv)((0,u.$y)(y.value)))])),_:1})):(0,u.Q3)("",!0)],40,Re),i.value&&s.value?((0,u.uX)(),(0,u.Wv)(u.Im,{key:0,to:"body"},[(0,u.Lk)("div",{class:"modern-submenu teleport-menu",style:(0,L.Tr)(p.value),onClick:l[1]||(l[1]=(0,t.D$)((()=>{}),["stop"])),role:"menu"},[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(e.item.items,((a,t)=>((0,u.uX)(),(0,u.Wv)(d,{key:a.value+"_"+t,item:a,activeKey:r.value,level:e.level+1,"onUpdate:activeKey":l[0]||(l[0]=e=>r.value=e),onItemClick:f,class:"submenu-item"},null,8,["item","activeKey","level"])))),128))],4)])):(0,u.Q3)("",!0)],34)}}};const xe=(0,ie.A)(Ie,[["__scopeId","data-v-39d8b5c0"]]);var Ee=xe,Ae={__name:"CustomMenubar",props:{model:{type:Array,required:!0}},emits:["item-click"],setup(e,{emit:a}){const l=e,t=(0,d.KR)(window.innerWidth<=768),o=a,n=(0,d.KR)(null),r=(0,d.KR)(null),s=(0,d.KR)(null),i=e=>{o("item-click",e)},c=()=>{r.value&&r.value.scrollBy({left:-500,behavior:"smooth"})},p=()=>{r.value&&r.value.scrollBy({left:500,behavior:"smooth"})};function m(){t.value=window.innerWidth<=768}function v(e){if(s.value){const a=n.value&&n.value.contains(e.target),l=e.target.closest(".teleport-menu");a||l||(s.value=null)}}function b(){s.value=null}return(0,u.sV)((()=>{document.addEventListener("mousemove",v),document.addEventListener("wheel",b),window.addEventListener("resize",m)})),(0,u.hi)((()=>{window.removeEventListener("resize",m)})),(0,u.xo)((()=>{document.removeEventListener("mousemove",v),document.removeEventListener("wheel",b)})),(e,a)=>((0,u.uX)(),(0,u.CE)("div",{class:"custom-menubar w-[140%] max-2560:w-[120%] max-1920:w-[85%] max-1745:ml-[0rem] max-1536:w-[82%] max-1366:w-[70%] max-1280:w-[80%] max-1280:ml-[-3rem] max-1180:w-[75%] max-820:w-full max-600:w-full max-430:w-full max-375:w-[120%] flex items-center flex-nowrap relative gap-2 z-9999",ref_key:"menubar",ref:n},[t.value?(0,u.Q3)("",!0):((0,u.uX)(),(0,u.CE)("button",{key:0,class:"arrow-btn left arrow max-600:ml-[-3rem] max-700:ml-[-3rem] max-768:ml-[-2rem] max-820:ml-[-2rem] max-960:ml-[-1rem] max-1097:ml-[-2rem] max-1180:ml-[-1rem] max-1280:ml-[0rem] max-1366:ml-[-1rem] max-1536:ml-[-2rem] max-1745:ml-[2rem] max-1920:ml-[0rem]",onClick:c},a[1]||(a[1]=[(0,u.Lk)("i",{class:"pi pi-chevron-left arrow max-820:text-[0.5rem] max-768:ml-[0rem]"},null,-1)]))),t.value?(0,u.Q3)("",!0):((0,u.uX)(),(0,u.CE)("button",{key:1,class:"arrow-btn right arrow max-600:ml-[0rem] max-768:ml-[0rem] max-820:ml-[0rem] max-820:mr-[-1rem] max-960:ml-[0rem] max-970:ml-[0rem] max-965:mr-[-2rem] max-1097:ml-[0rem] max-1120:ml-[1rem] max-1180:ml-[0rem] max-1280:ml-[0rem] max-1366:ml-[0rem] max-1536:ml-[0rem] max-1745:ml-[2rem] max-1920:ml-[1rem]",onClick:p},a[2]||(a[2]=[(0,u.Lk)("i",{class:"pi pi-chevron-right arrow"},null,-1)]))),(0,u.Lk)("div",{class:"menu-items-container",ref_key:"scrollContainer",ref:r},[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(l.model,((e,l)=>((0,u.uX)(),(0,u.Wv)(Ee,{key:e.value+"_"+l,item:e,activeKey:s.value,"onUpdate:activeKey":a[0]||(a[0]=e=>s.value=e),onItemClick:i},null,8,["item","activeKey"])))),128))],512)],512))}};const Te=(0,ie.A)(Ae,[["__scopeId","data-v-5b62855b"]]);var We=Te;l(37550);function Se(e,a){return e.filter((e=>!e.requiredRoles||e.requiredRoles.some((e=>a.includes(e))))).map((e=>{const l={...e};return l.items&&(l.items=Se(l.items,a)),l}))}const Ue={class:"viewport-info"};var $e={__name:"ViewportInfo",setup(e){const a=(0,d.KR)(`${window.innerWidth} Ã— ${window.innerHeight}`),l=()=>{a.value=`${window.innerWidth} Ã— ${window.innerHeight}`};return(0,u.sV)((()=>addEventListener("resize",l,{passive:!0}))),(0,u.xo)((()=>removeEventListener("resize",l))),(e,l)=>((0,u.uX)(),(0,u.CE)("div",Ue,(0,L.v_)(a.value),1))}};const Ne=(0,ie.A)($e,[["__scopeId","data-v-7330f884"]]);var Xe=Ne,Ke=l(11826),Me=l(98815);const Pe={class:"sticky-menu-container relative px-4"},Oe={class:"Menubar-Container"},ze={key:0},Be={class:"online-users-content"},je={class:"dialog-header"},Ye={class:"header-title"},Qe={key:0},He={class:"users-list"},qe={key:0,class:"no-data"},Je={key:1},Ge={class:"user-info"},Ze={class:"user-details"},ea={class:"user-id"},aa={key:0,class:"mobile-user-info"},la={class:"user-department-mobile"},ta={class:"user-ip-mobile"},oa={class:"user-time-mobile"},na={key:0,class:"user-roles-mobile"},ra={key:0,class:"more-roles"},sa={key:1,class:"desktop-user-info"},ua={class:"user-department"},ia={class:"user-ip"},da={class:"user-time"},ca={key:0,class:"user-connection"},pa={key:1,class:"user-roles"},ma={key:2,class:"user-permissions"},va={key:0},ba={class:"user-status"},ga={class:"dialog-footer"},ya={class:"footer-info"};var fa={__name:"HomeMenu",props:{loginUser:String,loginDpt:String,loginId:String,loginTitle:String},emits:["menu-selected"],setup(e,{emit:a}){const l=(0,i.n)(),t=l.user.permissions||[],o=(0,C.rd)(),n=(0,d.KR)(!1),r=(0,d.KR)(!1),s=(0,d.KR)([]),c=(0,u.EW)((()=>{if("undefined"!==typeof window){const e=window.innerWidth;return e<=480?"95%":e<=768?"90%":e<=1024?"80%":"600px"}return"600px"})),p=(0,u.EW)((()=>"undefined"!==typeof window&&window.innerWidth<=768)),m=async()=>{n.value=!0,await v()},v=async()=>{r.value=!0;try{const[e,a]=await Promise.all([W.A.getOnlineUsers().catch((()=>({data:{success:!1,users:[]}}))),W.A.getPresenceOnlineUsers().catch((()=>({data:{success:!1,connections:[]}})))]),l=[];if(e.data&&e.data.success){const a=e.data.users.filter((e=>"æœªçŸ¥ç”¨æˆ¶"!==e.userId&&"æœªè¨»å†Šç”¨æˆ¶"!==e.userName&&""!==e.userId&&""!==e.userName)).map((e=>({userName:e.userName||"æœªçŸ¥ä½¿ç”¨è€…",userId:e.userId,ip:e.ipAddress||"æœªçŸ¥IP",connectTime:new Date(e.connectedAt),departmentName:e.departmentName||"æœªçŸ¥éƒ¨é–€",titleName:e.titleName||"æœªçŸ¥è·ç¨±",email:e.email||"",roles:e.roles||[],roleNames:e.roleNames||[],permissions:e.permissions||[],onlineDuration:e.onlineDuration,isRegistered:e.isRegistered||!1,connectionId:e.connectionId,source:"memory",dataType:e.isRegistered?"registered":"basic"})));l.push(...a)}if(a.data&&a.data.success){const e=a.data.connections.map((e=>({userName:e.userName||"è³‡æ–™åº«é€£ç·š",userId:e.userId,ip:e.ip||"æœªçŸ¥IP",connectTime:new Date(e.connectedAt),departmentName:"è³‡æ–™åº«è¿½è¹¤",titleName:"æŒä¹…åŒ–é€£ç·š",email:"",roles:[],roleNames:[],permissions:[],onlineDuration:e.durationSeconds?`${Math.floor(e.durationSeconds/60)} åˆ†é˜`:"",isRegistered:!0,connectionId:e.connectionId,source:"database",dataType:"persistent",lastSeen:new Date(e.lastSeen),serverId:e.serverId})));l.push(...e)}const t=[],o=new Set;l.filter((e=>"memory"===e.source)).forEach((e=>{t.push(e),o.add(e.connectionId)})),l.filter((e=>"database"===e.source&&!o.has(e.connectionId))).forEach((e=>{t.push(e)})),s.value=t.sort(((e,a)=>e.isRegistered!==a.isRegistered?a.isRegistered-e.isRegistered:new Date(a.connectTime)-new Date(e.connectTime)));const n=document.getElementById("onlineCount");n&&(n.innerText=s.value.length),D.nk.success(`æˆåŠŸè¼‰å…¥ ${s.value.length} ä½ç·šä¸Šä½¿ç”¨è€…è³‡æ–™`)}catch(e){console.error("å–å¾—ç·šä¸Šä½¿ç”¨è€…è³‡æ–™æ™‚ç™¼ç”ŸéŒ¯èª¤:",e),D.nk.error("å–å¾—ç·šä¸Šä½¿ç”¨è€…è³‡æ–™å¤±æ•—: "+(e.response?.data?.message||e.message)),s.value=[]}finally{r.value=!1}},b=async()=>{await v()},g=e=>{if(!e)return"-";try{const a=new Date(e),l=a.getFullYear(),t=String(a.getMonth()+1).padStart(2,"0"),o=String(a.getDate()).padStart(2,"0"),n=String(a.getHours()).padStart(2,"0"),r=String(a.getMinutes()).padStart(2,"0"),s=String(a.getSeconds()).padStart(2,"0");return`${l}/${t}/${o} ${n}:${r}:${s}`}catch(a){return e.toString()}},y=e,f=a,h=(0,u.EW)((()=>{const e=V(y,(e=>f("menu-selected",e)));return Se(e,l.user.roles)})),k=()=>{o.push({name:"List_WF_Personal"})},_=(0,d.KR)(0),w=e=>{const{count:a}=e.detail;_.value=a};return(0,u.sV)((async()=>{await Promise.all([(0,Ke.N)(),(0,Me.lG)()]),window.addEventListener("registeredUsersUpdated",w)})),(0,u.hi)((()=>{(0,Ke.stopOnlineHub)(),(0,Me.stopPresenceHub)(),window.removeEventListener("registeredUsersUpdated",w)})),(e,a)=>{const l=(0,u.g2)("el-icon"),o=(0,u.g2)("el-button"),i=(0,u.g2)("el-empty"),v=(0,u.g2)("el-avatar"),y=(0,u.g2)("el-tag"),f=(0,u.g2)("el-dialog"),_=(0,u.gN)("loading");return(0,u.uX)(),(0,u.CE)(u.FK,null,[(0,u.Lk)("div",Pe,[((0,u.uX)(),(0,u.CE)("svg",{onClick:k,viewBox:"0 0 20 20",class:"w-16 h-16 max-600:w-[20px] max-600:h-[20px] max-820:w-[20px] max-820:h-[20px] max-1180:w-[30px] max-1180:h-[30px] max-1280:w-[40px] max-1280:h-[40px] max-1300:w-[45px] max-1300:h-[45px] max-1366:w-[55px] max-1366:h-[55px] max-1536:w-[60px] max-1536:h-[60px] max-1536:ml-[-1rem] max-1920:w-[70px] max-1920:h-[70px]"},a[2]||(a[2]=[(0,u.Lk)("image",{href:R,class:"w-full h-full cursor-pointer",x:"0",y:"0"},null,-1)]))),(0,u.Lk)("div",Oe,[(0,u.bF)(We,{model:h.value},null,8,["model"])])]),(0,d.R1)(t).includes("dev")?((0,u.uX)(),(0,u.CE)("div",ze,[(0,u.bF)((0,d.R1)(Xe)),(0,u.Lk)("div",{class:"online-person",onClick:m},a[3]||(a[3]=[(0,u.eW)(" ç›®å‰ç·šä¸Šäººæ•¸ï¼š"),(0,u.Lk)("span",{id:"onlineCount"},"0",-1),(0,u.Lk)("span",{class:"click-hint"},"ï¼ˆé»žæ“ŠæŸ¥çœ‹è©³æƒ…ï¼‰",-1)]))])):(0,u.Q3)("",!0),(0,u.Lk)("div",null,[(0,u.bF)(Le)]),(0,u.bF)(f,{modelValue:n.value,"onUpdate:modelValue":a[1]||(a[1]=e=>n.value=e),title:"ç·šä¸Šä½¿ç”¨è€… IP æ¸…å–®",width:c.value,"close-on-click-modal":!0,"close-on-press-escape":!0,center:"",class:"online-users-dialog"},{footer:(0,u.k6)((()=>[(0,u.Lk)("div",ga,[(0,u.Lk)("span",ya," ç¸½è¨ˆ: "+(0,L.v_)(s.value.length)+" ä½ä½¿ç”¨è€…ç·šä¸Š ",1),(0,u.bF)(o,{onClick:a[0]||(a[0]=e=>n.value=!1)},{default:(0,u.k6)((()=>a[7]||(a[7]=[(0,u.eW)("é—œé–‰")]))),_:1})])])),default:(0,u.k6)((()=>[(0,u.Lk)("div",Be,[(0,u.Lk)("div",je,[(0,u.Lk)("div",Ye,[(0,u.bF)(l,null,{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.Monitor))])),_:1}),a[4]||(a[4]=(0,u.Lk)("span",null,"ç›®å‰ç·šä¸Šä½¿ç”¨è€…è³‡è¨Š",-1))]),(0,u.bF)(o,{type:"primary",size:p.value?"small":"default",onClick:b,loading:r.value,class:"refresh-btn"},{default:(0,u.k6)((()=>[(0,u.bF)(l,null,{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.Refresh))])),_:1}),p.value?(0,u.Q3)("",!0):((0,u.uX)(),(0,u.CE)("span",Qe,"é‡æ–°æ•´ç†"))])),_:1},8,["size","loading"])]),(0,u.bo)(((0,u.uX)(),(0,u.CE)("div",He,[0===s.value.length?((0,u.uX)(),(0,u.CE)("div",qe,[(0,u.bF)(i,{description:"ç›®å‰æ²’æœ‰ç·šä¸Šä½¿ç”¨è€…"})])):((0,u.uX)(),(0,u.CE)("div",Je,[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(s.value,((e,t)=>((0,u.uX)(),(0,u.CE)("div",{key:t,class:(0,L.C4)(["user-item",{"mobile-user-item":p.value}])},[(0,u.Lk)("div",Ge,[(0,u.bF)(v,{size:p.value?32:40,class:(0,L.C4)(["user-avatar",{"unregistered-avatar":!e.isRegistered}])},{default:(0,u.k6)((()=>[(0,u.bF)(l,null,{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.User))])),_:1})])),_:2},1032,["size","class"]),(0,u.Lk)("div",Ze,[(0,u.Lk)("div",{class:(0,L.C4)(["user-name",{"unregistered-text":!e.isRegistered}])},[(0,u.eW)((0,L.v_)(e.userName||"æœªçŸ¥ä½¿ç”¨è€…")+" ",1),e.isRegistered?(0,u.Q3)("",!0):((0,u.uX)(),(0,u.Wv)(y,{key:0,type:"warning",size:"small",style:{"margin-left":"8px"}},{default:(0,u.k6)((()=>a[5]||(a[5]=[(0,u.eW)(" æœªè¨»å†Š ")]))),_:1}))],2),(0,u.Lk)("div",ea,[(0,u.bF)(l,null,{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.User))])),_:1}),(0,u.eW)(" ID: "+(0,L.v_)(e.userId),1)]),p.value?((0,u.uX)(),(0,u.CE)("div",aa,[(0,u.Lk)("div",la,[(0,u.bF)(l,null,{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.OfficeBuilding))])),_:1}),(0,u.eW)(" "+(0,L.v_)(e.departmentName),1)]),(0,u.Lk)("div",ta,[(0,u.bF)(l,null,{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.Location))])),_:1}),(0,u.eW)(" "+(0,L.v_)(e.ip),1)]),(0,u.Lk)("div",oa,[(0,u.bF)(l,null,{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.Clock))])),_:1}),(0,u.eW)(" "+(0,L.v_)(g(e.connectTime)),1)]),e.roleNames&&e.roleNames.length>0&&e.isRegistered?((0,u.uX)(),(0,u.CE)("div",na,[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(e.roleNames.slice(0,2),(e=>((0,u.uX)(),(0,u.Wv)(y,{key:e,size:"small",type:"info",style:{"margin-right":"4px"}},{default:(0,u.k6)((()=>[(0,u.eW)((0,L.v_)(e),1)])),_:2},1024)))),128)),e.roleNames.length>2?((0,u.uX)(),(0,u.CE)("span",ra,"+"+(0,L.v_)(e.roleNames.length-2),1)):(0,u.Q3)("",!0)])):(0,u.Q3)("",!0)])):((0,u.uX)(),(0,u.CE)("div",sa,[(0,u.Lk)("div",ua,[(0,u.bF)(l,null,{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.OfficeBuilding))])),_:1}),(0,u.eW)(" "+(0,L.v_)(e.departmentName)+" - "+(0,L.v_)(e.titleName),1)]),(0,u.Lk)("div",ia,[(0,u.bF)(l,null,{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.Location))])),_:1}),(0,u.eW)(" IP: "+(0,L.v_)(e.ip),1)]),(0,u.Lk)("div",da,[(0,u.bF)(l,null,{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.Clock))])),_:1}),(0,u.eW)(" é€£ç·šæ™‚é–“: "+(0,L.v_)(g(e.connectTime)),1)]),e.isRegistered?(0,u.Q3)("",!0):((0,u.uX)(),(0,u.CE)("div",ca,[(0,u.bF)(l,null,{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.Connection))])),_:1}),(0,u.eW)(" é€£ç·šID: "+(0,L.v_)(e.connectionId),1)])),e.roleNames&&e.roleNames.length>0&&e.isRegistered?((0,u.uX)(),(0,u.CE)("div",pa,[(0,u.bF)(l,null,{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.Key))])),_:1}),a[6]||(a[6]=(0,u.eW)(" è§’è‰²: ")),((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(e.roleNames,(e=>((0,u.uX)(),(0,u.Wv)(y,{key:e,size:"small",type:"info",style:{"margin-left":"5px"}},{default:(0,u.k6)((()=>[(0,u.eW)((0,L.v_)(e),1)])),_:2},1024)))),128))])):(0,u.Q3)("",!0),e.permissions&&e.permissions.length>0&&e.isRegistered?((0,u.uX)(),(0,u.CE)("div",ma,[(0,u.bF)(l,null,{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.Lock))])),_:1}),(0,u.eW)(" æ¬Šé™: "+(0,L.v_)(e.permissions.slice(0,3).join(", "))+" ",1),e.permissions.length>3?((0,u.uX)(),(0,u.CE)("span",va,"ç­‰ "+(0,L.v_)(e.permissions.length)+" é …",1)):(0,u.Q3)("",!0)])):(0,u.Q3)("",!0)]))])]),(0,u.Lk)("div",ba,[(0,u.bF)(y,{type:e.isRegistered?"success":"warning",size:"small"},{default:(0,u.k6)((()=>[(0,u.bF)(l,null,{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.CircleCheck))])),_:1}),(0,u.eW)(" "+(0,L.v_)(e.isRegistered?"ç·šä¸Š":"é€£ç·šä¸­"),1)])),_:2},1032,["type"])])],2)))),128))]))])),[[_,r.value]])])])),_:1},8,["modelValue","width"])],64)}}};const ha=(0,ie.A)(fa,[["__scopeId","data-v-55250e70"]]);var ka=ha,_a=l(66733),wa=JSON.parse('{"MyFavorites":[{"label":"å¸¸ç”¨é …ç›®","items":[{"label":"å…¬å¸çµ„ç¹”åœ–","path":"orgChart","URL_Side":"InSide","Component":"orgChart"}]}],"SystemManagement":[{"label":"ç³»çµ±ç®¡ç†å¸¸ç”¨","items":[{"label":"è¨»å†Šå¸³è™Ÿ","path":"userRegistration","URL_Side":"InSide","Component":"userRegistration"},{"label":"ç·¨è¼¯éƒ¨é–€åŠŸèƒ½æ¸…å–®","path":"editDptFuncList_Form","URL_Side":"InSide","Component":"editDptFuncList_Form"},{"label":"å“¡å·¥è³‡æ–™ç®¡ç†","path":"userManagement","URL_Side":"InSide","Component":"userManagement"}]},{"label":"ç³»çµ±ç®¡ç†ä¸å¸¸ç”¨","items":[{"label":"Chicago","path":"Chicago","URL_Side":"InSide"},{"label":"Los Angeles","path":"Los Angeles","URL_Side":"InSide"}]}],"EventsAndStatistics":[{"label":"æ´»å‹•æˆ–çµ±è¨ˆå¸¸ç”¨","items":[{"label":"Sample2","path":"Sample2","URL_Side":"InSide"}]},{"label":"æ´»å‹•æˆ–çµ±è¨ˆä¸å¸¸ç”¨","items":[{"label":"Sample4","path":"Sample4","URL_Side":"InSide"}]}],"ResearchAndDevelopment":[{"label":"ç ”ç™¼éƒ¨å¸¸ç”¨","items":[{"label":"R&D2","path":"R&D2","URL_Side":"InSide"}]},{"label":"ç ”ç™¼éƒ¨ä¸å¸¸ç”¨","items":[{"label":"R&D4","path":"R&D4","URL_Side":"InSide"}]}],"Electronics":[{"label":"é›»å­èª²å¸¸ç”¨","items":[{"label":"Electronic1","path":"Electronic1","URL_Side":"InSide"}]},{"label":"é›»å­èª²ä¸å¸¸ç”¨","items":[{"label":"Electronic3","path":"Electronic3","URL_Side":"InSide"}]}],"ProdTech":[{"label":"ç”ŸæŠ€èª²å¸¸ç”¨","items":[{"label":"BioTech1","path":"BioTech1","URL_Side":"InSide"}]},{"label":"ç”ŸæŠ€èª²ä¸å¸¸ç”¨","items":[{"label":"BioTech3","path":"BioTech3","URL_Side":"InSide"}]}],"Warehouse":[{"label":"å€‰ç®¡èª²å¸¸ç”¨","items":[{"label":"Warehouse1","path":"Warehouse1","URL_Side":"InSide"}]},{"label":"å€‰ç®¡èª²ä¸å¸¸ç”¨","items":[{"label":"Warehouse4","path":"Warehouse4","URL_Side":"InSide"}]}],"MultiDepartment":[{"label":"å¤šéƒ¨é–€å…±ç”¨å¸¸ç”¨","items":[{"label":"å”è¾¦å–®ç³»çµ±","path":"CoopForm","URL_Side":"InSide","View":"CoopHome"},{"label":"Multi2","path":"Multi2","URL_Side":"InSide"}]},{"label":"å¤šéƒ¨é–€å…±ç”¨ä¸å¸¸ç”¨","items":[{"label":"Multi4","path":"Multi4","URL_Side":"InSide"}]}],"Administration":[{"label":"ç®¡ç†éƒ¨å¸¸ç”¨","items":[{"label":"å®¢æˆ¶å¤–ä¾†æ–‡ä»¶åœ–æª”ç®¡ç†åˆ—è¡¨","path":"å®¢æˆ¶å¤–ä¾†æ–‡ä»¶åœ–æª”ç®¡ç†åˆ—è¡¨","URL_Side":"OutSide","URL":"http://192.168.1.133/sys/login/login.php"}]},{"label":"ç®¡ç†éƒ¨ä¸å¸¸ç”¨","items":[{"label":"Admin4","path":"Admin4","URL_Side":"InSide"}]}],"Sales":[{"label":"æ­£èˆªè³‡è¨Š","items":[{"label":"éŠ·è²¨è³‡è¨Š","items":[{"label":"éŠ·è²¨æŸ¥è©¢","path":"SalesQuery","URL_Side":"InSide","Component":"SalesQuery"}]}]},{"label":"æ¥­å‹™èª²å¸¸ç”¨","items":[{"label":"Sales2","path":"Sales2","URL_Side":"InSide"}]},{"label":"æ¥­å‹™èª²ä¸å¸¸ç”¨","items":[{"label":"Sales4","path":"Sales4","URL_Side":"InSide"}]}],"Purchasing":[{"label":"æŽ¡è³¼èª²å¸¸ç”¨","items":[{"label":"Purchasing2","path":"Purchasing2","URL_Side":"InSide"}]},{"label":"æŽ¡è³¼èª²ä¸å¸¸ç”¨","items":[{"label":"Purchasing4","path":"Purchasing4","URL_Side":"InSide"}]}],"ProductionControl":[{"label":"ç”Ÿç®¡èª²å¸¸ç”¨","items":[{"label":"ProdControl2","path":"ProdControl2","URL_Side":"InSide"}]},{"label":"ç”Ÿç®¡èª²ä¸å¸¸ç”¨","items":[{"label":"ProdControl4","path":"ProdControl4","URL_Side":"InSide"}]}],"PlantOperations":[{"label":"å» å‹™èª²å¸¸ç”¨","items":[{"label":"PlantOp2","path":"PlantOp2","URL_Side":"InSide"}]},{"label":"å» å‹™èª²ä¸å¸¸ç”¨","items":[{"label":"PlantOp4","path":"PlantOp4","URL_Side":"InSide"}]}],"QualityAssurance":[{"label":"å“ä¿èª²å¸¸ç”¨","items":[{"label":"QA2","path":"QA2","URL_Side":"InSide"}]},{"label":"å“ä¿èª²ä¸å¸¸ç”¨","items":[{"label":"QA4","path":"QA4","URL_Side":"InSide"}]}]}');const Fa={class:"card flex justify-center"},Ca={class:"flex justify-center items-center custom-group-label"};var Da={__name:"PageList",props:{selectedKey:{type:String,default:null}},setup(e){const a=e,l=(0,d.KR)(null),t=(0,u.EW)((()=>a.selectedKey&&wa[a.selectedKey]?wa[a.selectedKey]:wa.MyFavorites)),o=(0,C.rd)(),n=e=>{e?.value&&(e.value.path?o.push(e.value.path):e.value.name&&o.push({name:e.value.name}))};return(0,u.sV)((()=>{l.value=t.value[0]||null})),(e,a)=>((0,u.uX)(),(0,u.CE)("div",Fa,[(0,u.bF)((0,d.R1)(_a.A),{modelValue:l.value,"onUpdate:modelValue":a[0]||(a[0]=e=>l.value=e),options:t.value,optionLabel:"label",optionGroupLabel:"code",optionGroupChildren:"items",optionValue:e=>e,class:"w-full h-full",listStyle:"min-height: 5rem; max-height: 30rem; min-width: 10rem; max-width: 100%",onChange:n},{optiongroup:(0,u.k6)((e=>[(0,u.Lk)("div",Ca,[(0,u.Lk)("div",null,(0,L.v_)(e.option.label),1)])])),_:1},8,["modelValue","options","optionValue"])]))}};const La=(0,ie.A)(Da,[["__scopeId","data-v-d73fa4d4"]]);var Ra=La,Va=(l(72577),l(8872),l(89354)),Ia=l(10373);let xa;function Ea(e){xa=e}const Aa=()=>xa,Ta="Finance";var Wa={getSalarySlips_Eid_Date(e,a){return Aa().get(`/${Ta}/getSalarySlips-Eid-Date`,{params:{Eid:e,Date:a}})},getLeaveRecord(e,a){return Aa().get(`/${Ta}/getLeaveRecord`,{params:{userId:e,month:a}})},getPersonalLeaveRecords(e){return Aa().get(`/${Ta}/getPersonalLeaveRecords`,{params:e})},getPersonalOvertimeRecords(e){return Aa().get(`/${Ta}/getPersonalOvertimeRecords`,{params:e})},getMealAllowanceSummary(e){return Aa().get(`/${Ta}/getMealAllowanceSummary`,{params:e})},getMealAllowanceDetails(e){return Aa().get(`/${Ta}/getMealAllowanceDetails`,{params:e})},getAnnualLeaveSummary(e={}){return Aa().get(`/${Ta}/getAnnualLeaveSummary`,{params:e})},getSalaryStructureWithEmpId(e){return Aa().get(`/${Ta}/getSalaryStructureWithEmpId/${e}`)},postSalarySlip(e,a){return Aa().post(`/${Ta}/SalarySlips/${e}`,a)},decryptAllSalarySlips(){return Aa().post("/SalaryDecryption/DecryptAllSalarySlips")},postSalaryStructures(e,a){return Aa().post(`/${Ta}/SalaryStructures/${e}`,a)},encryptSalaryStructure(){return Aa().post(`/${Ta}/encrypt-salary-structure`)},encryptSalarySlip(){return Aa().post(`/${Ta}/encrypt-salary-slip`)},downloadInternalAttendanceMonthly(e,a){return Aa().get(`${Ta}/downloadInternalAttendanceMonthly/${e}/${a}`,{headers:{"Content-Type":"application/json"},responseType:"blob"})},downloadExternalAttendanceMonthly(e,a){return Aa().get(`${Ta}/downloadExternalAttendanceMonthly/${e}/${a}`,{headers:{"Content-Type":"application/json"},responseType:"blob"})},downloadCompanySalaryMonthly(e,a){return Aa().get(`${Ta}/downloadCompanySalaryMonthly/${e}/${a}`,{headers:{"Content-Type":"application/json"},responseType:"blob"})},downloadEmployeeSalaryMonthly(e,a){return Aa().get(`${Ta}/downloadEmployeeSalaryMonthly/${e}/${a}`,{headers:{"Content-Type":"application/json"},responseType:"blob"})},checkHasSalaryData_Before_download(e,a){return Aa().get(`${Ta}/checkHasSalaryData_Before_download/${e}/${a}`,{headers:{"Content-Type":"application/json"}})},downloadInternalAttendanceMonthlyOP(e){return Aa().get(`${Ta}/downloadInternalAttendanceMonthlyOP/${e}`,{headers:{"Content-Type":"application/json"},responseType:"blob"})},downloadExternalAttendanceMonthlyOP(e){return Aa().get(`${Ta}/downloadExternalAttendanceMonthlyOP/${e}`,{headers:{"Content-Type":"application/json"},responseType:"blob"})},downloadCompanySalaryMonthlyOP(e){return Aa().get(`${Ta}/downloadCompanySalaryMonthlyOP/${e}`,{headers:{"Content-Type":"application/json"},responseType:"blob"})},downloadEmployeeSalaryMonthlyOP(e){return Aa().get(`${Ta}/OP_DownloadEmployeeSalaryMonthly/${e}`,{headers:{"Content-Type":"application/json"},responseType:"blob"})},getAllAttendanceRecords(e){return Aa().get(`${Ta}/getAllAttendanceRecords/${e}`,{headers:{"Content-Type":"application/json"}})},getAttendanceRecord(e,a){return Aa().get(`${Ta}/getAttendanceRecord`,{headers:{"Content-Type":"application/json"},params:{month:e,employId:a}})},getCompanyLaborRate(){return Aa().get(`${Ta}/CompanyLaborRate`,{headers:{"Content-Type":"application/json"}})},putCompanyLaborRate(e,a){return Aa().put(`${Ta}/CompanyLaborRate/${e}`,a)},getCustomerTrackingData(){return Aa().get(`${Ta}/customerTracking`,{headers:{"Content-Type":"application/json"}})},getTyphoonLeaveRecords(e){return Aa().get(`${Ta}/typhoon-leave`,{params:e,headers:{"Content-Type":"application/json"}})},createTyphoonLeaveRecord(e){return Aa().post(`${Ta}/typhoon-leave`,e,{headers:{"Content-Type":"application/json"}})},updateTyphoonLeaveRecord(e,a){return Aa().put(`${Ta}/typhoon-leave/${e}`,a,{headers:{"Content-Type":"application/json"}})},deleteTyphoonLeaveRecord(e){return Aa().delete(`${Ta}/typhoon-leave/${e}`,{headers:{"Content-Type":"application/json"}})},getCardCorrectionRecords(e,a){return Aa().get(`${Ta}/getCardCorrectionRecords`,{params:{empId:e,date:a},headers:{"Content-Type":"application/json"}})},getOvertimePageInfo(e){return Aa().get(`${Ta}/getOvertimePageInfo`,{params:e,headers:{"Content-Type":"application/json"}})},getEmployeeOvertimeDetails(e){return Aa().get(`${Ta}/getEmployeeOvertimeDetails`,{params:e,headers:{"Content-Type":"application/json"}})},exportOvertimeData(e){return Aa().get(`${Ta}/exportOvertimeData`,{params:e,headers:{"Content-Type":"application/json"},responseType:"blob"})},getLeavePageInfo(e){return Aa().get(`${Ta}/getLeavePageInfo`,{params:e,headers:{"Content-Type":"application/json"}})},getEmployeeLeaveDetails(e){return Aa().get(`${Ta}/getEmployeeLeaveDetails`,{params:e,headers:{"Content-Type":"application/json"}})}},Sa=l(12933);let Ua;function $a(e){Ua=e}const Na=()=>Ua,Xa="Workflow",Ka="ReferenceData";var Ma={getAllEnums(){return Na().get(`${Xa}/AllEnums`,{headers:{"Content-Type":"application/json"}})},getEnum_NotificationTiming(){return Na().get(`${Xa}/NotificationTiming`,{headers:{"Content-Type":"application/json"}})},getEnum_ApprovalStatus(){return Na().get(`${Xa}/ApprovalStatus`,{headers:{"Content-Type":"application/json"}})},getEnum_ApprovalAction(){return Na().get(`${Xa}/ApprovalAction`,{headers:{"Content-Type":"application/json"}})},getEnum_StepTypeEnum(){return Na().get(`${Xa}/StepTypeEnum`,{headers:{"Content-Type":"application/json"}})},getApprovalSteps(e){return Na().get(`${Xa}/approvalStep/${e}`,{headers:{"Content-Type":"application/json"}})},getApprovalRecord(e){return Na().get(`${Xa}/approvalRecord/${e}`,{headers:{"Content-Type":"application/json"}})},SimulateProcess_CR(e){return Na().post(`${Xa}/SimulateProcess/CR`,e,{headers:{"Content-Type":"application/json"}})},getAllForms(){return Na().get(`${Xa}/forms`,{headers:{"Content-Type":"application/json"}})},getAllDocuments(){return Na().get(`${Xa}/documents`,{headers:{"Content-Type":"application/json"}})},getUserRelatedDocuments(e){return Na().get(`${Xa}/related-documents/${e}`,{headers:{"Content-Type":"application/json"}})},getNewUserRelatedDocuments(e){return Na().get(`${Xa}/new-related-documents/${e}`,{headers:{"Content-Type":"application/json"}})},getUserPendingDocuments(e){return Na().get(`${Xa}/pending-documents/${e}`,{headers:{"Content-Type":"application/json"}})},getUserApprovedDocuments(e){return Na().get(`${Xa}/approved-documents/${e}`,{headers:{"Content-Type":"application/json"}})},getUserVoidedDocuments(e){return Na().get(`${Xa}/voided-documents/${e}`,{headers:{"Content-Type":"application/json"}})},getInProgressDocuments(){return Na().get(`${Xa}/in-progress-documents`,{headers:{"Content-Type":"application/json"}})},getCompletedDocuments(){return Na().get(`${Xa}/completed-documents`,{headers:{"Content-Type":"application/json"}})},createForm(e){return Na().post(`${Xa}/forms`,e,{headers:{"Content-Type":"application/json"}})},resubmitForm(e){return Na().put(`${Xa}/resubmit`,e,{headers:{"Content-Type":"application/json"}})},resubmitWithAttachments(e){return Na().post(`${Xa}/resubmitWithAttachments`,e,{})},voidDocument(e){return Na().put(`${Xa}/void/${e}`,{headers:{"Content-Type":"application/json"}})},SaveAndApproval(e){return Na().post(`${Xa}/SaveAndApproval`,e,{headers:{"Content-Type":"application/json"}})},submitApproval(e){return Na().post(`${Xa}/approvals`,e,{headers:{"Content-Type":"application/json"}})},submitRejection(e){return Na().post(`${Xa}/reject`,e,{headers:{"Content-Type":"application/json"}})},resubmitDocument(e){return Na().post(`${Xa}/resubmit`,e,{headers:{"Content-Type":"application/json"}})},getFormById(e){return Na().get(`${Xa}/forms/${e}`,{headers:{"Content-Type":"application/json"}})},updateForm(e,a){return Na().put(`${Xa}/forms/${e}`,a,{headers:{"Content-Type":"application/json"}})},deleteForm(e){return Na().delete(`${Xa}/forms/${e}`,{headers:{"Content-Type":"application/json"}})},ProcessDefinition(e){return Na().post(`${Xa}/ProcessDefinition`,e,{headers:{"Content-Type":"application/json"}})},getAllProcessDefinitions(){return Na().get(`${Xa}/processDefinitions`,{headers:{"Content-Type":"application/json"}})},getProcessDefinitionById(e){return Na().get(`${Xa}/processDefinitions/${e}`,{headers:{"Content-Type":"application/json"}})},updateProcessDefinition(e,a){return Na().put(`${Xa}/processDefinitions/${e}`,a,{headers:{"Content-Type":"application/json"}})},deleteProcessDefinition(e){return Na().delete(`${Xa}/processDefinitions/${e}`,{headers:{"Content-Type":"application/json"}})},addProcessStepDefinition(e){return Na().post(`${Xa}/addProcessStepDefinition`,e,{headers:{"Content-Type":"application/json"}})},getStepsByDefinition(e){return Na().get(`${Xa}/processDefinitions/${e}/steps`,{headers:{"Content-Type":"application/json"}})},getProcessStepDefinitionById(e){return Na().get(`${Xa}/processStepDefinition/${e}`,{headers:{"Content-Type":"application/json"}})},updateProcessStepDefinition(e,a){return Na().put(`${Xa}/processStepDefinition/${e}`,a,{headers:{"Content-Type":"application/json"}})},deleteProcessStepDefinition(e){return Na().delete(`${Xa}/processStepDefinition/${e}`,{headers:{"Content-Type":"application/json"}})},startProcess(e){return Na().post(`${Xa}/startProcess`,e,{headers:{"Content-Type":"application/json"}})},getPendingForms(e){return Na().get(`${Xa}/pending`,{headers:{"Content-Type":"application/json"},params:{userId:e}})},approveForm(e){return Na().post(`${Xa}/approve`,e,{headers:{"Content-Type":"application/json"}})},addSign(e){return Na().post(`${Xa}/addsign`,e,{headers:{"Content-Type":"application/json"}})},reassignSign(e){return Na().post(`${Xa}/reassign`,e,{headers:{"Content-Type":"application/json"}})},getFormProcess(e){return Na().get(`${Xa}/process/${e}`,{headers:{"Content-Type":"application/json"}})},getApprovalHistory(e){return Na().get(`${Xa}/history/${e}`,{headers:{"Content-Type":"application/json"}})},getAttendanceRecord(e,a){return Na().get(`${Xa}/getAttendanceRecord`,{headers:{"Content-Type":"application/json"},params:{month:e,employId:a}})},getAllAttendanceRecords(e){return Na().get(`${Xa}/downloadAttendance/${e}`,{headers:{"Content-Type":"application/json"},responseType:"blob"})},getTbl_users_profile(){return Na().get(`${Xa}/getTbl_users_profile`,{headers:{"Content-Type":"application/json"}})},getDocumentPermissions(e,a){return Na().get(`${Xa}/documents/${e}/${a}/permissions`,{headers:{"Content-Type":"application/json"}})},getWorkflowForms(){return Na().get(`${Ka}/WorkflowForm`,{headers:{"Content-Type":"application/json"}})},getDocumentTypes(){return Na().get(`${Ka}/DocumentType`,{headers:{"Content-Type":"application/json"}})},getApprovalWorkflows(){return Na().get(`${Ka}/ApprovalWorkflow`,{headers:{"Content-Type":"application/json"}})},getApprovalSteps_ReferenceData(){return Na().get(`${Ka}/ApprovalStep`,{headers:{"Content-Type":"application/json"}})},getParallelGroups(){return Na().get(`${Ka}/ParallelGroup`,{headers:{"Content-Type":"application/json"}})},getCountersignGroups(){return Na().get(`${Ka}/CountersignGroup`,{headers:{"Content-Type":"application/json"}})},getDocuments(){return Na().get(`${Ka}/Document`,{headers:{"Content-Type":"application/json"}})},getApprovalRecords(){return Na().get(`${Ka}/ApprovalRecord`,{headers:{"Content-Type":"application/json"}})},getStepInsertions(){return Na().get(`${Ka}/StepInsertion`,{headers:{"Content-Type":"application/json"}})},getNotificationLogs(){return Na().get(`${Ka}/NotificationLog`,{headers:{"Content-Type":"application/json"}})},getDocumentNotificationRecipients(){return Na().get(`${Ka}/DocumentNotificationRecipient`,{headers:{"Content-Type":"application/json"}})},getDocumentNotifications(){return Na().get(`${Ka}/DocumentNotification`,{headers:{"Content-Type":"application/json"}})},getCountersignGroupMembers(){return Na().get(`${Ka}/CountersignGroupMember`,{headers:{"Content-Type":"application/json"}})},getParallelGroupMembers(){return Na().get(`${Ka}/ParallelGroupMember`,{headers:{"Content-Type":"application/json"}})}};let Pa;function Oa(e){Pa=e}const za=()=>Pa,Ba="ReferenceData";var ja={getDAE_RelEIPUserRole_JOIN_WF_RolesData(){return za().get(`${Ba}/rel-eip-user-roleJOIN-WFRoles`,{headers:{"Content-Type":"application/json"}})},getRelUserRole(){return za().get(`${Ba}/rel-user-role`,{headers:{"Content-Type":"application/json"}})},getWF_RoleData(){return za().get(`${Ba}/WF_Role`,{headers:{"Content-Type":"application/json"}})},getAreaData(){return za().get(`${Ba}/areas`,{headers:{"Content-Type":"application/json"}})},getEmployeeData(){return za().get(`${Ba}/employees`,{headers:{"Content-Type":"application/json"}})},getEmployeeDataByEmpID(e){return za().get(`${Ba}/employees/${e}`,{headers:{"Content-Type":"application/json"}})},getTitleData(){return za().get(`${Ba}/titles`,{headers:{"Content-Type":"application/json"}})},getDepartmentData(){return za().get(`${Ba}/departments`,{headers:{"Content-Type":"application/json"}})},getRoleData(){return za().get(`${Ba}/roles`,{headers:{"Content-Type":"application/json"}})},getUserData(){return za().get(`${Ba}/users`,{headers:{"Content-Type":"application/json"}})},getPermissionData(){return za().get(`${Ba}/permissions`,{headers:{"Content-Type":"application/json"}})},getFormsData(){return za().get(`${Ba}/forms`,{headers:{"Content-Type":"application/json"}})},getApprovalProcessAll(){return za().get(`${Ba}/approval-process/all`,{headers:{"Content-Type":"application/json"}})},addUserWFRoleData(e,a){return za().post(`${Ba}/userWFRole/${e}/${a}`,{headers:{"Content-Type":"application/json"}})},addEmployeeData(e){return za().post(`${Ba}/employee`,e,{headers:{"Content-Type":"application/json"}})},addWF_RoleData(e){return za().post(`${Ba}/WF_Role`,e,{headers:{"Content-Type":"application/json"}})},addUser(e){return za().post(`${Ba}/user`,e,{headers:{"Content-Type":"application/json"}})},addPermission(e){return za().post(`${Ba}/permission`,e,{headers:{"Content-Type":"application/json"}})},addRole(e){return za().post(`${Ba}/role`,e,{headers:{"Content-Type":"application/json"}})},addTitleData(e){return za().post(`${Ba}/title`,e,{headers:{"Content-Type":"application/json"}})},addDepartment(e){return za().post(`${Ba}/department`,e,{headers:{"Content-Type":"application/json"}})},addArea(e){return za().post(`${Ba}/area`,e,{headers:{"Content-Type":"application/json"}})},updateUserRoleData(e){return console.log(e),za().put(`${Ba}/userWFRole`,e,{headers:{"Content-Type":"application/json"}})},updateEmployeeData(e){return za().put(`${Ba}/employee`,e,{headers:{"Content-Type":"application/json"}})},updateWF_RoleData(e){return za().put(`${Ba}/WF_Role`,e,{headers:{"Content-Type":"application/json"}})},updateUser(e){return za().put(`${Ba}/user`,e,{headers:{"Content-Type":"application/json"}})},updatePermission(e){return za().put(`${Ba}/permission`,e,{headers:{"Content-Type":"application/json"}})},updateRole(e){return za().put(`${Ba}/role`,e,{headers:{"Content-Type":"application/json"}})},updateTitleData(e){return za().put(`${Ba}/title`,e,{headers:{"Content-Type":"application/json"}})},updateDepartment(e){return za().put(`${Ba}/department`,e,{headers:{"Content-Type":"application/json"}})},updateArea(e){return za().put(`${Ba}/area`,e,{headers:{"Content-Type":"application/json"}})},deleteUserWFRoleData(e,a){return za().delete(`${Ba}/userWFRole/${e}/${a}`,{headers:{"Content-Type":"application/json"}})},deleteWF_RoleData(e){return za().delete(`${Ba}/WF_Role/${e}`,{headers:{"Content-Type":"application/json"}})},deleteEmployeeData(e){return za().delete(`${Ba}/employee/${e}`,{headers:{"Content-Type":"application/json"}})},deleteUser(e){return za().delete(`${Ba}/user/${e}`,{headers:{"Content-Type":"application/json"}})},deletePermission(e){return za().delete(`${Ba}/permission/${e}`,{headers:{"Content-Type":"application/json"}})},deleteRole(e){return za().delete(`${Ba}/role/${e}`,{headers:{"Content-Type":"application/json"}})},deleteTitleData(e){return za().delete(`${Ba}/title/${e}`,{headers:{"Content-Type":"application/json"}})},deleteDepartment(e){return za().delete(`${Ba}/department/${e}`,{headers:{"Content-Type":"application/json"}})},deleteArea(e){return za().delete(`${Ba}/area/${e}`,{headers:{"Content-Type":"application/json"}})}};const Ya={style:{display:"flex","align-items":"start"}},Qa=["onClick"],Ha={class:"el-tree-node__label"};var qa={__name:"Tree-Employee",props:{modelValue:{type:Array,default:()=>[]},hasCancel:{type:Boolean,default:!1},returnType:{type:String,default:"id"},groupBy:{type:String,default:"Department",validator:e=>["Department","Title"].includes(e)}},emits:["update:modelValue","change"],setup(e,{emit:a}){const l=e,o=a,n=(0,d.KR)(null),r=(0,d.KR)([]),s=(0,d.KR)([]),i={children:"children",label:"label",disabled:"disabled"};(0,u.wB)([()=>l.groupBy],(()=>{s.value=g()})),(0,u.sV)((async()=>{const[e,a,l]=await Promise.all([ja.getEmployeeData(),ja.getDepartmentData(),ja.getTitleData()]);console.log("eRes.data:",e.data);const t=["mis","TW0004"];c.value=e.data.filter((e=>"Active"===e.emp_status)).filter((e=>!t.includes(String(e.id).trim()))),p.value=a.data,m.value=l.data,s.value=g()}));const c=(0,d.KR)([]),p=(0,d.KR)([]),m=(0,d.KR)([]);function v(e){e.sort(((e,a)=>(e.sortId||0)-(a.sortId||0))),e.forEach((e=>e.children&&v(e.children)))}function b(e){return e.map((e=>({...e,children:e.children?b(e.children):[]}))).filter((e=>!e.isGroup||e.children.length>0))}function g(){if("Department"===l.groupBy){const e={};p.value.forEach((a=>{e[a.id]={label:a.name,value:a.id,sortId:a.sortId,disabled:!0,isGroup:!0,children:[]}}));const a=[];return p.value.forEach((l=>{const t=e[l.id];l.p_dpt_id&&"-1"!==l.p_dpt_id&&e[l.p_dpt_id]?e[l.p_dpt_id].children.push(t):a.push(t)})),c.value.forEach((a=>{const t=e[a.dpt_id];t&&t.children.push({label:a.name,value:"name"===l.returnType?a.name:a.id,sortId:0,disabled:!1,isGroup:!1})})),v(a),b(a)}{const e={};m.value.forEach((a=>{e[a.name]||(e[a.name]=[]),e[a.name].push(a)})),Object.values(e).forEach((e=>e.sort(((e,a)=>(e.sortId||0)-(a.sortId||0)))));const a=Object.keys(e).map((a=>{const t={label:a,value:a,sortId:e[a][0].sortId,disabled:!0,isGroup:!0,children:[]};return e[a].forEach((e=>{const a={label:e.description,value:e.id+"_desc",sortId:e.sortId,disabled:!0,isGroup:!0,children:[]};c.value.forEach((t=>{t.title_id===e.id&&a.children.push({label:t.name,value:"name"===l.returnType?t.name:t.id,sortId:0,disabled:!1,isGroup:!1})})),a.children.length&&t.children.push(a)})),t}));return v(a),b(a)}}function y(e,a){if(e.isGroup)a.expanded=!a.expanded;else{const a=r.value.includes(e.value);n.value.setChecked(e.value,!a)}}function f(){const e=n.value.getCheckedKeys(!0);r.value=e;const a=c.value.filter((a=>e.includes(a.id)));console.log(a),o("update:modelValue",a),o("change",a)}function h(e,a){return a.label.toLowerCase().includes(e.toLowerCase())}function k(){r.value=[],n.value.setCheckedKeys([]),o("update:modelValue",[]),o("change",[])}return(0,u.wB)((()=>l.modelValue),(e=>{r.value=e.map((e=>e.id)),n.value&&n.value.setCheckedKeys(r.value)}),{immediate:!0}),(e,a)=>{const o=(0,u.g2)("el-tree"),c=(0,u.g2)("el-icon"),p=(0,u.g2)("el-button");return(0,u.uX)(),(0,u.CE)("div",Ya,[(0,u.bF)(o,{ref_key:"treeRef",ref:n,data:s.value,props:i,"node-key":"value","show-checkbox":"","check-strictly":"","default-expand-all":"","expand-on-click-node":!1,"check-on-click-node":!1,"default-checked-keys":r.value,onNodeClick:y,onCheckChange:f,"filter-node-method":h,style:{height:"calc(100vh - 100px)",overflow:"auto"}},{default:(0,u.k6)((({node:e,data:a})=>[(0,u.Lk)("div",{style:(0,L.Tr)({backgroundColor:a.isGroup?"transparent":"#f0fff0",width:"100%",display:"flex",alignItems:"center",padding:"4px 8px"})},[(0,u.Lk)("span",{class:"el-tree-node__expand-icon",onClick:(0,t.D$)((a=>e.expanded=!e.expanded),["stop"])},null,8,Qa),(0,u.Lk)("span",{class:"el-tree-node__checkbox-wrapper",style:(0,L.Tr)({backgroundColor:a.isGroup?"transparent":"#f0fff0"})},null,4),(0,u.Lk)("span",Ha,(0,L.v_)(a.label),1)],4)])),_:1},8,["data","default-checked-keys"]),l.hasCancel?((0,u.uX)(),(0,u.Wv)(p,{key:0,type:"text",onClick:k,style:{"margin-left":"10px","align-self":"flex-start"}},{default:(0,u.k6)((()=>[(0,u.bF)(c,null,{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.Close))])),_:1})])),_:1})):(0,u.Q3)("",!0)])}}};const Ja=qa;var Ga=Ja;const Za={class:"container"},el={class:"header-wrap"},al={class:"group-controls"},ll={class:"control-item"},tl={class:"control-item"},ol={key:0};var nl={__name:"Custom_List_Insert_Notify",props:{modelValue:{type:Array,default:()=>[]},mode:{type:String,default:"insert",validator:e=>["insert","notify"].includes(e)}},emits:["update:modelValue"],setup(e,{emit:a}){const l=e,t=a,o=(0,u.EW)({get:()=>l.modelValue,set:e=>t("update:modelValue",e)});return(e,a)=>{const l=(0,u.g2)("el-button"),t=(0,u.g2)("el-popover"),n=(0,u.g2)("el-card");return(0,u.uX)(),(0,u.CE)("div",Za,[(0,u.bF)(n,{class:"card","body-style":{padding:"1rem"}},{header:(0,u.k6)((()=>[(0,u.Lk)("div",el,[(0,u.Lk)("div",al,[(0,u.Lk)("div",ll,[a[2]||(a[2]=(0,u.Lk)("div",{class:"control-label"},"ä¾éƒ¨é–€åˆ†é¡ž",-1)),(0,u.bF)(t,{placement:"bottom",trigger:"click",width:"220"},{reference:(0,u.k6)((()=>[(0,u.bF)(l,{size:"mini",icon:"el-icon-s-cooperation",circle:""})])),default:(0,u.k6)((()=>[(0,u.bF)(Ga,{modelValue:o.value,"onUpdate:modelValue":a[0]||(a[0]=e=>o.value=e),groupBy:"Department"},null,8,["modelValue"])])),_:1})]),(0,u.Lk)("div",tl,[a[3]||(a[3]=(0,u.Lk)("div",{class:"control-label"},"ä¾è·ç¨±åˆ†é¡ž",-1)),(0,u.bF)(t,{placement:"bottom",trigger:"click",width:"220"},{reference:(0,u.k6)((()=>[(0,u.bF)(l,{size:"mini",icon:"el-icon-s-custom",circle:""})])),default:(0,u.k6)((()=>[(0,u.bF)(Ga,{modelValue:o.value,"onUpdate:modelValue":a[1]||(a[1]=e=>o.value=e),groupBy:"Title"},null,8,["modelValue"])])),_:1})])])])])),default:(0,u.k6)((()=>[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(o.value,(e=>((0,u.uX)(),(0,u.CE)("p",{key:e.id},(0,L.v_)(e.name),1)))),128)),0===o.value.length?((0,u.uX)(),(0,u.CE)("p",ol,"å°šæœªé¸æ“‡ä»»ä½•äºº")):(0,u.Q3)("",!0)])),_:1})])}}};const rl=(0,ie.A)(nl,[["__scopeId","data-v-cb6da07c"]]);var sl=rl;let ul;function il(e){ul=e}const dl=()=>ul,cl="Form";var pl={createForm(e){return dl().post(`${cl}/documents`,e,{})},SaveAndApproval(e,a){return dl().put(`${cl}/SaveAndApproval/${e}`,a)},getFormById(e){return dl().get(`${cl}/documents/${e}`,{headers:{"Content-Type":"application/json"}})},updateForm(e,a){return dl().put(`${cl}/documents/${e}`,a,{headers:{"Content-Type":"application/json"}})},deleteForm(e){return dl().delete(`${cl}/documents/${e}`,{headers:{"Content-Type":"application/json"}})},deleteFormByDocID(e,a){return dl().delete(`${cl}/document/${e}/${a}`,{headers:{"Content-Type":"application/json"}})},getDocDetail(e,a){return dl().get(`${cl}/document-detail/${e}/${a}`,{headers:{"Content-Type":"application/json"}})},getDocsByCR_Id(e){return dl().get(`${cl}/documents/CR/${e}`,{headers:{"Content-Type":"application/json"}})},getDocTypes(){return dl().get(`${cl}/documentTypes`,{headers:{"Content-Type":"application/json"}})},deleteAllDocument(){return dl().delete(`${cl}/ALLdocument`,{headers:{"Content-Type":"application/json"}})},getDocumentFiles(e,a){return dl().get(`${cl}/files/${e}/${a}`,{headers:{"Content-Type":"application/json"}})},getCompletedDocuments(e){return dl().get(`${cl}/documents/Completed/${e}`,{headers:{"Content-Type":"application/json"}})},getLeaveTypeRules(){return dl().get(`${cl}/leave-type-rules`,{headers:{"Content-Type":"application/json"}})},getUserLeaveRecords(e,a){return dl().get(`${cl}/user-leave-records/${e}/${a}`,{headers:{"Content-Type":"application/json"}})}},ml=l(25886);const vl=(0,o.nY)("employee",{state:()=>({employees:[]}),actions:{async fetchEmployeeData(){try{const e=await ja.getEmployeeData();e&&e.data&&(this.employees=e.data)}catch(e){console.error("Error fetching employee data:",e)}},async getEmployeeName(e){if(!this.employees.length)try{const e=await ja.getEmployeeData();e&&e.data&&(this.employees=e.data)}catch(l){console.error("Error fetching employee data:",l)}const a=this.employees.find((a=>a.id===e));return a?a.name:""},async getEmployeeArea(e){if(!this.employees.length)try{const e=await ja.getEmployeeData();e&&e.data&&(this.employees=e.data)}catch(l){console.error("Error fetching employee data:",l)}const a=this.employees.find((a=>a.id===e));return a?a.area_id:""}},persist:!0});var bl={__name:"Employee-IdToName",props:{employeeId:{type:[String,Number],default:""}},setup(e){const a=e,l=(0,d.KR)(""),t=vl(),o=async e=>{if(e){const a=await t.getEmployeeName(e);l.value=a}else l.value=""};return(0,u.sV)((()=>{o(a.employeeId)})),(0,u.wB)((()=>a.employeeId),(e=>{o(e)})),(e,a)=>((0,u.uX)(),(0,u.CE)("span",null,(0,L.v_)(l.value),1))}};const gl=bl;var yl=gl;const fl=(0,o.nY)("department",{state:()=>({departments:[]}),actions:{async fetchDepartmentData(){try{const e=await ja.getDepartmentData();e&&e.data&&(this.departments=e.data)}catch(e){console.error("Error fetching department data:",e)}},async getDepartmentName(e){if(!this.departments.length)try{const e=await ja.getDepartmentData();e&&e.data&&(this.departments=e.data)}catch(l){console.error("Error fetching department data:",l)}const a=this.departments.find((a=>a.id===e));return a?a.name:""}},persist:!0});var hl={__name:"Dept-IdToName",props:{deptId:{type:[String,Number],default:""},mode:{type:String,deault:"Name"}},setup(e){const a=e,l=(0,d.KR)(""),t=fl(),o=async e=>{l.value=e?await t.getDepartmentName(e):""};return(0,u.sV)((()=>{o(a.deptId)})),(0,u.wB)((()=>a.deptId),(e=>{o(e)})),(e,a)=>((0,u.uX)(),(0,u.CE)("span",null,(0,L.v_)(l.value),1))}};const kl=hl;var _l=kl;const wl=(0,o.nY)("title",{state:()=>({titles:[]}),actions:{async fetchTitleData(){try{const e=await ja.getTitleData();e&&e.data&&(this.titles=e.data)}catch(e){console.error("Error fetching title data:",e)}},async getTitleName(e){if(!this.titles.length)try{const e=await ja.getTitleData();e&&e.data&&(this.titles=e.data)}catch(l){console.error("Error fetching title data:",l)}const a=this.titles.find((a=>a.id===e));return a?a.name:""},async getTitleDescription(e){if(!this.titles.length)try{const e=await ja.getTitleData();e&&e.data&&(this.titles=e.data)}catch(l){console.error("Error fetching title data:",l)}const a=this.titles.find((a=>a.id===e));return a?a.description:""}},persist:!0});var Fl={__name:"Title-IdToName",props:{titleId:{type:[String,Number],default:""},mode:{type:String,default:"Name"}},setup(e){const a=e,l=(0,d.KR)(""),t=wl(),o=async e=>{l.value=e?await t.getTitleName(e):""},n=async e=>{l.value=e?await t.getTitleDescription(e):""},r=async()=>{"Description"===a.mode?await n(a.titleId):await o(a.titleId)};return(0,u.sV)((()=>{r()})),(0,u.wB)((()=>a.titleId),(()=>{r()})),(0,u.wB)((()=>a.mode),(()=>{r()})),(e,a)=>((0,u.uX)(),(0,u.CE)("span",null,(0,L.v_)(l.value),1))}};const Cl=Fl;var Dl=Cl,Ll=l(99150);const Rl={class:"flow-wrapper"},Vl={class:"form-flow"},Il={style:{"font-size":"0.8em",color:"gray",padding:"0.5rem 1rem"}},xl={key:0,class:"mr-2"},El={key:4,class:"pi pi-flag"},Al={key:5,class:"pi pi-megaphone"},Tl={key:6,class:"pi pi-hourglass"},Wl={key:1},Sl={key:2},Ul={key:0,class:"pi pi-clock p-mr-2 mr-2"},$l={style:{"font-size":"1rem"}},Nl={class:"user-line"},Xl={key:0,class:"pi pi-user icon"},Kl={class:"dept"},Ml={class:"title"},Pl={class:"name"},Ol={key:0,class:"user-comment"};var zl={__name:"Descending_Approval_Node",props:{visible:Boolean,docId:{type:[String,Number],required:!0}},setup(e){const a=e,l=(0,d.KR)([]),t=(0,d.KR)(null),o=(0,d.KR)(!0),n=(0,d.KR)(),r=(0,u.EW)((()=>n.value?.reduce(((e,a)=>(e[a.value]=a.description,e)),{})||{})),s=async e=>{o.value=!0;try{const a=await Ma.getApprovalSteps(e);console.log("API è¿”å›žçš„åŽŸå§‹æ•¸æ“š:",a.data);let o=a.data||[];Array.isArray(o)||(o="object"===typeof o?Object.values(o):[]);const n=o.sort(((e,a)=>{const l=e.viewOrder||e.stepOrder||0,t=a.viewOrder||a.stepOrder||0;return l-t}));l.value=n,t.value=n[0]?.currentStepID??null,console.log("è™•ç†å¾Œçš„æ•¸æ“š:",l.value)}catch(a){console.error("æŠ“æµç¨‹æ­¥é©Ÿå¤±æ•—",a),l.value=[]}finally{o.value=!1}};function i(e){return r.value[Number(e)]||"æœªçŸ¥"}function c(e){return e.hasVirtualNodeInFlow?e.isVirtualNode?"#e8f5e9":"white":e.currentStepID==e.stepID?"#e8f5e9":"white"}function p(e){return e.hasVirtualNodeInFlow?e.isVirtualNode?"#2E7D32":void 0:e.currentStepID==e.stepID?"#2E7D32":void 0}const m=async()=>{const e=await Ma.getEnum_StepTypeEnum();n.value=e.data},v=(0,u.EW)((()=>{const e=[],a=new Set;let t=!1;return l.value.forEach((o=>{if(!a.has(o.stepID)){if(o.isSameStep&&o.sameStepOrderAt){const t=l.value.filter((e=>e.sameStepOrderAt===o.sameStepOrderAt&&e.isSameStep)),n={...o,stepTypeDescription:i(o.stepType||0),users:t.map((e=>({userID:e.userID||"",userDeptID:e.userDeptID||"",userTitleID:e.userTitleID||"",userStepStatus:e.stepStatus||e.status||"å¾…ç°½æ ¸",userStepTypeDescription:i(e.stepType||0),comment:e.comment||"",action:e.action||""})))};e.push(n),t.forEach((e=>a.add(e.stepID)))}else{const l={...o,stepTypeDescription:i(o.stepType||0),users:[{userID:o.userID||"",userDeptID:o.userDeptID||"",userTitleID:o.userTitleID||"",userStepStatus:o.stepStatus||o.status||"å¾…ç°½æ ¸",userStepTypeDescription:i(o.stepType||0),comment:o.comment||"",action:o.action||""}]};e.push(l),a.add(o.stepID)}if(8===o.stepType&&"é€€å›ž"===o.stepStatus){const a=l.value.find((e=>0===e.stepType||"INITIATOR"===e.roleID)),n={stepID:`virtual-${o.stepID}`,stepType:"virtual",stepTypeDescription:"ç­‰å¾…ç”³è«‹äººå›žæ‡‰",stepStatus:"ç­‰å¾…ç”³è«‹äººæ±ºå®š",workflowID:o.workflowID,workflowName:o.workflowName,stepOrder:o.stepOrder+.5,viewOrder:o.viewOrder+.5,documentID:o.documentID,documentTypeName:o.documentTypeName,isVirtualNode:!0,users:[{userID:a?.userID||"",userDeptID:a?.userDeptID||"",userTitleID:a?.userTitleID||"",userStepStatus:"ç­‰å¾…ç”³è«‹äººæ±ºå®šä¸‹ä¸€æ­¥",userStepTypeDescription:"ç­‰å¾…ç”³è«‹äººå›žæ‡‰",comment:"",action:""}]};e.push(n),t=!0}}})),e.forEach((e=>{e.hasVirtualNodeInFlow=t})),e})),b=e=>{if(!e)return"N/A";const a=new Date(e);return`${a.getFullYear()}/${String(a.getMonth()+1).padStart(2,"0")}/${String(a.getDate()).padStart(2,"0")} ${String(a.getHours()).padStart(2,"0")}:${String(a.getMinutes()).padStart(2,"0")}`};return(0,u.sV)((async()=>{await m(),await s(a.docId)})),(e,a)=>{const l=(0,u.g2)("Document"),n=(0,u.g2)("el-icon"),r=(0,u.g2)("CirclePlusFilled"),s=(0,u.g2)("RefreshLeft"),i=(0,u.g2)("Edit"),m=(0,u.g2)("EditPen"),g=(0,u.g2)("Finished"),y=(0,u.g2)("CircleCheckFilled"),f=(0,u.g2)("ChatLineRound");return(0,u.uX)(),(0,u.CE)("div",Rl,[(0,u.Lk)("div",Vl,[o.value?((0,u.uX)(),(0,u.Wv)((0,d.R1)(Ll.A),{key:0,style:{width:"50px",height:"50px"},strokeWidth:"5",fill:"transparent",animationDuration:"1s","aria-label":"Custom ProgressSpinner"})):(0,u.Q3)("",!0),((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(v.value,((e,o)=>((0,u.uX)(),(0,u.CE)("div",{key:o,class:"step-section"},[a[0]||(a[0]=(0,u.Lk)("div",{class:"step-header"},[(0,u.Lk)("div",{class:"step-divider"})],-1)),(0,u.bF)((0,d.R1)(ml.A),{class:"nested-card",style:(0,L.Tr)({backgroundColor:c(e)})},{title:(0,u.k6)((()=>[(0,u.Lk)("div",{style:(0,L.Tr)({color:p(e)})},[e.stepTypeDescription?((0,u.uX)(),(0,u.CE)("span",xl,[0===e.stepType?((0,u.uX)(),(0,u.Wv)(n,{key:0},{default:(0,u.k6)((()=>[(0,u.bF)(l)])),_:1})):5===e.stepType?((0,u.uX)(),(0,u.Wv)(n,{key:1},{default:(0,u.k6)((()=>[(0,u.bF)(r)])),_:1})):8===e.stepType?((0,u.uX)(),(0,u.Wv)(n,{key:2},{default:(0,u.k6)((()=>[(0,u.bF)(s)])),_:1})):9===e.stepType?((0,u.uX)(),(0,u.Wv)(n,{key:3},{default:(0,u.k6)((()=>[(0,u.bF)(i)])),_:1})):99===e.stepType?((0,u.uX)(),(0,u.CE)("i",El)):6===e.stepType?((0,u.uX)(),(0,u.CE)("i",Al)):e.isVirtualNode?((0,u.uX)(),(0,u.CE)("i",Tl)):"å¾…ç°½"===e.stepStatus?((0,u.uX)(),(0,u.Wv)(n,{key:7},{default:(0,u.k6)((()=>[(0,u.bF)(m)])),_:1})):"å·²ç°½"===e.stepStatus?((0,u.uX)(),(0,u.Wv)(n,{key:8},{default:(0,u.k6)((()=>[(0,u.bF)(g)])),_:1})):1===e.stepType&&"å¾…ç°½"!==e.stepStatus?((0,u.uX)(),(0,u.Wv)(n,{key:9},{default:(0,u.k6)((()=>[(0,u.bF)(g)])),_:1})):(0,u.Q3)("",!0)])):(0,u.Q3)("",!0),"ä¸€èˆ¬ç°½æ ¸"==e.stepTypeDescription?((0,u.uX)(),(0,u.CE)("span",Wl,(0,L.v_)(e.stepStatus),1)):((0,u.uX)(),(0,u.CE)("span",Sl,(0,L.v_)(e.stepTypeDescription),1))],4)])),subtitle:(0,u.k6)((()=>[e.actionDate?((0,u.uX)(),(0,u.CE)("i",Ul)):(0,u.Q3)("",!0),(0,u.Lk)("span",$l,(0,L.v_)(e.actionDate?b(e.actionDate):""),1)])),content:(0,u.k6)((()=>[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(e.users,((e,a)=>((0,u.uX)(),(0,u.CE)("div",{key:a,class:"user-block"},[(0,u.Lk)("div",Nl,[e.userID?((0,u.uX)(),(0,u.CE)("i",Xl)):(0,u.Q3)("",!0),(0,u.Lk)("span",Kl,[(0,u.bF)((0,d.R1)(_l),{"dept-id":e.userDeptID},null,8,["dept-id"])]),(0,u.Lk)("span",Ml,[(0,u.bF)(Dl,{"title-id":e.userTitleID,mode:"Description"},null,8,["title-id"])]),(0,u.Lk)("span",Pl,[(0,u.bF)((0,d.R1)(yl),{"employee-id":e.userID},null,8,["employee-id"])]),(0,u.Lk)("span",null,["å·²ç°½æ ¸"===e.userStepStatus?((0,u.uX)(),(0,u.Wv)(n,{key:0,style:{"font-size":"1.2rem"}},{default:(0,u.k6)((()=>[(0,u.bF)(y)])),_:1})):(0,u.Q3)("",!0)])]),e.comment?((0,u.uX)(),(0,u.CE)("div",Ol,[(0,u.bF)(n,{style:{"font-size":"1.2rem"}},{default:(0,u.k6)((()=>[(0,u.bF)(f)])),_:1}),(0,u.eW)(" "+(0,L.v_)(e.comment),1)])):(0,u.Q3)("",!0)])))),128))])),footer:(0,u.k6)((()=>[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(e.comments,((e,a)=>((0,u.uX)(),(0,u.CE)("div",{key:a,class:"comment-line"},[(0,u.bF)(n,null,{default:(0,u.k6)((()=>[(0,u.bF)(f)])),_:1}),(0,u.bF)((0,d.R1)(yl),{"employee-id":e.userID},null,8,["employee-id"]),(0,u.eW)("ï¼š"+(0,L.v_)(e.comment),1)])))),128))])),default:(0,u.k6)((()=>[(0,u.Lk)("div",Il," stepID: "+(0,L.v_)(e.stepID)+" | CurrentStepID.value: "+(0,L.v_)(t.value.value)+" | Match: "+(0,L.v_)(e.stepID===t.value.value),1)])),_:2},1032,["style"])])))),128))])])}}};const Bl=(0,ie.A)(zl,[["__scopeId","data-v-b608751c"]]);var jl=Bl;const Yl={CR:{component:"CorrectionForm",fields:[{label:"ç”³è«‹æ—¥æœŸ",prop:"applyAt",type:"date"},{label:"è£œæ‰“å¡æ—¥",prop:"correctionDate",type:"date"},{label:"è£œæ‰“å¡æ™‚é–“",prop:"correctionTime",type:"time"},{label:"è£œåˆ·å¡äºº",prop:"applierName",type:"text"},{label:"è£œåˆ·å¡äººéƒ¨é–€",prop:"applierDptName",type:"text"},{label:"å–®ä½ä¸»ç®¡",prop:"supervisorName",type:"text"},{label:"è£œåˆ·å¡äº‹ç”±",prop:"reason",type:"textarea"}]},LR:{component:"LeaveRequestForm",fields:[{label:"ç”³è«‹æ—¥æœŸ",prop:"applyDate",type:"date"},{label:"å‡åˆ¥",prop:"leaveType",type:"text"},{label:"ç”³è«‹è€…éƒ¨é–€",prop:"applicantDept",type:"text"},{label:"ç”³è«‹è€…",prop:"applicantName",type:"text"},{label:"è«‹å‡æ—¥æœŸå’Œæ™‚é–“",prop:"leaveDateTimeRange",type:"datetimerange"},{label:"è·å‹™ä»£ç†äºº",prop:"agentEmployeeName",type:"text"},{label:"å‚™è¨»",prop:"reason",type:"textarea"}]},OR:{component:"OvertimeRequestForm",fields:[{label:"å–®è™Ÿ",prop:"documentId",type:"text"},{label:"ç”³è«‹äººè·å‹™/åœ°å€",prop:"applicantTitleId",type:"text"},{label:"ç”³è«‹äººéƒ¨é–€",prop:"applierDptName",type:"text"},{label:"æ˜¯å¦ç‚ºé åŠ ç­",prop:"isPreOvertime",type:"boolean"},{label:"åŠ ç­äººå“¡",prop:"overtimePersonnel",type:"array",children:[{label:"äººå“¡å§“å",prop:"personnelName",type:"text"},{label:"é è¨ˆåŠ ç­æ™‚æ®µ",prop:"overtimeDateTimeRange",type:"datetimerange"},{label:"é è¨ˆåŠ ç­æ™‚æ•¸",prop:"overtimeHours",type:"text"},{label:"åŠ ç­å…§å®¹",prop:"overtimeContent",type:"textarea"},{label:"é¤è²»ç”³è«‹",prop:"mealAllowance",type:"number"},{label:"å¯¦éš›åŠ ç­",prop:"actualOvertime",type:"text",condition:{prop:"isPreOvertime",value:!1}},{label:"å¯¦éš›åŠ ç­æ—¥æœŸ",prop:"actualOvertimeDate",type:"date",condition:{prop:"isPreOvertime",value:!1}},{label:"å¯¦éš›åŠ ç­æ™‚é–“",prop:"actualOvertimeTimeRange",type:"datetimerange",condition:{prop:"isPreOvertime",value:!1}},{label:"å¯¦éš›åŠ ç­æ™‚æ•¸",prop:"actualOvertimeHours",type:"text",condition:{prop:"isPreOvertime",value:!1}},{label:"å¯¦éš›åŠ ç­å…§å®¹",prop:"actualOvertimeContent",type:"textarea",condition:{prop:"isPreOvertime",value:!1}}]},{label:"å–®ä½ä¸»ç®¡",prop:"supervisorName",type:"text"}]},LC:{component:"LeaveCancellationForm",fields:[{label:"ç”³è«‹æ—¥æœŸ",prop:"applyDate",type:"date"},{label:"ç”³è«‹äººå§“å",prop:"applierName",type:"text"},{label:"å–®ä½ä¸»ç®¡",prop:"supervisor",type:"text"},{label:"æ¬²éŠ·å‡çš„å–®æ“š",prop:"selectedDocument",type:"text"}]}};var Ql=l(91737);const Hl=(0,o.nY)("area",{state:()=>({areas:[],regions:[]}),actions:{async fetchAreaData(){try{const e=await ja.getAreaData();e&&e.data&&(this.areas=e.data),console.log(e)}catch(e){console.error("Error fetching area data:",e)}},async getAreaName(e){if(!this.areas.length)try{const e=await ja.getAreaData();e&&e.data&&(this.areas=e.data),console.log("getAreaName:",e)}catch(l){console.error("Error fetching area data:",l)}const a=this.areas.find((a=>a.id===e));return a?a.area:""},async getAreaRegion(e){if(!this.areas.length)try{const e=await ja.getAreaData();e&&e.data&&(this.areas=e.data)}catch(l){console.error("Error fetching area data:",l)}const a=this.areas.find((a=>a.id===e));return a?a.region:""},async getAreaDistrict(e){if(!this.areas.length)try{const e=await ja.getAreaData();e&&e.data&&(this.areas=e.data)}catch(l){console.error("Error fetching area data:",l)}const a=this.areas.find((a=>a.id===e));return a?a.district:""}},persist:!0}),ql=(0,o.nY)("role",{state:()=>({roles:[]}),actions:{async fetchRoleData(){try{const e=await ja.getRoleData();console.log(e),e&&e.data&&(this.roles=e.data),console.log("Roles data:",e)}catch(e){console.error("Error fetching role data:",e)}},getRoleName(e){const a=this.roles.find((a=>a.id===e));return a?a.name:""}},persist:!0});async function Jl(e){const a=Hl();return a.getAreaName(e)}async function Gl(e){const a=fl();return a.getDepartmentName(e)}async function Zl(e){const a=vl();return a.getEmployeeName(e)}async function et(e){const a=wl();return a.getTitleName(e)}async function at(e){const a=ql();return a.getRoleName(e)}var lt={getAreaName:Jl,getDepartmentName:Gl,getEmployeeName:Zl,getTitleName:et,getRoleName:at},tt=l(2359),ot={__name:"Area-IdToName",props:{areaId:{type:[String,Number],default:""}},setup(e){const a=e,l=(0,d.KR)(""),t=Hl(),o=async e=>{if(e){const a=await t.getAreaRegion(e);l.value=a}else l.value=""};return(0,u.sV)((()=>{o(a.areaId)})),(0,u.wB)((()=>a.areaId),(e=>{o(e)})),(e,a)=>((0,u.uX)(),(0,u.CE)("span",null,(0,L.v_)(l.value),1))}};const nt=ot;var rt=nt;const st={class:"container",style:{margin:"0 auto"}},ut={key:0},it={class:"flex items-center gap-2"},dt={key:0},ct={key:1};var pt={__name:"CorrectionForm",props:{mode:{type:String,default:"create"},WF_Form_Data:{type:Object,default:()=>({})},WF_canEdit:{type:Boolean,default:!1}},emits:["form-submitted","form-reset"],setup(e,{expose:a,emit:l}){const t=l,o=e,n=(0,S.k)(),r=fl(),s=vl(),i=(0,d.KR)(null),c=(0,d.KR)(),p=(0,d.KR)(),m=(0,d.KR)([]),v=(0,d.KR)(),b=(0,d.KR)(),g=((0,d.KR)(!1),(0,d.KR)(!1),(0,d.KR)(0)),y=(0,d.KR)(),{width:f}=(0,Ql.lWr)(),h=(0,u.EW)((()=>f.value<=768?{width:"80%",maxWidth:"100%",margin:"1rem auto"}:{width:"35rem",maxWidth:"40rem",margin:"4rem"})),k=(0,u.EW)((()=>"WF"===o.mode&&!o.WF_canEdit)),_=(0,d.KR)({applyDate:new Date,correctionDate:"",startHour:null,startMinute:null,correctionTime:y,employeeId:"",employeeName:"",employeeDpt:"",supervisor:"",reason:"",applierId:n.userId,applierName:n.userName,inserPersonList:[],notificationList:[],correctionType:"ClockIn"}),w={correctionDate:[{required:!0,message:"è«‹é¸æ“‡è£œåˆ·å¡æ—¥",trigger:"change"},{validator:(e,a,l)=>{if(!a)return l(new Error("è«‹é¸æ“‡è£œåˆ·å¡æ—¥"));const t=new Date(a),o=new Date;if(o.setHours(0,0,0,0),o.setDate(o.getDate()-1),t>new Date(o.getTime()+864e5-1))return l(new Error("è£œåˆ·å¡æ—¥åƒ…èƒ½é¸æ“‡æ˜¨å¤©(å«)ä»¥å‰çš„æ—¥æœŸ"));l()},trigger:"change"}],correctionTime:[{required:!0,message:"è«‹é¸æ“‡è£œåˆ·å¡æ™‚é–“",trigger:"change"},{validator:(e,a,l)=>{a?/^([01]\d|2[0-3]):([0-5]\d)$/.test(a)?l():l(new Error("è«‹è¼¸å…¥æœ‰æ•ˆçš„æ™‚é–“æ ¼å¼ (HH:mm)")):l(new Error("è«‹é¸æ“‡è£œåˆ·å¡æ™‚é–“"))},trigger:"blur"}],reason:[{required:!0,message:"è«‹å¡«å¯«è£œåˆ·å¡äº‹ç”±",trigger:"blur"}],employeeId:[{required:!0,message:"è«‹é¸æ“‡æœ‰æ•ˆçš„è£œåˆ·å¡äººè³‡æ–™",trigger:"change"},{validator:(e,a,l)=>{if(""===a||null===a)return l(new Error("è£œåˆ·å¡äººå·¥è™Ÿä¸å¯ç‚ºç©º"));l()},trigger:"change"}],employeeName:[{required:!0,message:"è«‹é¸æ“‡æœ‰æ•ˆçš„è£œåˆ·å¡äººè³‡æ–™",trigger:"change"},{validator:(e,a,l)=>{if(""===a||null===a)return l(new Error("è£œåˆ·å¡äººåç¨±ä¸å¯ç‚ºç©º"));l()},trigger:"change"}],correctionType:[{required:!0,message:"è«‹é¸æ“‡è£œåˆ·å¡é¡žåž‹",trigger:"change"}]};function F(e){const a=e.getFullYear(),l=String(e.getMonth()+1).padStart(2,"0"),t=String(e.getDate()).padStart(2,"0");return`${a}-${l}-${t}`}const C=async e=>{const a=_.value.correctionTime;e.validate((async(e,l)=>{if(!e){const e={applyDate:"ç”³è«‹æ—¥æœŸ",correctionDate:"è£œåˆ·å¡æ—¥",correctionTime:"è£œåˆ·å¡æ™‚é–“(æ™‚:åˆ†)",employeeId:"è£œåˆ·å¡äººå·¥è™Ÿ",employeeName:"è£œåˆ·å¡äºº",department:"è£œåˆ·å¡äººéƒ¨é–€",applierName:"ç”³è«‹è€…å§“å",supervisor:"å–®ä½ä¸»ç®¡",reason:"è£œåˆ·å¡äº‹ç”±"},a=Object.keys(l)[0],t=l[a][0].message,o=e[a]||a;return D.nk.error(`æ¬„ä½ã€Œ${o}ã€éŒ¯èª¤ï¼š${t}`),!1}const o={applyDate:_.value.applyDate.toISOString().split("T")[0],correctionDate:F(_.value.correctionDate),startTime:a,employeeId:_.value.employeeId,employeeName:_.value.employeeName,department:_.value.employeeDpt,supervisorId:c.value,supervisorName:_.value.supervisor,reason:_.value.reason,correctionType:_.value.correctionType},r=`è«‹ç¢ºèªä»¥ä¸‹è³‡æ–™æ˜¯å¦æ­£ç¢ºï¼š<br/>ç”³è«‹æ—¥æœŸï¼š${_.value.applyDate.toISOString().split("T")[0]}<br/>è£œåˆ·å¡æ—¥ï¼š${F(_.value.correctionDate)}<br/>è£œåˆ·å¡æ™‚é–“ï¼š${a}<br/>è£œåˆ·å¡é¡žåž‹ï¼š${_.value.correctionType}<br/>è£œåˆ·å¡äººå§“åï¼š${_.value.employeeName}<br/>è£œåˆ·å¡äººéƒ¨é–€ï¼š${n.userDeptName}<br/>ç”³è«‹è€…å§“åï¼š${_.value.applierName}<br/>å–®ä½ä¸»ç®¡ï¼š${_.value.supervisor}<br/>è£œåˆ·å¡äº‹ç”±ï¼š${_.value.reason}`;Sa.s.confirm(r,"ç¢ºèªå¡«å¯«å…§å®¹",{confirmButtonText:"ç¢ºèª",cancelButtonText:"å–æ¶ˆ",dangerouslyUseHTMLString:!0}).then((async()=>{const e=new FormData;e.append("DocumentTypeID","CR"),e.append("CreatorID",_.value.employeeId),e.append("CreatorSupervisorID",c.value),e.append("FormData",JSON.stringify(o));const a=_.value.inserPersonList.map((e=>e.id));a.length>0&&e.append("InsertSignerIds",JSON.stringify(a));const l={NotificationTiming:g.value,NotifierIds:_.value.notificationList.map((e=>e.id))};e.append("Notification",JSON.stringify(l));try{console.log("createForm:",e);const a=await pl.createForm(e);i.value.resetFields(),D.nk.success("æäº¤ç”³è«‹å–®æˆåŠŸ!"),t("form-submitted",a.data.documentID)}catch(n){console.error("æäº¤å¤±æ•—:",n),D.nk.error("æäº¤å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦!")}})).catch((()=>{D.nk.info("å·²å–æ¶ˆæäº¤ã€‚")}))}))};const R=e=>{e.resetFields(),_.value.startMinute=null,t("form-reset")},V=(e,a)=>{const l=m.value.filter((a=>a.name.includes(e))).map((e=>({value:e.name,raw:e})));a(l)},I=async e=>{await x(e),await A(e),await E(e)},x=async e=>{_.value.employeeName=e.value,_.value.employeeId=e.raw.id},E=async e=>{v.value=e.raw.area_id,b.value=e.raw.title_id},A=async e=>{await r.fetchDepartmentData();const a=r.departments.find((a=>a.id===e.raw.dpt_id));if(_.value.employeeDpt=a?a.id:"",!a)return p.value="",void(_.value.supervisor="");if("TW0005"===e.raw.id)return c.value="vincent",p.value="æœ±æ–‡æ¾",void(_.value.supervisor=p.value);let l=a.manager_id?.trim()||"";if(l===_.value.employeeId){let e=a.p_dpt_id;while(e&&"-1"!==e){const a=r.departments.find((a=>a.id===e));if(!a)break;const t=a.manager_id?.trim();if(t&&t!==_.value.employeeId){l=t;break}e=a.p_dpt_id}}c.value=l,p.value=l?await lt.getEmployeeName(l):"",_.value.supervisor=p.value},T=async()=>{await s.fetchEmployeeData();const e=s.employees.filter((e=>"Inactive"!==e.emp_status&&"mis"!==e.id&&"vincent"!==e.id));m.value=e};function W(){const e=_.value.correctionTime,[a,l]=e.split(":"),t=`${a}:${l}`;return{correctionDate:_.value.correctionDate,startTime:t,correctionType:_.value.correctionType,reason:_.value.reason}}return(0,u.wB)(g,(e=>{0===e&&(_.value.notificationList=[])})),(0,u.wB)((()=>o.WF_Form_Data),(async e=>{if(e&&Object.keys(e).length>0&&(_.value.applyDate=e.applyAt?new Date(e.applyAt):new Date,_.value.correctionDate=e.correctionDate?new Date(e.correctionDate):"",_.value.correctionTime=e.correctionTime,_.value.employeeId=e.applierId||"",_.value.employeeName=e.applierName||"",_.value.supervisor=e.supervisorName||"",_.value.reason=e.reason||"",_.value.correctionType=e.correctionType||"ClockIn","WF"===o.mode&&e.applierId)){0===m.value.length&&await T();const a=m.value.find((a=>a.id===e.applierId));a&&(await A({raw:a}),await E({raw:a}))}}),{immediate:!0}),a({getResubmitData:W,applyFormRef:i}),(0,u.sV)((async()=>{await T(),"WF"!==o.mode&&(v.value="",b.value="")})),(a,l)=>{const t=(0,u.g2)("el-date-picker"),o=(0,u.g2)("el-form-item"),n=(0,u.g2)("el-time-picker"),r=(0,u.g2)("el-radio"),s=(0,u.g2)("el-radio-group"),c=(0,u.g2)("el-input"),p=((0,u.g2)("el-icon"),(0,u.g2)("el-tag"),(0,u.g2)("el-button")),m=((0,u.g2)("el-text"),(0,u.g2)("el-alert"),(0,u.g2)("el-dialog"),(0,u.g2)("el-radio-button"),(0,u.g2)("el-form"));return(0,u.uX)(),(0,u.CE)("div",st,[(0,u.bF)(m,{ref_key:"applyFormRef",ref:i,class:"workflow-form invoice",style:(0,L.Tr)(h.value),model:_.value,rules:w,"label-width":"8rem","status-icon":""},{default:(0,u.k6)((()=>[(0,u.bF)(o,{label:"ç”³è«‹æ—¥æœŸ",prop:"applyDate",class:"form-item-responsive"},{default:(0,u.k6)((()=>[(0,u.bF)(t,{modelValue:_.value.applyDate,"onUpdate:modelValue":l[0]||(l[0]=e=>_.value.applyDate=e),type:"date",placeholder:"ç”³è«‹æ—¥æœŸ",style:{width:"100%"},disabled:"true"},null,8,["modelValue"])])),_:1}),(0,u.bF)(o,{label:"è£œåˆ·å¡æ—¥",prop:"correctionDate",class:"form-item-responsive"},{default:(0,u.k6)((()=>[(0,u.bF)(t,{modelValue:_.value.correctionDate,"onUpdate:modelValue":l[1]||(l[1]=e=>_.value.correctionDate=e),type:"date",placeholder:"é¸æ“‡è£œåˆ·å¡æ—¥",style:{width:"100%"},disabled:k.value},null,8,["modelValue","disabled"])])),_:1}),(0,u.bF)(o,{label:"è£œåˆ·å¡æ™‚é–“",prop:"correctionTime",class:"form-item-responsive"},{default:(0,u.k6)((()=>[(0,u.bF)(n,{modelValue:_.value.correctionTime,"onUpdate:modelValue":l[2]||(l[2]=e=>_.value.correctionTime=e),format:"HH:mm","value-format":"HH:mm",placeholder:"é¸æ“‡æ™‚é–“",disabled:k.value,style:{width:"100%"}},null,8,["modelValue","disabled"])])),_:1}),(0,u.bF)(o,{label:"è£œåˆ·å¡é¡žåž‹",prop:"correctionType",class:"form-item-responsive"},{default:(0,u.k6)((()=>[(0,u.bF)(s,{modelValue:_.value.correctionType,"onUpdate:modelValue":l[3]||(l[3]=e=>_.value.correctionType=e),disabled:k.value},{default:(0,u.k6)((()=>[(0,u.bF)(r,{label:"ä¸Šç­",value:"ClockIn",border:""}),(0,u.bF)(r,{label:"ä¸‹ç­",value:"ClockOut",border:""})])),_:1},8,["modelValue","disabled"])])),_:1}),(0,u.bF)(o,{prop:"employeeId",style:{display:"None"},class:"form-item-responsive"},{default:(0,u.k6)((()=>[(0,u.bF)(c,{modelValue:_.value.employeeId,"onUpdate:modelValue":l[4]||(l[4]=e=>_.value.employeeId=e),disabled:k.value},null,8,["modelValue","disabled"])])),_:1}),(0,u.bF)(o,{label:"è£œåˆ·å¡äºº",prop:"employeeName",class:"form-item-responsive"},{default:(0,u.k6)((()=>["WF"===e.mode?((0,u.uX)(),(0,u.CE)("span",ut,(0,L.v_)(_.value.employeeName),1)):((0,u.uX)(),(0,u.Wv)((0,d.R1)(tt.s9),{key:1,modelValue:_.value.employeeName,"onUpdate:modelValue":l[5]||(l[5]=e=>_.value.employeeName=e),"fetch-suggestions":V,placeholder:"è¼¸å…¥å¾Œè«‹é¸æ“‡æ­£ç¢ºçš„è£œåˆ·å¡äººå§“å",onSelect:I,style:{width:"100%"},clearable:"","trigger-on-focus":!1,disabled:k.value},null,8,["modelValue","disabled"]))])),_:1}),(0,u.bF)(o,{label:"åœ°å€/è·ç¨±",class:"form-item-responsive"},{default:(0,u.k6)((()=>[(0,u.Lk)("div",it,[(0,u.bF)(rt,{areaId:v.value},null,8,["areaId"]),(0,u.bF)(Dl,{mode:"Description",titleId:b.value},null,8,["titleId"])])])),_:1}),(0,u.bF)(o,{label:"è£œåˆ·å¡äººéƒ¨é–€",prop:"employeeDpt",class:"form-item-responsive"},{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(_l),{deptId:_.value.employeeDpt},null,8,["deptId"])])),_:1}),"WF"===!e.mode?((0,u.uX)(),(0,u.Wv)(o,{key:0,label:"ç”³è«‹è€…å§“å",prop:"applierName",class:"form-item-responsive"},{default:(0,u.k6)((()=>[(0,u.bF)(c,{modelValue:_.value.applierName,"onUpdate:modelValue":l[6]||(l[6]=e=>_.value.applierName=e),disabled:k.value},null,8,["modelValue","disabled"])])),_:1})):(0,u.Q3)("",!0),(0,u.bF)(o,{label:"å–®ä½ä¸»ç®¡",prop:"supervisor",class:"form-item-responsive"},{default:(0,u.k6)((()=>["WF"===e.mode?((0,u.uX)(),(0,u.CE)("label",dt,(0,L.v_)(_.value.supervisor),1)):((0,u.uX)(),(0,u.CE)("label",ct,(0,L.v_)(_.value.supervisor),1))])),_:1}),(0,u.bF)(o,{label:"è£œåˆ·å¡äº‹ç”±",prop:"reason",class:"form-item-responsive"},{default:(0,u.k6)((()=>[(0,u.bF)(c,{type:"textarea",modelValue:_.value.reason,"onUpdate:modelValue":l[7]||(l[7]=e=>_.value.reason=e),placeholder:"è«‹å¡«å¯«è£œåˆ·å¡åŽŸå› ",rows:3,disabled:k.value},null,8,["modelValue","disabled"])])),_:1}),(0,u.Q3)("",!0),(0,u.Q3)("",!0),(0,u.Q3)("",!0),"create"===e.mode?((0,u.uX)(),(0,u.Wv)(o,{key:4},{default:(0,u.k6)((()=>[(0,u.bF)(p,{type:"success",onClick:l[20]||(l[20]=e=>C(i.value)),disabled:k.value},{default:(0,u.k6)((()=>l[30]||(l[30]=[(0,u.eW)(" ç¢ºèª ")]))),_:1},8,["disabled"]),(0,u.bF)(p,{onClick:l[21]||(l[21]=e=>R(i.value)),disabled:k.value},{default:(0,u.k6)((()=>l[31]||(l[31]=[(0,u.eW)(" æ¸…ç©º ")]))),_:1},8,["disabled"])])),_:1})):(0,u.Q3)("",!0)])),_:1},8,["style","model"])])}}};const mt=(0,ie.A)(pt,[["__scopeId","data-v-244b5fd0"]]);var vt=mt,bt=(l(16573),l(78100),l(77936),l(64979),l(14603),l(47566),l(98721),l(97722)),gt=l(39623),yt=l(47358),ft=l(3191),ht=l(9109),kt=l(29143);const _t={class:"leave-form-grid"},wt={class:"form-section"},Ft={class:"item1"},Ct={key:0,style:{"margin-top":"4rem","margin-left":"3rem","margin-bottom":"-2rem"}},Dt={key:0,style:{"font-size":"1.2rem"}},Lt={key:1,style:{"font-size":"1.2rem"}},Rt={key:0,class:"el-upload__tip",style:{"text-align":"right"}},Vt={key:0,style:{color:"red"}},It={class:"upload-container"},xt=["src"],Et={key:0,class:"leave-info-section"},At={class:"leave-info-content"},Tt={class:"info-row"},Wt={class:"info-value"},St={class:"info-row"},Ut={class:"info-value"},$t={class:"info-row"},Nt={class:"info-value"};var Xt={__name:"LeaveRequestForm",props:{mode:{type:String,default:"create"},WF_Form_Data:{type:Object,default:()=>({})},WF_canEdit:{type:Boolean,default:!1},layout:{type:Boolean,defailt:!1}},emits:["form-submitted","form-reset"],setup(e,{expose:a,emit:l}){const o=l,n=e,r=(0,S.k)(),s=fl(),i=vl(),c=(0,d.KR)(null),p=(0,d.KR)(),m=(0,d.KR)(),v=(0,d.KR)([]),{width:b}=(0,Ql.lWr)(),g=(0,u.EW)((()=>b.value<=768)),y=(0,d.KR)(!1),f=(0,d.KR)(""),h=(0,d.KR)(""),k=(0,d.KR)(null),_=(0,d.KR)(null),w=(0,u.EW)((()=>{if(b.value<=768)return{width:"80%",maxWidth:"100%",margin:"1rem auto"};{const e="WF"===n.mode?"3rem 3rem 3rem 1rem":"3rem";return{width:"35rem",maxWidth:"40rem",margin:e}}})),F=(0,u.EW)((()=>"WF"===n.mode&&!n.WF_canEdit)),C=(0,d.KR)({applyDate:new Date,leaveType:"",applicantDept:r.userDeptId,applicantName:r.userName,leaveDateTimeRange:[],leaveHours:0,agentEmployeeId:"",agentEmployeeName:"",reason:"",attachments:[],insertSignerList:[]}),R=((0,d.KR)(!1),(0,d.KR)(!1)),V=(0,d.KR)(0),I=(0,d.KR)(0),x=["AnnualLeave","PersonalLeave","MenstrualLeave","JobSeekingLeave","OfficialLeave","WorkInjuryLeave"],E=(0,u.EW)((()=>C.value.leaveType&&!x.includes(C.value.leaveType))),A=(e,a,l)=>{const t=C.value.agentEmployeeId;if(!a||!a.trim())return l(new Error("è«‹è¼¸å…¥å¾Œé¸æ“‡æŒ‡å®šçš„è·å‹™ä»£ç†äºº"));if(!t)return l(new Error("è«‹å¾žæ¸…å–®ä¸­é¸æ“‡ï¼Œå‹¿æ‰‹å‹•è¼¸å…¥"));const o=v.value.find((e=>e.id===t));return o&&o.name===a?l():l(new Error("è¼¸å…¥å¾Œè«‹é¸æ“‡æŒ‡å®šçš„è·å‹™ä»£ç†äºº"))},T=(0,u.EW)((()=>({leaveType:[{required:!0,message:"è«‹é¸æ“‡å‡åˆ¥",trigger:"change"}],leaveDateTimeRange:[{required:!0,message:"è«‹é¸æ“‡è«‹å‡æ—¥æœŸå’Œæ™‚é–“å€é–“",trigger:"change"}],agentEmployeeId:[{required:!0,message:"è«‹é¸æ“‡æœ‰æ•ˆçš„è·å‹™ä»£ç†äººè³‡æ–™",trigger:"change"},{validator:(e,a,l)=>{if(""===a||null===a)return l(new Error("è·å‹™ä»£ç†äººåç¨±ä¸å¯ç‚ºç©º"));l()},trigger:"change"}],agentEmployeeName:[{required:!0,message:"è«‹é¸æ“‡è·å‹™ä»£ç†äºº",trigger:["change","blur"]},{validator:A,trigger:["change","blur"]}],attachments:[{validator:(e,a,l)=>E.value?a&&0!==a.length?void l():l(new Error("æ­¤å‡åˆ¥éœ€è¦ä¸Šå‚³é™„ä»¶")):l(),trigger:["change","blur"]}]}))),W=[new Date(2e3,1,1,8,30,0),new Date(2e3,2,1,17,30,0)],U=(0,u.EW)((()=>{const[e,a]=C.value.leaveDateTimeRange;if(!e||!a)return 0;let l=0;const t=[{start:{hours:8,minutes:30},end:{hours:12,minutes:30}},{start:{hours:13,minutes:30},end:{hours:17,minutes:30}}];let o=new Date(e);o.setHours(0,0,0,0);const n=new Date(a);n.setHours(0,0,0,0);while(o.getTime()<=n.getTime()){const n=o.getDay();if(0!==n&&6!==n)for(const r of t){const t=new Date(o.getFullYear(),o.getMonth(),o.getDate(),r.start.hours,r.start.minutes,0),n=new Date(o.getFullYear(),o.getMonth(),o.getDate(),r.end.hours,r.end.minutes,0),s=new Date(Math.max(e.getTime(),t.getTime())),u=new Date(Math.min(a.getTime(),n.getTime()));s<u&&(l+=(u.getTime()-s.getTime())/6e4)}o.setDate(o.getDate()+1)}return Math.floor(l)})),$=(0,u.EW)((()=>{const e=I.value,a=Math.floor(e/60),l=e%60;return`${a} å°æ™‚ ${l} åˆ†`}));(0,u.wB)(U,(e=>{R.value||(I.value=e,C.value.leaveHours=e/60,C.value.leaveMinutes=e)}),{immediate:!0});const N=()=>{F.value||(R.value=!0,V.value=I.value,(0,u.dY)((()=>{})))},X=()=>{R.value=!1,V.value=Math.round(Number(V.value)||0),I.value=V.value,C.value.leaveHours=V.value/60,C.value.leaveMinutes=V.value};function K(e){const a=e.getFullYear(),l=String(e.getMonth()+1).padStart(2,"0"),t=String(e.getDate()).padStart(2,"0");return`${a}-${l}-${t}`}const M=async e=>{e.validate((async(e,a)=>{if(!e){const e={leaveType:"å‡åˆ¥",leaveDateTimeRange:"è«‹å‡æ—¥æœŸå’Œæ™‚é–“",agentEmployeeName:"è·å‹™ä»£ç†äºº",reason:"å‚™è¨»",attachments:"é™„ä»¶"},l=Object.keys(a)[0],t=a[l][0].message,o=e[l]||l;return D.nk.error(`æ¬„ä½ã€Œ${o}ã€éŒ¯èª¤ï¼š${t}`),!1}const l=I.value,t=ne(l/60,2),n={applyDate:C.value.applyDate.toISOString().split("T")[0],leaveType:C.value.leaveType,applicantDept:r.userDeptId,applicantId:r.userId,applicantName:r.userName,leaveStartDate:K(C.value.leaveDateTimeRange[0]),leaveEndDate:K(C.value.leaveDateTimeRange[1]),leaveStartTime:C.value.leaveDateTimeRange[0].toLocaleTimeString("zh-TW",{hour:"2-digit",minute:"2-digit",hour12:!1}),leaveEndTime:C.value.leaveDateTimeRange[1].toLocaleTimeString("zh-TW",{hour:"2-digit",minute:"2-digit",hour12:!1}),leaveHours:t,leaveMinutes:l,agentEmployeeId:C.value.agentEmployeeId,agentEmployeeName:C.value.agentEmployeeName,reason:C.value.reason,attachments:C.value.attachments.map((e=>e.raw))};console.log(n);const s={AnnualLeave:"ç‰¹ä¼‘",SickLeave:"ç—…å‡",PersonalLeave:"äº‹å‡",MenstrualLeave:"ç”Ÿç†å‡",OfficialLeave:"å…¬å‡",WorkInjuryLeave:"å·¥å‚·å‡",FamilyCareLeave:"å®¶åº­ç…§é¡§å‡",MarriageLeave:"å©šå‡",MaternityLeave:"ç”¢å‡",PrenatalCheckupLeave:"ç”¢æª¢å‡",PaternityLeave:"é™ªç”¢å‡",FuneralLeave:"å–ªå‡",JobSeekingLeave:"è¬€è·å‡"},u=`è«‹ç¢ºèªä»¥ä¸‹è³‡æ–™æ˜¯å¦æ­£ç¢ºï¼š<br/>ç”³è«‹æ—¥æœŸï¼š${n.applyDate}<br/>å‡åˆ¥ï¼š${s[n.leaveType]||n.leaveType}<br/>ç”³è«‹è€…IDï¼š${n.applicantId}<br/>ç”³è«‹è€…ï¼š${n.applicantName}<br/>è«‹å‡æ—¥æœŸå’Œæ™‚é–“ï¼š${n.leaveStartDate} ${n.leaveStartTime} è‡³ ${n.leaveEndDate} ${n.leaveEndTime}<br/>è«‹å‡æ™‚æ•¸ï¼š${$.value}<br/>è·å‹™ä»£ç†äººï¼š${n.agentEmployeeName}<br/>å‚™è¨»ï¼š${n.reason}`;Sa.s.confirm(u,"ç¢ºèªå¡«å¯«å…§å®¹",{confirmButtonText:"ç¢ºèª",cancelButtonText:"å–æ¶ˆ",dangerouslyUseHTMLString:!0}).then((async()=>{const e=new FormData;e.append("DocumentTypeID","LR"),e.append("CreatorID",r.userId),e.append("CreatorSupervisorID",p.value),e.append("FormData",JSON.stringify(n));const a=C.value.insertSignerList?.map((e=>e.id))||[];e.append("InsertSignerIds",JSON.stringify(a)),C.value.attachments.forEach((a=>{e.append("Attachments",a.raw)}));try{console.log("createForm:",e);const a=await pl.createForm(e);c.value.resetFields(),D.nk.success("æäº¤ç”³è«‹å–®æˆåŠŸ!"),o("form-submitted",a.data.documentID)}catch(l){console.error("æäº¤ç”³è«‹å–®å¤±æ•—:",l),D.nk.error("æäº¤ç”³è«‹å–®å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦!")}})).catch((()=>{D.nk.info("å·²å–æ¶ˆæäº¤ã€‚")}))}))},P=e=>{e.resetFields(),C.value.attachments=[],o("form-reset")},O=(e,a)=>{const l=v.value.filter((a=>a.name.includes(e))).map((e=>({value:e.name,raw:e})));a(l)},z=async e=>{C.value.agentEmployeeName=e.value,C.value.agentEmployeeId=e.raw.id},B=(0,d.KR)(""),j=(0,d.KR)(!1),Y=(e,a)=>{const l=["image/jpeg","image/png","image/tiff","application/pdf"],t=l.includes(e.raw.type);if(!t){D.nk.warning("ä¸Šå‚³é™„ä»¶åªèƒ½æ˜¯ JPG, JPEG, PNG, TIFF, PDF æ ¼å¼!");const l=a.filter((a=>a.uid!==e.uid));return C.value.attachments=l,!1}C.value.attachments=a,c.value&&c.value.validateField("attachments")},Q=(e,a)=>{C.value.attachments=a,c.value&&c.value.validateField("attachments")},H=e=>{const{raw:a,name:l,url:t}=e,o=a?.type||"",n=(l?.split(".").pop()||"").toLowerCase(),r=o.startsWith("image/")||t.startsWith("data:image")||["jpg","jpeg","png","gif","bmp","webp","tiff"].includes(n),s="application/pdf"===o||"pdf"===n||t.startsWith("data:application/pdf");if(r)return B.value=t,void(j.value=!0);if(s){if(t.startsWith("data:application/pdf;base64,")){const e=t.split(",")[1],a=atob(e),l=a.length,o=new Uint8Array(l);for(let t=0;t<l;t++)o[t]=a.charCodeAt(t);const n=new Blob([o],{type:"application/pdf"}),r=URL.createObjectURL(n);return window.open(r,"_blank"),void setTimeout((()=>URL.revokeObjectURL(r)),6e4)}if(a instanceof Blob){const e=URL.createObjectURL(a);return window.open(e,"_blank"),void setTimeout((()=>URL.revokeObjectURL(e)),6e4)}window.open(t,"_blank")}else D.nk.warning("ä¸æ”¯æ´çš„é è¦½æª”æ¡ˆé¡žåž‹ã€‚")},q=e=>{const a=e.target.files;if(!a||0===a.length)return;const l=a[0],t={name:l.name,raw:l,size:l.size,status:"ready",uid:Date.now()+Math.random(),url:URL.createObjectURL(l)},o=[...C.value.attachments,t];Y(t,o),e.target.value=""},G=async()=>{await i.fetchEmployeeData();const e=i.employees.filter((e=>"Inactive"!==e.emp_status&&"mis"!==e.id&&"vincent"!==e.id));v.value=e},Z=async()=>{await s.fetchDepartmentData();const e=s.departments.find((e=>e.id===r.userDeptId));if(e){let a=e.manager_id?.trim()||"";if("TW0005"===r.userId)return p.value="vincent",void(m.value="æœ±æ–‡æ¾");if(a===r.userId){let l=e.p_dpt_id;while(l&&"-1"!==l){const e=s.departments.find((e=>e.id===l));if(!e)break;const t=e.manager_id?.trim();if(t&&t!==r.userId){a=t;break}l=e.p_dpt_id}}p.value=a,m.value=a?await lt.getEmployeeName(a):""}};function ee(){return{applyDate:C.value.applyDate.toISOString().split("T")[0],leaveType:C.value.leaveType,applicantDept:C.value.applicantDept,applicantId:r.userId,applicantName:r.userName,leaveStartDate:K(C.value.leaveDateTimeRange[0]),leaveEndDate:K(C.value.leaveDateTimeRange[1]),leaveStartTime:C.value.leaveDateTimeRange[0].toLocaleTimeString("zh-TW",{hour:"2-digit",minute:"2-digit",hour12:!1}),leaveEndTime:C.value.leaveDateTimeRange[1].toLocaleTimeString("zh-TW",{hour:"2-digit",minute:"2-digit",hour12:!1}),leaveHours:I.value/60,leaveMinutes:I.value,agentEmployeeId:C.value.agentEmployeeId,agentEmployeeName:C.value.agentEmployeeName,reason:C.value.reason,attachments:C.value.attachments.map((e=>e.raw))}}(0,u.wB)((()=>n.WF_Form_Data),(async e=>{if(e&&Object.keys(e).length>0){if(C.value.applyDate=e.applyAt?new Date(e.applyAt):new Date,C.value.leaveType=e.leaveType||"",C.value.applicantDept=e.applierDptId||"",C.value.applicantName=e.applicantName||"",e.leaveStartDate&&e.leaveEndDate&&e.leaveStartTime&&e.leaveEndTime){const a=new Date(`${e.leaveStartDate.split("T")[0]}T${e.leaveStartTime}`),l=new Date(`${e.leaveEndDate.split("T")[0]}T${e.leaveEndTime}`);isNaN(a.getTime())||isNaN(l.getTime())?C.value.leaveDateTimeRange=[]:C.value.leaveDateTimeRange=[a,l]}else C.value.leaveDateTimeRange=[];if(C.value.leaveHours=e.leaveHours||0,C.value.leaveMinutes=e.leaveMinutes||0,I.value=e.leaveMinutes||0,V.value=e.leaveMinutes||0,C.value.agentEmployeeId=e.agentEmployeeId||"",C.value.agentEmployeeName=e.agentEmployeeName||"",f.value=e.agentEmployeeName||"",h.value=e.agentEmployeeId||"",C.value.reason=e.reason||"",e.attachments&&Array.isArray(e.attachments)?C.value.attachments=e.attachments.map((a=>{if(a.dataUri&&a.fileName)return{name:a.fileName,url:a.dataUri,raw:a};{const l=new Date(e.applyAt),t=l.getFullYear(),o=String(l.getMonth()+1).padStart(2,"0"),n=String(l.getDate()).padStart(2,"0"),r=`${t}-${o}-${n}`,s=e.id,u=a.fileName,i=`/files/attached/${r}/${s}/${u}`;return{name:u,url:i,raw:a}}})):C.value.attachments=[],"WF"===n.mode&&e.applicantId){0===v.value.length&&await G();v.value.find((a=>a.id===e.applicantId))}}}),{immediate:!0}),a({getResubmitData:ee,applyFormRef:c});const ae=(0,d.KR)(!1),le=(0,d.KR)(null),te=(0,d.KR)(""),oe=(0,d.KR)({SickLeave:{title:"ç—…å‡",regulation:"1.æœªä½é™¢ï¼Œ1å¹´å…§åˆè¨ˆä¸å¾—è¶…éŽ30æ—¥ã€‚2.ä½é™¢è€…ï¼Œ2å¹´å…§åˆè¨ˆä¸å¾—è¶…éŽ1å¹´ã€‚3.æœªä½é™¢èˆ‡ä½é™¢å‚·ç—…å‡2å¹´å…§åˆè¨ˆä¸å¾—è¶…éŽ1å¹´ã€‚4.ç¶“é†«å¸«è¨ºæ–·ï¼Œç½¹æ‚£ç™Œç—‡ï¼ˆå«åŽŸä½ç™Œï¼‰æŽ¡é–€è¨ºæ–¹å¼æ²»ç™‚æˆ–æ‡·å­•æœŸé–“éœ€å®‰èƒŽä¼‘é¤Šè€…ï¼Œå…¶æ²»ç™‚æˆ–ä¼‘é¤ŠæœŸé–“ï¼Œä½µå…¥ä½é™¢å‚·ç—…å‡è¨ˆç®—ã€‚",salary:"1å¹´å…§æœªè¶…éŽ30æ—¥éƒ¨åˆ†ï¼ŒæŠ˜åŠç™¼çµ¦",legal:"å‹žå‹•åŸºæº–æ³•Â§43ã€å‹žå·¥è«‹å‡è¦å‰‡Â§4ã€Â§5ï¼Œæ€§åˆ¥å·¥ä½œç­‰æ³•Â§15ã€Â§21"},PersonalLeave:{title:"äº‹å‡",regulation:"çµ¦å‡14æ—¥",salary:"å¯ä¸çµ¦å·¥è³‡",legal:"å‹žå‹•åŸºæº–æ³•Â§43ã€å‹žå·¥è«‹å‡è¦å‰‡Â§7"},MenstrualLeave:{title:"ç”Ÿç†å‡",regulation:"æ¯å€‹æœˆ1æ—¥ï¼Œå…¨å¹´è«‹å‡æ—¥æ•¸æœªé€¾3æ—¥ï¼Œä¸ä½µå…¥ç—…å‡è¨ˆç®—ï¼Œå…¶é¤˜æ—¥æ•¸ä½µå…¥ç—…å‡è¨ˆç®—ã€‚(ä¸ç”¨æä¾›è­‰æ˜Ž)",salary:"ä½µå…¥åŠä¸ä½µå…¥ç—…å‡ä¹‹ç”Ÿç†å‡è–ªè³‡ï¼Œæ¸›åŠç™¼çµ¦",legal:"æ€§åˆ¥å·¥ä½œå¹³ç­‰æ³•Â§14ã€Â§21"},OfficialLeave:{title:"å…¬å‡",regulation:"ä¾æ³•ä»¤è¦å®šæ‡‰çµ¦äºˆå…¬å‡è€…ã€‚",salary:"å·¥è³‡ç…§çµ¦(ä¸å¾—æ‰£å…¨å‹¤çŽé‡‘)",legal:"å‹žå·¥è«‹å‡è¦å‰‡Â§8ã€Â§9"},WorkInjuryLeave:{title:"å·¥å‚·å‡",regulation:"å› è·æ¥­ç½å®³è€Œè‡´å¤±èƒ½ã€å‚·å®³æˆ–ç–¾ç—…è€…ï¼Œå…¶æ²»ç™‚ã€ä¼‘é¤ŠæœŸé–“ï¼Œçµ¦äºˆå…¬å‚·ç—…å‡ã€‚",salary:"å·¥è³‡ç…§çµ¦(ä¸å¾—æ‰£å…¨å‹¤çŽé‡‘)",legal:"å‹žå‹•åŸºæº–æ³•Â§59ã€å‹žå·¥è«‹å‡è¦å‰‡Â§6ã€Â§9"},FamilyCareLeave:{title:"å®¶åº­ç…§é¡§å‡",regulation:"å‹žå·¥å› å…¶å®¶åº­æˆå“¡é é˜²æŽ¥ç¨®ã€ç™¼ç”Ÿåš´é‡ç–¾ç—…æˆ–é‡å¤§äº‹æ•…éœ€è¦ªè‡ªç…§é¡§ï¼Œå…¨å¹´çµ¦å‡7æ—¥ï¼Œè«‹å‡æ—¥æ•¸ä½µå…¥äº‹å‡ã€‚",salary:"åŒäº‹å‡è¦å®š",legal:"æ€§åˆ¥å·¥ä½œå¹³ç­‰æ³•Â§20ã€Â§21ï¼Œå‹žå·¥è«‹å‡è¦å‰‡Â§7"},MarriageLeave:{title:"å©šå‡",regulation:"çµ¦å‡å…«æ—¥ï¼Œå¯è‡ªçµå©šä¹‹æ—¥å‰åæ—¥èµ·ä¸‰å€‹æœˆå…§è«‹ç•¢ã€‚ä½†ç¶“å…¬å¸åŒæ„è€…ï¼Œå¾—æ–¼ä¸€å¹´å…§è«‹ç•¢ã€‚",salary:"å·¥è³‡ç…§çµ¦(ä¸å¾—æ‰£å…¨å‹¤çŽé‡‘)",legal:"å‹žå‹•åŸºæº–æ³•Â§43ï¼Œå‹žå·¥è«‹å‡è¦å‰‡Â§2ã€Â§9"},MaternityLeave:{title:"ç”¢å‡",regulation:"1.ç”¢å‡ï¼š8æ˜ŸæœŸï¼ˆæŒ‰æ›†é€£çºŒè¨ˆç®—ï¼‰ã€‚2.å¦Šå¨ 3å€‹æœˆä»¥ä¸Šæµç”¢è€…ï¼Œç”¢å‡4æ˜ŸæœŸã€‚3.å¦Šå¨ 2å€‹æœˆä»¥ä¸Šæœªæ»¿3å€‹æœˆæµç”¢è€…ï¼Œç”¢å‡1æ˜ŸæœŸã€‚4.å¦Šå¨ æœªæ»¿2å€‹æœˆæµç”¢è€…ï¼Œç”¢å‡5æ—¥ã€‚",salary:"ç¬¬1.2é …å—åƒ±6å€‹æœˆä»¥ä¸Šè€…å·¥è³‡ç…§çµ¦ï¼Œæœªæ»¿6å€‹æœˆè€…ï¼Œæ¸›åŠç™¼çµ¦",legal:"æ€§åˆ¥å·¥ä½œå¹³ç­‰æ³•Â§15ã€Â§21ï¼Œå‹žå‹•åŸºæº–æ³•Â§50"},PrenatalCheckupLeave:{title:"ç”¢æª¢å‡",regulation:"çµ¦å‡7æ—¥",salary:"å·¥è³‡ç…§çµ¦",legal:"æ€§åˆ¥å·¥ä½œå¹³ç­‰æ³•Â§15ã€Â§21"},PaternityLeave:{title:"é™ªç”¢å‡",regulation:"çµ¦å‡7æ—¥(é™¤é™ªç”¢æª¢æ–¼é…å¶å¦Šå¨ æœŸé–“è«‹å‡å¤–ï¼Œå—åƒ±è€…é™ªç”¢ä¹‹é™ªç”¢å‡ï¼Œæ‡‰æ–¼é…å¶åˆ†å¨©ä¹‹ç•¶æ—¥åŠå‰å¾Œåˆè¨ˆ15æ—¥æœŸé–“å…§ç‚ºä¹‹)ã€‚",salary:"å·¥è³‡ç…§çµ¦",legal:"æ€§åˆ¥å·¥ä½œå¹³ç­‰æ³•Â§15ã€Â§21"},FuneralLeave:{title:"å–ªå‡",regulation:"1.çˆ¶æ¯ã€é¤Šçˆ¶æ¯ã€ç¹¼çˆ¶æ¯ã€é…å¶å–ªäº¡è€…ï¼š8æ—¥ã€‚2.(å¤–)ç¥–çˆ¶æ¯ã€å­å¥³ã€é…å¶ä¹‹çˆ¶æ¯ã€é…å¶ä¹‹é¤Šçˆ¶æ¯æˆ–ç¹¼çˆ¶æ¯å–ªäº¡è€…ï¼š6æ—¥ã€‚3.(å¤–)æ›¾ç¥–çˆ¶æ¯ã€å…„å¼Ÿå§å¦¹ã€é…å¶ä¹‹(å¤–)ç¥–çˆ¶æ¯å–ªäº¡è€…ï¼š3æ—¥ã€‚",salary:"å·¥è³‡ç…§çµ¦(ä¸å¾—æ‰£å…¨å‹¤çŽé‡‘)",legal:"å‹žå‹•åŸºæº–æ³•Â§43ã€å‹žå·¥è«‹å‡è¦å‰‡Â§3ã€Â§9"},JobSeekingLeave:{title:"è¬€è·å‡",regulation:"ä¾ç›¸é—œæ³•ä»¤è¦å®š",salary:"ä¾ç›¸é—œæ³•ä»¤è¦å®š",legal:"ä¾ç›¸é—œæ³•ä»¤è¦å®š"}});function ne(e,a=2){const l=10**a;return Math.round((e+Number.EPSILON)*l)/l}(0,u.wB)((()=>C.value.leaveType),(e=>{e&&"AnnualLeave"!==e&&oe.value[e]?te.value=e:te.value="",c.value&&(0,u.dY)((()=>{c.value.validateField("attachments")}))}));const re=()=>{g.value&&(Sa.s.alert("è«‹é¸æ“‡ä¸Šå‚³æ–¹å¼","ä¸Šå‚³é™„ä»¶",{confirmButtonText:"æ‹ç…§",showCancelButton:!0,cancelButtonText:"å¾žç›¸ç°¿é¸æ“‡",showClose:!1,closeOnClickModal:!1,callback:e=>{"confirm"===e?k.value.click():"cancel"===e&&_.value.click()}}).then((()=>{})),Sa.s.confirm("æˆ–é¸æ“‡æŽƒæ QR Code","æŽƒæé¸é …",{confirmButtonText:"æŽƒæ QR Code",showCancelButton:!1,showClose:!1,type:"info",center:!0}).then((()=>{se()})).catch((()=>{})))},se=()=>{ae.value=!0,(0,u.dY)((()=>{const e="qr-code-reader";le.value=new kt.TF(e,{fps:10,qrbox:{width:250,height:250}},!1),le.value.render(((e,a)=>{console.log(`QR Code result: ${e}`,a),C.value.reason=e,D.nk.success("QR Code æŽƒææˆåŠŸï¼å…§å®¹å·²å¡«å…¥è«‹å‡äº‹ç”±ã€‚"),ue()}),(e=>{console.warn(`QR Code Scan Error: ${e}`)}))}))},ue=()=>{le.value&&le.value.clear().then((()=>{ae.value=!1,le.value=null})).catch((e=>{console.error("Failed to clear html5QrcodeScanner. ",e),ae.value=!1,le.value=null}))};return(0,u.sV)((async()=>{await G(),await Z()})),(a,l)=>{const o=(0,u.g2)("el-text"),s=(0,u.g2)("el-date-picker"),i=(0,u.g2)("el-form-item"),p=(0,u.g2)("el-option"),m=(0,u.g2)("el-select"),v=(0,u.g2)("el-icon"),b=(0,u.g2)("el-button"),g=((0,u.g2)("el-tag"),(0,u.g2)("el-alert"),(0,u.g2)("el-form")),f=(0,u.g2)("el-collapse-item"),h=(0,u.g2)("el-collapse");return(0,u.uX)(),(0,u.CE)("div",{class:(0,L.C4)(["container",{"layout-margin":n.layout}])},[(0,u.Lk)("div",_t,[(0,u.Lk)("div",wt,[(0,u.Lk)("div",Ft,["create"===e.mode?((0,u.uX)(),(0,u.CE)("div",Ct,[(0,u.bF)(o,{style:{"font-size":"1.7rem"},type:"warning",class:"mx-1"},{default:(0,u.k6)((()=>l[16]||(l[16]=[(0,u.eW)("å¦‚è«‹å‡æœŸé–“è·¨å‘¨æœ«å…­æ—¥ï¼Œè«‹æ‹†åˆ†å…©å¼µå–®æ“šç”³è«‹ã€‚ "),(0,u.Lk)("br",null,null,-1)]))),_:1})])):(0,u.Q3)("",!0),(0,u.bF)((0,d.R1)(bt.H6),{locale:(0,d.R1)(ht.A)},{default:(0,u.k6)((()=>[(0,u.bF)(g,{ref_key:"applyFormRef",ref:c,class:"workflow-form invoice",style:(0,L.Tr)(w.value),model:C.value,rules:T.value,"label-width":"10rem","status-icon":""},{default:(0,u.k6)((()=>[(0,u.bF)(i,{label:"ç”³è«‹æ—¥æœŸ",prop:"applyDate",class:"form-item-responsive"},{default:(0,u.k6)((()=>[(0,u.bF)(s,{modelValue:C.value.applyDate,"onUpdate:modelValue":l[0]||(l[0]=e=>C.value.applyDate=e),type:"date",placeholder:"ç”³è«‹æ—¥æœŸ",style:{width:"100%","font-size":"1.2rem"},disabled:!0},null,8,["modelValue"])])),_:1}),(0,u.bF)(i,{label:"å‡åˆ¥",prop:"leaveType",class:"form-item-responsive"},{default:(0,u.k6)((()=>[(0,u.bF)(m,{modelValue:C.value.leaveType,"onUpdate:modelValue":l[1]||(l[1]=e=>C.value.leaveType=e),placeholder:"è«‹é¸æ“‡å‡åˆ¥",style:{width:"10rem","font-size":"1.2rem"},disabled:F.value},{default:(0,u.k6)((()=>[(0,u.bF)(p,{label:"ç‰¹ä¼‘",value:"AnnualLeave"}),(0,u.bF)(p,{label:"ç—…å‡",value:"SickLeave"}),(0,u.bF)(p,{label:"äº‹å‡",value:"PersonalLeave"}),(0,u.bF)(p,{label:"ç”Ÿç†å‡",value:"MenstrualLeave"}),(0,u.bF)(p,{label:"å…¬å‡",value:"OfficialLeave"}),(0,u.bF)(p,{label:"å·¥å‚·å‡",value:"WorkInjuryLeave"}),(0,u.bF)(p,{label:"å®¶åº­ç…§é¡§å‡",value:"FamilyCareLeave"}),(0,u.bF)(p,{label:"å©šå‡",value:"MarriageLeave"}),(0,u.bF)(p,{label:"ç”¢å‡",value:"MaternityLeave"}),(0,u.bF)(p,{label:"ç”¢æª¢å‡",value:"PrenatalCheckupLeave"}),(0,u.bF)(p,{label:"é™ªç”¢å‡",value:"PaternityLeave"}),(0,u.bF)(p,{label:"å–ªå‡",value:"FuneralLeave"}),(0,u.bF)(p,{label:"è¬€è·å‡",value:"JobSeekingLeave"})])),_:1},8,["modelValue","disabled"])])),_:1}),(0,u.bF)(i,{label:"ç”³è«‹è€…éƒ¨é–€",class:"form-item-responsive"},{default:(0,u.k6)((()=>["create"===e.mode?((0,u.uX)(),(0,u.Wv)((0,d.R1)(_l),{key:0,deptId:(0,d.R1)(r).userDeptId,style:{"font-size":"1.2rem"}},null,8,["deptId"])):"WF"===e.mode?((0,u.uX)(),(0,u.Wv)((0,d.R1)(_l),{key:1,deptId:C.value.applicantDept,style:{"font-size":"1.2rem"}},null,8,["deptId"])):(0,u.Q3)("",!0)])),_:1}),(0,u.bF)(i,{label:"ç”³è«‹è€…",class:"form-item-responsive"},{default:(0,u.k6)((()=>["create"===e.mode?((0,u.uX)(),(0,u.CE)("span",Dt,(0,L.v_)((0,d.R1)(r).userName),1)):"WF"===e.mode?((0,u.uX)(),(0,u.CE)("span",Lt,(0,L.v_)(C.value.applicantName),1)):(0,u.Q3)("",!0)])),_:1}),(0,u.bF)(i,{prop:"leaveDateTimeRange",class:"form-item-responsive"},{label:(0,u.k6)((()=>l[17]||(l[17]=[(0,u.Lk)("label",null," è«‹å‡æ—¥æœŸå’Œæ™‚é–“",-1)]))),default:(0,u.k6)((()=>[(0,u.bF)(s,{modelValue:C.value.leaveDateTimeRange,"onUpdate:modelValue":l[2]||(l[2]=e=>C.value.leaveDateTimeRange=e),type:"datetimerange","range-separator":"åˆ°","start-placeholder":"é–‹å§‹","end-placeholder":"çµæŸ","default-time":W,format:"YYYY-MM-DD HH:mm",disabled:F.value},null,8,["modelValue","disabled"])])),_:1}),(0,u.bF)(i,{label:"è«‹å‡æ™‚æ•¸",class:"form-item-responsive"},{default:(0,u.k6)((()=>[R.value?((0,u.uX)(),(0,u.Wv)((0,d.R1)(gt.WK),{key:1,modelValue:V.value,"onUpdate:modelValue":l[3]||(l[3]=e=>V.value=e),modelModifiers:{number:!0},onBlur:X,onKeyup:(0,t.jR)(X,["enter"]),size:"small",style:{width:"8rem"},disabled:F.value},{append:(0,u.k6)((()=>l[18]||(l[18]=[(0,u.eW)("åˆ†é˜")]))),_:1},8,["modelValue","disabled"])):((0,u.uX)(),(0,u.CE)("span",{key:0,onDblclick:N,class:"editable-span"},(0,L.v_)($.value),33))])),_:1}),(0,u.bF)(i,{label:"è·å‹™ä»£ç†äºº",prop:"agentEmployeeName",class:"form-item-responsive"},{default:(0,u.k6)((()=>["create"===e.mode||!0===y.value?((0,u.uX)(),(0,u.Wv)((0,d.R1)(tt.s9),{key:0,modelValue:C.value.agentEmployeeName,"onUpdate:modelValue":l[4]||(l[4]=e=>C.value.agentEmployeeName=e),"fetch-suggestions":O,placeholder:"è¼¸å…¥å¾Œè«‹é¸æ“‡æ­£ç¢ºçš„è·å‹™ä»£ç†äººå§“å",onSelect:z,style:{width:"100%","font-size":"1.2rem"},clearable:"","trigger-on-focus":!1,disabled:F.value},null,8,["modelValue","disabled"])):"WF"===e.mode?((0,u.uX)(),(0,u.Wv)((0,d.R1)(yl),{key:1,employeeId:C.value.agentEmployeeId},null,8,["employeeId"])):(0,u.Q3)("",!0)])),_:1}),(0,u.bF)(i,{label:"è«‹å‡äº‹ç”±",prop:"reason",class:"form-item-responsive"},{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(gt.WK),{type:"textarea",modelValue:C.value.reason,"onUpdate:modelValue":l[5]||(l[5]=e=>C.value.reason=e),placeholder:"è«‹å¡«å¯«è«‹å‡äº‹ç”±",style:{"font-size":"1.2rem"},rows:3,disabled:F.value},null,8,["modelValue","disabled"])])),_:1}),(0,u.bF)(i,{class:"form-item-responsive attachment-item",prop:"attachments"},{label:(0,u.k6)((()=>["create"===e.mode?((0,u.uX)(),(0,u.CE)("div",Rt,[(0,u.bF)(o,{class:"",style:{"font-size":"1.2rem"}},{default:(0,u.k6)((()=>[l[19]||(l[19]=(0,u.eW)(" é™„ä»¶ ")),E.value?((0,u.uX)(),(0,u.CE)("span",Vt,"*")):(0,u.Q3)("",!0),l[20]||(l[20]=(0,u.Lk)("br",null,null,-1))])),_:1}),(0,u.bF)(o,{class:"",style:{"font-size":"1.2rem"}},{default:(0,u.k6)((()=>l[21]||(l[21]=[(0,u.eW)("(åƒ…é™åœ–ç‰‡æª”)")]))),_:1})])):(0,u.Q3)("",!0)])),default:(0,u.k6)((()=>[(0,u.Lk)("div",It,[(0,u.bF)((0,d.R1)(yt.j5),{multiple:"",class:"upload-demo",action:"#","list-type":"picture","on-change":Y,"on-remove":Q,"on-preview":H,"file-list":C.value.attachments,"auto-upload":!1,disabled:F.value,accept:"image/*,application/pdf"},{default:(0,u.k6)((()=>["create"===e.mode?((0,u.uX)(),(0,u.Wv)(b,{key:0,onClick:re},{default:(0,u.k6)((()=>[(0,u.bF)(v,null,{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.Plus))])),_:1})])),_:1})):((0,u.uX)(),(0,u.Wv)(b,{key:1,disabled:F.value},{default:(0,u.k6)((()=>[(0,u.bF)(v,null,{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.Plus))])),_:1})])),_:1},8,["disabled"]))])),_:1},8,["file-list","disabled"])]),(0,u.bF)((0,d.R1)(ft.kZ),{modelValue:j.value,"onUpdate:modelValue":l[6]||(l[6]=e=>j.value=e),"close-on-click-modal":!0,"show-close":!0},{default:(0,u.k6)((()=>[(0,u.Lk)("img",{src:B.value,alt:"Preview",class:"preview-img"},null,8,xt)])),_:1},8,["modelValue"]),(0,u.Lk)("input",{type:"file",ref_key:"cameraInputRef",ref:k,accept:"image/*,application/pdf",capture:"camera",style:{display:"none"},onChange:q},null,544),(0,u.Lk)("input",{type:"file",ref_key:"galleryInputRef",ref:_,accept:"image/*,application/pdf",style:{display:"none"},onChange:q},null,544),(0,u.bF)((0,d.R1)(ft.kZ),{modelValue:ae.value,"onUpdate:modelValue":l[7]||(l[7]=e=>ae.value=e),title:"æŽƒæ QR Code","close-on-click-modal":!1,"show-close":!0,onClose:ue,width:"80%",top:"5vh"},{default:(0,u.k6)((()=>l[22]||(l[22]=[(0,u.Lk)("div",{id:"qr-code-reader",style:{width:"100%"}},null,-1)]))),_:1},8,["modelValue"])])),_:1}),(0,u.Q3)("",!0),"create"===e.mode?((0,u.uX)(),(0,u.Wv)(i,{key:1},{default:(0,u.k6)((()=>[(0,u.bF)(b,{type:"success",onClick:l[13]||(l[13]=e=>M(c.value)),disabled:F.value},{default:(0,u.k6)((()=>l[28]||(l[28]=[(0,u.eW)(" ç¢ºèª ")]))),_:1},8,["disabled"]),(0,u.bF)(b,{onClick:l[14]||(l[14]=e=>P(c.value)),disabled:F.value},{default:(0,u.k6)((()=>l[29]||(l[29]=[(0,u.eW)(" æ¸…ç©º ")]))),_:1},8,["disabled"])])),_:1})):(0,u.Q3)("",!0)])),_:1},8,["style","model","rules"])])),_:1},8,["locale"])])]),"create"===e.mode?((0,u.uX)(),(0,u.CE)("div",Et,[l[33]||(l[33]=(0,u.Lk)("div",{class:"leave-info-header"},[(0,u.Lk)("h3",null,"å‡åˆ¥èªªæ˜Ž")],-1)),(0,u.bF)(h,{modelValue:te.value,"onUpdate:modelValue":l[15]||(l[15]=e=>te.value=e),accordion:"",class:"leave-info-collapse"},{default:(0,u.k6)((()=>[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(oe.value,((e,a)=>(0,u.bo)(((0,u.uX)(),(0,u.Wv)(f,{key:a,title:e.title,name:a},{default:(0,u.k6)((()=>[(0,u.Lk)("div",At,[(0,u.Lk)("div",Tt,[l[30]||(l[30]=(0,u.Lk)("span",{class:"info-label"},"çµ¦å‡è¦å®šï¼š",-1)),(0,u.Lk)("span",Wt,(0,L.v_)(e.regulation),1)]),(0,u.Lk)("div",St,[l[31]||(l[31]=(0,u.Lk)("span",{class:"info-label"},"å·¥è³‡ï¼š",-1)),(0,u.Lk)("span",Ut,(0,L.v_)(e.salary),1)]),(0,u.Lk)("div",$t,[l[32]||(l[32]=(0,u.Lk)("span",{class:"info-label"},"æ³•ä»¤ä¾æ“šï¼š",-1)),(0,u.Lk)("span",Nt,(0,L.v_)(e.legal),1)])])])),_:2},1032,["title","name"])),[[t.aG,"AnnualLeave"!==a]]))),128))])),_:1},8,["modelValue"])])):(0,u.Q3)("",!0)])],2)}}};const Kt=(0,ie.A)(Xt,[["__scopeId","data-v-26009c44"]]);var Mt=Kt;async function Pt(e,a){const l=fl();await l.fetchDepartmentData();const t=l.departments.find((e=>e.id===a));let o=(0,d.KR)(""),n=(0,d.KR)("");if(!t)return n.value="",o.value="",{supervisorId:o.value,supervisorName:n.value};if("TW0005"===e)return o.value="vincent",n.value="æœ±æ–‡æ¾",{supervisorId:o.value,supervisorName:n.value};let r=t.manager_id?.trim()||"";if(r===e){let a=t.p_dpt_id;while(a&&"-1"!==a){const t=l.departments.find((e=>e.id===a));if(!t)break;const o=t.manager_id?.trim();if(o&&o!==e){r=o;break}a=t.p_dpt_id}}return o.value=r,n.value=r?await lt.getEmployeeName(r):"",{supervisorId:o.value,supervisorName:n.value}}var Ot=l(82006),zt=l(58165),Bt=l(80047),jt=l(24521);const Yt={class:"container"},Qt={class:"item1"},Ht={class:"applier-info-fields"},qt={key:0},Jt={key:1,style:{"font-size":"1.2rem","font-weight":"bold"}},Gt={key:0},Zt={key:1,style:{"font-size":"1.2rem","font-weight":"bold",width:"11rem"}},eo={class:"overtime-personnel-header"},ao={style:{"font-weight":"bold","font-size":"1rem","background-color":"darkseagreen",padding:"0.3rem 1rem 0.5rem 1rem","text-align":"center","border-radius":"10px 100px / 120px"}},lo={key:0,class:"overtime-personnel-fields-wf"},to={class:"personnel-name-row"},oo={style:{display:"flex","align-items":"center",gap:"1rem"}},no={key:0,style:{"font-size":"1.5rem","font-weight":"bold","background-color":"antiquewhite",width:"8rem"}},ro={class:"fields-grid"},so={class:"grid-row"},uo={key:0,class:"readonly-datetime"},io={key:0,class:"readonly-datetime"},co={class:"grid-row"},po={key:0,class:"readonly-content"},mo={key:1},vo=["onDblclick"],bo=["onDblclick"],go={class:"grid-row"},yo={key:0,class:"readonly-content"},fo={key:0,class:"readonly-content"},ho={class:"grid-row"},ko={key:0,class:"readonly-amount"},_o={key:0,class:"readonly-amount"},wo={key:0},Fo=["onDblclick"],Co={style:{width:"15rem"}},Do={key:0},Lo=["onDblclick"],Ro={class:"button-group"},Vo={key:1,class:"submit-btn-group"};var Io={__name:"OvertimeRequestForm",props:{mode:{type:String,default:"create"},WF_Form_Data:{type:Object,default:()=>({})},WF_canEdit:{type:Boolean,default:!1},canAmend:{type:Boolean,default:!1},layout:{type:Boolean,default:!1},isShowActualField:{type:Boolean,default:!1}},emits:["form-submitted","form-reset"],setup(e,{expose:a,emit:l}){const o=l,n=(0,S.k)(),r=(0,i.n)(),s=vl(),c=(0,d.KR)(null),p=(0,d.KR)(),m=(0,d.KR)(),v=(0,d.KR)([]),{width:b}=(0,Ql.lWr)(),g=(0,d.KR)(0),y=e,f=(0,u.EW)((()=>"WF"===y.mode)),h=(0,u.EW)((()=>"WF"===y.mode&&!y.WF_canEdit)),k=(0,u.EW)((()=>"WF"===y.mode&&!y.canAmend)),_=(0,u.EW)((()=>b.value<=768?{width:"80%",maxWidth:"100%",margin:"1rem auto",padding:"0rem"}:f.value?{width:"35rem",maxWidth:"35rem",margin:"1rem auto",padding:"0rem"}:{width:"105%",maxWidth:"105%",margin:"3rem",padding:"1rem 1rem"})),w=(0,d.KR)(""),F=(0,d.KR)(""),C=(0,d.KR)(""),R=(0,d.KR)(""),V=()=>{const e=new Date,a=new Date(e);a.setHours(8,30,0,0);const l=new Date(e);return l.setHours(17,30,0,0),{id:Date.now()+Math.random(),personnelId:"",personnelName:"",overtimeDateTimeRange:[a,l],overtimeContent:"",mealAllowance:0,isEditingOvertimeHours:!1,manualOvertimeMinutes:null,actualOvertimeDate:null,actualOvertimeDateTimeRange:[],actualOvertimeHours:0,actualOvertimeMinutes:0,actualOvertimeContent:"",actualMealAllowance:0,actualStartTime:"",actualEndTime:"",isEditingActualOvertimeHours:!1,manualActualOvertimeMinutes:0}},I=(0,d.KR)({isPreOvertime:!0,insertSignerList:[],overtimePersonnel:[V()],actualOvertimeDate:null,actualOvertimeDateTimeRange:[],actualOvertimeHours:0,actualOvertimeMinutes:0,actualOvertimeContent:"",applicantTitleId:"",applierName:""}),x=((0,d.KR)(!1),e=>{if(!e)return null;if(e instanceof Date)return isNaN(e.getTime())?null:e;if("string"===typeof e){const a=e.includes("T")?e:e.replace(" ","T"),l=new Date(a);return isNaN(l.getTime())?null:l}return null}),E=e=>String(e).padStart(2,"0"),A=e=>{const a=x(e);if(!a)return null;const l=a.getFullYear(),t=E(a.getMonth()+1),o=E(a.getDate());return`${l}-${t}-${o}`},T=e=>{const a=new Date(e);if(isNaN(a))return null;const l=e=>String(e).padStart(2,"0"),t=a.getFullYear(),o=l(a.getMonth()+1),n=l(a.getDate()),r=l(a.getHours()),s=l(a.getMinutes());return`${t}-${o}-${n} ${r}:${s}`},W=e=>{const a=x(e);return a?`${E(a.getHours())}:${E(a.getMinutes())}`:null},U=(0,u.EW)((()=>{const e=f.value&&!y.canAmend,a=I.value.overtimePersonnel.reduce(((a,l,t)=>(a[`overtimePersonnel.${t}.personnelName`]=[{required:!e,message:"è«‹é¸æ“‡åŠ ç­äººå“¡",trigger:"change"}],a[`overtimePersonnel.${t}.overtimeDateTimeRange`]=[{required:!e,validator:(a,l,o)=>{if(e)return o();const n=I.value.overtimePersonnel[t];if(!n.overtimeDateTimeRange||2!==n.overtimeDateTimeRange.length||!n.overtimeDateTimeRange[0]||!n.overtimeDateTimeRange[1])return o(new Error("è«‹é¸æ“‡åŠ ç­æ—¥/æ™‚é–“å€é–“"));o()},trigger:"change"}],a[`overtimePersonnel.${t}.overtimeContent`]=[{required:!e,message:"è«‹å¡«å¯«åŠ ç­å…§å®¹",trigger:"blur"}],a[`overtimePersonnel.${t}.mealAllowance`]=[{validator:(e,a,l)=>null===a||void 0===a||""===a?l():isNaN(a)||a<0?l(new Error("é¤è²»ç”³è«‹å¿…é ˆæ˜¯æ•¸å­—ä¸”ä¸èƒ½ç‚ºè² å€¼")):void l(),trigger:"blur"}],a[`overtimePersonnel.${t}.manualOvertimeMinutes`]=[{validator:(e,a,l)=>{const o=I.value.overtimePersonnel[t];return!o.isEditingOvertimeHours||null!==a&&void 0!==a&&""!==a?o.isEditingOvertimeHours&&(isNaN(a)||a<0)?l(new Error("é è¨ˆåŠ ç­æ™‚æ•¸å¿…é ˆæ˜¯æ•¸å­—ä¸”ä¸èƒ½ç‚ºè² å€¼")):void l():l(new Error("è«‹è¼¸å…¥é è¨ˆåŠ ç­æ™‚æ•¸"))},trigger:"blur"}],!1===I.value.isPreOvertime&&(a[`overtimePersonnel.${t}.actualOvertimeDateTimeRange`]=[{required:!e,validator:(a,l,o)=>{if(e)return o();const n=I.value.overtimePersonnel[t];if(!n.actualOvertimeDateTimeRange||2!==n.actualOvertimeDateTimeRange.length||!n.actualOvertimeDateTimeRange[0]||!n.actualOvertimeDateTimeRange[1])return o(new Error("è«‹é¸æ“‡å¯¦éš›åŠ ç­æ—¥/æ™‚é–“å€é–“"));o()},trigger:"change"}],a[`overtimePersonnel.${t}.actualOvertimeContent`]=[{required:!e,message:"è«‹å¡«å¯«å¯¦éš›åŠ ç­å…§å®¹",trigger:"blur"}]),a)),{}),l={isPreOvertime:[{required:!e,message:"è«‹é¸æ“‡æ˜¯å¦ç‚ºé åŠ ç­",trigger:"change"}],...a};return!1===I.value.isPreOvertime?{...l,actualOvertime:[{required:!e,message:"è«‹è¼¸å…¥å¯¦éš›åŠ ç­å…§å®¹",trigger:"blur"}],actualOvertimeDate:[{required:!e,message:"è«‹é¸æ“‡å¯¦éš›åŠ ç­æ—¥æœŸ",trigger:"change"}],actualOvertimeTimeRange:[{required:!e,validator:(a,l,t)=>e?t():C.value&&R.value?void t():t(new Error("è«‹é¸æ“‡å¯¦éš›åŠ ç­æ™‚é–“å€é–“")),trigger:"change"}],actualOvertimeContent:[{required:!e,message:"è«‹å¡«å¯«å¯¦éš›åŠ ç­å…§å®¹",trigger:"blur"}]}:l})),$=e=>{const a=e.overtimeDateTimeRange;if(!a||2!==a.length||!a[0]||!a[1])return 0;const l=new Date(a[0]),t=new Date(a[1]);if(isNaN(l)||isNaN(t)||t<=l)return 0;let o=(t-l)/6e4;if(l.toDateString()===t.toDateString()){const e=new Date(l.getFullYear(),l.getMonth(),l.getDate(),12,0,0),a=new Date(l.getFullYear(),l.getMonth(),l.getDate(),13,0,0),n=Math.max(0,Math.min(t.getTime(),a.getTime())-Math.max(l.getTime(),e.getTime())),r=Math.floor(n/6e4);o-=r}return Math.max(0,Math.floor(o))},N=e=>{let a;a=null===e.manualOvertimeMinutes||void 0===e.manualOvertimeMinutes||e.isEditingOvertimeHours?$(e):e.manualOvertimeMinutes;const l=Math.floor(a/60),t=a%60;return`${l} å°æ™‚ ${t} åˆ†`},X=e=>{const a=e.actualOvertimeDateTimeRange;if(!a||2!==a.length||!a[0]||!a[1])return 0;const l=new Date(a[0]),t=new Date(a[1]);if(isNaN(l)||isNaN(t)||t<=l)return 0;let o=(t-l)/6e4;if(l.toDateString()===t.toDateString()){const e=new Date(l.getFullYear(),l.getMonth(),l.getDate(),12,0,0),a=new Date(l.getFullYear(),l.getMonth(),l.getDate(),13,0,0),n=Math.max(0,Math.min(t.getTime(),a.getTime())-Math.max(l.getTime(),e.getTime())),r=Math.floor(n/6e4);o-=r}return Math.max(0,Math.floor(o))},K=e=>{const a=e.isEditingActualOvertimeHours?e.manualActualOvertimeMinutes:X(e),l=Math.floor(a/60),t=a%60;return`${l} å°æ™‚ ${t} åˆ†`},M=e=>{if(!e||!Array.isArray(e)||2!==e.length)return"æœªè¨­å®š";const[a,l]=e;if(!a||!l)return"æœªè¨­å®š";const t=e=>{const a=new Date(e);if(isNaN(a.getTime()))return"";const l=a.getFullYear(),t=String(a.getMonth()+1).padStart(2,"0"),o=String(a.getDate()).padStart(2,"0"),n=String(a.getHours()).padStart(2,"0"),r=String(a.getMinutes()).padStart(2,"0");return`${l}/${t}/${o} ${n}:${r}`};return`${t(a)} - ${t(l)}`},P=e=>{if(null===e||void 0===e||""===e)return"NT$ 0";const a=Number(e);return isNaN(a)?"NT$ 0":`NT$ ${a.toLocaleString()}`},O=e=>{e.isEditingOvertimeHours=!0,null!==e.manualOvertimeMinutes&&void 0!==e.manualOvertimeMinutes||(e.manualOvertimeMinutes=$(e)),(0,u.dY)((()=>{}))},z=e=>{e.isEditingOvertimeHours=!1},B=e=>{e.isEditingOvertimeHours||(e.manualOvertimeMinutes=$(e))},j=e=>{e.isEditingActualOvertimeHours||(e.manualActualOvertimeMinutes=X(e))};(0,u.wB)((()=>I.value.overtimePersonnel),(()=>{}),{deep:!0,immediate:!0}),(0,u.wB)([()=>I.value.actualOvertimeDate,C,R],(([e,a,l])=>{if(e&&a&&l){const t=new Date(`${e.toISOString().split("T")[0]}T${a}`),o=new Date(`${e.toISOString().split("T")[0]}T${l}`);I.value.actualOvertimeDateTimeRange=[t,o]}else I.value.actualOvertimeDateTimeRange=[]}),{immediate:!0});const Y=(e,a)=>{const l=v.value.filter((a=>a.name.includes(e))).map((e=>({value:e.name,raw:e})));a(l)},Q=(e,a)=>{I.value.overtimePersonnel[a].personnelName=e.value,I.value.overtimePersonnel[a].personnelId=e.raw.id},H=async()=>{await s.fetchEmployeeData();const e=s.employees.filter((e=>"Inactive"!==e.emp_status&&"mis"!==e.id&&"vincent"!==e.id));v.value=e},q=()=>{I.value.overtimePersonnel.push(V())},G=e=>{I.value.overtimePersonnel.length>1?I.value.overtimePersonnel.splice(e,1):D.nk.warning("è‡³å°‘éœ€è¦ä¸€ä½åŠ ç­äººå“¡ã€‚")},Z=e=>{e.isEditingActualOvertimeHours=!0,e.manualActualOvertimeMinutes=X(e),(0,u.dY)((()=>{}))},ee=e=>{e.isEditingActualOvertimeHours=!1},ae=()=>{console.log("ðŸ”„ é–‹å§‹è¤‡è£½é è¨ˆåŠ ç­è³‡æ–™åˆ°å¯¦éš›åŠ ç­è³‡æ–™"),console.log("ðŸ“Š ç•¶å‰è¡¨å–®æ•¸æ“š:",I.value.overtimePersonnel),I.value.overtimePersonnel.forEach(((e,a)=>{if(console.log(`ðŸ‘¤ è™•ç†äººå“¡ ${a+1}: ${e.personnelName}`),console.log("ðŸ“… åŽŸå§‹é è¨ˆæ™‚æ®µ:",e.overtimeDateTimeRange),console.log("ðŸ“… åŽŸå§‹å¯¦éš›æ™‚æ®µ:",e.actualOvertimeDateTimeRange),2===e.overtimeDateTimeRange?.length){const a=e.overtimeDateTimeRange.map(T);e.actualOvertimeDateTimeRange=[...a]}void 0!==e.manualOvertimeMinutes&&null!==e.manualOvertimeMinutes&&(e.manualActualOvertimeMinutes=e.manualOvertimeMinutes,console.log(`âœ… è¤‡è£½åŠ ç­æ™‚æ•¸: ${e.manualOvertimeMinutes} åˆ†é˜`)),e.overtimeContent&&(e.actualOvertimeContent=e.overtimeContent,console.log(`âœ… è¤‡è£½åŠ ç­å…§å®¹: ${e.overtimeContent}`)),void 0!==e.mealAllowance&&null!==e.mealAllowance&&(e.actualMealAllowance=e.mealAllowance,console.log(`âœ… è¤‡è£½é¤è²»: ${e.mealAllowance}`))})),console.log("âœ… è¤‡è£½å®Œæˆï¼Œæœ€çµ‚æ•¸æ“š:",I.value.overtimePersonnel),(0,u.dY)((()=>{console.log("ðŸ”„ å¼·åˆ¶é‡æ–°æ¸²æŸ“å¾Œçš„æ•¸æ“š:",I.value.overtimePersonnel),c.value&&c.value.validate((()=>{}))}))},le=async e=>{e.validate((async(a,l)=>{if(!a){const e={isPreOvertime:"æ˜¯å¦ç‚ºé åŠ ç­",actualOvertime:"å¯¦éš›åŠ ç­",actualOvertimeDate:"å¯¦éš›åŠ ç­æ—¥æœŸ",actualOvertimeTimeRange:"å¯¦éš›åŠ ç­æ™‚é–“",actualOvertimeContent:"å¯¦éš›åŠ ç­å…§å®¹",remark:"å‚™è¨»"};for(const n in l)if(n.startsWith("overtimePersonnel.")){const e=n.split("."),a=parseInt(e[1]),t=e[2],o={personnelName:"åŠ ç­äººå“¡",overtimeDate:"åŠ ç­æ—¥æœŸ",overtimeTimeRange:"åŠ ç­æ™‚é–“",overtimeContent:"åŠ ç­å…§å®¹",mealAllowance:"é¤è²»ç”³è«‹",actualOvertime:"å¯¦éš›åŠ ç­",actualOvertimeDateTimeRange:"å¯¦éš›åŠ ç­æ™‚æ®µ",actualOvertimeContent:"å¯¦éš›åŠ ç­å…§å®¹"},r=o[t]||t;return D.nk.error(`åŠ ç­äººå“¡ ${a+1} çš„ã€Œ${r}ã€éŒ¯èª¤ï¼š${l[n][0].message}`),!1}const a=Object.keys(l)[0],t=l[a][0].message,o=e[a]||a;return D.nk.error(`æ¬„ä½ã€Œ${o}ã€éŒ¯èª¤ï¼š${t}`),!1}ae();const t={applierName:n.userName,isPreOvertime:I.value.isPreOvertime,supervisorId:p.value,supervisorName:m.value,overtimePersonnel:I.value.overtimePersonnel.map((e=>{const a=(e.overtimeDateTimeRange||[]).map((e=>T(e)));return{personnelId:e.personnelId,personnelName:e.personnelName,overtimeDateTimeRange:a,overtimeHours:Math.floor(e.manualOvertimeMinutes/60),overtimeMinutes:e.manualOvertimeMinutes%60,overtimeContent:e.overtimeContent,mealAllowance:e.mealAllowance,actualOvertime:e.actualOvertime,actualOvertimeDate:A(e.actualOvertimeDateTimeRange?.[0]),actualOvertimeStartTime:W(e.actualOvertimeDateTimeRange?.[0]),actualOvertimeEndTime:W(e.actualOvertimeDateTimeRange?.[1]),actualOvertimeHours:e.isEditingActualOvertimeHours?Math.floor(e.manualActualOvertimeMinutes/60):Math.floor(X(e)/60),actualOvertimeMinutes:e.isEditingActualOvertimeHours?e.manualActualOvertimeMinutes%60:X(e)%60,actualOvertimeContent:e.actualOvertimeContent,actualMealAllowance:e.actualMealAllowance}}))};let r=`è«‹ç¢ºèªä»¥ä¸‹è³‡æ–™æ˜¯å¦æ­£ç¢ºï¼š<br/>è·å‹™/åœ°å€ï¼š${w.value} / ${F.value}<br/>éƒ¨é–€ï¼š${n.userDeptName}<br/>æ˜¯å¦ç‚ºé åŠ ç­ï¼š${t.isPreOvertime?"æ˜¯":"å¦"}<br/>`;t.overtimePersonnel.forEach(((e,a)=>{r+=`<br/>åŠ ç­äººå“¡ ${a+1}ï¼š<br/>äººå“¡å§“åï¼š${e.personnelName||"æœªå¡«å¯«"}<br/>é è¨ˆåŠ ç­æ™‚æ•¸ï¼š${N(I.value.overtimePersonnel[a])}<br/>åŠ ç­å…§å®¹ï¼š${e.overtimeContent||"æœªå¡«å¯«"}<br/>é¤è²»ç”³è«‹ï¼šNT$${e.mealAllowance||0}<br/>`,!1===t.isPreOvertime&&(r+=`å¯¦éš›åŠ ç­ï¼š${e.actualOvertime||"æœªå¡«å¯«"}<br/>å¯¦éš›åŠ ç­æ™‚æ®µï¼š${e.actualOvertimeStartTime||"æœªå¡«å¯«"} è‡³ ${e.actualOvertimeEndTime||"æœªå¡«å¯«"}<br/>å¯¦éš›åŠ ç­æ™‚æ•¸ï¼š${K(I.value.overtimePersonnel[a])}<br/>å¯¦éš›åŠ ç­å…§å®¹ï¼š${e.actualOvertimeContent||"æœªå¡«å¯«"}<br/>å¯¦éš›é¤è²»ï¼šNT$${e.actualMealAllowance||0}<br/>`)})),Sa.s.confirm(r,"ç¢ºèªå¡«å¯«å…§å®¹",{confirmButtonText:"ç¢ºèª",cancelButtonText:"å–æ¶ˆ",dangerouslyUseHTMLString:!0}).then((async()=>{const a=new FormData;a.append("DocumentTypeID","OR"),a.append("CreatorID",n.userId);const l=I.value.insertSignerList?.map((e=>e.id))||[];a.append("InsertSignerIds",JSON.stringify(l)),a.append("CreatorSupervisorID",p.value||""),a.append("FormData",JSON.stringify(t));try{const l=await pl.createForm(a);oe(e),D.nk.success("æäº¤åŠ ç­å–®æˆåŠŸ!"),o("form-submitted",l.data.documentID)}catch(r){console.error("æäº¤åŠ ç­å–®å¤±æ•—:",r),D.nk.error("æäº¤åŠ ç­å–®å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦!")}})).catch((()=>{D.nk.info("å·²å–æ¶ˆæäº¤ã€‚")}))}))},te=async()=>{console.log("ðŸš€ SaveAndApprovalForm é–‹å§‹åŸ·è¡Œ");try{console.log("ðŸ“ é–‹å§‹è¡¨å–®é©—è­‰...");const e=await new Promise((e=>{c.value.validate((a=>{console.log("ðŸ“ è¡¨å–®é©—è­‰çµæžœ:",a),e(a)}))}));if(!e)return console.error("âŒ è¡¨å–®é©—è­‰å¤±æ•—"),D.nk.error("è¡¨å–®é©—è­‰å¤±æ•—ï¼Œè«‹æª¢æŸ¥å¡«å¯«å…§å®¹"),!1;console.log("âœ… è¡¨å–®é©—è­‰é€šéŽï¼Œæº–å‚™è¤‡è£½è³‡æ–™...");const a={approverID:n.userId,formData:JSON.stringify(se())};return await pl.SaveAndApproval(y.WF_Form_Data.id,a),D.nk.success("è¡¨å–®å„²å­˜ä¸¦æ ¸å‡†æˆåŠŸ"),!0}catch(e){return console.error("å„²å­˜ä¸¦æäº¤å¤±æ•—:",e),D.nk.error("å„²å­˜ä¸¦æäº¤å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦"),!1}},oe=e=>{e.resetFields(),I.value.isPreOvertime=!0,I.value.overtimePersonnel=[V()]},ne=(0,d.KR)(""),re=e=>{if(e&&Object.keys(e).length>0){I.value.documentId=e.documentId||"",I.value.isPreOvertime=e.isPreOvertime,I.value.applicantTitleId=e.applicantTitleId||"",I.value.applierName=e.applierName||"";let l=[];if(e.overtimePersonnel)try{"string"===typeof e.overtimePersonnel?l=JSON.parse(e.overtimePersonnel):Array.isArray(e.overtimePersonnel)&&(l=e.overtimePersonnel),Array.isArray(l)&&l.length>0?I.value.overtimePersonnel=l.map((e=>{const a=e=>{if(!e)return null;const a=e.replace(" ","T")+":00",l=new Date(a);return isNaN(l.getTime())?null:l};return{id:e.id||Date.now()+Math.random(),personnelId:e.personnelId||"",personnelName:e.personnelName||"",overtimeDateTimeRange:e.overtimeDateTimeRange?e.overtimeDateTimeRange.map(a).filter((e=>null!==e)):[],overtimeContent:e.overtimeContent||"",mealAllowance:e.mealAllowance||0,isEditingOvertimeHours:!1,manualOvertimeMinutes:60*e.overtimeHours+(e.overtimeMinutes||0),actualOvertime:e.actualOvertime||"",actualOvertimeDateTimeRange:e.actualOvertimeDate&&e.actualOvertimeStartTime&&e.actualOvertimeEndTime?[new Date(`${e.actualOvertimeDate}T${e.actualOvertimeStartTime}:00`),new Date(`${e.actualOvertimeDate}T${e.actualOvertimeEndTime}:00`)].filter((e=>!isNaN(e.getTime()))):[],actualOvertimeHours:e.actualOvertimeHours||0,actualOvertimeMinutes:e.actualOvertimeMinutes||0,actualOvertimeContent:e.actualOvertimeContent||"",actualMealAllowance:e.actualMealAllowance||0,isEditingActualOvertimeHours:!1,manualActualOvertimeMinutes:60*(e.actualOvertimeHours||0)+(e.actualOvertimeMinutes||0)}})):I.value.overtimePersonnel=[V()]}catch(a){console.error("Error parsing overtimePersonnel:",a),I.value.overtimePersonnel=[V()]}else I.value.overtimePersonnel=[V()];e.titleName&&(w.value=e.titleName),e.applierDptName&&(ne.value=e.applierDptName),e.applierAreaName&&(F.value=e.applierAreaName),m.value=e.supervisorName||"",(0,u.dY)((()=>{console.log("After nextTick - overtimeForm.overtimePersonnel:",JSON.stringify(I.value.overtimePersonnel,((e,a)=>a instanceof Date?a.toISOString():a))),c.value?.validateField("overtimePersonnel")}))}};function se(){return{documentId:I.value.documentId,isPreOvertime:I.value.isPreOvertime,overtimePersonnel:I.value.overtimePersonnel.map((e=>({personnelId:e.personnelId,personnelName:e.personnelName,overtimeDateTimeRange:(e.overtimeDateTimeRange||[]).map((e=>T(e))),overtimeHours:Math.floor(e.manualOvertimeMinutes/60),overtimeMinutes:e.manualOvertimeMinutes%60,overtimeContent:e.overtimeContent,mealAllowance:e.mealAllowance,actualOvertime:e.actualOvertime,actualOvertimeDate:A(e.actualOvertimeDateTimeRange?.[0]),actualOvertimeStartTime:W(e.actualOvertimeDateTimeRange?.[0]),actualOvertimeEndTime:W(e.actualOvertimeDateTimeRange?.[1]),actualOvertimeHours:e.isEditingActualOvertimeHours?Math.floor(e.manualActualOvertimeMinutes/60):Math.floor(X(e)/60),actualOvertimeMinutes:e.isEditingActualOvertimeHours?e.manualActualOvertimeMinutes%60:X(e)%60,actualOvertimeContent:e.actualOvertimeContent,actualMealAllowance:e.actualMealAllowance})))}}return(0,u.wB)((()=>y.WF_Form_Data),(e=>{re(e),y.canAmend&&(0,u.dY)((()=>ae()))}),{immediate:!0}),(0,u.sV)((async()=>{if(await H(),"create"===y.mode){w.value=r.user.titleName;const e=r.user.areaInfo.id;F.value=await lt.getAreaName(e||"");const{supervisorId:a,supervisorName:l}=await Pt(n.userId,n.userDeptId);p.value=a,m.value=l}else"WF"===y.mode&&re(y.WF_Form_Data);C.value="08:30",R.value="17:30"})),a({titleName:w,areaName:F,overtimeFormRef:c,getResubmitData:se,SaveAndApprovalForm:te}),(a,l)=>{const o=(0,u.g2)("el-text");(0,u.g2)("el-icon"),(0,u.g2)("el-tag"),(0,u.g2)("el-alert"),(0,u.g2)("el-dialog");return(0,u.uX)(),(0,u.CE)("div",Yt,[(0,u.Lk)("div",Qt,[(0,u.bF)((0,d.R1)(bt.H6),{locale:(0,d.R1)(ht.A)},{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(Ot.US),{ref_key:"overtimeFormRef",ref:c,class:"workflow-form invoice",style:(0,L.Tr)(_.value),model:I.value,rules:U.value,"label-width":"9rem","status-icon":"","label-position":"left"},{default:(0,u.k6)((()=>[(0,u.Lk)("div",Ht,[(0,u.bF)((0,d.R1)(Ot.xE),{"label-position":"center",label:"ç”³è«‹äººè·å‹™/åœ°å€",class:(0,L.C4)({"form-item-responsive":!f.value,"form-item-vertical":f.value})},{default:(0,u.k6)((()=>["create"===e.mode?((0,u.uX)(),(0,u.CE)("span",qt,(0,L.v_)(w.value)+" / "+(0,L.v_)(F.value),1)):"WF"===e.mode?((0,u.uX)(),(0,u.CE)("span",Jt,(0,L.v_)(w.value)+" / "+(0,L.v_)(F.value),1)):(0,u.Q3)("",!0)])),_:1},8,["class"]),(0,u.bF)((0,d.R1)(Ot.xE),{"label-position":"center",label:"ç”³è«‹äººéƒ¨é–€",class:(0,L.C4)({"form-item-responsive":!f.value,"form-item-vertical":f.value})},{default:(0,u.k6)((()=>["create"===e.mode?((0,u.uX)(),(0,u.CE)("span",Gt,(0,L.v_)((0,d.R1)(n).userDeptName),1)):"WF"===e.mode?((0,u.uX)(),(0,u.CE)("span",Zt,(0,L.v_)(ne.value),1)):(0,u.Q3)("",!0)])),_:1},8,["class"])]),((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(I.value.overtimePersonnel,((a,n)=>((0,u.uX)(),(0,u.CE)("div",{key:n,class:"overtime-personnel-block"},[(0,u.Lk)("div",eo,["create"===e.mode?((0,u.uX)(),(0,u.Wv)((0,d.R1)(zt.fR),{key:0,"content-position":"left"},{default:(0,u.k6)((()=>[I.value.overtimePersonnel.length>1?((0,u.uX)(),(0,u.Wv)((0,d.R1)(Bt.S2),{key:0,style:{"margin-right":"0.5rem"},size:"small",type:"danger",icon:(0,d.R1)(J.Minus),circle:"",onClick:e=>G(n)},null,8,["icon","onClick"])):(0,u.Q3)("",!0),(0,u.Lk)("span",ao,"åŠ ç­äººå“¡ "+(0,L.v_)(a.personnelName||n+1),1),y.canAmend?((0,u.uX)(),(0,u.Wv)((0,d.R1)(Bt.S2),{key:1,style:{"margin-left":"1rem"},size:"small",type:"primary",onClick:ae,title:"å°‡é è¨ˆåŠ ç­è³‡æ–™è¤‡è£½åˆ°å¯¦éš›åŠ ç­è³‡æ–™"},{default:(0,u.k6)((()=>l[7]||(l[7]=[(0,u.eW)(" å¸¶å…¥å¯¦éš›åŠ ç­è³‡æ–™ ")]))),_:1})):(0,u.Q3)("",!0)])),_:2},1024)):(0,u.Q3)("",!0)]),f.value?((0,u.uX)(),(0,u.CE)("div",lo,[(0,u.Lk)("div",to,[(0,u.bF)((0,d.R1)(Ot.xE),{label:"åŠ ç­äººå“¡",prop:`overtimePersonnel.${n}.personnelName`,"label-width":"6rem",class:"personnel-name-item"},{default:(0,u.k6)((()=>[(0,u.Lk)("div",oo,[y.WF_canEdit?((0,u.uX)(),(0,u.Wv)((0,d.R1)(tt.s9),{key:1,modelValue:a.personnelName,"onUpdate:modelValue":e=>a.personnelName=e,"fetch-suggestions":Y,placeholder:"è«‹è¼¸å…¥å§“å",onSelect:e=>Q(e,n),clearable:"","trigger-on-focus":!1,disabled:h.value,style:{width:"12rem"}},null,8,["modelValue","onUpdate:modelValue","onSelect","disabled"])):((0,u.uX)(),(0,u.CE)("span",no,(0,L.v_)(a.personnelName||`äººå“¡ ${n+1}`),1)),y.WF_canEdit&&I.value.overtimePersonnel.length>1?((0,u.uX)(),(0,u.Wv)((0,d.R1)(Bt.S2),{key:2,size:"small",type:"danger",icon:(0,d.R1)(J.Minus),circle:"",onClick:e=>G(n),title:"åˆªé™¤æ­¤äººå“¡"},null,8,["icon","onClick"])):(0,u.Q3)("",!0),y.canAmend?((0,u.uX)(),(0,u.Wv)((0,d.R1)(Bt.S2),{key:3,size:"small",type:"primary",onClick:ae,title:"å°‡é è¨ˆåŠ ç­è³‡æ–™è¤‡è£½åˆ°å¯¦éš›åŠ ç­è³‡æ–™"},{default:(0,u.k6)((()=>l[8]||(l[8]=[(0,u.eW)(" å¸¶å…¥å¯¦éš›åŠ ç­è³‡æ–™ ")]))),_:1})):(0,u.Q3)("",!0)])])),_:2},1032,["prop"])]),(0,u.Lk)("div",ro,[(0,u.Lk)("div",so,[(0,u.bF)((0,d.R1)(Ot.xE),{label:"é è¨ˆåŠ ç­æ™‚æ®µ",prop:`overtimePersonnel.${n}.overtimeDateTimeRange`,"label-width":"6.5rem",class:"grid-item expected"},{default:(0,u.k6)((()=>[y.WF_canEdit?((0,u.uX)(),(0,u.Wv)((0,d.R1)(jt.MG),{key:1,modelValue:a.overtimeDateTimeRange,"onUpdate:modelValue":e=>a.overtimeDateTimeRange=e,type:"datetimerange","range-separator":"~","start-placeholder":"é–‹å§‹æ™‚é–“","end-placeholder":"çµæŸæ™‚é–“","value-format":f.value?"":"YYYY-MM-DD HH:mm",style:{width:"100%","font-size":"0.5rem"},format:"YYYY/MM/DD HH:mm",onChange:e=>B(a),disabled:h.value},null,8,["modelValue","onUpdate:modelValue","value-format","onChange","disabled"])):((0,u.uX)(),(0,u.CE)("span",uo,(0,L.v_)(M(a.overtimeDateTimeRange)),1))])),_:2},1032,["prop"]),y.isShowActualField?((0,u.uX)(),(0,u.Wv)((0,d.R1)(Ot.xE),{key:0,label:"å¯¦éš›åŠ ç­æ™‚æ®µ","label-width":"6.5rem",prop:`overtimePersonnel.${n}.actualOvertimeDateTimeRange`,"label-class":"actual-label",class:"grid-item expected actual"},{default:(0,u.k6)((()=>[y.canAmend?((0,u.uX)(),(0,u.Wv)((0,d.R1)(jt.MG),{key:`actual-datetime-${n}-${g.value}`,modelValue:a.actualOvertimeDateTimeRange,"onUpdate:modelValue":e=>a.actualOvertimeDateTimeRange=e,type:"datetimerange","range-separator":"è‡³","start-placeholder":"é–‹å§‹æ™‚é–“","end-placeholder":"çµæŸæ™‚é–“","value-format":"YYYY-MM-DD HH:mm",style:{width:"100%"},format:"YYYY/MM/DD HH:mm",onChange:e=>j(a),disabled:k.value,class:"actual-datetime-picker","data-personnel-index":n},null,8,["modelValue","onUpdate:modelValue","onChange","disabled","data-personnel-index"])):((0,u.uX)(),(0,u.CE)("span",io,(0,L.v_)(M(a.actualOvertimeDateTimeRange)),1))])),_:2},1032,["prop"])):(0,u.Q3)("",!0)]),(0,u.Lk)("div",co,[(0,u.bF)((0,d.R1)(Ot.xE),{label:"é è¨ˆåŠ ç­æ™‚æ•¸","label-width":"6.5rem",class:"grid-item expected"},{default:(0,u.k6)((()=>[y.WF_canEdit?a.isEditingOvertimeHours?((0,u.uX)(),(0,u.Wv)((0,d.R1)(gt.WK),{key:2,modelValue:a.manualOvertimeMinutes,"onUpdate:modelValue":e=>a.manualOvertimeMinutes=e,modelModifiers:{number:!0},onBlur:e=>z(a),onKeyup:(0,t.jR)((e=>z(a)),["enter"]),size:"small",disabled:h.value},{append:(0,u.k6)((()=>[(0,u.bF)(o,{style:{"font-size":"1rem"}},{default:(0,u.k6)((()=>l[10]||(l[10]=[(0,u.eW)("åˆ†é˜")]))),_:1})])),_:2},1032,["modelValue","onUpdate:modelValue","onBlur","onKeyup","disabled"])):((0,u.uX)(),(0,u.CE)("div",mo,[(0,u.Lk)("span",{onDblclick:e=>O(a),class:"readonly-content",style:{cursor:"pointer"}},(0,L.v_)(N(a)),41,vo),(0,u.bF)(o,{class:"mx-1",type:"info",style:{"font-size":"0.8rem"}},{default:(0,u.k6)((()=>l[9]||(l[9]=[(0,u.eW)("(é»žæ“Šå…©ä¸‹å¯ç·¨è¼¯)")]))),_:1})])):((0,u.uX)(),(0,u.CE)("div",po,(0,L.v_)(N(a)),1))])),_:2},1024),y.isShowActualField?((0,u.uX)(),(0,u.Wv)((0,d.R1)(Ot.xE),{key:0,"label-width":"6.5rem",label:"å¯¦éš›åŠ ç­æ™‚æ•¸","label-class":"actual-label",class:"grid-item actual expected"},{default:(0,u.k6)((()=>[a.isEditingActualOvertimeHours?((0,u.uX)(),(0,u.Wv)((0,d.R1)(gt.WK),{key:1,modelValue:a.manualActualOvertimeMinutes,"onUpdate:modelValue":e=>a.manualActualOvertimeMinutes=e,modelModifiers:{number:!0},onBlur:e=>ee(a),onKeyup:(0,t.jR)((e=>ee(a)),["enter"]),size:"small",disabled:k.value},{append:(0,u.k6)((()=>[(0,u.bF)(o,{style:{"font-size":"1rem"}},{default:(0,u.k6)((()=>l[11]||(l[11]=[(0,u.eW)("åˆ†é˜")]))),_:1})])),_:2},1032,["modelValue","onUpdate:modelValue","onBlur","onKeyup","disabled"])):((0,u.uX)(),(0,u.CE)("span",{key:0,onDblclick:e=>Z(a),class:"readonly-content"},(0,L.v_)(K(a)),41,bo))])),_:2},1024)):(0,u.Q3)("",!0)]),(0,u.Lk)("div",go,[(0,u.bF)((0,d.R1)(Ot.xE),{label:"åŠ ç­å…§å®¹","label-width":"6.5rem",prop:`overtimePersonnel.${n}.overtimeContent`,class:"grid-item expected"},{default:(0,u.k6)((()=>[y.WF_canEdit?((0,u.uX)(),(0,u.Wv)((0,d.R1)(gt.WK),{key:1,type:"textarea",modelValue:a.overtimeContent,"onUpdate:modelValue":e=>a.overtimeContent=e,placeholder:"è«‹å¡«å¯«åŠ ç­å…§å®¹",rows:2,disabled:h.value},null,8,["modelValue","onUpdate:modelValue","disabled"])):((0,u.uX)(),(0,u.CE)("span",yo,(0,L.v_)(a.overtimeContent||"(æœªå¡«å¯«)"),1))])),_:2},1032,["prop"]),y.isShowActualField?((0,u.uX)(),(0,u.Wv)((0,d.R1)(Ot.xE),{key:0,label:"å¯¦éš›åŠ ç­å…§å®¹","label-width":"6.5rem",prop:`overtimePersonnel.${n}.actualOvertimeContent`,"label-class":"actual-label",class:"grid-item actual expected"},{default:(0,u.k6)((()=>["WF"!==y.mode||y.canAmend?((0,u.uX)(),(0,u.Wv)((0,d.R1)(gt.WK),{key:1,type:"textarea",modelValue:a.actualOvertimeContent,"onUpdate:modelValue":e=>a.actualOvertimeContent=e,placeholder:"è«‹å¡«å¯«å¯¦éš›åŠ ç­å…§å®¹",rows:2,disabled:k.value},null,8,["modelValue","onUpdate:modelValue","disabled"])):((0,u.uX)(),(0,u.CE)("span",fo,(0,L.v_)(a.actualOvertimeContent||"(æœªå¡«å¯«)"),1))])),_:2},1032,["prop"])):(0,u.Q3)("",!0)]),(0,u.Lk)("div",ho,[(0,u.bF)((0,d.R1)(Ot.xE),{label:"é¤è²»ç”³è«‹","label-width":"6.5rem",prop:`overtimePersonnel.${n}.mealAllowance`,class:"grid-item expected"},{default:(0,u.k6)((()=>[y.WF_canEdit?((0,u.uX)(),(0,u.Wv)((0,d.R1)(gt.WK),{key:1,class:"no-spin",type:"number",min:"0",modelValue:a.mealAllowance,"onUpdate:modelValue":e=>a.mealAllowance=e,modelModifiers:{number:!0},placeholder:"è«‹è¼¸å…¥é¤è²»é‡‘é¡",disabled:h.value},{prepend:(0,u.k6)((()=>l[12]||(l[12]=[(0,u.eW)("NT$")]))),_:2},1032,["modelValue","onUpdate:modelValue","disabled"])):((0,u.uX)(),(0,u.CE)("span",ko,(0,L.v_)(P(a.mealAllowance)),1))])),_:2},1032,["prop"]),y.isShowActualField?((0,u.uX)(),(0,u.Wv)((0,d.R1)(Ot.xE),{key:0,"label-width":"6.5rem",label:"å¯¦éš›é¤è²»",prop:`overtimePersonnel.${n}.actualMealAllowance`,"label-class":"actual-label",class:"grid-item actual expected"},{default:(0,u.k6)((()=>["WF"!==y.mode||y.canAmend?((0,u.uX)(),(0,u.Wv)((0,d.R1)(gt.WK),{key:1,class:"no-spin",type:"number",min:"0",modelValue:a.actualMealAllowance,"onUpdate:modelValue":e=>a.actualMealAllowance=e,modelModifiers:{number:!0},placeholder:"è«‹è¼¸å…¥å¯¦éš›é¤è²»é‡‘é¡",disabled:k.value},{prepend:(0,u.k6)((()=>l[13]||(l[13]=[(0,u.eW)("NT$")]))),_:2},1032,["modelValue","onUpdate:modelValue","disabled"])):((0,u.uX)(),(0,u.CE)("span",_o,(0,L.v_)(P(a.actualMealAllowance)),1))])),_:2},1032,["prop"])):(0,u.Q3)("",!0)])])])):((0,u.uX)(),(0,u.CE)("div",{key:1,class:(0,L.C4)(["overtime-personnel-fields",{"form-item-responsive":!f.value,"form-item-vertical":f.value}])},[(0,u.bF)((0,d.R1)(Ot.xE),{label:"åŠ ç­äººå“¡",prop:`overtimePersonnel.${n}.personnelName`,"label-width":"6rem",class:(0,L.C4)([{"form-item-responsive":!f.value,"form-item-vertical":f.value},"overtime-personnel-name-item"])},{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(tt.s9),{modelValue:a.personnelName,"onUpdate:modelValue":e=>a.personnelName=e,"fetch-suggestions":Y,placeholder:"è«‹è¼¸å…¥å§“å",onSelect:e=>Q(e,n),clearable:"","trigger-on-focus":!1,disabled:h.value,style:(0,L.Tr)({"margin-left":f.value?"3rem":"0rem"})},null,8,["modelValue","onUpdate:modelValue","onSelect","disabled","style"])])),_:2},1032,["prop","class"]),(0,u.bF)((0,d.R1)(Ot.xE),{label:"é è¨ˆåŠ ç­æ™‚æ®µ",prop:`overtimePersonnel.${n}.overtimeDateTimeRange`,class:(0,L.C4)([{"form-item-responsive":!f.value,"form-item-vertical":f.value},"overtime-datetime-range-item"])},{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(jt.MG),{modelValue:a.overtimeDateTimeRange,"onUpdate:modelValue":e=>a.overtimeDateTimeRange=e,type:"datetimerange","range-separator":"è‡³","start-placeholder":"é–‹å§‹æ™‚é–“","end-placeholder":"çµæŸæ™‚é–“","value-format":f.value?"":"YYYY-MM-DD HH:mm",style:(0,L.Tr)([{width:"14rem"},{"margin-left":f.value?"3rem":"0rem"}]),format:"YYYY/MM/DD HH:mm",onChange:e=>B(a),disabled:h.value},null,8,["modelValue","onUpdate:modelValue","value-format","onChange","disabled","style"])])),_:2},1032,["prop","class"]),(0,u.bF)((0,d.R1)(Ot.xE),{label:"é è¨ˆåŠ ç­æ™‚æ•¸",class:(0,L.C4)({"form-item-responsive":!f.value,"form-item-vertical":f.value})},{default:(0,u.k6)((()=>[a.isEditingOvertimeHours?((0,u.uX)(),(0,u.Wv)((0,d.R1)(gt.WK),{key:1,modelValue:a.manualOvertimeMinutes,"onUpdate:modelValue":e=>a.manualOvertimeMinutes=e,modelModifiers:{number:!0},onBlur:e=>z(a),onKeyup:(0,t.jR)((e=>z(a)),["enter"]),size:"small",disabled:h.value,style:(0,L.Tr)({"margin-left":f.value?"3rem":"0rem"})},{append:(0,u.k6)((()=>[(0,u.bF)(o,{style:{"font-size":"1rem"}},{default:(0,u.k6)((()=>l[15]||(l[15]=[(0,u.eW)("åˆ†é˜")]))),_:1})])),_:2},1032,["modelValue","onUpdate:modelValue","onBlur","onKeyup","disabled","style"])):((0,u.uX)(),(0,u.CE)("div",wo,[(0,u.Lk)("div",{onDblclick:e=>O(a),class:"readonly-content"},(0,L.v_)(N(a)),41,Fo),"create"===y.mode?((0,u.uX)(),(0,u.Wv)(o,{key:0,class:"mx-1",type:"info"},{default:(0,u.k6)((()=>l[14]||(l[14]=[(0,u.eW)("(é»žæ“Šå…©ä¸‹å¯ç·¨è¼¯)")]))),_:1})):(0,u.Q3)("",!0)]))])),_:2},1032,["class"]),(0,u.bF)((0,d.R1)(Ot.xE),{label:"åŠ ç­å…§å®¹",prop:`overtimePersonnel.${n}.overtimeContent`,"label-width":"6.5rem",class:(0,L.C4)([{"form-item-responsive":!f.value,"form-item-vertical":f.value},"overtime-content-item"])},{default:(0,u.k6)((()=>[(0,u.Lk)("div",Co,[(0,u.bF)((0,d.R1)(gt.WK),{type:"textarea",modelValue:a.overtimeContent,"onUpdate:modelValue":e=>a.overtimeContent=e,placeholder:"è«‹å¡«å¯«åŠ ç­å…§å®¹",rows:2,disabled:h.value},null,8,["modelValue","onUpdate:modelValue","disabled"])])])),_:2},1032,["prop","class"]),(0,u.bF)((0,d.R1)(Ot.xE),{label:"é¤è²»ç”³è«‹",prop:`overtimePersonnel.${n}.mealAllowance`,"label-width":"6rem",class:(0,L.C4)([{"form-item-responsive":!f.value,"form-item-vertical":f.value},"meal-allowance-item"])},{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(gt.WK),{class:"no-spin",type:"number",min:"0",modelValue:a.mealAllowance,"onUpdate:modelValue":e=>a.mealAllowance=e,modelModifiers:{number:!0},placeholder:"è«‹è¼¸å…¥é¤è²»é‡‘é¡",disabled:h.value},{prepend:(0,u.k6)((()=>l[16]||(l[16]=[(0,u.eW)("NT$")]))),_:2},1032,["modelValue","onUpdate:modelValue","disabled"])])),_:2},1032,["prop","class"]),y.isShowActualField?((0,u.uX)(),(0,u.CE)(u.FK,{key:0},[(0,u.bF)((0,d.R1)(Ot.xE),{label:"å¯¦éš›åŠ ç­æ™‚æ®µ",prop:`overtimePersonnel.${n}.actualOvertimeDateTimeRange`,class:(0,L.C4)([{"form-item-responsive":!f.value,"form-item-vertical":f.value},"overtime-datetime-range-item expected"]),"label-class":"actual-label"},{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(jt.MG),{modelValue:a.actualOvertimeDateTimeRange,"onUpdate:modelValue":e=>a.actualOvertimeDateTimeRange=e,type:"datetimerange","range-separator":"è‡³","start-placeholder":"é–‹å§‹æ™‚é–“","end-placeholder":"çµæŸæ™‚é–“","value-format":"YYYY-MM-DD HH:mm",style:{width:"14rem"},format:"YYYY/MM/DD HH:mm",onChange:e=>j(a),disabled:k.value},null,8,["modelValue","onUpdate:modelValue","onChange","disabled"])])),_:2},1032,["prop","class"]),(0,u.bF)((0,d.R1)(Ot.xE),{label:"å¯¦éš›åŠ ç­æ™‚æ•¸",class:(0,L.C4)({"form-item-responsive":!f.value,"form-item-vertical":f.value}),"label-class":"actual-label"},{default:(0,u.k6)((()=>[a.isEditingActualOvertimeHours?((0,u.uX)(),(0,u.Wv)((0,d.R1)(gt.WK),{key:1,modelValue:a.manualActualOvertimeMinutes,"onUpdate:modelValue":e=>a.manualActualOvertimeMinutes=e,modelModifiers:{number:!0},onBlur:e=>ee(a),onKeyup:(0,t.jR)((e=>ee(a)),["enter"]),size:"small",style:{width:"8rem"},disabled:k.value},{append:(0,u.k6)((()=>[(0,u.bF)(o,{style:{"font-size":"1rem"}},{default:(0,u.k6)((()=>l[18]||(l[18]=[(0,u.eW)("åˆ†é˜")]))),_:1})])),_:2},1032,["modelValue","onUpdate:modelValue","onBlur","onKeyup","disabled"])):((0,u.uX)(),(0,u.CE)("div",Do,[(0,u.Lk)("span",{onDblclick:e=>Z(a),class:"readonly-content"},(0,L.v_)(K(a)),41,Lo),(0,u.bF)(o,{class:"mx-1",type:"info"},{default:(0,u.k6)((()=>l[17]||(l[17]=[(0,u.eW)("(é»žæ“Šå…©ä¸‹å¯é€²è¡Œç·¨è¼¯)")]))),_:1})]))])),_:2},1032,["class"]),(0,u.bF)((0,d.R1)(Ot.xE),{label:"å¯¦éš›åŠ ç­å…§å®¹",prop:`overtimePersonnel.${n}.actualOvertimeContent`,class:(0,L.C4)({"form-item-responsive":!f.value,"form-item-vertical":f.value}),"label-class":"actual-label"},{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(gt.WK),{type:"textarea",modelValue:a.actualOvertimeContent,"onUpdate:modelValue":e=>a.actualOvertimeContent=e,placeholder:"è«‹å¡«å¯«å¯¦éš›åŠ ç­å…§å®¹",rows:3,disabled:k.value},null,8,["modelValue","onUpdate:modelValue","disabled"])])),_:2},1032,["prop","class"]),(0,u.bF)((0,d.R1)(Ot.xE),{label:"å¯¦éš›é¤è²»",prop:`overtimePersonnel.${n}.actualMealAllowance`,"label-width":"6rem",class:(0,L.C4)([{"form-item-responsive":!f.value,"form-item-vertical":f.value},"actual-meal-allowance-item"]),"label-class":"actual-label"},{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(gt.WK),{class:"no-spin",type:"number",min:"0",modelValue:a.actualMealAllowance,"onUpdate:modelValue":e=>a.actualMealAllowance=e,modelModifiers:{number:!0},placeholder:"è«‹è¼¸å…¥å¯¦éš›é¤è²»é‡‘é¡",disabled:k.value,style:(0,L.Tr)({"margin-left":f.value?"3rem":"0rem"})},{prepend:(0,u.k6)((()=>l[19]||(l[19]=[(0,u.eW)("NT$")]))),_:2},1032,["modelValue","onUpdate:modelValue","disabled","style"])])),_:2},1032,["prop","class"])],64)):(0,u.Q3)("",!0)],2))])))),128)),(0,u.Lk)("div",Ro,["create"===e.mode||"WF"===e.mode&&y.WF_canEdit?((0,u.uX)(),(0,u.Wv)((0,d.R1)(Bt.S2),{key:0,class:"mb-3",size:"large",type:"warning",icon:(0,d.R1)(J.Plus),circle:"",onClick:q,disabled:h.value,title:"æ–°å¢žåŠ ç­äººå“¡"},null,8,["icon","disabled"])):(0,u.Q3)("",!0)]),(0,u.Q3)("",!0),"create"===e.mode?((0,u.uX)(),(0,u.CE)("div",Vo,[(0,u.bF)((0,d.R1)(Bt.S2),{type:"success",onClick:l[5]||(l[5]=e=>le(c.value)),disabled:h.value},{default:(0,u.k6)((()=>l[25]||(l[25]=[(0,u.eW)(" ç¢ºèª ")]))),_:1},8,["disabled"]),(0,u.bF)((0,d.R1)(Bt.S2),{onClick:l[6]||(l[6]=e=>oe(c.value)),disabled:h.value},{default:(0,u.k6)((()=>l[26]||(l[26]=[(0,u.eW)(" æ¸…ç©º ")]))),_:1},8,["disabled"])])):(0,u.Q3)("",!0)])),_:1},8,["style","model","rules"])])),_:1},8,["locale"])])])}}};const xo=(0,ie.A)(Io,[["__scopeId","data-v-171286ad"]]);var Eo=xo;const Ao={class:"container",style:{margin:"0 auto"}},To={class:"flex items-center gap-2"},Wo={key:0},So={key:0},Uo={key:1},$o={key:0};var No={__name:"LeaveCancellationForm",props:{mode:{type:String,default:"create"},WF_Form_Data:{type:Object,default:()=>({})},WF_canEdit:{type:Boolean,default:!0}},emits:["form-submitted","form-reset","update:WF_Form_Data"],setup(e,{expose:a,emit:l}){const t=e,o=l,n=(0,S.k)(),r=fl(),s=vl(),i=(0,d.KR)(null),c=(0,d.KR)([]),p=(0,d.KR)(!1),m=(0,d.KR)(null),v=(0,d.KR)(""),b=(0,d.KR)(""),g=(0,d.KR)(null),y=(0,d.KR)(""),f=(0,d.KR)(""),{width:h}=(0,Ql.lWr)(),k=(0,u.EW)((()=>h.value<=768?{width:"80%",maxWidth:"100%",margin:"1rem auto"}:{width:"35rem",maxWidth:"40rem",margin:"4rem"})),_=(0,u.EW)((()=>"WF"===t.mode&&!t.WF_canEdit)),w=(0,d.KR)({applyDate:new Date,applierName:n.userName,supervisor:"",selectedDocument:""}),F={selectedDocument:[{required:!0,message:"è«‹é¸æ“‡è¦éŠ·å‡çš„å–®æ“š",trigger:"change"}]},C=async()=>{await r.fetchDepartmentData();const e=r.departments.find((e=>e.id===n.userDeptId));if(!e)return b.value="",void(w.value.supervisor="");if("TW0005"===n.userId)return v.value="vincent",b.value="æœ±æ–‡æ¾",void(w.value.supervisor=b.value);let a=e.manager_id?.trim()||"";if(a===n.userId){let l=e.p_dpt_id;while(l&&"-1"!==l){const e=r.departments.find((e=>e.id===l));if(!e)break;const t=e.manager_id?.trim();if(t&&t!==n.userId){a=t;break}l=e.p_dpt_id}}v.value=a,b.value=a?await lt.getEmployeeName(a):"",w.value.supervisor=b.value},R=async()=>{try{await s.fetchEmployeeData();const e=s.employees.find((e=>e.id===n.userId));e&&(y.value=e.area_id||"",f.value=e.title_id||"")}catch(e){console.error("ç²å–ç•¶å‰ç”¨æˆ¶è³‡è¨Šå¤±æ•—:",e)}},V=async()=>{try{const e=await pl.getCompletedDocuments(n.userId),a=e.data||[];c.value=a.map((e=>({documentID:e,documentTypeID:e.substring(0,2),createdDate:(new Date).toISOString()})))}catch(e){console.error("ç²å–å·²å®Œæˆå–®æ“šå¤±æ•—:",e),D.nk.error("ç²å–å·²å®Œæˆå–®æ“šå¤±æ•—")}},I=e=>{if(e){const a=c.value.find((a=>a.documentID===e));a&&(m.value=a,p.value=!0,g.value=e)}},x=()=>{p.value=!1,Sa.s.confirm("è«‹å•æ˜¯å¦é¸æ“‡è©²å–®æ“š?","ç¢ºèªé¸æ“‡",{confirmButtonText:"æ˜¯",cancelButtonText:"å¦",type:"question"}).then((()=>{w.value.selectedDocument=g.value})).catch((()=>{w.value.selectedDocument="",g.value=null}))},E=async e=>{e.validate((async(e,a)=>{if(!e){const e={selectedDocument:"æ¬²éŠ·å‡çš„å–®æ“š"},l=Object.keys(a)[0],t=a[l][0].message,o=e[l]||l;return D.nk.error(`æ¬„ä½ã€Œ${o}ã€éŒ¯èª¤ï¼š${t}`),!1}const l={applyDate:w.value.applyDate.toISOString().split("T")[0],applierName:w.value.applierName,supervisorId:v.value,supervisorName:w.value.supervisor,selectedDocument:w.value.selectedDocument},t=`è«‹ç¢ºèªä»¥ä¸‹è³‡æ–™æ˜¯å¦æ­£ç¢ºï¼š<br/>ç”³è«‹æ—¥æœŸï¼š${w.value.applyDate.toISOString().split("T")[0]}<br/>ç”³è«‹äººå§“åï¼š${w.value.applierName}<br/>å–®ä½ä¸»ç®¡ï¼š${w.value.supervisor}<br/>æ¬²éŠ·å‡çš„å–®æ“šï¼š${w.value.selectedDocument}`;Sa.s.confirm(t,"ç¢ºèªå¡«å¯«å…§å®¹",{confirmButtonText:"ç¢ºèª",cancelButtonText:"å–æ¶ˆ",dangerouslyUseHTMLString:!0}).then((async()=>{const e=new FormData;e.append("DocumentTypeID","LC"),e.append("CreatorID",n.userId),e.append("CreatorSupervisorID",v.value),e.append("FormData",JSON.stringify(l));const a={NotificationTiming:0,NotifierIds:[]};e.append("Notification",JSON.stringify(a));try{console.log("createForm:",e);const a=await pl.createForm(e);i.value.resetFields(),D.nk.success("æäº¤éŠ·å‡å–®æˆåŠŸ!"),o("form-submitted",a.data.documentID)}catch(t){console.error("æäº¤å¤±æ•—:",t),D.nk.error("æäº¤å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦!")}})).catch((()=>{D.nk.info("å·²å–æ¶ˆæäº¤ã€‚")}))}))};function A(){return{applyDate:w.value.applyDate.toISOString().split("T")[0],applierName:w.value.applierName,supervisorName:w.value.supervisor,selectedDocument:w.value.selectedDocument}}return(0,u.wB)((()=>t.WF_Form_Data),(async e=>{e&&Object.keys(e).length>0&&(w.value.applyDate=e.applyDate?new Date(e.applyDate):new Date,w.value.applierName=e.applierName||e.applicantName||"",w.value.supervisor=e.supervisorName||e.supervisor||"",w.value.selectedDocument=e.selectedDocument||"")}),{immediate:!0}),a({getResubmitData:A,applyFormRef:i}),(0,u.sV)((async()=>{await R(),await C(),"WF"!==t.mode&&await V()})),(a,l)=>{const t=(0,u.g2)("el-date-picker"),o=(0,u.g2)("el-form-item"),n=(0,u.g2)("el-input"),r=(0,u.g2)("el-option"),s=(0,u.g2)("el-select"),d=(0,u.g2)("el-button"),v=(0,u.g2)("el-form");return(0,u.uX)(),(0,u.CE)("div",Ao,[(0,u.bF)(v,{ref_key:"applyFormRef",ref:i,class:"workflow-form invoice",style:(0,L.Tr)(k.value),model:w.value,rules:F,"label-width":"9rem","status-icon":""},{default:(0,u.k6)((()=>[(0,u.bF)(o,{label:"ç”³è«‹æ—¥æœŸ",prop:"applyDate",class:"form-item-responsive"},{default:(0,u.k6)((()=>[(0,u.bF)(t,{modelValue:w.value.applyDate,"onUpdate:modelValue":l[0]||(l[0]=e=>w.value.applyDate=e),type:"date",placeholder:"ç”³è«‹æ—¥æœŸ",style:{width:"100%"},disabled:"true"},null,8,["modelValue"])])),_:1}),(0,u.bF)(o,{label:"åœ°å€/è·ç¨±",class:"form-item-responsive"},{default:(0,u.k6)((()=>[(0,u.Lk)("div",To,[(0,u.bF)(rt,{areaId:y.value},null,8,["areaId"]),(0,u.bF)(Dl,{mode:"Description",titleId:f.value},null,8,["titleId"])])])),_:1}),(0,u.bF)(o,{label:"ç”³è«‹äººå§“å",prop:"applierName",class:"form-item-responsive"},{default:(0,u.k6)((()=>["WF"===e.mode?((0,u.uX)(),(0,u.CE)("label",Wo,(0,L.v_)(w.value.applierName),1)):((0,u.uX)(),(0,u.Wv)(n,{key:1,modelValue:w.value.applierName,"onUpdate:modelValue":l[1]||(l[1]=e=>w.value.applierName=e),disabled:""},null,8,["modelValue"]))])),_:1}),(0,u.bF)(o,{label:"å–®ä½ä¸»ç®¡",prop:"supervisor",class:"form-item-responsive"},{default:(0,u.k6)((()=>["WF"===e.mode?((0,u.uX)(),(0,u.CE)("label",So,(0,L.v_)(w.value.supervisor),1)):((0,u.uX)(),(0,u.CE)("label",Uo,(0,L.v_)(w.value.supervisor),1))])),_:1}),(0,u.bF)(o,{label:"æ¬²éŠ·å‡çš„å–®æ“š",prop:"selectedDocument",class:"form-item-responsive"},{default:(0,u.k6)((()=>["WF"===e.mode?((0,u.uX)(),(0,u.CE)("label",$o,(0,L.v_)(w.value.selectedDocument),1)):((0,u.uX)(),(0,u.Wv)(s,{key:1,modelValue:w.value.selectedDocument,"onUpdate:modelValue":l[2]||(l[2]=e=>w.value.selectedDocument=e),placeholder:"è«‹é¸æ“‡è¦éŠ·å‡çš„å–®æ“š",style:{width:"100%"},disabled:_.value,onChange:I,clearable:""},{default:(0,u.k6)((()=>[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(c.value,(e=>((0,u.uX)(),(0,u.Wv)(r,{key:e.documentID,label:e.documentID,value:e.documentID},null,8,["label","value"])))),128))])),_:1},8,["modelValue","disabled"]))])),_:1}),"create"===e.mode?((0,u.uX)(),(0,u.Wv)(o,{key:0},{default:(0,u.k6)((()=>[(0,u.bF)(d,{type:"success",onClick:l[3]||(l[3]=e=>E(i.value)),disabled:_.value},{default:(0,u.k6)((()=>l[5]||(l[5]=[(0,u.eW)(" ç¢ºèª ")]))),_:1},8,["disabled"])])),_:1})):(0,u.Q3)("",!0)])),_:1},8,["style","model"]),(0,u.bF)(en,{visible:p.value,"onUpdate:visible":l[4]||(l[4]=e=>p.value=e),doc:m.value,onClose:x},null,8,["visible","doc"])])}}};const Xo=(0,ie.A)(No,[["__scopeId","data-v-61b305e9"]]);var Ko=Xo;const Mo={key:0,class:"dialog-content-wrapper"},Po={class:"tooltip-container"},Oo={class:"fixed-content-wrapper"},zo={class:"signer-notify-group"},Bo={key:0,class:"insertion-column"},jo={class:"flex gap-2"},Yo={key:1,class:"notification-column"},Qo={class:"flex gap-2"},Ho={class:"comment-wrapper"},qo={key:0,class:"section-divider"},Jo={class:"approval-buttons-wrapper"};var Go={__name:"Detail_Related_WF_Dialog",props:{visible:Boolean,doc:Object,buttonGroupPosition:{type:String,default:"window",validator:e=>["window","dialog"].includes(e)}},emits:["update:visible","refreshList","close"],setup(e,{emit:a}){const l=(0,d.KR)(!1),t=(0,d.KR)(!1),o=(0,d.KR)(!1),n=(0,d.KR)(!1),r=(0,d.KR)(!1),s=(0,d.KR)(!1),i=(0,d.KR)(!1),c=(0,d.KR)(!0),p=(0,d.KR)(!1),m=(0,d.KR)(!1),v=(0,d.KR)(null),b=(0,d.KR)(!0),g=(0,d.KR)(null),y=e,f={CorrectionForm:vt,LeaveRequestForm:Mt,OvertimeRequestForm:Eo,LeaveCancellationForm:Ko},h=(0,u.EW)((()=>{const e=Yl[y.doc?.documentTypeID]?.component;return e?f[e]:null})),{width:k}=(0,Ql.lWr)(),_=(0,u.EW)((()=>k.value<=768?"23rem":"40rem"));async function w(){b.value=!1,await(0,u.dY)(),b.value=!0}const F=(0,u.EW)((()=>Yl[y.doc?.documentTypeID]?.fields||[])),C=(0,u.EW)((()=>n.value||r.value||t.value||o.value||s.value||i.value||c.value)),R=(0,d.KR)([]),V=(0,u.EW)((()=>{if(c.value)return!0;if(!R.value.length||!y.doc?.documentID)return!1;const e=R.value.findIndex((e=>e.stepID===e.currentStepID));if(-1===e)return!1;const a=R.value.filter((e=>!0===e.canAmendByApplicant));if(0===a.length)return!1;const l=R.value.findIndex((e=>e.stepID===a[a.length-1].stepID));return e>l})),I=a,x=(0,S.k)(),A=(0,d.KR)({comment:"",notificationTiming:2,notificationList:[],signerList:[],currentStepName:""});(0,u.wB)((()=>y.doc),(e=>{if(!e)return;const a=Yl[e.documentTypeID];a&&a.fields&&a.fields.forEach((e=>{e.prop in A.value||(A.value[e.prop]=null)}))}),{immediate:!0});const T=(0,d.KR)(!1),W=(0,d.KR)(!1),U=(0,d.KR)(null);function $(){I("update:visible",!1),I("close")}function N(e){A.value.signerList=A.value.signerList.filter((a=>a.id!==e))}function X(e){A.value.notificationList=A.value.notificationList.filter((a=>a.id!==e))}function K(){return{documentID:y.doc.documentID,approverID:x.userId,comment:A.value.comment,insertSignerIds:A.value.signerList.map((e=>e.id)),notification:{notificationTiming:A.value.notificationTiming,notifierIds:A.value.notificationList.map((e=>e.id))}}}async function M(){try{l.value=!0;const e=K();await Ma.submitApproval(e),D.nk.success("æ ¸å‡†æˆåŠŸ"),I("refreshList"),$()}catch{D.nk.error("æ ¸å‡†å¤±æ•—")}}async function P(){try{if(v.value&&"function"===typeof v.value.SaveAndApprovalForm){const e=await v.value.SaveAndApprovalForm();if(!0!==e)return;D.nk.success("å„²å­˜ä¸¦æäº¤æˆåŠŸ"),I("refreshList"),$()}else{const e=K();await Ma.submitApproval(e),D.nk.success("æ ¸å‡†æˆåŠŸ"),I("refreshList"),$()}}catch(e){console.error("å„²å­˜ä¸¦æäº¤å¤±æ•—:",e),D.nk.error("å„²å­˜ä¸¦æäº¤å¤±æ•—")}}async function O(){if(!A.value.comment.trim())return D.nk.warning("é€€ç°½æ™‚å¿…é ˆå¡«å¯«æ„è¦‹");try{const a={DocumentID:y.doc.documentID,RejecterID:x.userId,Comment:A.value.comment};var e=await Ma.submitRejection(a);e&&(D.nk.success("é€€ç°½æˆåŠŸ"),I("refreshList"),$())}catch(a){console.error("é€€ç°½å¤±æ•—:",a),D.nk.error("é€€ç°½å¤±æ•—")}}async function z(){try{var e=await Ma.voidDocument(y.doc.documentID);e&&(D.nk.success("ä½œå»¢æˆåŠŸ"),I("refreshList"),$())}catch{D.nk.error("ä½œå»¢å¤±æ•—")}}async function B(){if("function"===typeof v.value.getResubmitData){const a=v.value.getResubmitData(),l=new FormData;l.append("DocumentID",y.doc.documentID),l.append("ReSubmitter",x.userId);const t={...a};delete t.attachments,l.append("ResubmittedFormData",JSON.stringify(t)),a.attachments&&Array.isArray(a.attachments)&&a.attachments.forEach((e=>{e instanceof File||e instanceof Blob?l.append("Attachments",e):(e.raw instanceof File||e.raw instanceof Blob)&&l.append("Attachments",e.raw)}));try{for(const[a,t]of l.entries())console.log(a,t);const e=await Ma.resubmitWithAttachments(l);e&&(D.nk.success("å†æ¬¡æäº¤æˆåŠŸ!"),I("refreshList"),$())}catch(e){console.error("å†æ¬¡æäº¤å¤±æ•—ï¼š",e),D.nk.error("å†æ¬¡æäº¤å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦!")}}else D.nk.warning("ç•¶å‰è¡¨å–®é¡žåž‹å°šæœªé–‹ç™¼ å†æ¬¡æäº¤ åŠŸèƒ½ã€‚")}const j=(0,d.KR)();async function Y(){if(y.doc){p.value=!0;try{A.value.comment="",A.value.signerList=[],A.value.notificationList=[],j.value={};const a=await pl.getDocDetail(y.doc.documentTypeID,y.doc.documentID),l=a.data;console.log("fetch Detail:",l);const u=await pl.getDocumentFiles(y.doc.documentTypeID,y.doc.documentID),d=u.data;console.log("fetch files: ",d),j.value=l,j.value.attachments=d;const p=await Ma.getDocumentPermissions(y.doc.documentID,x.userId),v=p.data;console.log("perms:",v),v&&(t.value=v.canApprove,o.value=v.canReject,n.value=v.canInsertSigner,r.value=v.canNotify,s.value=v.canVoid,i.value=v.canResubmit,m.value=v.canEdit,c.value=v.canAmend);try{const e=await Ma.getApprovalSteps(y.doc.documentID);console.log("å·¥ä½œæµç¨‹APIè¿”å›ž:",e.data);let a=e.data||[];Array.isArray(a)||(a="object"===typeof a?Object.values(a):[]);const l=a.sort(((e,a)=>{const l=e.viewOrder||e.stepOrder||0,t=a.viewOrder||a.stepOrder||0;return l-t}));R.value=l,console.log("å·¥ä½œæµç¨‹æ­¥é©Ÿæ•¸æ“š:",R.value)}catch(e){console.error("ç²å–å·¥ä½œæµç¨‹æ­¥é©Ÿå¤±æ•—:",e),R.value=[]}Q(l,A.value,F.value),A.value.currentStepName=l.currentStepName}finally{p.value=!1}}}function Q(e,a,l){l.forEach((l=>{if("applyDate"===l.prop&&e.applyAt)a[l.prop]=new Date(e.applyAt);else if("leaveDateTimeRange"===l.prop&&e.leaveStartDate&&e.leaveEndDate&&e.leaveStartTime&&e.leaveEndTime){const t=new Date(`${e.leaveStartDate}T${e.leaveStartTime}`),o=new Date(`${e.leaveEndDate}T${e.leaveEndTime}`);isNaN(t.getTime())||isNaN(o.getTime())?a[l.prop]=[]:a[l.prop]=[t,o]}else void 0!==e[l.prop]&&(a[l.prop]=e[l.prop])}))}return(0,u.wB)((()=>y.visible),(async e=>{e&&(await Y(),await w())}),{immediate:!0}),(0,u.sV)((()=>{y.visible&&Y()})),(a,y)=>{const f=(0,u.g2)("el-text"),k=(0,u.g2)("el-form"),w=(0,u.g2)("el-button"),F=(0,u.g2)("el-dialog"),D=(0,u.g2)("el-tag"),R=(0,u.g2)("el-form-item"),I=(0,u.g2)("el-input"),x=(0,u.gN)("loading");return(0,u.bo)(((0,u.uX)(),(0,u.Wv)(F,{style:(0,L.Tr)([{border:"13px solid transparent",borderImage:"linear-gradient(45deg, #409EFF, #67C23A) 1",boxShadow:"0 8px 16px rgba(0, 0, 0, 13)"},{"text-align":"center"}]),"model-value":e.visible,width:_.value,"lock-scroll":!1,onClose:$,"destroy-on-close":"",ref_key:"dialogBody",ref:g,top:"3vh"},{default:(0,u.k6)((()=>[e.doc?((0,u.uX)(),(0,u.CE)("div",Mo,[(0,u.Lk)("p",null,[(0,u.bF)(f,{class:"responsive-text"},{default:(0,u.k6)((()=>y[14]||(y[14]=[(0,u.eW)("æ–‡ä»¶ç·¨è™Ÿï¼š")]))),_:1}),(0,u.bF)(f,{class:"responsive-text",style:{"background-color":"gold"}},{default:(0,u.k6)((()=>[(0,u.eW)((0,L.v_)(e.doc.documentID),1)])),_:1})]),(0,u.Lk)("p",null,[(0,u.bF)(f,{class:"responsive-text"},{default:(0,u.k6)((()=>y[15]||(y[15]=[(0,u.eW)("ç•¶å‰ç«™é»žï¼š")]))),_:1}),(0,u.bF)(f,{class:"responsive-text",style:(0,L.Tr)({backgroundColor:"å·²ä½œå»¢"===A.value.currentStepName?"red":"mediumturquoise"})},{default:(0,u.k6)((()=>[(0,u.eW)((0,L.v_)(A.value.currentStepName),1)])),_:1},8,["style"])]),(0,u.bF)(k,{ref_key:"formRef",ref:U,model:j.value},{default:(0,u.k6)((()=>[((0,u.uX)(),(0,u.Wv)((0,u.$y)(h.value),{ref_key:"dynamicFormRef",ref:v,WF_Form_Data:j.value,"onUpdate:WF_Form_Data":y[0]||(y[0]=e=>j.value=e),mode:"WF",WF_canEdit:m.value,canAmend:c.value,isShowActualField:V.value},null,40,["WF_Form_Data","WF_canEdit","canAmend","isShowActualField"])),(0,u.RG)(a.$slots,`custom-fields-${e.doc?.documentTypeID}`,{formModel:j.value})])),_:3},8,["model"]),(0,u.bF)(F,{modelValue:T.value,"onUpdate:modelValue":y[4]||(y[4]=e=>T.value=e),title:"çŸ¥æœƒè¨­å®š",width:"60%",top:"0vh",onClose:y[5]||(y[5]=e=>T.value=!1)},{footer:(0,u.k6)((()=>[(0,u.bF)(w,{onClick:y[2]||(y[2]=e=>T.value=!1)},{default:(0,u.k6)((()=>y[16]||(y[16]=[(0,u.eW)("å–æ¶ˆ")]))),_:1}),(0,u.bF)(w,{type:"primary",onClick:y[3]||(y[3]=e=>T.value=!1)},{default:(0,u.k6)((()=>y[17]||(y[17]=[(0,u.eW)("ç¢ºå®š")]))),_:1})])),default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(sl),{modelValue:A.value.notificationList,"onUpdate:modelValue":y[1]||(y[1]=e=>A.value.notificationList=e),mode:"notify"},null,8,["modelValue"])])),_:1},8,["modelValue"]),(0,u.bF)(F,{class:"insert_notify_dialog",modelValue:W.value,"onUpdate:modelValue":y[9]||(y[9]=e=>W.value=e),title:"åŠ ç°½è¨­å®š",top:"0vh",onClose:y[10]||(y[10]=e=>W.value=!1)},{footer:(0,u.k6)((()=>[(0,u.bF)(w,{onClick:y[7]||(y[7]=e=>W.value=!1)},{default:(0,u.k6)((()=>y[18]||(y[18]=[(0,u.eW)("å–æ¶ˆ")]))),_:1}),(0,u.bF)(w,{type:"primary",onClick:y[8]||(y[8]=e=>W.value=!1)},{default:(0,u.k6)((()=>y[19]||(y[19]=[(0,u.eW)("ç¢ºå®š")]))),_:1})])),default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(sl),{modelValue:A.value.signerList,"onUpdate:modelValue":y[6]||(y[6]=e=>A.value.signerList=e),mode:"insert"},null,8,["modelValue"])])),_:1},8,["modelValue"]),b.value?((0,u.uX)(),(0,u.Wv)(jl,{key:0,docId:e.doc.documentID,visible:e.visible},null,8,["docId","visible"])):(0,u.Q3)("",!0),(0,u.Lk)("div",Po,[(0,u.bF)((0,d.R1)(E.A),{severity:"secondary",icon:"pi pi-times",class:"p-button-rounded p-button-text p-button-lg",onClick:$,raised:""}),y[20]||(y[20]=(0,u.Lk)("span",{class:"tooltip-text"},"é—œé–‰å–®æ“š",-1))])])):(0,u.Q3)("",!0),C.value?((0,u.uX)(),(0,u.CE)("div",{key:1,class:(0,L.C4)(["fixed-button-group",`position-${e.buttonGroupPosition}`])},[(0,u.Lk)("div",Oo,[(0,u.Lk)("div",zo,[n.value?((0,u.uX)(),(0,u.CE)("div",Bo,[(0,u.bF)(R,{label:"åŠ ç°½äººå“¡"},{default:(0,u.k6)((()=>[(0,u.Lk)("div",jo,[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(A.value.signerList,(e=>((0,u.uX)(),(0,u.Wv)(D,{key:e.id,closable:"",onClose:a=>N(e.id)},{default:(0,u.k6)((()=>[(0,u.eW)((0,L.v_)(e.name),1)])),_:2},1032,["onClose"])))),128)),(0,u.bF)(w,{size:"small",class:"button-new-tag button-new-tag--primary",onClick:y[11]||(y[11]=e=>W.value=!0)},{default:(0,u.k6)((()=>y[21]||(y[21]=[(0,u.eW)(" + åŠ ç°½ ")]))),_:1})])])),_:1})])):(0,u.Q3)("",!0),r.value?((0,u.uX)(),(0,u.CE)("div",Yo,[(0,u.bF)(R,{label:"çŸ¥æœƒäººå“¡"},{default:(0,u.k6)((()=>[(0,u.Lk)("div",Qo,[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(A.value.notificationList,(e=>((0,u.uX)(),(0,u.Wv)(D,{key:e.id,type:"warning",closable:"",onClose:a=>X(e.id)},{default:(0,u.k6)((()=>[(0,u.eW)((0,L.v_)(e.name),1)])),_:2},1032,["onClose"])))),128)),(0,u.bF)(w,{size:"small",class:"button-new-tag button-new-tag--warning",onClick:y[12]||(y[12]=e=>T.value=!0)},{default:(0,u.k6)((()=>y[22]||(y[22]=[(0,u.eW)(" + çŸ¥æœƒ ")]))),_:1})])])),_:1})])):(0,u.Q3)("",!0)]),(0,u.Lk)("div",Ho,[t.value?((0,u.uX)(),(0,u.Wv)(R,{key:0,label:"å›žè¦†",prop:"comment",class:"vertical-label-item"},{default:(0,u.k6)((()=>[(0,u.bF)(I,{type:"textarea",modelValue:A.value.comment,"onUpdate:modelValue":y[13]||(y[13]=e=>A.value.comment=e),placeholder:"è«‹è¼¸å…¥æ‚¨çš„æ„è¦‹",rows:4,class:"comment-textarea"},null,8,["modelValue"])])),_:1})):(0,u.Q3)("",!0)]),t.value?((0,u.uX)(),(0,u.CE)("hr",qo)):(0,u.Q3)("",!0),(0,u.Lk)("div",Jo,[(0,u.RG)(a.$slots,`custom-actions-${e.doc?.documentTypeID}`,{formModel:A.value}),c.value?((0,u.uX)(),(0,u.Wv)(w,{key:0,type:"warning",onClick:P,size:"large",round:"",plain:""},{default:(0,u.k6)((()=>y[23]||(y[23]=[(0,u.eW)("å„²å­˜ä¸¦æäº¤")]))),_:1})):(0,u.Q3)("",!0),i.value?((0,u.uX)(),(0,u.Wv)(w,{key:1,type:"warning",onClick:B,size:"large",round:"",plain:""},{default:(0,u.k6)((()=>y[24]||(y[24]=[(0,u.eW)("å†æ¬¡æäº¤")]))),_:1})):(0,u.Q3)("",!0),t.value?((0,u.uX)(),(0,u.Wv)(w,{key:2,type:"success",onClick:M,size:"large",loading:l.value,disabled:l.value,round:"",plain:""},{default:(0,u.k6)((()=>y[25]||(y[25]=[(0,u.eW)("æ ¸å‡†")]))),_:1},8,["loading","disabled"])):(0,u.Q3)("",!0),o.value?((0,u.uX)(),(0,u.Wv)(w,{key:3,type:"danger",onClick:O,size:"large",round:"",plain:""},{default:(0,u.k6)((()=>y[26]||(y[26]=[(0,u.eW)("é€€ç°½")]))),_:1})):(0,u.Q3)("",!0),s.value?((0,u.uX)(),(0,u.Wv)(w,{key:4,type:"info",onClick:z,size:"large",round:"",plain:""},{default:(0,u.k6)((()=>y[27]||(y[27]=[(0,u.eW)("ä½œå»¢")]))),_:1})):(0,u.Q3)("",!0)])])],2)):(0,u.Q3)("",!0)])),_:3},8,["model-value","width"])),[[x,p.value]])}}};const Zo=(0,ie.A)(Go,[["__scopeId","data-v-70f386ea"]]);var en=Zo;const an={class:"parent"},ln={class:"div1",style:{width:"30rem",display:"flex","flex-direction":"column","align-items":"center","margin-top":"-0.5rem"}},tn={class:"title-section",style:{display:"flex","align-items":"center"}},on={class:"table-title",style:{"font-size":"1.2rem","margin-bottom":"-1rem"}},nn={class:"sub-title",style:{display:"flex","align-items":"center"}},rn={class:"sub-title",style:{margin:"0","margin-top":"-0rem"}},sn={style:{"padding-right":"1rem","font-size":"1.5rem"},class:"highlight"},un={style:{"font-size":"1.5rem"},class:"attendance-date"},dn={style:{width:"100%","overflow-x":"auto","margin-top":"10px"}},cn=["onClick"],pn={key:1,class:"custom-tag custom-tag-success"},mn=["onClick","title"],vn=["onClick","title"],bn={key:4,class:"custom-tag custom-tag-inverse",style:{"margin-right":"5px"}},gn={key:0,style:{"margin-top":"5rem","margin-left":"1rem"},class:"stats-card div2"},yn={class:"stats-title"},fn={class:"stats-section"},hn={class:"section-title"},kn={class:"stats-summary"},_n={class:"stats-list"},wn={class:"date"},Fn={class:"info"},Cn={key:0,class:"extra-info"},Dn={class:"stats-section"},Ln={class:"section-title"},Rn={class:"stats-summary"},Vn={class:"stats-list"},In={class:"date"},xn={class:"info"},En={class:"stats-total"},An={key:0,class:"no-records"},Tn={key:1},Wn={class:"dialog-footer"};var Sn={__name:"AttendanceRecord",props:{editMode:{type:Boolean,default:!1},selectedUser:{type:Object,default:null},personalMode:{type:Boolean,default:!1},sysMode:{type:Boolean,default:!1}},emits:["attendanceDate","updateAttendanceDate","lateTotal"],setup(e,{emit:a}){const{t:l}=(0,O.s9)(),t=e,o=(0,d.KR)([]),n=(0,d.KR)([]),r=(0,d.KR)((new Date).getFullYear()),s=(0,d.KR)([]),i=(0,d.KR)(""),c=(0,d.KR)(""),p=(0,d.KR)(""),m=(0,d.KR)(""),v=(0,d.KR)(!1),b=(0,u.EW)((()=>{const e=[...s.value];return U.value.forEach((a=>{if(a.actualOvertimeDate){const l=new Date(a.actualOvertimeDate),t=`${(l.getMonth()+1).toString().padStart(2,"0")}/${l.getDate().toString().padStart(2,"0")}`,o=["æ—¥","ä¸€","äºŒ","ä¸‰","å››","äº”","å…­"],n=o[l.getDay()],r=`${t} (${n})`,s=e.find((e=>e["æ—¥æœŸ"]===r));s||e.push({"æ—¥æœŸ":r,"ä¸Šç­":"","ä¸‹ç­":"","å·¥æ™‚":"","é²åˆ°":"","æ—©é€€":"","å‚™è¨»":"åƒ…æœ‰åŠ ç­è¨˜éŒ„",_isOvertimeOnly:!0})}})),e.sort(((e,a)=>{const l=e["æ—¥æœŸ"].match(/(\d{2}\/\d{2})/)?.[1]||"",t=a["æ—¥æœŸ"].match(/(\d{2}\/\d{2})/)?.[1]||"";return l.localeCompare(t)}))})),g=(0,u.EW)((()=>s.value.filter((e=>{const a=A(e);if(null===a||a<=0||a>3)return!1;const l=V(e),t=e["æ—¥æœŸ"].includes("(å…­)")||e["æ—¥æœŸ"].includes("(æ—¥)");if(l&&t)return!1;const o=j(e["æ—¥æœŸ"]);if(o)return!1;const n=J(e["æ—¥æœŸ"]);return!n})))),y=(0,u.EW)((()=>s.value.filter((e=>{const a=A(e);if(null===a||a<=3)return!1;const l=V(e),t=e["æ—¥æœŸ"].includes("(å…­)")||e["æ—¥æœŸ"].includes("(æ—¥)");if(l&&t)return console.log(`è·³éŽé€±æœ«åŠ ç­è¨˜éŒ„: ${e["æ—¥æœŸ"]} (é²åˆ° ${a} åˆ†é˜)`),!1;const o=j(e["æ—¥æœŸ"]);if(o)return console.log(`è·³éŽæœ‰è«‹å‡è¨˜éŒ„çš„æ—¥æœŸ: ${e["æ—¥æœŸ"]} (å‡åˆ¥: ${o}, é²åˆ° ${a} åˆ†é˜)`),!1;const n=J(e["æ—¥æœŸ"]);return!n||(console.log(`è·³éŽæœ‰é¢±é¢¨å‡è¨˜éŒ„çš„æ—¥æœŸ: ${e["æ—¥æœŸ"]} (é²åˆ° ${a} åˆ†é˜)`),!1)})))),f=(0,u.EW)((()=>y.value.reduce(((e,a)=>e+(A(a)||0)),0))),h=(0,u.EW)((()=>g.value.length<=3?0:g.value.slice(3).reduce(((e,a)=>e+(A(a)||0)),0))),k=(0,u.EW)((()=>{const e=new Date;return e.setMonth(e.getMonth()-1),R(e)})),_=(0,u.EW)((()=>m.value<=k.value));async function w(e){p.value="";const a=new Date;t.personalMode?a.setMonth(a.getMonth()):a.setMonth(a.getMonth()-1);const l=a.getFullYear();let o=a.getMonth()+1;o=o<10?"0"+o:o,m.value=`${l}-${o}`;try{const a=await Wa.getAttendanceRecord(m.value,e);s.value=a.data,await Promise.all([H(),Q(),q(),G()]),v.value=!0}catch(n){console.error("å–å¾—è€ƒå‹¤è³‡æ–™ç™¼ç”ŸéŒ¯èª¤ï¼š",n),p.value="å–å¾—è€ƒå‹¤è³‡æ–™ç™¼ç”ŸéŒ¯èª¤",v.value=!0}}async function F(){const[e,a]=m.value.split("-"),l=parseInt(e),o=parseInt(a),n=new Date(l,o-1,1);n.setMonth(n.getMonth()-1);const i=R(n);if(t.editMode)Sa.s.confirm("ç•¶å‰ç·¨è¼¯çš„å…§å®¹å°šæœªå„²å­˜ï¼Œè«‹å•æ˜¯å¦è¦åˆ‡æ›åˆ°ä¸åŒè³‡æ–™ï¼Ÿ","æç¤º",{confirmButtonText:"ç¢ºèª",cancelButtonText:"å–æ¶ˆ",type:"warning"}).then((async()=>{m.value=i,r.value=n.getFullYear(),await(0,u.dY)();try{D(r.value);const e=await Wa.getAttendanceRecord(m.value,c.value);s.value=e.data,await Promise.all([H(),Q(),q(),G()]),v.value=!0}catch(e){console.error("å–å¾—è€ƒå‹¤è³‡æ–™ç™¼ç”ŸéŒ¯èª¤ï¼š",e),p.value="å–å¾—è€ƒå‹¤è³‡æ–™ç™¼ç”ŸéŒ¯èª¤",v.value=!0}})).catch((()=>{}));else{m.value=i,r.value=n.getFullYear(),await(0,u.dY)();try{D(r.value);const e=await Wa.getAttendanceRecord(m.value,c.value);s.value=e.data,await Promise.all([H(),Q(),q(),G()]),v.value=!0}catch(d){console.error("å–å¾—è€ƒå‹¤è³‡æ–™ç™¼ç”ŸéŒ¯èª¤ï¼š",d),p.value="å–å¾—è€ƒå‹¤è³‡æ–™ç™¼ç”ŸéŒ¯èª¤",v.value=!0}}}async function C(){const[e,a]=m.value.split("-"),l=parseInt(e),o=parseInt(a),n=new Date(l,o-1,1);n.setMonth(n.getMonth()+1);const i=R(n);if(t.editMode)Sa.s.confirm("ç•¶å‰ç·¨è¼¯çš„å…§å®¹å°šæœªå„²å­˜ï¼Œè«‹å•æ˜¯å¦è¦åˆ‡æ›åˆ°ä¸åŒè³‡æ–™ï¼Ÿ","æç¤º",{confirmButtonText:"ç¢ºèª",cancelButtonText:"å–æ¶ˆ",type:"warning"}).then((async()=>{m.value=i,r.value=n.getFullYear(),await(0,u.dY)();try{D(r.value);const e=await Wa.getAttendanceRecord(m.value,c.value);s.value=e.data,await Promise.all([H(),Q(),q(),G()]),v.value=!0}catch(e){console.error("å–å¾—è€ƒå‹¤è³‡æ–™ç™¼ç”ŸéŒ¯èª¤ï¼š",e),p.value="å–å¾—è€ƒå‹¤è³‡æ–™ç™¼ç”ŸéŒ¯èª¤",v.value=!0}})).catch((()=>{}));else{m.value=i,r.value=n.getFullYear(),await(0,u.dY)();try{D(r.value);const e=await Wa.getAttendanceRecord(m.value,c.value);s.value=e.data,await Promise.all([H(),Q(),q(),G()]),v.value=!0}catch(d){console.error("å–å¾—è€ƒå‹¤è³‡æ–™ç™¼ç”ŸéŒ¯èª¤ï¼š",d),p.value="å–å¾—è€ƒå‹¤è³‡æ–™ç™¼ç”ŸéŒ¯èª¤",v.value=!0}}}const D=async e=>{const a=await fetch(`https://cdn.jsdelivr.net/gh/ruyut/TaiwanCalendar/data/${e}.json`),l=await a.json();l.forEach((e=>{if(e.date&&8===e.date.length){const a=e.date.slice(4,6),l=e.date.slice(6,8);e.date=`${a}/${l}`}})),o.value=l.filter((e=>!0===e.isHoliday)),n.value=l.filter((e=>e.description.includes("è£œè¡Œä¸Šç­")))};function R(e){const a=e.getFullYear();let l=e.getMonth()+1;return l=l<10?"0"+l:l,`${a}-${l}`}function V(e){const a=e["æ—¥æœŸ"];return!!e._isOvertimeOnly||I(a)}function I(e){let a=null;const l=e.match(/(\d{2}\/\d{2})/);if(l&&(a=l[1]),!a)return!1;for(const t of U.value)if(t.actualOvertimeDate){const e=new Date(t.actualOvertimeDate),l=`${(e.getMonth()+1).toString().padStart(2,"0")}/${e.getDate().toString().padStart(2,"0")}`;if(l===a)return!0}return!1}function x(e){const a=e["æ—¥æœŸ"],t=o.value.find((e=>a.startsWith(e.date)));return t&&t.description?l(`holiday.${t.description}`,t.description):""}function E(e){if(!e["ä¸Šç­"]&&!e["ä¸‹ç­"]){const a=e["æ—¥æœŸ"];if(a.includes("(å…­)")||a.includes("(æ—¥)"))return!1;const l=a.split(" ")[0],[t,n]=l.split("/"),r=new Date,s=new Date(r.getFullYear(),parseInt(t,10)-1,parseInt(n,10));if(s>r)return!1;const u=o.value.some((e=>a.startsWith(e.date)));if(u)return!1;const i=J(a);if(i)return!1;const d=j(a);return"äº‹å‡"!==d}return!1}function A(e){if(!e["ä¸Šç­"])return null;const a=e["ä¸Šç­"].split(":"),l=V(e),t=e["æ—¥æœŸ"].includes("(å…­)")||e["æ—¥æœŸ"].includes("(æ—¥)");if(l&&t)return 0;if(a.length<2)return null;const o=60*parseInt(a[0],10)+parseInt(a[1],10),n=750,r=810,s=510;return o<n?o-s:o<=r?0:o-r}function T(e){if(E(e))return"warn";const a=A(e);return a<=0?"":a<=3?"warn":"danger"}function W(e){if(E(e))return"æ› è·";const a=A(e);return a<=0?"":l("lateText",{delay:a})}const S=(0,d.KR)([]),U=(0,d.KR)([]),$=(0,d.KR)([]),N=(0,d.KR)([]),X=(0,d.KR)(null),K=(0,d.KR)(!1),M=(0,d.KR)(!1);(0,u.wB)((()=>t.selectedUser),(async e=>{t.personalMode?(c.value=e.userId,i.value=e.userName,await w(c.value)):e&&e.namE_FIRST&&(c.value=e.emploY_ID,i.value=e.namE_FIRST,await w(c.value)),await H(),await Q(),await q(),await G()}),{immediate:!0});const P=a;(0,u.wB)((()=>m.value),(e=>{P("attendanceDate",e)}));const z=(0,u.EW)((()=>f.value+h.value));function B(e){let a=null;if(e.includes("/")){const l=e.match(/(\d{4}\/\d{2}\/\d{2})/);if(l)a=l[1];else{const l=e.match(/(\d{2}\/\d{2})/);if(l){const[e]=m.value.split("-");a=`${e}/${l[1]}`}}}if(!a)return[];const l=[];for(const o of S.value)try{let e=null,t=null;if(o.leaveStartDate){const a="string"===typeof o.leaveStartDate?o.leaveStartDate:o.leaveStartDate.toString();e=a.substring(0,10).replace(/-/g,"/")}if(o.leaveEndDate){const e="string"===typeof o.leaveEndDate?o.leaveEndDate:o.leaveEndDate.toString();t=e.substring(0,10).replace(/-/g,"/")}if(!e||!t)continue;if(e<=a&&a<=t){const e=Y(o.leaveType);l.push({...o,leaveTypeName:e,documentId:o.leaveRequestID||o.id||"Unknown"})}}catch(t){console.error("è™•ç†å‡åˆ¥è¨˜éŒ„æ™‚ç™¼ç”ŸéŒ¯èª¤:",t,o);continue}return l}function j(e){let a=null;if(e.includes("/")){const l=e.match(/(\d{4}\/\d{2}\/\d{2})/);if(l)a=l[1];else{const l=e.match(/(\d{2}\/\d{2})/);if(l){const[e]=m.value.split("-");a=`${e}/${l[1]}`}}}if(!a)return null;for(const t of S.value)try{let e=null,l=null;if(t.leaveStartDate){const a="string"===typeof t.leaveStartDate?t.leaveStartDate:t.leaveStartDate.toString();e=a.substring(0,10).replace(/-/g,"/")}if(t.leaveEndDate){const e="string"===typeof t.leaveEndDate?t.leaveEndDate:t.leaveEndDate.toString();l=e.substring(0,10).replace(/-/g,"/")}if(!e||!l)continue;if(e<=a&&a<=l)return Y(t.leaveType)}catch(l){console.error("è™•ç†å‡åˆ¥è¨˜éŒ„æ™‚ç™¼ç”ŸéŒ¯èª¤:",l,t);continue}return null}function Y(e){const a={AnnualLeave:"ç‰¹ä¼‘",SickLeave:"ç—…å‡",PersonalLeave:"äº‹å‡",MaternityLeave:"ç”¢å‡",PaternityLeave:"é™ªç”¢å‡",FamilyCareLeave:"å®¶åº­ç…§é¡§å‡",MenstrualLeave:"ç”Ÿç†å‡",BereavementLeave:"å–ªå‡",MarriageLeave:"å©šå‡",OfficialLeave:"å…¬å‡",CompensatoryLeave:"è£œä¼‘",PregnancyCheckupLeave:"ç”¢æª¢å‡",VaccinationLeave:"ç–«è‹—å‡",InjuryLeave:"å…¬å‚·å‡",JobSeekingLeave:"è¬€è·å‡"};return a[e]||e}async function Q(){try{if(!m.value)return void(U.value=[]);if(!t.selectedUser)return void(U.value=[]);const[e,a]=m.value.split("-"),l=`${e}-${a}-01`,o=new Date(e,a,0).getDate(),n=`${e}-${a}-${o.toString().padStart(2,"0")}`,r=t.personalMode?t.selectedUser.userId:t.selectedUser.emploY_ID,s={userId:r,page:1,pageSize:1e3,startDate:l,endDate:n},u=await Wa.getPersonalOvertimeRecords(s);u.data&&u.data.success?U.value=u.data.records||[]:U.value=[]}catch(e){console.error("å–å¾—åŠ ç­è¨˜éŒ„æ™‚ç™¼ç”ŸéŒ¯èª¤:",e),U.value=[]}}async function H(){try{if(!m.value)return void(S.value=[]);const[e,a]=m.value.split("-"),l=`${e}-${a}-01`,o=new Date(e,a,0).getDate(),n=`${e}-${a}-${o.toString().padStart(2,"0")}`;if(!t.selectedUser)return void(S.value=[]);const r=t.personalMode?t.selectedUser.userId:t.selectedUser.emploY_ID,s={userId:r,page:1,pageSize:1e3,startDate:l,endDate:n,leaveType:""},u=await Wa.getPersonalLeaveRecords(s);u.data&&u.data.success?S.value=u.data.records||[]:u.data&&Array.isArray(u.data)?S.value=u.data:S.value=[]}catch(e){console.error("[AttendanceRecord] å–å¾—å‡åˆ¥è¨˜éŒ„æ™‚ç™¼ç”ŸéŒ¯èª¤:",e),S.value=[]}}async function q(){try{if(!m.value)return void($.value=[]);const[e,a]=m.value.split("-"),l=`${e}-${a}-01`,t=new Date(e,a,0).getDate(),o=`${e}-${a}-${t.toString().padStart(2,"0")}`,n={startDate:l,endDate:o},r=await Wa.getTyphoonLeaveRecords(n);r.data&&r.data.success?$.value=r.data.data||[]:$.value=[]}catch(e){console.error("[AttendanceRecord] å–å¾—é¢±é¢¨å‡è¨˜éŒ„æ™‚ç™¼ç”ŸéŒ¯èª¤:",e),$.value=[]}}function J(e){if(!$.value||0===$.value.length)return null;let a=null;if(e.includes("/")){const l=e.match(/(\d{4}\/\d{2}\/\d{2})/);if(l)a=l[1].replace(/\//g,"-");else{const l=e.match(/(\d{2}\/\d{2})/);if(l){const[e]=m.value.split("-");a=`${e}-${l[1].replace("/","-")}`}}}if(!a)return null;for(const l of $.value){let e=null;if(l.leaveDate?e=l.leaveDate.substring(0,10):l.date?e=l.date.substring(0,10):l.Date?e=l.Date.substring(0,10):l.typhoonDate&&(e=l.typhoonDate.substring(0,10)),e===a)return"é¢±é¢¨å‡"}return null}async function G(){try{if(!m.value)return void(N.value=[]);if(!t.selectedUser)return void(N.value=[]);const e=t.personalMode?t.selectedUser.userId:t.selectedUser.emploY_ID,a=await Wa.getCardCorrectionRecords(e,m.value);a.data&&Array.isArray(a.data)?N.value=a.data:N.value=[]}catch(e){console.error("[AttendanceRecord] å–å¾—è£œåˆ·å¡è¨˜éŒ„æ™‚ç™¼ç”ŸéŒ¯èª¤:",e),N.value=[]}}function Z(e){let a=null;if(e.includes("/")){const l=e.match(/(\d{4}\/\d{2}\/\d{2})/);if(l)a=l[1].replace(/\//g,"-");else{const l=e.match(/(\d{2}\/\d{2})/);if(l){const[e]=m.value.split("-");a=`${e}-${l[1].replace("/","-")}`}}}if(!a)return null;for(const l of N.value){let e=null;if(l.newStatus&&(e=le(l.newStatus)),e===a)return!0}return null}function ee(e){let a=null;if(e.includes("/")){const l=e.match(/(\d{4}\/\d{2}\/\d{2})/);if(l)a=l[1].replace(/\//g,"-");else{const l=e.match(/(\d{2}\/\d{2})/);if(l){const[e]=m.value.split("-");a=`${e}-${l[1].replace("/","-")}`}}}if(!a)return[];const l=[];for(const t of N.value){let e=null;t.newStatus&&(e=le(t.newStatus)),e===a&&l.push(t)}return l.sort(((e,a)=>{const l=e.newStatus||"",t=a.newStatus||"";return l.localeCompare(t)})),l}function ae(e){return"ClockIn"===e.correctionType?"è£œ(ä¸Š)":"ClockOut"===e.correctionType?"è£œ(ä¸‹)":e.correctionType?`è£œ(${e.correctionType})`:"è£œåˆ·å¡"}function le(e){if(!e)return null;try{const a=e.match(/(\d{4}\/\d{1,2}\/\d{1,2})/);if(a){const e=a[1],l=e.split("/");if(3===l.length){const e=l[0],a=l[1].padStart(2,"0"),t=l[2].padStart(2,"0"),o=`${e}-${a}-${t}`;return o}}return console.warn(`ç„¡æ³•è§£æž NewStatus æ—¥æœŸæ ¼å¼: "${e}"`),null}catch(a){return console.error(`è§£æž NewStatus æ—¥æœŸæ™‚ç™¼ç”ŸéŒ¯èª¤: "${e}"`,a),null}}(0,u.wB)(z,(e=>{P("lateTotal",e)}));const te=e=>{console.log("openLeaveDetailByRecord è¢«å‘¼å«ï¼Œè¨˜éŒ„:",e);const a=e.documentId;console.log("æ‰¾åˆ°çš„æ–‡ä»¶ID:",a),a&&"Unknown"!==a?(X.value={documentID:a,documentTypeID:"LR"},K.value=!0,console.log("é–‹å•Ÿå‡åˆ¥è©³æƒ…å°è©±æ¡†ï¼Œæ–‡ä»¶ID:",a)):console.log("æœªæ‰¾åˆ°å°æ‡‰çš„å‡åˆ¥è¨˜éŒ„æˆ–æ–‡ä»¶IDç„¡æ•ˆ")},oe=e=>{const a=re(e);if(a)X.value={documentID:a,documentTypeID:"OR"},K.value=!0;else{const a=ne(e);if(a&&a.overtimeRequestId)X.value={documentID:a.overtimeRequestId,documentTypeID:"OR"},K.value=!0;else if(U.value.length>0){const e=U.value[0];e.overtimeRequestId&&(X.value={documentID:e.overtimeRequestId,documentTypeID:"OR"},K.value=!0)}}},ne=e=>{let a=null;if(e.includes("/")){const l=e.match(/(\d{4}\/\d{2}\/\d{2})/);if(l)a=l[1];else{const l=e.match(/(\d{2}\/\d{2})/);if(l){const[e]=m.value.split("-");a=`${e}/${l[1]}`}}}if(!a)return null;for(const l of U.value)if(l.actualOvertimeDate){const e=l.actualOvertimeDate.substring(0,10).replace(/-/g,"/");if(e===a)return l}return null},re=e=>{const a=ne(e);return a&&a.overtimeRequestId?a.overtimeRequestId:null},se=(e,a=null)=>{let l=a;if(l||(l=ce(e)),l)X.value={documentID:l,documentTypeID:"CR"},K.value=!0;else{const a=ee(e);if(a.length>0&&a[0].documentId){const e=a[0].documentId;X.value={documentID:e,documentTypeID:"CR"},K.value=!0}}},ue=()=>{M.value=!0},ie=e=>{if(!e)return"";try{const a=new Date(e);if(isNaN(a.getTime()))return e;const l=a.getFullYear(),t=(a.getMonth()+1).toString().padStart(2,"0"),o=a.getDate().toString().padStart(2,"0");return`${l}-${t}-${o}`}catch(a){return console.error("æ ¼å¼åŒ–æ—¥æœŸæ™‚ç™¼ç”ŸéŒ¯èª¤:",a),e}},de=e=>{if(!e)return"";try{const a=new Date(e);if(isNaN(a.getTime()))return e;const l=a.getFullYear(),t=(a.getMonth()+1).toString().padStart(2,"0"),o=a.getDate().toString().padStart(2,"0"),n=a.getHours().toString().padStart(2,"0"),r=a.getMinutes().toString().padStart(2,"0"),s=a.getSeconds().toString().padStart(2,"0");return`${l}-${t}-${o} ${n}:${r}:${s}`}catch(a){return console.error("æ ¼å¼åŒ–æ—¥æœŸæ™‚é–“æ™‚ç™¼ç”ŸéŒ¯èª¤:",a),e}},ce=()=>{if(N.value.length>0){const e=N.value[0];if(e.documentId){const a=e.documentId;return a}}return null},pe=()=>{H(),Q(),q(),G()};return(a,l)=>{const t=(0,u.g2)("el-table-column"),o=(0,u.g2)("el-table"),n=(0,u.g2)("el-button"),r=(0,u.g2)("el-dialog");return(0,u.uX)(),(0,u.CE)(u.FK,null,[(0,u.Lk)("div",an,[(0,u.Lk)("div",ln,[(0,u.Lk)("div",tn,[(0,u.Lk)("h2",on,(0,L.v_)(a.$t("attendanceRecords")),1)]),(0,u.Lk)("div",nn,[(0,u.Lk)("i",{class:"pi pi-chevron-left",style:{cursor:"pointer","margin-right":"10px","font-size":"1rem","margin-top":"1 rem"},onClick:F}),(0,u.Lk)("span",rn,[(0,u.eW)((0,L.v_)(a.$t("employeeName"))+": ",1),(0,u.Lk)("span",sn,(0,L.v_)(i.value),1),(0,u.eW)(" "+(0,L.v_)(a.$t("attendanceDate"))+": ",1),(0,u.Lk)("span",un,(0,L.v_)(m.value),1)]),(0,u.Lk)("i",{class:"pi pi-chevron-right",style:(0,L.Tr)({cursor:"pointer",marginLeft:"10px",marginTop:"0rem",fontSize:"1rem",visibility:_.value?"visible":"hidden"}),onClick:C},null,4)]),(0,u.Lk)("div",dn,[(0,u.bF)((0,d.R1)(Va.A),{value:b.value,style:{width:"100%"}},{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(Ia.A),{field:"æ—¥æœŸ",header:a.$t("Date"),style:{width:"120px"}},null,8,["header"]),(0,u.bF)((0,d.R1)(Ia.A),{field:"ä¸Šç­",header:a.$t("ClockIn"),style:{width:"100px"}},null,8,["header"]),(0,u.bF)((0,d.R1)(Ia.A),{field:"ä¸‹ç­",header:a.$t("ClockOut"),style:{width:"100px"}},null,8,["header"]),e.personalMode||e.sysMode?(0,u.Q3)("",!0):((0,u.uX)(),(0,u.Wv)((0,d.R1)(Ia.A),{key:0,header:"è€ƒå‹¤",style:{width:"150px"}},{body:(0,u.k6)((e=>[(0,u.Lk)("div",null,[V(e.data)?((0,u.uX)(),(0,u.CE)("span",{key:0,class:"custom-tag custom-tag-warning clickable-tag",style:{"margin-right":"5px",cursor:"pointer"},onClick:a=>oe(e.data["æ—¥æœŸ"]),title:"é»žæ“ŠæŸ¥çœ‹åŠ ç­å–®æ“šè©³æƒ…"}," åŠ ç­ ",8,cn)):(0,u.Q3)("",!0),x(e.data)?((0,u.uX)(),(0,u.CE)("span",pn,(0,L.v_)(x(e.data)),1)):(0,u.Q3)("",!0),((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(B(e.data["æ—¥æœŸ"]),((e,a)=>((0,u.uX)(),(0,u.CE)("span",{key:`leave-${a}`,class:(0,L.C4)("ç‰¹ä¼‘"===e.leaveTypeName?"custom-tag clickable-tag":"custom-tag custom-tag-success clickable-tag"),style:(0,L.Tr)("ç‰¹ä¼‘"===e.leaveTypeName?"margin-right:5px; cursor: pointer; background-color: #D8BFD8; color: #6B46C1; border-color: #D8BFD8;":"margin-right:5px; cursor: pointer;"),onClick:a=>te(e),title:`é»žæ“ŠæŸ¥çœ‹è«‹å‡å–®æ“šè©³æƒ… (${e.documentId})`},(0,L.v_)(e.leaveTypeName),15,mn)))),128)),J(e.data["æ—¥æœŸ"])?((0,u.uX)(),(0,u.CE)("span",{key:2,class:"custom-tag clickable-tag",style:{"margin-right":"5px","background-color":"#5CADAD",color:"white","border-color":"#5CADAD",cursor:"pointer"},onClick:l[0]||(l[0]=e=>ue()),title:"é»žæ“ŠæŸ¥çœ‹ç•¶æœˆé¢±é¢¨å‡è¨˜éŒ„"},(0,L.v_)(J(e.data["æ—¥æœŸ"])),1)):(0,u.Q3)("",!0),Z(e.data["æ—¥æœŸ"])?((0,u.uX)(!0),(0,u.CE)(u.FK,{key:3},(0,u.pI)(ee(e.data["æ—¥æœŸ"]),((a,l)=>((0,u.uX)(),(0,u.CE)("span",{key:`correction-${l}`,class:"custom-tag clickable-tag",style:{"margin-right":"5px","background-color":"#FFAD86",color:"white","border-color":"#FFAD86",cursor:"pointer"},onClick:l=>se(e.data["æ—¥æœŸ"],a.documentId),title:`é»žæ“ŠæŸ¥çœ‹è£œåˆ·å¡å–®æ“šè©³æƒ… (${a.documentId})`},(0,L.v_)(ae(a)),9,vn)))),128)):(0,u.Q3)("",!0),E(e.data)?((0,u.uX)(),(0,u.CE)("span",bn,(0,L.v_)(a.$t("absenteeism")),1)):((0,u.uX)(),(0,u.CE)(u.FK,{key:5},[A(e.data)>0?((0,u.uX)(),(0,u.CE)("span",{key:0,class:(0,L.C4)(["custom-tag p-tag-rounded",{"custom-tag custom-tag-warn":"warn"===T(e.data),"custom-tag custom-tag-danger":"danger"===T(e.data)}]),style:{"margin-right":"5px"}},(0,L.v_)(W(e.data)),3)):(0,u.Q3)("",!0)],64))])])),_:1}))])),_:1},8,["value"])])]),e.personalMode?(0,u.Q3)("",!0):((0,u.uX)(),(0,u.CE)("div",gn,[(0,u.Lk)("span",yn,(0,L.v_)(a.$t("attendanceStatistics")),1),(0,u.Lk)("div",fn,[(0,u.Lk)("h3",hn,(0,L.v_)(a.$t("lateWithinThreeMinutes")),1),(0,u.Lk)("p",kn,(0,L.v_)(a.$t("records"))+"ï¼š"+(0,L.v_)(g.value.length),1),(0,u.Lk)("ul",_n,[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(g.value,(e=>((0,u.uX)(),(0,u.CE)("li",{key:e.æ—¥æœŸ,class:"stats-item"},[(0,u.Lk)("span",wn,(0,L.v_)(e.æ—¥æœŸ),1),(0,u.Lk)("span",Fn,(0,L.v_)(a.$t("totalMinutesLate"))+" "+(0,L.v_)(A(e))+" "+(0,L.v_)(a.$t("minutes")),1)])))),128))]),g.value.length>3?((0,u.uX)(),(0,u.CE)("div",Cn,[(0,u.Lk)("p",null,[(0,u.eW)((0,L.v_)(a.$t("accumulatedMinutesAfterFourth"))+"ï¼š",1),(0,u.Lk)("strong",null,(0,L.v_)(h.value),1),(0,u.eW)(" "+(0,L.v_)(a.$t("minutes")),1)])])):(0,u.Q3)("",!0)]),(0,u.Lk)("div",Dn,[(0,u.Lk)("h3",Ln,(0,L.v_)(a.$t("lateBeyondThreeMinutes")),1),(0,u.Lk)("p",Rn,(0,L.v_)(a.$t("records"))+"ï¼š"+(0,L.v_)(y.value.length),1),(0,u.Lk)("ul",Vn,[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(y.value,(e=>((0,u.uX)(),(0,u.CE)("li",{key:e.æ—¥æœŸ+"-over",class:"stats-item"},[(0,u.Lk)("span",In,(0,L.v_)(e.æ—¥æœŸ),1),(0,u.Lk)("span",xn,(0,L.v_)(a.$t("totalMinutesLate"))+" "+(0,L.v_)(A(e))+" "+(0,L.v_)(a.$t("minutes")),1)])))),128))])]),(0,u.Lk)("div",En,[(0,u.Lk)("p",null,[(0,u.eW)((0,L.v_)(a.$t("totalMinutesLate"))+" ",1),(0,u.Lk)("strong",null,(0,L.v_)(f.value),1),(0,u.eW)(" "+(0,L.v_)(a.$t("minutes")),1)])])]))]),K.value&&X.value?((0,u.uX)(),(0,u.Wv)(en,{key:0,visible:K.value,"onUpdate:visible":l[1]||(l[1]=e=>K.value=e),doc:X.value,buttonGroupPosition:"dialog",onRefreshList:pe},null,8,["visible","doc"])):(0,u.Q3)("",!0),(0,u.bF)(r,{modelValue:M.value,"onUpdate:modelValue":l[3]||(l[3]=e=>M.value=e),title:`${m.value} é¢±é¢¨å‡è¨˜éŒ„`,width:"700px","close-on-click-modal":!1},{footer:(0,u.k6)((()=>[(0,u.Lk)("span",Wn,[(0,u.bF)(n,{onClick:l[2]||(l[2]=e=>M.value=!1)},{default:(0,u.k6)((()=>l[5]||(l[5]=[(0,u.eW)("é—œé–‰")]))),_:1})])])),default:(0,u.k6)((()=>[0===$.value.length?((0,u.uX)(),(0,u.CE)("div",An,l[4]||(l[4]=[(0,u.Lk)("p",{style:{"text-align":"center",color:"#999",padding:"20px"}}," æœ¬æœˆä»½ç„¡é¢±é¢¨å‡è¨˜éŒ„ ",-1)]))):((0,u.uX)(),(0,u.CE)("div",Tn,[(0,u.bF)(o,{data:$.value,border:"",style:{width:"100%"}},{default:(0,u.k6)((()=>[(0,u.bF)(t,{prop:"leaveDate",label:"é¢±é¢¨å‡æ—¥æœŸ",width:"120"},{default:(0,u.k6)((e=>[(0,u.eW)((0,L.v_)(ie(e.row.leaveDate)),1)])),_:1}),(0,u.bF)(t,{prop:"startTime",label:"é–‹å§‹æ™‚é–“",width:"100"},{default:(0,u.k6)((e=>[(0,u.eW)((0,L.v_)(e.row.startTime||"å…¨å¤©"),1)])),_:1}),(0,u.bF)(t,{prop:"endTime",label:"çµæŸæ™‚é–“",width:"100"},{default:(0,u.k6)((e=>[(0,u.eW)((0,L.v_)(e.row.endTime||"å…¨å¤©"),1)])),_:1}),(0,u.bF)(t,{prop:"hours",label:"æ™‚æ•¸",width:"80"},{default:(0,u.k6)((e=>[(0,u.eW)((0,L.v_)(e.row.hours||"8")+" å°æ™‚ ",1)])),_:1}),(0,u.bF)(t,{prop:"createdBy",label:"å»ºç«‹è€…",width:"100"},{default:(0,u.k6)((e=>[(0,u.eW)((0,L.v_)(e.row.createdBy),1)])),_:1}),(0,u.bF)(t,{prop:"createdAt",label:"å»ºç«‹æ™‚é–“"},{default:(0,u.k6)((e=>[(0,u.eW)((0,L.v_)(de(e.row.createdAt)),1)])),_:1})])),_:1},8,["data"])]))])),_:1},8,["modelValue","title"]),(0,u.Q3)("",!0)],64)}}};const Un=(0,ie.A)(Sn,[["__scopeId","data-v-355de4d4"]]);var $n=Un;const Nn={class:"marquee-container"},Xn={class:"marquee-content"},Kn=["onClick"];var Mn={__name:"custom-marquee",emits:["closeMarquee","messageClick"],setup(e,{emit:a}){const l=a,t=(0,d.KR)([{text:"Mac Addressèˆ‡é›»è…¦æ¸…å–®è¡¨å–®å¡«å¯«(è«‹æ–¼2025/04/29å‰å®Œæˆ)",details:"è«‹è‡³ã€Œæ´»å‹•æˆ–çµ±è¨ˆã€å¡«å¯«"}]);function o(e){l("messageClick",e)}return(e,a)=>((0,u.uX)(),(0,u.CE)("div",null,[(0,u.Lk)("div",Nn,[(0,u.Lk)("div",Xn,[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(t.value,((e,a)=>((0,u.uX)(),(0,u.CE)("span",{key:a,class:"marquee-item",onClick:a=>o(e)},(0,L.v_)(e.text),9,Kn)))),128))])])]))}};const Pn=(0,ie.A)(Mn,[["__scopeId","data-v-4bce2790"]]);var On=Pn;let zn;function Bn(e){zn=e}const jn=()=>zn,Yn="EventsAndStatistics";var Qn={getMacAddress(){return jn().get(`${Yn}/mac-addresses`,{headers:{"Content-Type":"application/json"}})},getMacAddressWithEmpId(e){return jn().get(`${Yn}/mac-addresses-WithEmpId/${e}`,{headers:{"Content-Type":"application/json"}})},GetMacAddressesWithListDpt(e){const a=new URLSearchParams;return e.forEach((e=>a.append("dpt",e))),jn().get(`${Yn}/mac-addresses-WithListDpt`,{params:a,headers:{"Content-Type":"application/json"}})},GetMacAddressesWithDpt(e){return jn().get(`${Yn}/mac-addresses-WithListDpt`,{params:{dpt:e},headers:{"Content-Type":"application/json"}})},postMacAddress(e){return jn().post(`${Yn}/mac-addresses`,e,{headers:{"Content-Type":"application/json"}})},updateMacAddress(e,a){return jn().put(`${Yn}/mac-addresses/${e}`,a,{headers:{"Content-Type":"application/json"}})},deleteMacAddress(e){return jn().delete(`${Yn}/mac-addresses/${e}`,{headers:{"Content-Type":"application/json"}})},updateMacFormRegistration(e,a){return jn().patch(`${Yn}/mac-addresses/${e}/registration`,a,{headers:{"Content-Type":"application/json"}})},updateMacFormDisposal(e,a){return jn().patch(`${Yn}/mac-addresses/${e}/disposal`,a,{headers:{"Content-Type":"application/json"}})},getComputerInventorys(){return jn().get(`${Yn}/computer-inventory`,{headers:{"Content-Type":"application/json"}})},getComputerInventoryWithDptNameAndEmpName(e,a){return jn().get(`${Yn}/computer-inventory-WithDptNameAndEmpName`,{params:{dptName:e,empName:a},headers:{"Content-Type":"application/json"}})},getComputerInventoryWithDptFilter(e){return jn().get(`${Yn}/computer-inventory-filter/${e}`,{headers:{"Content-Type":"application/json"}})},getComputerInventoryWithListDpt(e,a){return jn().get(`${Yn}/computer-inventory-WithListDpt`,{params:{userId:e,dpt:a},paramsSerializer:e=>{const a=new URLSearchParams;return a.append("userId",e.userId),e.dpt.forEach((e=>a.append("dpts",e))),a.toString()},headers:{"Content-Type":"application/json"}})},getComputerInventoryWithDpt(e){return jn().get(`${Yn}/computer-inventory-WithListDpt`,{params:{dpt:e},headers:{"Content-Type":"application/json"}})},postComputerInventory(e){return jn().post(`${Yn}/computer-inventory`,e,{headers:{"Content-Type":"application/json"}})},deleteComputerInventory(e){return jn().delete(`${Yn}/computer-inventory/${e}`,{headers:{"Content-Type":"application/json"}})},updateComputerInventory(e,a){return jn().put(`${Yn}/computer-inventory/${e}`,a,{headers:{"Content-Type":"application/json"}})},updateComputerInventoryDisposal(e,a){return jn().patch(`${Yn}/computer-inventory/${e}/disposal`,a,{headers:{"Content-Type":"application/json"}})}};const Hn={style:{display:"flex","align-items":"center"}};var qn={__name:"TreeSelect-Department",props:{modelValue:{type:[String,Number,Array,Object],default:null},size:{type:String,default:"default"},multiMode:{type:Boolean,default:!1},hasCancel:{type:Boolean,default:!1},returnType:{type:String,default:"id"}},emits:["update:modelValue","change"],setup(e,{emit:a}){const l=e,t=a,o=(0,u.EW)((()=>"Middle"===l.size||"middle"===l.size?"default":l.size)),n=(0,d.KR)(l.multiMode?Array.isArray(l.modelValue)?l.modelValue:[]:l.modelValue),r=(0,d.KR)([]),s=(0,d.KR)([]);function i(e){const a=[],t={};function o(e){e.sort(((e,a)=>e.sortId-a.sortId)),e.forEach((e=>{e.children&&e.children.length>0&&o(e.children)}))}return e.forEach((e=>{t[e.id]={label:e.name,value:"name"===l.returnType?e.name:e.id,sortId:e.sortId||0,children:[],...e}})),e.forEach((e=>{const l=t[e.id];"-1"!==e.p_dpt_id&&t[e.p_dpt_id]?t[e.p_dpt_id].children.push(l):a.push(l)})),o(a),a}const c=async()=>{try{const e=await ja.getDepartmentData();r.value=e.data,s.value=i(r.value)}catch(e){console.error("å–å¾—éƒ¨é–€è³‡æ–™å¤±æ•—:",e)}},p=()=>{l.multiMode,n.value=[],t("update:modelValue",n.value),t("change",n.value)},m=(e,a)=>"name"===l.returnType?e.name&&e.name.toLowerCase().includes(a.toLowerCase()):e.id&&e.id.toString().toLowerCase().includes(a.toLowerCase());return(0,u.sV)((()=>{c()})),(0,u.wB)(n,(e=>{t("update:modelValue",e),t("change",e)})),(0,u.wB)((()=>l.modelValue),(e=>{n.value=l.multiMode?Array.isArray(e)?e:[]:e})),(e,a)=>{const t=(0,u.g2)("el-tree-select"),r=(0,u.g2)("el-icon"),i=(0,u.g2)("el-button");return(0,u.uX)(),(0,u.CE)("div",Hn,[(0,u.bF)(t,{modelValue:n.value,"onUpdate:modelValue":a[0]||(a[0]=e=>n.value=e),data:s.value,"render-after-expand":!1,"default-expand-all":"","check-strictly":!0,multiple:l.multiMode,placeholder:"è«‹é¸æ“‡éƒ¨é–€",style:{width:"210px"},size:o.value,"filter-method":m},null,8,["modelValue","data","multiple","size"]),l.hasCancel?((0,u.uX)(),(0,u.Wv)(i,{key:0,type:"text",onClick:p,style:{"margin-left":"10px"}},{default:(0,u.k6)((()=>[(0,u.bF)(r,null,{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.Close))])),_:1})])),_:1})):(0,u.Q3)("",!0)])}}};const Jn=qn;var Gn=Jn,Zn={__name:"TreeSelect-Area",props:{modelValue:{type:[String,Number,Object],default:""},returnType:{type:String,default:"id",validator:e=>["id","name"].includes(e)}},emits:["update:modelValue"],setup(e,{emit:a}){const l=e,t=a,o=(0,d.KR)(l.modelValue);(0,u.wB)(o,(e=>{t("update:modelValue",e)})),(0,u.wB)((()=>l.modelValue),(e=>{o.value=e}));const n=(0,d.KR)([]),r=(0,d.KR)([]);function s(e){const a={};e.forEach((e=>{a[e.area]||(a[e.area]=[]),a[e.area].push(e)}));for(const l in a)a[l].sort(((e,a)=>e.sortId-a.sortId));const t=Object.keys(a).map((e=>({label:e,value:e,sortId:a[e][0].sortId,children:a[e].map((e=>({label:e.region,value:"id"===l.returnType?e.id:e.region,sortId:e.sortId})))})));return t.sort(((e,a)=>e.sortId-a.sortId)),t}const i=async()=>{try{const e=await ja.getAreaData();n.value=e.data,r.value=s(n.value)}catch(e){console.error("å–å¾—åœ°å€è³‡æ–™å¤±æ•—:",e)}};return(0,u.sV)((()=>{i()})),(e,a)=>{const l=(0,u.g2)("el-tree-select");return(0,u.uX)(),(0,u.Wv)(l,{modelValue:o.value,"onUpdate:modelValue":a[0]||(a[0]=e=>o.value=e),data:r.value,"render-after-expand":!1,"default-expand-all":"",placeholder:"è«‹é¸æ“‡åœ°å€",style:{width:"200px"}},null,8,["modelValue","data"])}}};const er=Zn;var ar=er,lr=l(50595);const tr=(0,lr.A)();var or=tr;const nr={key:0,class:"flex items-center mb-4",style:{gap:"1rem"}},rr={style:{color:"#409EFF","text-decoration":"underline",cursor:"pointer"}},sr={key:0},ur={key:1},ir={key:0},dr={key:1},cr={key:0},pr={key:1},mr={key:0},vr={key:1},br={key:0},gr={key:1},yr={key:0},fr={key:1},hr={style:{"text-align":"center"}},kr={key:0},_r={key:1};var wr={__name:"MAC_Form_Detail",props:{sysMode:{type:Boolean,default:!1}},setup(e){const a=[{label:"éƒ¨é–€",value:"departmentId"},{label:"ä½¿ç”¨äººå“¡",value:"userId"},{label:"è£ç½®åç¨±",value:"deviceName"},{label:"æœ‰ç·š MAC Address",value:"cable_MacAddress"},{label:"ç„¡ç·š MAC Address",value:"wireless_MacAddress"},{label:"å€åŸŸ",value:"area_id"},{label:"å¡«å¯«æ™‚é–“",value:"createAt"},{label:"å¡«å¯«äººå“¡",value:"createBy"},{label:"å·²è¨»å†Š",value:"isRegistered"},{label:"è¨»å†Šæ™‚é–“",value:"registeredAt"},{label:"è¨»å†Šäºº",value:"registeredBy"},{label:"å·²å ±å»¢",value:"isDisposed"},{label:"å ±å»¢æ™‚é–“",value:"disposedAt"},{label:"å ±å»¢äºº",value:"disposedBy"},{label:"å‚™è¨»",value:"remark"}],l=(0,d.KR)(a[0].value),t=(0,d.KR)(""),o=(0,u.EW)((()=>{const e=t.value.trim().toLowerCase(),a=l.value;return e?m.value.filter((l=>{const t=l[a];return null!=t&&String(t).toLowerCase().includes(e)})):m.value})),n=e,r=(0,T.d)(),s=(0,S.k)(),c=(0,i.n)(),p=(0,d.KR)([]),m=(0,d.KR)([]),v=(0,d.KR)(null),b=e=>new Promise(((a,l)=>{if(!e.departmentId||""===e.departmentId.trim())return l("è«‹è¼¸å…¥éƒ¨é–€");if(!e.userId||""===e.userId.trim())return l("è«‹è¼¸å…¥ä½¿ç”¨äººå“¡");if(!e.deviceName||""===e.deviceName.trim())return l("è«‹è¼¸å…¥è£ç½®åç¨±");const t=/^([0-9A-F]{2}-){5}[0-9A-F]{2}$/;return e.cable_MacAddress&&""!==e.cable_MacAddress.trim()&&!t.test(e.cable_MacAddress)?l("æœ‰ç·š MAC Address æ ¼å¼ä¸æ­£ç¢º (ä¾‹å¦‚: 00-1A-2B-3C-4D-5E)"):e.wireless_MacAddress&&""!==e.wireless_MacAddress.trim()&&!t.test(e.wireless_MacAddress)?l("ç„¡ç·š MAC Address æ ¼å¼ä¸æ­£ç¢º (ä¾‹å¦‚: 00-1A-2B-3C-4D-5E)"):e.area_id&&""!==e.area_id.trim()?void a():l("è«‹è¼¸å…¥å€åŸŸç·¨è™Ÿ")}));function g(e){const a={...e};return Object.keys(a).forEach((e=>{"string"===typeof a[e]&&""===a[e].trim()&&(a[e]=null),a.createAt=new Date((new Date).toLocaleString("en-US",{timeZone:"Asia/Taipei"})),a.updateAt=new Date((new Date).toLocaleString("en-US",{timeZone:"Asia/Taipei"})),a.updateBy=s.userId})),a}const y=async e=>{if(e){let a=await Qn.GetMacAddressesWithDpt(e);Array.isArray(a.data)&&(m.value=a.data.map((e=>({...e,isRegistered:"True"===e.isRegistered||!0===e.isRegistered,isDisposed:"True"===e.isDisposed||!0===e.isDisposed,createAt:V(e.createAt),registeredAt:V(e.registeredAt),disposedAt:V(e.disposedAt)}))))}else m.value=[...p.value]},f=async()=>{try{c.user.roles.includes("RO0000")?await R():c.user.managers.length>0?await C():await F(),m.value=[...p.value]}catch(e){console.error("MAC Address å–å¾—å¤±æ•—:",e)}},h=async e=>{try{const a={newStatus:e.isRegistered,userName:s.userName};let l=await Qn.updateMacFormRegistration(e.nanoId,a);if(l){r.add({severity:"success",summary:"å·²è¨»å†Šè³‡æ–™æ›´æ–°æˆåŠŸï¼",detail:"",life:3e3});const a=m.value.findIndex((a=>a.nanoId===e.nanoId));if(-1!==a){const e={...m.value[a],...l.data,createAt:V(l.data.createAt||m.value[a].createAt),registeredAt:V(l.data.registeredAt||m.value[a].registeredAt),disposedAt:V(l.data.disposedAt||m.value[a].disposedAt)};m.value[a]=e}}else r.add({severity:"warn",summary:"ä¸æ˜ŽåŽŸå› éŒ¯èª¤ï¼",detail:"",life:3e3})}catch(a){console.error("æ›´æ–°å·²è¨»å†Šç‹€æ…‹å¤±æ•—:",a),r.add({severity:"error",summary:"å·²è¨»å†Šè³‡æ–™æ›´æ–°å¤±æ•—ï¼",detail:"",life:3e3})}},k=async e=>{try{const a={newStatus:e.isDisposed,userName:s.userName};let l=await Qn.updateMacFormDisposal(e.nanoId,a);if(l&&l.data){r.add({severity:"success",summary:"å·²å ±å»¢è³‡æ–™æ›´æ–°æˆåŠŸï¼",detail:"",life:3e3});const a=m.value.findIndex((a=>a.nanoId===e.nanoId));if(-1!==a){const e={...m.value[a],...l.data,createAt:V(l.data.createAt||m.value[a].createAt),registeredAt:V(l.data.registeredAt||m.value[a].registeredAt),disposedAt:V(l.data.disposedAt||m.value[a].disposedAt)};m.value[a]=e}}else r.add({severity:"warn",summary:"ä¸æ˜ŽåŽŸå› éŒ¯èª¤ï¼",detail:"",life:3e3})}catch(a){console.error("æ›´æ–°å·²å ±å»¢ç‹€æ…‹å¤±æ•—:",a),r.add({severity:"error",summary:"å·²å ±å»¢è³‡æ–™æ›´æ–°å¤±æ•—ï¼",detail:"",life:3e3})}},_=async(e,a)=>{if(a.isEditing){const e={...a};delete e.isEditing;const t=g(e);try{await b(t),await Qn.updateMacAddress(a.nanoId,t);const e=m.value.findIndex((e=>e.nanoId===a.nanoId));-1!==e&&(m.value[e]={...t}),D.nk.success("æ›´æ–°æˆåŠŸ")}catch(l){console.error("æ›´æ–°å¤±æ•—:",l),D.nk.error(l)}}else a.isEditing=!0},w=async(e,a)=>{try{await Qn.deleteMacAddress(a.nanoId);const e=m.value.findIndex((e=>e.nanoId===a.nanoId));-1!==e&&m.value.splice(e,1),D.nk.success("åˆªé™¤æˆåŠŸ")}catch(l){console.error("åˆªé™¤å¤±æ•—:",l),D.nk.error("åˆªé™¤å¤±æ•—")}},F=async()=>{try{const e=await Qn.getMacAddressWithEmpId(s.userId);Array.isArray(e.data)?p.value=e.data.map((e=>({...e,isRegistered:"True"===e.isRegistered||!0===e.isRegistered,isDisposed:"True"===e.isDisposed||!0===e.isDisposed,createAt:V(e.createAt),registeredAt:V(e.registeredAt),disposedAt:V(e.disposedAt)}))):p.value=[]}catch(e){console.error("MAC Address å–å¾—å¤±æ•—:",e),p.value=[]}},C=async()=>{try{const e=await Qn.GetMacAddressesWithListDpt(c.user.subDepartments);Array.isArray(e.data)?p.value=e.data.map((e=>({...e,isRegistered:"True"===e.isRegistered||!0===e.isRegistered,isDisposed:"True"===e.isDisposed||!0===e.isDisposed,createAt:V(e.createAt),registeredAt:V(e.registeredAt),disposedAt:V(e.disposedAt)}))):p.value=[]}catch(e){console.error("MAC Address å–å¾—å¤±æ•—:",e),p.value=[]}},R=async()=>{try{const e=await Qn.getMacAddress();Array.isArray(e.data)?p.value=e.data.map((e=>({...e,createAt:V(e.createAt),registeredAt:V(e.registeredAt),disposedAt:V(e.disposedAt)}))):p.value=[]}catch(e){console.error("MAC Address å–å¾—å¤±æ•—:",e)}};function V(e){if(!e)return"";const a=new Date(e);return isNaN(a.getTime())?"":a.toLocaleString("zh-TW",{timeZone:"Asia/Taipei"})}return(0,u.sV)((async()=>{await f(),or.on("dataUpdated",(async()=>{await f()}))})),(r,s)=>{const i=(0,u.g2)("el-option"),p=(0,u.g2)("el-select"),m=(0,u.g2)("el-input"),b=(0,u.g2)("el-icon"),g=(0,u.g2)("el-popover"),f=(0,u.g2)("el-table-column"),F=(0,u.g2)("el-button"),C=(0,u.g2)("el-checkbox"),D=(0,u.g2)("el-table");return(0,u.uX)(),(0,u.CE)("div",null,[(0,u.Lk)("div",{style:(0,L.Tr)([{"max-width":"1000px",margin:"0 auto"},{"max-width":e.sysMode?"200rem":"80rem","margin-left":e.sysMode?"-25rem":"0rem"}])},[e.sysMode?((0,u.uX)(),(0,u.CE)("div",nr,[(0,u.bF)(p,{modelValue:l.value,"onUpdate:modelValue":s[0]||(s[0]=e=>l.value=e),placeholder:"é¸æ“‡æŸ¥è©¢æ¬„ä½",style:{width:"100px"}},{default:(0,u.k6)((()=>[((0,u.uX)(),(0,u.CE)(u.FK,null,(0,u.pI)(a,(e=>(0,u.bF)(i,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),64))])),_:1},8,["modelValue"]),(0,u.bF)(m,{modelValue:t.value,"onUpdate:modelValue":s[1]||(s[1]=e=>t.value=e),placeholder:"è¼¸å…¥é—œéµå­—",clearable:"",style:{width:"200px"}},null,8,["modelValue"])])):(0,u.Q3)("",!0),(0,u.bF)(D,{class:"workflow-form",data:o.value,style:{width:"100%"}},{default:(0,u.k6)((()=>[(0,u.bF)(f,{label:"éƒ¨é–€",prop:"departmentId",width:110},(0,u.eX)({default:(0,u.k6)((e=>[e.row.isEditing?((0,u.uX)(),(0,u.CE)("div",sr,[(0,u.bF)(Gn,{"return-type":"name",modelValue:e.row.departmentId,"onUpdate:modelValue":a=>e.row.departmentId=a},null,8,["modelValue","onUpdate:modelValue"])])):((0,u.uX)(),(0,u.CE)("div",ur,(0,L.v_)(e.row.departmentId),1))])),_:2},[!0===n.sysMode?{name:"header",fn:(0,u.k6)((()=>[(0,u.bF)(g,{placement:"bottom-start",title:"é¸æ“‡éƒ¨é–€",width:300,trigger:"click"},{reference:(0,u.k6)((()=>[(0,u.Lk)("span",rr,[s[3]||(s[3]=(0,u.eW)(" éƒ¨é–€ ")),(0,u.bF)(b,null,{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.Filter))])),_:1})])])),default:(0,u.k6)((()=>[(0,u.bF)(Gn,{modelValue:v.value,"onUpdate:modelValue":s[2]||(s[2]=e=>v.value=e),"has-cancel":!0,multiMode:!1,onChange:y},null,8,["modelValue"])])),_:1})])),key:"0"}:void 0]),1024),(0,u.bF)(f,{label:"ä½¿ç”¨äººå“¡",prop:"userId",width:80},{default:(0,u.k6)((e=>[e.row.isEditing?((0,u.uX)(),(0,u.CE)("div",ir,[(0,u.bF)(m,{modelValue:e.row.userId,"onUpdate:modelValue":a=>e.row.userId=a,size:"small"},null,8,["modelValue","onUpdate:modelValue"])])):((0,u.uX)(),(0,u.CE)("div",dr,(0,L.v_)(e.row.userId),1))])),_:1}),(0,u.bF)(f,{label:"è£ç½®åç¨±",prop:"deviceName",width:120},{default:(0,u.k6)((e=>[e.row.isEditing?((0,u.uX)(),(0,u.CE)("div",cr,[(0,u.bF)(m,{modelValue:e.row.deviceName,"onUpdate:modelValue":a=>e.row.deviceName=a,size:"small"},null,8,["modelValue","onUpdate:modelValue"])])):((0,u.uX)(),(0,u.CE)("div",pr,(0,L.v_)(e.row.deviceName),1))])),_:1}),(0,u.bF)(f,{label:"æœ‰ç·šMAC Address",prop:"cable_MacAddress",width:170},{default:(0,u.k6)((e=>[e.row.isEditing?((0,u.uX)(),(0,u.CE)("div",mr,[(0,u.bF)(m,{modelValue:e.row.cable_MacAddress,"onUpdate:modelValue":a=>e.row.cable_MacAddress=a,size:"small"},null,8,["modelValue","onUpdate:modelValue"])])):((0,u.uX)(),(0,u.CE)("div",vr,(0,L.v_)(e.row.cable_MacAddress),1))])),_:1}),(0,u.bF)(f,{label:"ç„¡ç·šMAC Address",prop:"wireless_MacAddress",width:170},{default:(0,u.k6)((e=>[e.row.isEditing?((0,u.uX)(),(0,u.CE)("div",br,[(0,u.bF)(m,{modelValue:e.row.wireless_MacAddress,"onUpdate:modelValue":a=>e.row.wireless_MacAddress=a,size:"small"},null,8,["modelValue","onUpdate:modelValue"])])):((0,u.uX)(),(0,u.CE)("div",gr,(0,L.v_)(e.row.wireless_MacAddress),1))])),_:1}),(0,u.bF)(f,{label:"å€åŸŸ",prop:"area_id",width:100},{default:(0,u.k6)((e=>[e.row.isEditing?((0,u.uX)(),(0,u.CE)("div",yr,[(0,u.bF)(ar,{modelValue:e.row.area_id,"onUpdate:modelValue":a=>e.row.area_id=a},null,8,["modelValue","onUpdate:modelValue"])])):((0,u.uX)(),(0,u.CE)("div",fr,(0,L.v_)(e.row.area_id),1))])),_:1}),(0,u.bF)(f,{label:"å¡«å¯«æ™‚é–“",prop:"createAt",width:180},{default:(0,u.k6)((e=>[(0,u.eW)((0,L.v_)(e.row.createAt),1)])),_:1}),(0,u.bF)(f,{label:"å¡«å¯«äººå“¡",prop:"createBy",width:80},{default:(0,u.k6)((e=>[(0,u.bF)(yl,{"employee-id":e.row.createBy},null,8,["employee-id"])])),_:1}),(0,d.R1)(c).user.managers.length>0||n.sysMode?((0,u.uX)(),(0,u.Wv)(f,{key:0,label:"æ“ä½œ",width:140},{default:(0,u.k6)((e=>[(0,u.Lk)("div",hr,[(0,u.bF)(F,{size:"small",onClick:a=>_(e.$index,e.row)},{default:(0,u.k6)((()=>[(0,u.eW)((0,L.v_)(e.row.isEditing?"å®Œæˆ":"ç·¨è¼¯"),1)])),_:2},1032,["onClick"]),(0,u.bF)(F,{size:"small",type:"danger",onClick:a=>w(e.$index,e.row)},{default:(0,u.k6)((()=>s[4]||(s[4]=[(0,u.eW)(" åˆªé™¤ ")]))),_:2},1032,["onClick"])])])),_:1})):(0,u.Q3)("",!0),!0===n.sysMode?((0,u.uX)(),(0,u.CE)(u.FK,{key:1},[(0,u.bF)(f,{label:"å·²è¨»å†Š",prop:"isRegistered",width:70},{default:(0,u.k6)((e=>[(0,u.bF)(C,{modelValue:e.row.isRegistered,"onUpdate:modelValue":a=>e.row.isRegistered=a,onChange:a=>h(e.row)},null,8,["modelValue","onUpdate:modelValue","onChange"])])),_:1}),(0,u.bF)(f,{label:"è¨»å†Šæ™‚é–“",prop:"registeredAt",width:100},{default:(0,u.k6)((e=>[(0,u.eW)((0,L.v_)(e.row.registeredAt),1)])),_:1}),(0,u.bF)(f,{label:"è¨»å†Šäºº",prop:"registeredBy",width:70},{default:(0,u.k6)((e=>[(0,u.eW)((0,L.v_)(e.row.registeredBy),1)])),_:1}),(0,u.bF)(f,{label:"å·²å ±å»¢",prop:"isDisposed",width:70,"header-cell-style":{textAlign:"center"}},{default:(0,u.k6)((e=>[(0,u.bF)(C,{modelValue:e.row.isDisposed,"onUpdate:modelValue":a=>e.row.isDisposed=a,onChange:a=>k(e.row),style:{display:"block",margin:"0 auto"}},null,8,["modelValue","onUpdate:modelValue","onChange"])])),_:1}),(0,u.bF)(f,{label:"å ±å»¢æ™‚é–“",prop:"disposedAt",width:100},{default:(0,u.k6)((e=>[(0,u.eW)((0,L.v_)(e.row.disposedAt),1)])),_:1}),(0,u.bF)(f,{label:"å ±å»¢äºº",prop:"disposedBy",width:70},{default:(0,u.k6)((e=>[(0,u.eW)((0,L.v_)(e.row.disposedBy),1)])),_:1}),(0,u.bF)(f,{label:"å‚™è¨»",prop:"remark",width:160},{default:(0,u.k6)((e=>[e.row.isEditing?((0,u.uX)(),(0,u.CE)("div",kr,[(0,u.bF)(m,{modelValue:e.row.remark,"onUpdate:modelValue":a=>e.row.remark=a,size:"small"},null,8,["modelValue","onUpdate:modelValue"])])):((0,u.uX)(),(0,u.CE)("div",_r,(0,L.v_)(e.row.remark),1))])),_:1})],64)):(0,u.Q3)("",!0)])),_:1},8,["data"])],4)])}}};const Fr=wr;var Cr=Fr,Dr=l(84887);const Lr={class:"mac-container"},Rr=["onUpdate:modelValue","onInput","onKeydown","disabled"],Vr={key:0,class:"mac-separator"},Ir={class:"mac-container"},xr=["onUpdate:modelValue","onInput","onKeydown","disabled"],Er={key:0,class:"mac-separator"};var Ar={__name:"Fill_Mac_Form",setup(e){const a=(0,S.k)(),l=(0,T.d)(),o=(0,d.KR)("default"),n=(0,d.KR)(null),r=()=>m.value.some((e=>""!==e.trim())),s=()=>v.value.some((e=>""!==e.trim())),i=(0,d.Kh)({NanoId:"",DepartmentId:"",UserId:"",DeviceName:"",Cable_MacAddress:null,Wireless_MacAddress:null,isRegistered:!1,isObsoleted:!1,createAt:new Date((new Date).toLocaleString("en-US",{timeZone:"Asia/Taipei"})),createBy:a.userId,updateAt:null,updateBy:null,area_id:""}),c=(0,d.KR)(),p=(0,d.KR)(),m=(0,d.KR)(["","","","","",""]),v=(0,d.KR)(["","","","","",""]);(0,u.wB)(m,(e=>{i.Cable_MacAddress=e.join("-").toUpperCase()}),{deep:!0}),(0,u.wB)(v,(e=>{i.Wireless_MacAddress=e.join("-").toUpperCase()}),{deep:!0}),(0,u.wB)([p,c],(([e,a])=>{e&&(v.value=["","","","","",""]),a&&(m.value=["","","","","",""])}));const b=(e,a,l)=>{let t=e.target.value.toUpperCase().replace(/[^0-9A-F]/g,"");t.length>2&&(t=t.slice(0,2)),"cable"===l?m.value[a]=t:"wireless"===l&&(v.value[a]=t)},g=(e,a,l)=>{let t="cable"===l?m.value:v.value;"Backspace"===e.key&&!t[a]&&a>0&&(e.preventDefault(),"cable"===l?m.value[a-1]="":"wireless"===l&&(v.value[a-1]=""),(0,u.dY)((()=>{e.target.previousElementSibling?.previousElementSibling?.focus()})))},y=(0,d.Kh)({DepartmentId:[{required:!0,message:"è«‹è¼¸å…¥éƒ¨é–€",trigger:"blur"}],UserId:[{required:!0,message:"è«‹è¼¸å…¥äººå“¡",trigger:"blur"}],DeviceName:[{required:!0,message:"è«‹è¼¸å…¥è£ç½®åç¨±",trigger:"blur"}],Cable_MacAddress:[{validator:(e,a,l)=>{if(!r())return l();c.value||/^([0-9A-F]{2}-){5}[0-9A-F]{2}$/.test(a)?l():l(new Error("æœ‰ç·š MAC Address æ ¼å¼ä¸æ­£ç¢º (ä¾‹å¦‚: 00-1A-2B-3C-4D-5E)"))},trigger:"blur"}],Wireless_MacAddress:[{validator:(e,a,l)=>{if(!s())return l();p.value||/^([0-9A-F]{2}-){5}[0-9A-F]{2}$/.test(a)?l():l(new Error("ç„¡ç·š MAC Address æ ¼å¼ä¸æ­£ç¢º (ä¾‹å¦‚: 00-1A-2B-3C-4D-5E)"))},trigger:"blur"}],isRegistered:!1,isObsoleted:!1,area_id:[{required:!0,message:"è«‹è¼¸å…¥å€åŸŸç·¨è™Ÿ",trigger:"blur"}]}),f=async e=>{e&&(i.NanoId||(i.NanoId=(0,Dr.Ak)(10)),c.value&&(i.Cable_MacAddress=""),p.value&&(i.Wireless_MacAddress=""),await e.validate(((a,t)=>{a?(console.log("é©—è­‰é€šéŽ!",i),Qn.postMacAddress(i).then((()=>{l.add({severity:"success",summary:"Mac Address",detail:"æ–°å¢žæˆåŠŸï¼",life:5e3}),e.resetFields(),m.value=["","","","","",""],v.value=["","","","","",""],i.NanoId="",or.emit("dataUpdated")})).catch((e=>{console.error("MAC Address æ–°å¢žå¤±æ•—:",e)}))):console.log("é©—è­‰éŒ¯èª¤!",t)})))},h=e=>{e&&(e.resetFields(),m.value=["","","","","",""],v.value=["","","","","",""])};return(e,a)=>{const l=(0,u.g2)("el-form-item"),r=(0,u.g2)("el-input"),s=(0,u.g2)("el-button"),k=(0,u.g2)("el-checkbox"),_=(0,u.g2)("el-form");return(0,u.uX)(),(0,u.CE)("div",null,[a[12]||(a[12]=(0,u.Lk)("div",{style:{"font-size":"1.5rem"}},[(0,u.Lk)("div",null,"æ“ä½œæµç¨‹å¦‚ä¸‹ï¼š"),(0,u.Lk)("div",null,'1.æŒ‰ä¸‹ Windows é”® + R é”®ï¼Œé–‹å•Ÿ"åŸ·è¡Œ"ã€‚'),(0,u.Lk)("div",null,'2.åœ¨"åŸ·è¡Œ"ä¸­è¼¸å…¥ "cmd"ï¼Œä¸¦è¼¸å…¥ "ipconfig /all"ï¼Œç„¶å¾ŒæŒ‰ Enter éµã€‚'),(0,u.Lk)("div",null,"3.ä¾ç…§åœ–ç‰‡èªªæ˜Žå°‡Macç¢¼å¡«å…¥è¡¨æ ¼")],-1)),(0,u.bF)(_,{ref_key:"macFormRef",ref:n,style:{"max-width":"600px"},model:i,rules:y,"label-width":"9rem",class:"workflow-form",size:o.value,"status-icon":""},{default:(0,u.k6)((()=>[(0,u.bF)(l,{label:"éƒ¨é–€",prop:"DepartmentId"},{default:(0,u.k6)((()=>[(0,u.bF)(Gn,{modelValue:i.DepartmentId,"onUpdate:modelValue":a[0]||(a[0]=e=>i.DepartmentId=e)},null,8,["modelValue"])])),_:1}),(0,u.bF)(l,{label:"äººå“¡",prop:"UserId"},{default:(0,u.k6)((()=>[(0,u.bF)(r,{style:{width:"200px"},modelValue:i.UserId,"onUpdate:modelValue":a[1]||(a[1]=e=>i.UserId=e),placeholder:"è«‹è¼¸å…¥äººå“¡"},null,8,["modelValue"])])),_:1}),(0,u.bF)(l,{label:"è£ç½®é¡žåž‹",prop:"DeviceName"},{default:(0,u.k6)((()=>[(0,u.bF)(r,{style:{width:"200px"},modelValue:i.DeviceName,"onUpdate:modelValue":a[2]||(a[2]=e=>i.DeviceName=e),placeholder:"ç­†é›»ã€æ¡Œé›»ã€å¹³æ¿"},null,8,["modelValue"])])),_:1}),(0,u.bF)(l,{label:"å€åŸŸç·¨è™Ÿ",prop:"area_id"},{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(ar),{returnType:"name",modelValue:i.area_id,"onUpdate:modelValue":a[3]||(a[3]=e=>i.area_id=e)},null,8,["modelValue"])])),_:1}),(0,u.bF)(l,{label:"æœ‰ç·šMAC Address",prop:"Cable_MacAddress"},{default:(0,u.k6)((()=>[(0,u.Lk)("div",Lr,[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(m.value,((e,a)=>((0,u.uX)(),(0,u.CE)(u.FK,{key:"cable-"+a},[(0,u.bo)((0,u.Lk)("input",{"onUpdate:modelValue":e=>m.value[a]=e,class:"mac-input",type:"text",maxlength:"2",onInput:e=>b(e,a,"cable"),onKeydown:e=>g(e,a,"cable"),disabled:c.value},null,40,Rr),[[t.Jo,m.value[a]]]),a<5?((0,u.uX)(),(0,u.CE)("span",Vr,"-")):(0,u.Q3)("",!0)],64)))),128))])])),_:1}),(0,u.bF)(l,{label:"ç„¡ç·šMAC Address",prop:"Wireless_MacAddress"},{default:(0,u.k6)((()=>[(0,u.Lk)("div",Ir,[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(v.value,((e,a)=>((0,u.uX)(),(0,u.CE)(u.FK,{key:"wireless-"+a},[(0,u.bo)((0,u.Lk)("input",{"onUpdate:modelValue":e=>v.value[a]=e,class:"mac-input",type:"text",maxlength:"2",onInput:e=>b(e,a,"wireless"),onKeydown:e=>g(e,a,"wireless"),disabled:p.value},null,40,xr),[[t.Jo,v.value[a]]]),a<5?((0,u.uX)(),(0,u.CE)("span",Er,"-")):(0,u.Q3)("",!0)],64)))),128))])])),_:1}),(0,u.bF)(l,null,{default:(0,u.k6)((()=>[(0,u.bF)(s,{type:"primary",onClick:a[4]||(a[4]=e=>f(n.value))},{default:(0,u.k6)((()=>a[8]||(a[8]=[(0,u.eW)("æäº¤")]))),_:1}),(0,u.bF)(s,{onClick:a[5]||(a[5]=e=>h(n.value))},{default:(0,u.k6)((()=>a[9]||(a[9]=[(0,u.eW)("æ¸…ç©º")]))),_:1})])),_:1}),(0,u.bo)((0,u.bF)(l,{label:"å·²è¨»å†Š",prop:"isRegistered"},{default:(0,u.k6)((()=>[(0,u.bF)(k,{modelValue:i.isRegistered,"onUpdate:modelValue":a[6]||(a[6]=e=>i.isRegistered=e),"true-label":"Y","false-label":"N"},{default:(0,u.k6)((()=>a[10]||(a[10]=[(0,u.eW)(" å·²è¨»å†Š ")]))),_:1},8,["modelValue"])])),_:1},512),[[t.aG,!1]]),(0,u.bo)((0,u.bF)(l,{label:"å·²å ±å»¢",prop:"isObsoleted"},{default:(0,u.k6)((()=>[(0,u.bF)(k,{modelValue:i.isObsoleted,"onUpdate:modelValue":a[7]||(a[7]=e=>i.isObsoleted=e),"true-label":"Y","false-label":"N"},{default:(0,u.k6)((()=>a[11]||(a[11]=[(0,u.eW)(" å·²å ±å»¢ ")]))),_:1},8,["modelValue"])])),_:1},512),[[t.aG,!1]])])),_:1},8,["model","rules","size"])])}}};const Tr=(0,ie.A)(Ar,[["__scopeId","data-v-41ca4d0e"]]);var Wr=Tr,Sr=l(57606);const Ur={class:"container"},$r={key:0,style:{width:"45rem"}};var Nr={__name:"MacForm",props:{sysMode:{type:Boolean,default:!1}},setup(e){const a=e;return(t,o)=>((0,u.uX)(),(0,u.CE)("div",Ur,[a.sysMode?(0,u.Q3)("",!0):((0,u.uX)(),(0,u.CE)("div",$r,[(0,u.bF)((0,d.R1)(Sr.A),{alt:"Image",src:l(75659),preview:""},null,8,["src"]),o[0]||(o[0]=(0,u.Lk)("div",{style:{width:"40rem"}},null,-1))])),(0,u.Lk)("div",null,[a.sysMode?(0,u.Q3)("",!0):((0,u.uX)(),(0,u.Wv)(Wr,{key:0})),(0,u.bF)(Cr,{sysMode:e.sysMode,style:(0,L.Tr)(e.sysMode?{"margin-left":"25rem"}:{})},null,8,["sysMode","style"])])]))}};const Xr=(0,ie.A)(Nr,[["__scopeId","data-v-290c9ebe"]]);var Kr=Xr;const Mr={class:"flex items-center justify-between px-6 pt-4 shrink-0"},Pr={class:"overflow-y-auto flex-1 p-4"},Or={class:"menu-list"},zr=["onClick"],Br={key:0,class:"submenu-list pl-4"};var jr={__name:"SlidePanel",props:{drawerVisible:{type:Boolean,default:!1},width:{type:String,default:"300px"}},emits:["update:visible"],setup(e,{emit:a}){const l=e,o=a;function n(){o("update:visible",!1)}const r=(0,d.Kh)([{title:"FAVORITES",open:!1,children:["Dashboard","Bookmarks"]},{title:"REPORTS",open:!1,children:["Revenue","Expenses"]},{title:"TEAM",open:!1,children:["Members","Roles"]}]);function s(e){r[e].open=!r[e].open}return(a,o)=>((0,u.uX)(),(0,u.Wv)(t.eB,{name:"slide-panel"},{default:(0,u.k6)((()=>[l.drawerVisible?((0,u.uX)(),(0,u.CE)("div",{key:0,class:"slide-panel flex flex-col",style:(0,L.Tr)({width:e.width}),onKeydown:o[1]||(o[1]=(0,t.jR)((e=>n()),["esc"])),tabindex:"0"},[(0,u.Lk)("div",Mr,[o[3]||(o[3]=(0,u.Lk)("span",{class:"inline-flex items-center gap-2"},[(0,u.Lk)("svg",{width:"35",height:"40"}),(0,u.Lk)("span",{class:"font-semibold text-2xl text-secondary"},"DAE")],-1)),(0,u.Lk)("button",{onClick:o[0]||(o[0]=e=>n()),class:"p-2 rounded border"},o[2]||(o[2]=[(0,u.Lk)("i",{class:"pi pi-times"},null,-1)]))]),(0,u.Lk)("div",Pr,[(0,u.Lk)("ul",Or,[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(r,((e,a)=>((0,u.uX)(),(0,u.CE)("li",{key:a,class:"menu-item"},[(0,u.Lk)("div",{class:"menu-title flex justify-between items-center cursor-pointer p-2",onClick:e=>s(a)},[(0,u.Lk)("span",null,(0,L.v_)(e.title),1),(0,u.Lk)("i",{class:(0,L.C4)(["pi",e.open?"pi-chevron-down":"pi-chevron-right"])},null,2)],8,zr),(0,u.bF)(t.eB,{name:"slide-toggle"},{default:(0,u.k6)((()=>[e.open?((0,u.uX)(),(0,u.CE)("ul",Br,[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(e.children,((e,a)=>((0,u.uX)(),(0,u.CE)("li",{key:a,class:"submenu-item p-2 cursor-pointer hover:bg-gray-100"},[(0,u.Lk)("span",null,(0,L.v_)(e),1)])))),128))])):(0,u.Q3)("",!0)])),_:2},1024)])))),128))])])],36)):(0,u.Q3)("",!0)])),_:1}))}};const Yr=(0,ie.A)(jr,[["__scopeId","data-v-7510106d"]]);var Qr=Yr;const Hr={key:0},qr={key:1},Jr={class:"header"},Gr={class:"wrapper"},Zr={class:"card flex justify-center"},es={class:"flex justify-content-center"},as={style:{width:"100%"}},ls={key:0};var ts={__name:"HomePage",setup(e){const a=(0,i.n)(),l=(a.user.permissions,(0,d.KR)(!0),(0,d.KR)(!0));function t(){l.value=!1}const o=(0,d.KR)(!1),n=(0,d.KR)(!1),r=(0,d.KR)(!1),s=(0,d.KR)(null);function c(e){"Mac Addressè¡¨å–®æ¢å¯«"===e.text?b.push({name:"MacForm"}):(s.value=e,n.value=!0)}const p=(0,d.KR)(!1),v=()=>{const e=window.innerWidth,a=window.innerHeight,l=e/a;p.value=e<=768&&l<1};(0,u.sV)((()=>{v(),window.addEventListener("resize",v)})),(0,u.hi)((()=>{window.removeEventListener("resize",v)}));const b=(0,C.rd)(),g=(0,S.k)();(0,u.wB)((()=>g.userId),(e=>{e||console.log("å·²ç™»å‡ºä½¿ç”¨è€…ï¼Œè«‹é‡æ–°ç™»å…¥")}));const y=(0,d.KR)(!1),f=((0,u.EW)((()=>({position:"fixed",top:l.value?"10rem":"7rem",left:y.value?"200px":"0px",zIndex:800,transition:"top 0.3s ease, left 0.3s ease",display:"flex",flexDirection:"column",gap:"0.5rem"}))),(0,u.EW)((()=>({marginLeft:y.value?"200px":"0px",transition:"margin-left 0.3s ease"})))),h=(0,d.KR)("dev");return(0,u.sV)((()=>{const e=setInterval((()=>{m().get("userId")||g.clearUserInfo()}),2e3);(0,u.hi)((()=>{clearInterval(e)}))})),(0,u.wB)(o,(e=>console.log("drawerVisible=",e))),(e,a)=>{const i=(0,u.g2)("router-view"),p=(0,u.g2)("el-button"),m=(0,u.g2)("el-dialog");return"demo"==h.value?((0,u.uX)(),(0,u.CE)("div",Hr,[(0,u.bF)((0,d.R1)(E.A),{class:"change-mode",onClick:a[0]||(a[0]=e=>h.value="demo"===h.value?"dev":"demo")},{default:(0,u.k6)((()=>a[6]||(a[6]=[(0,u.eW)("åˆ‡æ›")]))),_:1}),(0,u.bF)($n)])):((0,u.uX)(),(0,u.CE)("div",qr,[(0,u.Lk)("div",Jr,[(0,u.bF)(ka),l.value?((0,u.uX)(),(0,u.Wv)(On,{key:0,onCloseMarquee:t,onMessageClick:c})):(0,u.Q3)("",!0)]),(0,u.Lk)("div",Gr,[(0,u.Lk)("div",null,[(0,u.Lk)("div",{class:(0,L.C4)(["side",{"side-hidden":!y.value,"marquee-open":l.value}]),style:{"background-color":"#effff6"}},[(0,u.bF)(Ra)],2),(0,u.Q3)("",!0),(0,u.Lk)("div",Zr,[(0,u.bF)(Qr,{visible:o.value,"onUpdate:visible":a[2]||(a[2]=e=>o.value=e),width:"280px"},null,8,["visible"])])]),(0,u.Lk)("div",{class:"body",style:(0,L.Tr)(f.value)},[(0,u.Lk)("div",es,[(0,u.Lk)("div",as,[(0,u.bF)(i)])])],4)]),(0,u.bF)(m,{modelValue:n.value,"onUpdate:modelValue":a[4]||(a[4]=e=>n.value=e),title:"è·‘é¦¬ç‡ˆè¨Šæ¯",width:"400px"},{footer:(0,u.k6)((()=>[(0,u.bF)(p,{onClick:a[3]||(a[3]=e=>n.value=!1)},{default:(0,u.k6)((()=>a[9]||(a[9]=[(0,u.eW)("é—œé–‰")]))),_:1})])),default:(0,u.k6)((()=>[s.value?((0,u.uX)(),(0,u.CE)("div",ls,[(0,u.Lk)("p",null,[a[7]||(a[7]=(0,u.Lk)("strong",null,"å…§å®¹ï¼š",-1)),(0,u.eW)((0,L.v_)(s.value.text),1)]),(0,u.Lk)("p",null,[a[8]||(a[8]=(0,u.Lk)("strong",null,"è©³ç´°ï¼š",-1)),(0,u.eW)((0,L.v_)(s.value.details),1)])])):(0,u.Q3)("",!0)])),_:1},8,["modelValue"]),(0,u.bF)(m,{modelValue:r.value,"onUpdate:modelValue":a[5]||(a[5]=e=>r.value=e)},{default:(0,u.k6)((()=>[(0,u.bF)(Kr)])),_:1},8,["modelValue"])]))}}};const os=(0,ie.A)(ts,[["__scopeId","data-v-8efaef42"]]);var ns=os;const rs={class:"personal-info-container"},ss={class:"main-card"},us={class:"card-header"},is={class:"header-icon"},ds={class:"header-actions"},cs={key:1,class:"edit-actions"},ps={class:"form-content"},ms={class:"profile-image-section"},vs={class:"profile-image-container"},bs={class:"profile-image-wrapper"},gs={key:0,class:"profile-image-overlay"},ys={class:"profile-image-info"},fs={class:"profile-name"},hs={class:"form-section"},ks={class:"section-header"},_s={class:"form-flex"},ws={class:"modern-label"},Fs={key:0,class:"form-section"},Cs={class:"section-header"},Ds={class:"form-flex"},Ls={class:"modern-label"},Rs={class:"modern-label"},Vs={class:"modern-label"},Is={key:1,class:"form-section"},xs={class:"section-header"},Es={class:"form-flex"},As={class:"modern-label"},Ts={class:"modern-label"},Ws={class:"modern-label"},Ss={class:"form-section"},Us={class:"section-header"},$s={class:"form-flex"},Ns={class:"modern-label"},Xs={key:0,class:"password-display"},Ks={class:"modern-label"},Ms={class:"modern-label"},Ps={class:"action-buttons"},Os={key:0,class:"button-row"},zs={key:1,class:"button-row"},Bs={key:2,class:"button-row"},js={key:1,class:"loading-container"},Ys={class:"loading-content"};var Qs={__name:"PersonalInformation",setup(e){const a=(0,S.k)(),l=c(),t=(0,d.KR)(l.isDark());(0,u.wB)((()=>l.currentTheme),(e=>{t.value="dark"===e}));const o=(0,d.KR)(null),n=(0,d.KR)(null),r=(0,d.Kh)({id:"",name:"",en_name:"",dpt_id:"",title_id:"",ext_group:"",ext_num:"",area_id:"",email:"",password:"",new_password:"",confirm_new_password:"",profile_image:""}),s=(0,d.KR)(""),i=(0,d.KR)(!1),p=[{validator:(e,a,l)=>{if(y.value)if(a){const e=/^(?=.*[a-zA-Z])(?=.*\d).{7,}$/;e.test(a)?l():l(new Error("é ˆåŒ…å«è‹±æ–‡åŠæ•¸å­—ï¼Œä¸”è‡³å°‘7ç¢¼"))}else l(new Error("æ–°å¯†ç¢¼ä¸èƒ½ç‚ºç©º"));else l()},trigger:"blur"}],m=[{validator:(e,a,l)=>{y.value&&r.new_password&&a!==r.new_password?l(new Error("å…©æ¬¡è¼¸å…¥çš„æ–°å¯†ç¢¼ä¸ä¸€è‡´")):l()},trigger:"blur"}],v=(0,d.KR)(!1),b=(0,d.KR)(!1),g=(0,d.KR)(!1),y=(0,d.KR)(!1),f=(0,d.KR)(!1),h=(0,d.KR)({}),k=(0,d.KR)({password:"",new_password:"",confirm_new_password:""});async function _(){try{const e=await W.A.getEmployeeDataByID(a.userId);console.log(e.data),Object.assign(r,e.data),Object.assign(h.value,e.data),k.value.password=e.data.password,k.value.new_password="",k.value.confirm_new_password="",$()}catch(e){console.error(e),D.nk.error("å–å¾—å“¡å·¥è³‡æ–™å¤±æ•—")}finally{v.value=!0}}async function w(){o.value.validate((async e=>{if(e){b.value=!0;try{const e={...r};delete e.password,delete e.old_password,delete e.new_password,delete e.confirm_new_password,delete e.emp_status,delete e.dpt_id,delete e.area_id,delete e.id,delete e.title_id,delete e.name,console.log("dataToSave:",e),await W.A.editEmployeeData(a.userId,e),D.nk.success("æ›´æ–°æˆåŠŸ"),g.value=!1,_()}catch(l){console.error(l);const e=l.response?.data?.error||l.message;D.nk.error("æ›´æ–°å¤±æ•—ï¼š"+e)}finally{b.value=!1}}}))}async function F(){o.value.validate((async e=>{if(e&&r.new_password===r.confirm_new_password){b.value=!0;try{const e={newPassword:r.new_password};let l=await W.A.editPassword(a.userId,e);l.data&&(D.nk.success("å¯†ç¢¼æ›´æ–°æˆåŠŸ"),y.value=!1,r.new_password="",r.confirm_new_password="",r.password="********",f.value=!1,k.value.password="********",_())}catch(l){console.error(l);const e=l.response?.data?.error||l.message;D.nk.error("å¯†ç¢¼æ›´æ–°å¤±æ•—ï¼š"+e)}finally{b.value=!1}}}))}function C(){g.value=!0,y.value=!1}function R(){g.value&&(Object.assign(r,h.value),o.value.resetFields()),g.value=!g.value,y.value=!1,r.new_password="",r.confirm_new_password=""}function V(){y.value=!0,g.value=!1,r.new_password="",r.confirm_new_password="",o.value.resetFields()}function I(){y.value=!1,r.password=k.value.password,r.new_password=k.value.new_password,r.confirm_new_password=k.value.confirm_new_password,o.value.resetFields()}function x(){n.value.click()}function E(e){const a=e.target.files[0];if(!a)return;if(a.size>1048576)return void D.nk.error("æª”æ¡ˆå¤§å°ä¸èƒ½è¶…éŽ 1MB");const l=["image/jpeg","image/jpg","image/png","image/gif"];l.includes(a.type)?A(a):D.nk.error("åªæ”¯æ´ JPGã€JPEGã€PNGã€GIF æ ¼å¼")}async function A(e){i.value=!0;try{const l=await W.A.uploadProfileImage(a.userId,e);if(!l.data||!l.data.profileImageUrl)throw new Error("ä¸Šå‚³éŸ¿æ‡‰æ ¼å¼éŒ¯èª¤");r.profile_image=l.data.profileImageUrl,$(),D.nk.success("å¤§é ­è²¼ä¸Šå‚³æˆåŠŸ")}catch(l){console.error("Upload error:",l);const e=l.response?.data?.message||l.message||"å¤§é ­è²¼ä¸Šå‚³å¤±æ•—";D.nk.error(e)}finally{i.value=!1,n.value&&(n.value.value="")}}async function T(){try{await Sa.s.confirm("ç¢ºå®šè¦åˆªé™¤å¤§é ­è²¼å—Žï¼Ÿ","ç¢ºèªåˆªé™¤",{confirmButtonText:"ç¢ºå®š",cancelButtonText:"å–æ¶ˆ",type:"warning"}),i.value=!0;const e=await W.A.deleteProfileImage(a.userId);if(200!==e.status)throw new Error("åˆªé™¤å¤±æ•—");r.profile_image="",s.value="",D.nk.success("å¤§é ­è²¼åˆªé™¤æˆåŠŸ")}catch(e){if("cancel"!==e){console.error("Delete error:",e);const a=e.response?.data?.message||e.message||"å¤§é ­è²¼åˆªé™¤å¤±æ•—";D.nk.error(a)}}finally{i.value=!1}}function U(){s.value=""}function $(){r.profile_image?r.profile_image.startsWith("/")?s.value=r.profile_image:s.value="/"+r.profile_image:s.value=""}return(0,u.sV)((()=>{_()})),(e,a)=>{const l=(0,u.g2)("el-icon"),t=(0,u.g2)("el-button"),c=(0,u.g2)("el-avatar"),f=(0,u.g2)("el-text"),h=(0,u.g2)("el-form-item"),k=(0,u.g2)("el-input"),_=(0,u.g2)("el-form"),D=(0,u.g2)("el-spin");(0,u.g2)("el-switch"),(0,u.g2)("el-card");return(0,u.uX)(),(0,u.CE)("div",rs,[a[41]||(a[41]=(0,u.Lk)("div",{class:"background-decoration"},[(0,u.Lk)("div",{class:"decoration-circle circle-1"}),(0,u.Lk)("div",{class:"decoration-circle circle-2"}),(0,u.Lk)("div",{class:"decoration-circle circle-3"})],-1)),(0,u.Lk)("div",ss,[(0,u.Lk)("div",us,[(0,u.Lk)("div",is,[(0,u.bF)(l,{size:"24"},{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.User))])),_:1})]),a[10]||(a[10]=(0,u.Lk)("h1",{class:"header-title"},"å€‹äººè³‡æ–™ç®¡ç†",-1)),a[11]||(a[11]=(0,u.Lk)("p",{class:"header-subtitle"},"ç®¡ç†å€‹äººèˆ‡å¸³æˆ¶è³‡è¨Š",-1)),(0,u.Lk)("div",ds,[g.value||y.value?(0,u.Q3)("",!0):((0,u.uX)(),(0,u.Wv)(t,{key:0,type:"primary",onClick:C,class:"edit-main-btn",size:"default"},{default:(0,u.k6)((()=>[(0,u.bF)(l,null,{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.Edit))])),_:1}),a[7]||(a[7]=(0,u.eW)(" ç·¨è¼¯è³‡æ–™ "))])),_:1})),g.value?((0,u.uX)(),(0,u.CE)("div",cs,[(0,u.bF)(t,{type:"success",onClick:w,loading:b.value,size:"default"},{default:(0,u.k6)((()=>[(0,u.bF)(l,null,{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.Check))])),_:1}),a[8]||(a[8]=(0,u.eW)(" å„²å­˜ "))])),_:1},8,["loading"]),(0,u.bF)(t,{onClick:R,size:"default"},{default:(0,u.k6)((()=>[(0,u.bF)(l,null,{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.Close))])),_:1}),a[9]||(a[9]=(0,u.eW)(" å–æ¶ˆ "))])),_:1})])):(0,u.Q3)("",!0)])]),(0,u.Lk)("div",ps,[(0,u.Lk)("div",ms,[(0,u.Lk)("div",vs,[(0,u.Lk)("div",bs,[(0,u.bF)(c,{size:120,src:s.value,class:"profile-avatar",onError:U},{default:(0,u.k6)((()=>[(0,u.bF)(l,{size:"40"},{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.User))])),_:1})])),_:1},8,["src"]),g.value?((0,u.uX)(),(0,u.CE)("div",gs,[(0,u.bF)(t,{type:"primary",circle:"",onClick:x,class:"upload-btn",size:"small",loading:i.value,disabled:i.value},{default:(0,u.k6)((()=>[(0,u.bF)(l,null,{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.Edit))])),_:1})])),_:1},8,["loading","disabled"]),r.profile_image?((0,u.uX)(),(0,u.Wv)(t,{key:0,type:"danger",circle:"",onClick:T,class:"delete-btn",size:"small",loading:i.value,disabled:i.value},{default:(0,u.k6)((()=>[(0,u.bF)(l,null,{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.Delete))])),_:1})])),_:1},8,["loading","disabled"])):(0,u.Q3)("",!0)])):(0,u.Q3)("",!0)]),(0,u.Lk)("div",ys,[(0,u.Lk)("h4",fs,(0,L.v_)(r.name),1),a[12]||(a[12]=(0,u.Lk)("p",{class:"profile-subtitle"},"å€‹äººå¤§é ­è²¼",-1))])]),(0,u.Lk)("input",{ref_key:"fileInput",ref:n,type:"file",accept:"image/jpeg,image/jpg,image/png,image/gif",onChange:E,style:{display:"none"}},null,544)]),v.value?((0,u.uX)(),(0,u.Wv)(_,{key:0,model:r,ref_key:"formRef",ref:o,"label-position":"top",size:"default",class:"modern-form compact-form"},{default:(0,u.k6)((()=>[(0,u.Lk)("div",hs,[(0,u.Lk)("div",ks,[(0,u.bF)(l,{class:"section-icon"},{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.UserFilled))])),_:1}),a[13]||(a[13]=(0,u.Lk)("h3",{class:"section-title"},"åŸºæœ¬è³‡è¨Š",-1))]),(0,u.Lk)("div",_s,[(0,u.bF)(h,{prop:"name",class:"form-item-modern"},{label:(0,u.k6)((()=>[(0,u.Lk)("div",ws,[(0,u.bF)(l,null,{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.User))])),_:1}),a[14]||(a[14]=(0,u.Lk)("span",null,"å§“å",-1))])])),default:(0,u.k6)((()=>[(0,u.bF)(f,{class:"readonly-text"},{default:(0,u.k6)((()=>[(0,u.eW)((0,L.v_)(r.name),1)])),_:1})])),_:1}),(0,u.bF)(h,{prop:"en_name",class:"form-item-modern"},{label:(0,u.k6)((()=>a[15]||(a[15]=[(0,u.Lk)("div",{class:"modern-label"},[(0,u.Lk)("i",{class:"pi pi-globe"}),(0,u.Lk)("span",null,"è‹±æ–‡å")],-1)]))),default:(0,u.k6)((()=>[g.value?((0,u.uX)(),(0,u.Wv)(k,{key:1,modelValue:r.en_name,"onUpdate:modelValue":a[0]||(a[0]=e=>r.en_name=e),placeholder:"è«‹è¼¸å…¥è‹±æ–‡å",class:"modern-input",size:"small"},null,8,["modelValue"])):((0,u.uX)(),(0,u.Wv)(f,{key:0,class:"readonly-text"},{default:(0,u.k6)((()=>[(0,u.eW)((0,L.v_)(r.en_name||"æœªè¨­å®š"),1)])),_:1}))])),_:1})])]),y.value?(0,u.Q3)("",!0):((0,u.uX)(),(0,u.CE)("div",Fs,[(0,u.Lk)("div",Cs,[(0,u.bF)(l,{class:"section-icon"},{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.OfficeBuilding))])),_:1}),a[16]||(a[16]=(0,u.Lk)("h3",{class:"section-title"},"çµ„ç¹”è³‡è¨Š",-1))]),(0,u.Lk)("div",Ds,[(0,u.bF)(h,{prop:"area_id",class:"form-item-modern"},{label:(0,u.k6)((()=>[(0,u.Lk)("div",Ls,[(0,u.bF)(l,null,{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.Location))])),_:1}),a[17]||(a[17]=(0,u.Lk)("span",null,"åœ°å€",-1))])])),default:(0,u.k6)((()=>[(0,u.bF)(rt,{"area-id":r.area_id,class:"readonly-text"},null,8,["area-id"])])),_:1}),(0,u.bF)(h,{prop:"dpt_id",class:"form-item-modern"},{label:(0,u.k6)((()=>[(0,u.Lk)("div",Rs,[(0,u.bF)(l,null,{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.OfficeBuilding))])),_:1}),a[18]||(a[18]=(0,u.Lk)("span",null,"éƒ¨é–€",-1))])])),default:(0,u.k6)((()=>[(0,u.bF)(_l,{"dept-id":r.dpt_id,class:"readonly-text"},null,8,["dept-id"])])),_:1}),(0,u.bF)(h,{prop:"title_id",class:"form-item-modern"},{label:(0,u.k6)((()=>[(0,u.Lk)("div",Vs,[(0,u.bF)(l,null,{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.Medal))])),_:1}),a[19]||(a[19]=(0,u.Lk)("span",null,"è·ç¨±",-1))])])),default:(0,u.k6)((()=>[(0,u.bF)(Dl,{"title-id":r.title_id,class:"readonly-text"},null,8,["title-id"])])),_:1})])])),y.value?(0,u.Q3)("",!0):((0,u.uX)(),(0,u.CE)("div",Is,[(0,u.Lk)("div",xs,[(0,u.bF)(l,{class:"section-icon"},{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.Message))])),_:1}),a[20]||(a[20]=(0,u.Lk)("h3",{class:"section-title"},"è¯çµ¡è³‡è¨Š",-1))]),(0,u.Lk)("div",Es,[(0,u.bF)(h,{prop:"email",rules:[{type:"email",message:"è«‹è¼¸å…¥æœ‰æ•ˆ Email",trigger:"blur"}],class:"form-item-modern"},{label:(0,u.k6)((()=>[(0,u.Lk)("div",As,[(0,u.bF)(l,null,{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.Message))])),_:1}),a[21]||(a[21]=(0,u.Lk)("span",null,"é›»å­éƒµä»¶",-1))])])),default:(0,u.k6)((()=>[g.value?((0,u.uX)(),(0,u.Wv)(k,{key:1,modelValue:r.email,"onUpdate:modelValue":a[1]||(a[1]=e=>r.email=e),placeholder:"è«‹è¼¸å…¥é›»å­éƒµä»¶",class:"modern-input",size:"small"},null,8,["modelValue"])):((0,u.uX)(),(0,u.Wv)(f,{key:0,class:"readonly-text"},{default:(0,u.k6)((()=>[(0,u.eW)((0,L.v_)(r.email||"æœªè¨­å®š"),1)])),_:1}))])),_:1}),(0,u.bF)(h,{prop:"ext_group",class:"form-item-modern"},{label:(0,u.k6)((()=>[(0,u.Lk)("div",Ts,[(0,u.bF)(l,null,{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.Phone))])),_:1}),a[22]||(a[22]=(0,u.Lk)("span",null,"åˆ†æ©Ÿç¾¤çµ„",-1))])])),default:(0,u.k6)((()=>[g.value?((0,u.uX)(),(0,u.Wv)(k,{key:1,modelValue:r.ext_group,"onUpdate:modelValue":a[2]||(a[2]=e=>r.ext_group=e),placeholder:"è«‹è¼¸å…¥åˆ†æ©Ÿç¾¤çµ„",class:"modern-input",size:"small"},null,8,["modelValue"])):((0,u.uX)(),(0,u.Wv)(f,{key:0,class:"readonly-text"},{default:(0,u.k6)((()=>[(0,u.eW)((0,L.v_)(r.ext_group||"æœªè¨­å®š"),1)])),_:1}))])),_:1}),(0,u.bF)(h,{prop:"ext_num",class:"form-item-modern"},{label:(0,u.k6)((()=>[(0,u.Lk)("div",Ws,[(0,u.bF)(l,null,{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.Phone))])),_:1}),a[23]||(a[23]=(0,u.Lk)("span",null,"åˆ†æ©Ÿè™Ÿç¢¼",-1))])])),default:(0,u.k6)((()=>[g.value?((0,u.uX)(),(0,u.Wv)(k,{key:1,modelValue:r.ext_num,"onUpdate:modelValue":a[3]||(a[3]=e=>r.ext_num=e),placeholder:"è«‹è¼¸å…¥åˆ†æ©Ÿè™Ÿç¢¼",class:"modern-input",size:"small"},null,8,["modelValue"])):((0,u.uX)(),(0,u.Wv)(f,{key:0,class:"readonly-text"},{default:(0,u.k6)((()=>[(0,u.eW)((0,L.v_)(r.ext_num||"æœªè¨­å®š"),1)])),_:1}))])),_:1})])])),(0,u.Lk)("div",Ss,[(0,u.Lk)("div",Us,[(0,u.bF)(l,{class:"section-icon"},{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.Lock))])),_:1}),a[24]||(a[24]=(0,u.Lk)("h3",{class:"section-title"},"å®‰å…¨è¨­å®š",-1))]),(0,u.Lk)("div",$s,[(0,u.bF)(h,{prop:"password",class:"form-item-modern password-field"},{label:(0,u.k6)((()=>[(0,u.Lk)("div",Ns,[(0,u.bF)(l,null,{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.Key))])),_:1}),a[25]||(a[25]=(0,u.Lk)("span",null,"å¯†ç¢¼",-1))])])),default:(0,u.k6)((()=>[y.value?(0,u.Q3)("",!0):((0,u.uX)(),(0,u.CE)("div",Xs,[(0,u.bF)(f,{class:"readonly-text password-mask"},{default:(0,u.k6)((()=>a[26]||(a[26]=[(0,u.eW)("â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢")]))),_:1}),(0,u.bF)(t,{type:"primary",link:"",onClick:V,class:"edit-btn"},{default:(0,u.k6)((()=>[(0,u.bF)(l,null,{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.Edit))])),_:1})])),_:1})]))])),_:1}),y.value?((0,u.uX)(),(0,u.Wv)(h,{key:0,prop:"new_password",rules:p,class:"form-item-modern"},{label:(0,u.k6)((()=>[(0,u.Lk)("div",Ks,[(0,u.bF)(l,null,{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.Lock))])),_:1}),a[27]||(a[27]=(0,u.Lk)("span",null,"æ–°å¯†ç¢¼",-1))])])),default:(0,u.k6)((()=>[(0,u.bF)(k,{modelValue:r.new_password,"onUpdate:modelValue":a[4]||(a[4]=e=>r.new_password=e),type:"password",placeholder:"è«‹è¼¸å…¥æ–°å¯†ç¢¼",class:"modern-input","show-password":""},null,8,["modelValue"])])),_:1})):(0,u.Q3)("",!0),y.value?((0,u.uX)(),(0,u.Wv)(h,{key:1,prop:"confirm_new_password",rules:m,class:"form-item-modern"},{label:(0,u.k6)((()=>[(0,u.Lk)("div",Ms,[(0,u.bF)(l,null,{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.Lock))])),_:1}),a[28]||(a[28]=(0,u.Lk)("span",null,"ç¢ºèªæ–°å¯†ç¢¼",-1))])])),default:(0,u.k6)((()=>[(0,u.bF)(k,{modelValue:r.confirm_new_password,"onUpdate:modelValue":a[5]||(a[5]=e=>r.confirm_new_password=e),type:"password",placeholder:"è«‹å†æ¬¡è¼¸å…¥æ–°å¯†ç¢¼",class:"modern-input","show-password":""},null,8,["modelValue"])])),_:1})):(0,u.Q3)("",!0)])]),(0,u.Lk)("div",Ps,[g.value||y.value?(0,u.Q3)("",!0):((0,u.uX)(),(0,u.CE)("div",Os,[(0,u.bF)(t,{type:"primary",size:"large",onClick:R,class:"action-btn primary-btn"},{default:(0,u.k6)((()=>[(0,u.bF)(l,null,{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.Edit))])),_:1}),a[29]||(a[29]=(0,u.eW)(" ç·¨è¼¯è³‡æ–™ "))])),_:1}),(0,u.bF)(t,{type:"warning",size:"large",onClick:V,class:"action-btn warning-btn"},{default:(0,u.k6)((()=>[(0,u.bF)(l,null,{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.Key))])),_:1}),a[30]||(a[30]=(0,u.eW)(" ä¿®æ”¹å¯†ç¢¼ "))])),_:1})])),g.value&&!y.value?((0,u.uX)(),(0,u.CE)("div",zs,[(0,u.bF)(t,{type:"success",size:"large",onClick:w,loading:b.value,class:"action-btn success-btn"},{default:(0,u.k6)((()=>[(0,u.bF)(l,null,{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.Check))])),_:1}),a[31]||(a[31]=(0,u.eW)(" å„²å­˜è®Šæ›´ "))])),_:1},8,["loading"]),(0,u.bF)(t,{size:"large",onClick:R,disabled:b.value,class:"action-btn cancel-btn"},{default:(0,u.k6)((()=>[(0,u.bF)(l,null,{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.Close))])),_:1}),a[32]||(a[32]=(0,u.eW)(" å–æ¶ˆç·¨è¼¯ "))])),_:1},8,["disabled"])])):(0,u.Q3)("",!0),y.value?((0,u.uX)(),(0,u.CE)("div",Bs,[(0,u.bF)(t,{type:"success",size:"large",onClick:F,loading:b.value,class:"action-btn success-btn"},{default:(0,u.k6)((()=>[(0,u.bF)(l,null,{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.Check))])),_:1}),a[33]||(a[33]=(0,u.eW)(" å„²å­˜å¯†ç¢¼ "))])),_:1},8,["loading"]),(0,u.bF)(t,{size:"large",onClick:I,disabled:b.value,class:"action-btn cancel-btn"},{default:(0,u.k6)((()=>[(0,u.bF)(l,null,{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.Close))])),_:1}),a[34]||(a[34]=(0,u.eW)(" å–æ¶ˆä¿®æ”¹ "))])),_:1},8,["disabled"])])):(0,u.Q3)("",!0)])])),_:1},8,["model"])):((0,u.uX)(),(0,u.CE)("div",js,[(0,u.Lk)("div",Ys,[(0,u.bF)(D,{size:"large"}),a[35]||(a[35]=(0,u.Lk)("p",{class:"loading-text"},"è¼‰å…¥å€‹äººè³‡æ–™ä¸­...",-1))])]))]),(0,u.Q3)("",!0)])])}}};const Hs=(0,ie.A)(Qs,[["__scopeId","data-v-ed92a468"]]);var qs=Hs,Js=l.p+"img/DAE_history.ca407fbd.jpg";const Gs={viewBox:"0 0 800 600",style:{cursor:"pointer",display:"block",width:"100%",height:"auto"},class:"pt-5 pl-5 mr-2"};function Zs(e,a){return(0,u.uX)(),(0,u.CE)("svg",Gs,a[0]||(a[0]=[(0,u.Lk)("image",{href:Js,width:"800",height:"600",preserveAspectRatio:"xMidYMid meet"},null,-1)]))}const eu={},au=(0,ie.A)(eu,[["render",Zs]]);var lu=au,tu=l(69730),ou=l(772),nu={__name:"TreeSelect-Title",props:{modelValue:{type:[String,Number,Object],default:""},size:{type:String,default:"medium"},returnType:{type:String,default:"id",validator:e=>["id","description"].includes(e)}},emits:["update:modelValue"],setup(e,{emit:a}){const l=e,t=a,o=(0,d.KR)(l.modelValue);(0,u.wB)(o,(e=>{t("update:modelValue",e)})),(0,u.wB)((()=>l.modelValue),(e=>{o.value=e}));const n=(0,u.EW)((()=>"Middle"===l.size||"middle"===l.size?"medium":l.size)),r=(0,d.KR)([]),s=(0,d.KR)([]);function i(e){const a={};e.forEach((e=>{a[e.name]||(a[e.name]=[]),a[e.name].push(e)}));for(const l in a)a[l].sort(((e,a)=>a.sortId-e.sortId));const t=Object.keys(a).map((e=>({label:e,value:e,sortId:a[e][0].sortId,children:a[e].map((e=>({label:e.description,value:"id"===l.returnType?e.id:e.description,sortId:e.sortId})))})));return t.sort(((e,a)=>a.sortId-e.sortId)),t}const c=async()=>{try{const e=await ja.getTitleData();r.value=e.data,s.value=i(r.value)}catch(e){console.error("å–å¾—è·ç¨±è³‡æ–™å¤±æ•—:",e)}};return(0,u.sV)((()=>{c()})),(e,a)=>{const l=(0,u.g2)("el-tree-select");return(0,u.uX)(),(0,u.Wv)(l,{modelValue:o.value,"onUpdate:modelValue":a[0]||(a[0]=e=>o.value=e),data:s.value,"render-after-expand":!1,"default-expand-all":"",placeholder:"è«‹é¸æ“‡è·ç¨±",style:{width:"200px"},size:n.value},null,8,["modelValue","data","size"])}}};const ru=nu;var su=ru;const uu={class:"card justify-center",style:{display:"flex","justify-content":"center","margin-left":"-10rem","padding-top":"5%"}},iu={class:"emp-form",style:{position:"sticky","justify-content":"center"}},du={class:"card flex",style:{gap:"0","align-items":"center","flex-direction":"row","margin-left":"-2rem"}},cu={class:"select-button-wrapper",style:{display:"flex","align-items":"center"}},pu={class:"card flex field-detail",style:{"margin-left":"-1rem"}},mu={key:0,style:{color:"darkgray"}},vu={key:1,style:{color:"darkgrey"}},bu={class:"card flex flex-wrap justify-center gap-4"},gu={class:"card flex",style:{gap:"0",display:"flex","flex-direction":"row","align-items":"center"}},yu={class:"card flex flex-wrap justify-center gap-4"},fu={class:"card flex flex-wrap justify-center"},hu={class:"card flex flex-wrap justify-center"},ku={class:"card flex flex-wrap justify-center"};var _u={__name:"employee-registration",setup(e){(0,u.WQ)("$axios");const a=(0,d.KR)(!1),l=(0,d.KR)(""),t=(0,d.KR)(""),o=(0,d.KR)(""),n=(0,d.KR)(!1),r=(0,d.KR)(!1),s=(0,d.KR)("TW"),i=(0,d.KR)([]),c=(0,d.KR)([]),p=(0,d.KR)(),m=(0,d.KR)(),v=(0,d.KR)(),b=(0,d.KR)(),g=(0,d.KR)(""),y=(0,d.KR)(""),f=(0,u.EW)((()=>!!r.value&&!l.value)),h=(0,u.EW)((()=>{if(!n.value)return!1;let e=t.value||"";const a=/^[0-9]{4}$/;return!(a.test(e)&&4===e.length)})),k=()=>{let e=t.value||"";const a=/^[0-9]{4}$/;return a.test(e)&&4===e.length},_=async()=>{const e=await W.A.getDptsList();i.value=e.data.sort(((e,a)=>parseInt(e.dptsIndex)-parseInt(a.dptsIndex))).map((e=>({name:e.chName,value:e.enName})))},w=async()=>{const e=await W.A.getTitlesList();c.value=e.data.filter((e=>"GM"!==e.shortEnName)).sort(((e,a)=>parseInt(e.dptsIndex)-parseInt(a.dptsIndex))).map((e=>({name:e.chName,value:e.enName}))),console.log(e.data)};(0,u.sV)((()=>{_(),w()}));const F=(0,T.d)(),C=()=>{let e=[];return l.value||e.push("å§“å"),s.value||e.push("å·¥è™Ÿé–‹é ­å­—æ¯"),t.value||e.push("å·¥è™Ÿ"),o.value||e.push("ä¿¡ç®±"),m.value&&""!==m.value||e.push("è·ç¨±"),p.value&&""!==p.value||e.push("éƒ¨é–€"),e.length>0?(F.add({severity:"warn",summary:`è«‹å¡«å¯« ${e.join("ã€")} æ¬„ä½ï¼`,detail:"",life:3e3}),!1):!!k()||(F.add({severity:"warn",summary:"å·¥è™Ÿæ ¼å¼ä¸æ­£ç¢ºï¼",detail:"",life:3e3}),!1)},D=(0,u.EW)((()=>{const e=/^[A-Za-z0-9_]+$/;return e.test(o.value)?"":"ã€€ ã€€(åƒ…é™è¼¸å…¥ '_', è‹±æ–‡, æ•¸å­—)"}));(0,u.nT)((()=>{}));const R=async()=>{if(C()){const u={regName:l.value,regAccount:s.value+t.value,regEmail:o.value+b.value,regSelectedDpt:p.value,regSelectedTitle:m.value,regExtGroup:g.value,regExtNum:y.value,regAreaId:v.value};console.log("æäº¤çš„è³‡æ–™:",u),a.value=!0;try{const e=await W.A.submitRegForm(u);console.log("response:",e.data),F.add({severity:"success",summary:"å·²æˆåŠŸå»ºç«‹äººå“¡è³‡æ–™ï¼",detail:"",life:3e3}),l.value="",t.value="",o.value="",g.value="",y.value="",v.value=null,p.value=null,m.value=null,n.value=!1,r.value=!1}catch(e){console.error("æäº¤å¤±æ•—:",e);let a="å»ºç«‹äººå“¡è³‡æ–™å¤±æ•—ï¼";e.response&&409===e.response.status?a="æ­¤å·¥è™Ÿå·²è¨»å†Šï¼Œè«‹å†ç¢ºèª!":e.response&&e.response.data&&(a=e.response.data),F.add({severity:"error",summary:"éŒ¯èª¤",detail:a,life:3e3})}finally{a.value=!1}}};return(e,i)=>{const c=(0,u.g2)("el-radio-button"),b=(0,u.g2)("el-radio-group"),k=(0,u.g2)("el-button");return(0,u.uX)(),(0,u.CE)(u.FK,null,[(0,u.Lk)("div",uu,[(0,u.Lk)("div",iu,[(0,u.Lk)("div",du,[(0,u.Lk)("div",cu,[(0,u.bF)(b,{modelValue:s.value,"onUpdate:modelValue":i[0]||(i[0]=e=>s.value=e)},{default:(0,u.k6)((()=>[(0,u.bF)(c,{label:"TW",value:"TW",size:"large"}),(0,u.bF)(c,{label:"OP",value:"OP",size:"large"})])),_:1},8,["modelValue"])]),(0,u.bF)((0,d.R1)(tu.A),{variant:"on",class:"float-label-wrapper",style:{flex:"0"}},{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(x.A),{modelValue:t.value,"onUpdate:modelValue":i[1]||(i[1]=e=>t.value=e),autocomplete:"off",class:"no-margin",invalid:h.value,onInput:i[2]||(i[2]=()=>{n.value=!0})},null,8,["modelValue","invalid"]),i[11]||(i[11]=(0,u.Lk)("label",null,"å·¥è™Ÿ",-1))])),_:1})]),(0,u.Lk)("div",pu,[h.value?((0,u.uX)(),(0,u.CE)("label",mu," è«‹è¼¸å…¥å·¥è™Ÿå¾Œé¢æ•¸å­—éƒ¨åˆ†(å››ç¢¼) ")):((0,u.uX)(),(0,u.CE)("label",vu,(0,L.v_)(s.value?"å·¥è™Ÿç‚º: "+s.value+t.value:"è«‹é¸æ“‡å·¥è™Ÿé–‹é ­å­—æ¯"),1))]),(0,u.Lk)("div",bu,[(0,u.bF)((0,d.R1)(tu.A),{variant:"on"},{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(x.A),{modelValue:l.value,"onUpdate:modelValue":i[3]||(i[3]=e=>l.value=e),invalid:f.value,onInput:i[4]||(i[4]=()=>{r.value=!0}),autocomplete:"off"},null,8,["modelValue","invalid"]),i[12]||(i[12]=(0,u.Lk)("label",null,"å§“å",-1))])),_:1})]),(0,u.Lk)("div",gu,[(0,u.bF)((0,d.R1)(ou.A),{variant:"in",style:{display:"flex","flex-direction":"row","align-items":"center"}},{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(x.A),{id:"reg_mail",style:{width:"16rem"},modelValue:o.value,"onUpdate:modelValue":i[5]||(i[5]=e=>o.value=e),fluid:"",placeholder:"ç¯„ä¾‹: dae.davidlu@gmail.com"},null,8,["modelValue"]),i[13]||(i[13]=(0,u.Lk)("label",{for:"reg_mail"},"ä¿¡ç®±",-1)),(0,u.Lk)("label",{for:"reg_mail",style:(0,L.Tr)({color:e.isMailValid?"black":"darkgrey",marginLeft:"5px"})},(0,L.v_)(D.value),5)])),_:1})]),(0,u.Lk)("div",yu,[(0,u.bF)((0,d.R1)(tu.A),{variant:"on",class:"w-full md:w-14rem"},{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(x.A),{modelValue:g.value,"onUpdate:modelValue":i[6]||(i[6]=e=>g.value=e)},null,8,["modelValue"]),i[14]||(i[14]=(0,u.Lk)("label",null,"åˆ†æ©Ÿç¾¤ (ext_group)",-1))])),_:1}),(0,u.bF)((0,d.R1)(tu.A),{variant:"on",class:"w-full md:w-14rem"},{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(x.A),{modelValue:y.value,"onUpdate:modelValue":i[7]||(i[7]=e=>y.value=e)},null,8,["modelValue"]),i[15]||(i[15]=(0,u.Lk)("label",null,"åˆ†æ©Ÿè™Ÿ (ext_num)",-1))])),_:1})]),(0,u.Lk)("div",fu,[(0,u.bF)(ar,{modelValue:v.value,"onUpdate:modelValue":i[8]||(i[8]=e=>v.value=e)},null,8,["modelValue"])]),(0,u.Lk)("div",hu,[(0,u.bF)(Gn,{modelValue:p.value,"onUpdate:modelValue":i[9]||(i[9]=e=>p.value=e)},null,8,["modelValue"])]),(0,u.Lk)("div",ku,[(0,u.bF)(su,{modelValue:m.value,"onUpdate:modelValue":i[10]||(i[10]=e=>m.value=e)},null,8,["modelValue"])]),(0,u.bF)(k,{type:"primary",loading:a.value,onClick:R,style:{"margin-left":"10rem","margin-top":"1rem"}},{default:(0,u.k6)((()=>i[16]||(i[16]=[(0,u.eW)("ç¢ºå®š")]))),_:1},8,["loading"])])]),(0,u.bF)((0,d.R1)(A.A),{baseZIndex:10001})],64)}}};const wu=(0,ie.A)(_u,[["__scopeId","data-v-6211804a"]]);var Fu=wu,Cu=l(16144),Du=l(34565);const Lu={class:"card"};var Ru={__name:"userManagement",setup(e){const a=(0,d.KR)([]),l=(0,d.KR)([]),t=(0,d.KR)([{label:"Active",value:"Active"},{label:"Inactive",value:"Inactive"}]);(0,u.sV)((async()=>{const e=await W.A.getUsersList();a.value=e.data}));const o=(0,T.d)(),n=e=>{switch(e){case"Active":return"success";case"Inactive":return"danger";default:return null}},r=e=>e&&"0001-01-01T00:00:00"!==e?new Date(e).toLocaleString():"æœªç™»å…¥",s=async e=>{const l=e.newData;try{const e=await W.A.updateUsers(l),t=e.data,n=a.value.findIndex((e=>e.userId===t.userId));-1!==n&&(a.value[n]=t,o.add({severity:"warn",summary:`"${l.userName}" è³‡æ–™æ›´æ–°æˆåŠŸï¼`,detail:"",life:3e3}))}catch(t){console.error("Error updating user:",t)}};return(e,o)=>{const i=(0,u.g2)("Toast");return(0,u.uX)(),(0,u.CE)(u.FK,null,[o[1]||(o[1]=(0,u.Lk)("h1",null,"å“¡å·¥è³‡æ–™ç·¨è¼¯",-1)),(0,u.Lk)("div",Lu,[(0,u.bF)((0,d.R1)(Va.A),{editingRows:l.value,"onUpdate:editingRows":o[0]||(o[0]=e=>l.value=e),value:a.value,editMode:"row",dataKey:"userId",onRowEditSave:s,pt:{table:{style:"max-width: 300rem; min-width: 80rem"},column:{bodycell:({state:e})=>({style:e["d_editing"]&&"padding-top: 0.75rem; padding-bottom: 0.75rem"})}}},{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(Ia.A),{field:"userId",header:"ä½¿ç”¨è€…ç·¨è™Ÿ",style:{width:"10%"}},{editor:(0,u.k6)((({data:e,field:a})=>[(0,u.bF)((0,d.R1)(x.A),{modelValue:e[a],"onUpdate:modelValue":l=>e[a]=l,fluid:""},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),(0,u.bF)((0,d.R1)(Ia.A),{field:"userName",header:"å§“å",style:{width:"15%"}},{editor:(0,u.k6)((({data:e,field:a})=>[(0,u.bF)((0,d.R1)(x.A),{modelValue:e[a],"onUpdate:modelValue":l=>e[a]=l,fluid:""},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),(0,u.bF)((0,d.R1)(Ia.A),{field:"dptEnName",header:"éƒ¨é–€åç¨±",style:{width:"10%"}},{editor:(0,u.k6)((({data:e,field:a})=>[(0,u.bF)((0,d.R1)(x.A),{modelValue:e[a],"onUpdate:modelValue":l=>e[a]=l,fluid:""},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),(0,u.bF)((0,d.R1)(Ia.A),{field:"titleEnName",header:"è·ç¨±",style:{width:"10%"}},{editor:(0,u.k6)((({data:e,field:a})=>[(0,u.bF)((0,d.R1)(x.A),{modelValue:e[a],"onUpdate:modelValue":l=>e[a]=l,fluid:""},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),(0,u.bF)((0,d.R1)(Ia.A),{field:"email",header:"é›»å­éƒµä»¶",style:{width:"20%"}},{editor:(0,u.k6)((({data:e,field:a})=>[(0,u.bF)((0,d.R1)(x.A),{modelValue:e[a],"onUpdate:modelValue":l=>e[a]=l,fluid:""},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),(0,u.bF)((0,d.R1)(Ia.A),{field:"accountStatus",header:"å¸³è™Ÿç‹€æ…‹",style:{width:"10%"}},{editor:(0,u.k6)((({data:e,field:a})=>[(0,u.bF)((0,d.R1)(Cu.A),{modelValue:e[a],"onUpdate:modelValue":l=>e[a]=l,options:t.value,optionLabel:"label",optionValue:"value",placeholder:"Select a Status",fluid:""},{option:(0,u.k6)((e=>[(0,u.bF)((0,d.R1)(Du.A),{value:e.option.value,severity:n(e.option.value)},null,8,["value","severity"])])),_:2},1032,["modelValue","onUpdate:modelValue","options"])])),body:(0,u.k6)((e=>[(0,u.bF)((0,d.R1)(Du.A),{value:e.data.accountStatus,severity:n(e.data.accountStatus)},null,8,["value","severity"])])),_:1}),(0,u.bF)((0,d.R1)(Ia.A),{field:"createdDate",header:"å»ºç«‹æ—¥æœŸ",style:{width:"15%"}},{body:(0,u.k6)((({data:e,field:a})=>[(0,u.eW)((0,L.v_)(r(e[a])),1)])),_:1}),(0,u.bF)((0,d.R1)(Ia.A),{field:"lastLoginTime",header:"ä¸Šæ¬¡ç™»å…¥æ™‚é–“",style:{width:"15%"}},{body:(0,u.k6)((({data:e,field:a})=>[(0,u.eW)((0,L.v_)(r(e[a])),1)])),_:1}),(0,u.bF)((0,d.R1)(Ia.A),{rowEditor:!0,style:{width:"10%","min-width":"8rem"},bodyStyle:"text-align:center"})])),_:1},8,["editingRows","value","pt"])]),(0,u.bF)(i,{baseZIndex:10001})],64)}}};const Vu=Ru;var Iu=Vu,xu=l(92113),Eu=l.n(xu);const Au={id:"tree",ref:"tree",class:"chart-container"};var Tu={__name:"orgChart",setup(e){const a={department:"è‘£äº‹é•·/è‘£äº‹æœƒ",children:[{department:"ç¸½ç¶“ç†",person:"æœ±æ–‡æ¾",title:"ç¸½ç¶“ç†",children:[{department:"ç®¡ç†éƒ¨",person:"è”¡å®œå€«",person2:"éƒ­å† è¾°",title:"å”ç†",title2:"å‰¯ç†",children:[{department:"ç³»çµ±èª²",person:"éƒ­æ¬½èª ",title:"å‰¯ç†"}]},{department:"å¸‚å ´é–‹ç™¼éƒ¨",children:[{department:"åœ‹å¤–æ¥­å‹™èª²"}]},{department:"ç ”ç™¼éƒ¨",children:[{department:"ç ”ç™¼èª²"},{department:"ç”¢å“ä¼åŠƒèª²"},{department:"ç¡¬é«”èª²"},{department:"è»Ÿé«”èª²"},{department:"ç”ŸæŠ€èª²"},{department:"å“ä¿èª²"}]},{department:"è£½é€ éƒ¨",children:[{department:"ç”Ÿç®¡èª²"},{department:"æŽ¡è³¼èª²"},{department:"å¤–åŒ…èª²"},{department:"å€‰ç®¡èª²"},{department:"ç”¢ç·šèª²"},{department:"ç¶­ä¿®èª²"},{department:"å“ç®¡èª²"}]},{department:"è²¡å‹™éƒ¨",children:[{department:"åŒ—ç‡Ÿæ¥­å€",children:[{department:"äººè³‡èª²"},{department:"ç¸½å‹™èª²"},{department:"æœƒè¨ˆèª²"},{department:"è²¡å‹™èª²"}]},{department:"ä¸­ç‡Ÿæ¥­å€",children:[{department:"äººè³‡èª²"},{department:"ç¸½å‹™èª²"},{department:"æœƒè¨ˆèª²"},{department:"è²¡å‹™èª²"}]},{department:"å—ç‡Ÿæ¥­å€",children:[{department:"äººè³‡èª²"},{department:"ç¸½å‹™èª²"},{department:"æœƒè¨ˆèª²"},{department:"è²¡å‹™èª²"}]}]},{department:"è·å®‰å®¤",children:[{department:"åŒ—ç‡Ÿæ¥­å€"},{department:"ä¸­ç‡Ÿæ¥­å€"},{department:"å—ç‡Ÿæ¥­å€"}]}]}]};let l=1;function t(e,a=null,o=[]){const n=l++;return o.push({id:n,pid:a,department:e.department,title:e.title||"",person:e.person}),Array.isArray(e.children)&&e.children.forEach((e=>{t(e,n,o)})),o}const o=t(a);return(0,u.sV)((()=>{Eu().templates.ula=Object.assign({},Eu().templates.ana),Eu().templates.ula.node='<rect x="0" y="0" height="{h}" width="{w}" fill="#ffffff" stroke-width="1" stroke="#aeaeae"></rect>\n    <line x1="0" y1="0" x2="250" y2="0" stroke-width="2" stroke="#039BE5"></line>',Eu().templates.ula.field_0='<text data-width="200" style="font-size: 30px;" fill="#039BE5" x="30" y="55">{val}</text>',Eu().templates.ula.field_1='<text data-width="145" data-text-overflow="multiline" style="font-size: 14px;" fill="#afafaf" x="100" y="76">{val}</text>',Eu().templates.ula.img_0='<clipPath id="{randId}"><circle cx="50" cy="60" r="40"></circle></clipPath>\n    <image preserveAspectRatio="xMidYMid slice" clip-path="url(#{randId})" xlink:href="{val}" x="10" y="20" width="10" height="10"></image>',Eu().templates.ula.menu='<g style="cursor:pointer;" transform="matrix(1,0,0,1,225,12)" data-ctrl-n-menu-id="{id}">\n        <rect x="-4" y="-10" fill="#ffffff" width="22" height="22"></rect>\n        <circle cx="0" cy="0" r="2" fill="#039BE5"></circle>\n        <circle cx="7" cy="0" r="2" fill="#039BE5"></circle>\n        <circle cx="14" cy="0" r="2" fill="#039BE5"></circle>\n    </g>',Eu().templates.ula.nodeMenuButton='<g style="cursor:pointer;" transform="matrix(1,0,0,1,225,105)" data-ctrl-n-menu-id="{id}">\n        <rect x="-4" y="-10" fill="#000000" fill-opacity="0" width="22" height="22"></rect>\n        <circle cx="0" cy="0" r="2" fill="#AEAEAE"></circle>\n        <circle cx="7" cy="0" r="2" fill="#AEAEAE"></circle>\n        <circle cx="14" cy="0" r="2" fill="#AEAEAE"></circle>\n    </g>',new(Eu())(document.getElementById("tree"),{template:"ula",nodeBinding:{field_0:"department",field_1:"person",field_2:"title"},nodes:o,enableSearch:!1,nodeMouseClick:Eu().action.none})})),(e,a)=>((0,u.uX)(),(0,u.CE)("div",Au,null,512))}};const Wu=(0,ie.A)(Tu,[["__scopeId","data-v-f81541a6"]]);var Su=Wu,Uu=l(31121);const $u={class:"card"};var Nu={__name:"PC_BarBasic",setup(e){(0,u.sV)((()=>{a.value=t(),l.value=o()}));const a=(0,d.KR)(),l=(0,d.KR)(),t=()=>({labels:["Q1","Q2","Q3","Q4"],datasets:[{label:"Sales",data:[540,325,702,620],backgroundColor:["rgba(249, 115, 22, 0.2)","rgba(6, 182, 212, 0.2)","rgb(107, 114, 128, 0.2)","rgba(139, 92, 246 0.2)"],borderColor:["rgb(249, 115, 22)","rgb(6, 182, 212)","rgb(107, 114, 128)","rgb(139, 92, 246)"],borderWidth:1}]}),o=()=>{const e=getComputedStyle(document.documentElement),a=e.getPropertyValue("--p-text-color"),l=e.getPropertyValue("--p-text-muted-color"),t=e.getPropertyValue("--p-content-border-color");return{plugins:{legend:{labels:{color:a}}},scales:{x:{ticks:{color:l},grid:{color:t}},y:{beginAtZero:!0,ticks:{color:l},grid:{color:t}}}}};return(e,t)=>((0,u.uX)(),(0,u.CE)("div",$u,[(0,u.bF)((0,d.R1)(Uu.A),{type:"bar",data:a.value,options:l.value},null,8,["data","options"])]))}};const Xu=Nu;var Ku=Xu;const Mu={class:"card"};var Pu={__name:"PC_BarHorizontal",setup(e){(0,u.sV)((()=>{a.value=t(),l.value=o()}));const a=(0,d.KR)(),l=(0,d.KR)(),t=()=>{const e=getComputedStyle(document.documentElement);return{labels:["January","February","March","April","May","June","July"],datasets:[{label:"My First dataset",backgroundColor:e.getPropertyValue("--p-cyan-500"),borderColor:e.getPropertyValue("--p-cyan-500"),data:[65,59,80,81,56,55,40]},{label:"My Second dataset",backgroundColor:e.getPropertyValue("--p-gray-500"),borderColor:e.getPropertyValue("--p-gray-500"),data:[28,48,40,19,86,27,90]}]}},o=()=>{const e=getComputedStyle(document.documentElement),a=e.getPropertyValue("--p-text-color"),l=e.getPropertyValue("--p-text-muted-color"),t=e.getPropertyValue("--p-content-border-color");return{indexAxis:"y",maintainAspectRatio:!1,aspectRatio:.8,plugins:{legend:{labels:{color:a}}},scales:{x:{ticks:{color:l,font:{weight:500}},grid:{display:!1,drawBorder:!1}},y:{ticks:{color:l},grid:{color:t,drawBorder:!1}}}}};return(e,t)=>((0,u.uX)(),(0,u.CE)("div",Mu,[(0,u.bF)((0,d.R1)(Uu.A),{type:"bar",data:a.value,options:l.value,class:"h-[30rem]"},null,8,["data","options"])]))}};const Ou=Pu;var zu=Ou;const Bu={class:"card"};var ju={__name:"PC_BarStacked",setup(e){(0,u.sV)((()=>{a.value=t(),l.value=o()}));const a=(0,d.KR)(),l=(0,d.KR)(),t=()=>{const e=getComputedStyle(document.documentElement);return{labels:["January","February","March","April","May","June","July"],datasets:[{type:"bar",label:"Dataset 1",backgroundColor:e.getPropertyValue("--p-cyan-500"),data:[50,25,12,48,90,76,42]},{type:"bar",label:"Dataset 2",backgroundColor:e.getPropertyValue("--p-gray-500"),data:[21,84,24,75,37,65,34]},{type:"bar",label:"Dataset 3",backgroundColor:e.getPropertyValue("--p-orange-500"),data:[41,52,24,74,23,21,32]}]}},o=()=>{const e=getComputedStyle(document.documentElement),a=e.getPropertyValue("--p-text-color"),l=e.getPropertyValue("--p-text-muted-color"),t=e.getPropertyValue("--p-content-border-color");return{maintainAspectRatio:!1,aspectRatio:.8,plugins:{tooltips:{mode:"index",intersect:!1},legend:{labels:{color:a}}},scales:{x:{stacked:!0,ticks:{color:l},grid:{color:t}},y:{stacked:!0,ticks:{color:l},grid:{color:t}}}}};return(e,t)=>((0,u.uX)(),(0,u.CE)("div",Bu,[(0,u.bF)((0,d.R1)(Uu.A),{type:"bar",data:a.value,options:l.value,class:"h-[30rem]"},null,8,["data","options"])]))}};const Yu=ju;var Qu=Yu;const Hu={class:"card"};var qu={__name:"PC_BarVertical",setup(e){(0,u.sV)((()=>{a.value=t(),l.value=o()}));const a=(0,d.KR)(),l=(0,d.KR)(),t=()=>{const e=getComputedStyle(document.documentElement);return{labels:["January","February","March","April","May","June","July"],datasets:[{label:"My First dataset",backgroundColor:e.getPropertyValue("--p-cyan-500"),borderColor:e.getPropertyValue("--p-cyan-500"),data:[65,59,80,81,56,55,40]},{label:"My Second dataset",backgroundColor:e.getPropertyValue("--p-gray-500"),borderColor:e.getPropertyValue("--p-gray-500"),data:[28,48,40,19,86,27,90]}]}},o=()=>{const e=getComputedStyle(document.documentElement),a=e.getPropertyValue("--p-text-color"),l=e.getPropertyValue("--p-text-muted-color"),t=e.getPropertyValue("--p-content-border-color");return{maintainAspectRatio:!1,aspectRatio:.8,plugins:{legend:{labels:{color:a}}},scales:{x:{ticks:{color:l,font:{weight:500}},grid:{display:!1,drawBorder:!1}},y:{ticks:{color:l},grid:{color:t,drawBorder:!1}}}}};return(e,t)=>((0,u.uX)(),(0,u.CE)("div",Hu,[(0,u.bF)((0,d.R1)(Uu.A),{type:"bar",data:a.value,options:l.value,class:"h-[30rem]"},null,8,["data","options"])]))}};const Ju=qu;var Gu=Ju;const Zu={class:"card"};var ei={__name:"PC_Combo",setup(e){(0,u.sV)((()=>{a.value=t(),l.value=o()}));const a=(0,d.KR)(),l=(0,d.KR)(),t=()=>{const e=getComputedStyle(document.documentElement);return{labels:["January","February","March","April","May","June","July"],datasets:[{type:"line",label:"Dataset 1",borderColor:e.getPropertyValue("--p-orange-500"),borderWidth:2,fill:!1,tension:.4,data:[50,25,12,48,56,76,42]},{type:"bar",label:"Dataset 2",backgroundColor:e.getPropertyValue("--p-gray-500"),data:[21,84,24,75,37,65,34],borderColor:"white",borderWidth:2},{type:"bar",label:"Dataset 3",backgroundColor:e.getPropertyValue("--p-cyan-500"),data:[41,52,24,74,23,21,32]}]}},o=()=>{const e=getComputedStyle(document.documentElement),a=e.getPropertyValue("--p-text-color"),l=e.getPropertyValue("--p-text-muted-color"),t=e.getPropertyValue("--p-content-border-color");return{maintainAspectRatio:!1,aspectRatio:.6,plugins:{legend:{labels:{color:a}}},scales:{x:{ticks:{color:l},grid:{color:t}},y:{ticks:{color:l},grid:{color:t}}}}};return(e,t)=>((0,u.uX)(),(0,u.CE)("div",Zu,[(0,u.bF)((0,d.R1)(Uu.A),{type:"bar",data:a.value,options:l.value,class:"h-[30rem]"},null,8,["data","options"])]))}};const ai=ei;var li=ai;const ti={class:"card flex justify-center"};var oi={__name:"PC_Doughnut",setup(e){(0,u.sV)((()=>{a.value=t(),l.value=o()}));const a=(0,d.KR)(),l=(0,d.KR)(null),t=()=>{const e=getComputedStyle(document.body);return{labels:["A","B","C"],datasets:[{data:[540,325,702],backgroundColor:[e.getPropertyValue("--p-cyan-500"),e.getPropertyValue("--p-orange-500"),e.getPropertyValue("--p-gray-500")],hoverBackgroundColor:[e.getPropertyValue("--p-cyan-400"),e.getPropertyValue("--p-orange-400"),e.getPropertyValue("--p-gray-400")]}]}},o=()=>{const e=getComputedStyle(document.documentElement),a=e.getPropertyValue("--p-text-color");return{plugins:{legend:{labels:{cutout:"60%",color:a}}}}};return(e,t)=>((0,u.uX)(),(0,u.CE)("div",ti,[(0,u.bF)((0,d.R1)(Uu.A),{type:"doughnut",data:a.value,options:l.value,class:"w-full md:w-[30rem]"},null,8,["data","options"])]))}};const ni=oi;var ri=ni;const si={class:"card"};var ui={__name:"PC_Line",setup(e){(0,u.sV)((()=>{a.value=t(),l.value=o()}));const a=(0,d.KR)(),l=(0,d.KR)(),t=()=>{const e=getComputedStyle(document.documentElement);return{labels:["January","February","March","April","May","June","July"],datasets:[{label:"First Dataset",data:[65,59,80,81,56,55,40],fill:!1,borderColor:e.getPropertyValue("--p-cyan-500"),tension:.4},{label:"Second Dataset",data:[28,48,40,19,86,27,90],fill:!1,borderColor:e.getPropertyValue("--p-gray-500"),tension:.4}]}},o=()=>{const e=getComputedStyle(document.documentElement),a=e.getPropertyValue("--p-text-color"),l=e.getPropertyValue("--p-text-muted-color"),t=e.getPropertyValue("--p-content-border-color");return{maintainAspectRatio:!1,aspectRatio:.6,plugins:{legend:{labels:{color:a}}},scales:{x:{ticks:{color:l},grid:{color:t}},y:{ticks:{color:l},grid:{color:t}}}}};return(e,t)=>((0,u.uX)(),(0,u.CE)("div",si,[(0,u.bF)((0,d.R1)(Uu.A),{type:"line",data:a.value,options:l.value,class:"h-[30rem]"},null,8,["data","options"])]))}};const ii=ui;var di=ii;const ci={class:"card"};var pi={__name:"PC_LineMultiAxis",setup(e){(0,u.sV)((()=>{a.value=t(),l.value=o()}));const a=(0,d.KR)(),l=(0,d.KR)(),t=()=>{const e=getComputedStyle(document.documentElement);return{labels:["January","February","March","April","May","June","July"],datasets:[{label:"Dataset 1",fill:!1,borderColor:e.getPropertyValue("--p-cyan-500"),yAxisID:"y",tension:.4,data:[65,59,80,81,56,55,10]},{label:"Dataset 2",fill:!1,borderColor:e.getPropertyValue("--p-gray-500"),yAxisID:"y1",tension:.4,data:[28,48,40,19,86,27,90]}]}},o=()=>{const e=getComputedStyle(document.documentElement),a=e.getPropertyValue("--p-text-color"),l=e.getPropertyValue("--p-text-muted-color"),t=e.getPropertyValue("--p-content-border-color");return{stacked:!1,maintainAspectRatio:!1,aspectRatio:.6,plugins:{legend:{labels:{color:a}}},scales:{x:{ticks:{color:l},grid:{color:t}},y:{type:"linear",display:!0,position:"left",ticks:{color:l},grid:{color:t}},y1:{type:"linear",display:!0,position:"right",ticks:{color:l},grid:{drawOnChartArea:!1,color:t}}}}};return(e,t)=>((0,u.uX)(),(0,u.CE)("div",ci,[(0,u.bF)((0,d.R1)(Uu.A),{type:"line",data:a.value,options:l.value,class:"h-[30rem]"},null,8,["data","options"])]))}};const mi=pi;var vi=mi;const bi={class:"card"};var gi={__name:"PC_LineStyle",setup(e){(0,u.sV)((()=>{a.value=t(),l.value=o()}));const a=(0,d.KR)(),l=(0,d.KR)(),t=()=>{const e=getComputedStyle(document.documentElement);return{labels:["January","February","March","April","May","June","July"],datasets:[{label:"First Dataset",data:[65,59,80,81,56,55,40],fill:!1,tension:.4,borderColor:e.getPropertyValue("--p-cyan-500")},{label:"Second Dataset",data:[28,48,40,19,86,27,90],fill:!1,borderDash:[5,5],tension:.4,borderColor:e.getPropertyValue("--p-orange-500")},{label:"Third Dataset",data:[12,51,62,33,21,62,45],fill:!0,borderColor:e.getPropertyValue("--p-gray-500"),tension:.4,backgroundColor:"rgba(107, 114, 128, 0.2)"}]}},o=()=>{const e=getComputedStyle(document.documentElement),a=e.getPropertyValue("--p-text-color"),l=e.getPropertyValue("--p-text-muted-color"),t=e.getPropertyValue("--p-content-border-color");return{maintainAspectRatio:!1,aspectRatio:.6,plugins:{legend:{labels:{color:a}}},scales:{x:{ticks:{color:l},grid:{color:t}},y:{ticks:{color:l},grid:{color:t}}}}};return(e,t)=>((0,u.uX)(),(0,u.CE)("div",bi,[(0,u.bF)((0,d.R1)(Uu.A),{type:"line",data:a.value,options:l.value,class:"h-[30rem]"},null,8,["data","options"])]))}};const yi=gi;var fi=yi;const hi={class:"card flex justify-center"};var ki={__name:"PC_Pie",setup(e){(0,u.sV)((()=>{a.value=t(),l.value=o()}));const a=(0,d.KR)(),l=(0,d.KR)(),t=()=>{const e=getComputedStyle(document.body);return{labels:["A","B","C"],datasets:[{data:[540,325,702],backgroundColor:[e.getPropertyValue("--p-cyan-500"),e.getPropertyValue("--p-orange-500"),e.getPropertyValue("--p-gray-500")],hoverBackgroundColor:[e.getPropertyValue("--p-cyan-400"),e.getPropertyValue("--p-orange-400"),e.getPropertyValue("--p-gray-400")]}]}},o=()=>{const e=getComputedStyle(document.documentElement),a=e.getPropertyValue("--p-text-color");return{plugins:{legend:{labels:{usePointStyle:!0,color:a}}}}};return(e,t)=>((0,u.uX)(),(0,u.CE)("div",hi,[(0,u.bF)((0,d.R1)(Uu.A),{type:"pie",data:a.value,options:l.value,class:"w-full md:w-[30rem]"},null,8,["data","options"])]))}};const _i=ki;var wi=_i;const Fi={class:"card flex justify-center"};var Ci={__name:"PC_PolarArea",setup(e){(0,u.sV)((()=>{a.value=t(),l.value=o()}));const a=(0,d.KR)(),l=(0,d.KR)(),t=()=>{const e=getComputedStyle(document.documentElement);return{datasets:[{data:[11,16,7,3,14],backgroundColor:[e.getPropertyValue("--p-pink-500"),e.getPropertyValue("--p-gray-500"),e.getPropertyValue("--p-orange-500"),e.getPropertyValue("--p-purple-500"),e.getPropertyValue("--p-cyan-500")],label:"My dataset"}],labels:["Pink","Gray","Orange","Purple","Cyan"]}},o=()=>{const e=getComputedStyle(document.documentElement),a=e.getPropertyValue("--p-text-color"),l=e.getPropertyValue("--p-content-border-color");return{plugins:{legend:{labels:{color:a}}},scales:{r:{grid:{color:l}}}}};return(e,t)=>((0,u.uX)(),(0,u.CE)("div",Fi,[(0,u.bF)((0,d.R1)(Uu.A),{type:"polarArea",data:a.value,options:l.value,class:"w-full md:w-[30rem]"},null,8,["data","options"])]))}};const Di=Ci;var Li=Di;const Ri={class:"card flex justify-center"};var Vi={__name:"PC_Radar",setup(e){(0,u.sV)((()=>{a.value=t(),l.value=o()}));const a=(0,d.KR)(),l=(0,d.KR)(),t=()=>{const e=getComputedStyle(document.documentElement),a=e.getPropertyValue("--p-text-color");return{labels:["Eating","Drinking","Sleeping","Designing","Coding","Cycling","Running"],datasets:[{label:"My First dataset",borderColor:e.getPropertyValue("--p-gray-400"),pointBackgroundColor:e.getPropertyValue("--p-gray-400"),pointBorderColor:e.getPropertyValue("--p-gray-400"),pointHoverBackgroundColor:a,pointHoverBorderColor:e.getPropertyValue("--p-gray-400"),data:[65,59,90,81,56,55,40]},{label:"My Second dataset",borderColor:e.getPropertyValue("--p-pink-400"),pointBackgroundColor:e.getPropertyValue("--p-pink-400"),pointBorderColor:e.getPropertyValue("--p-pink-400"),pointHoverBackgroundColor:a,pointHoverBorderColor:e.getPropertyValue("--p-pink-400"),data:[28,48,40,19,96,27,100]}]}},o=()=>{const e=getComputedStyle(document.documentElement),a=e.getPropertyValue("--p-text-color"),l=e.getPropertyValue("--p-text-muted-color");return{plugins:{legend:{labels:{color:a}}},scales:{r:{grid:{color:l}}}}};return(e,t)=>((0,u.uX)(),(0,u.CE)("div",Ri,[(0,u.bF)((0,d.R1)(Uu.A),{type:"radar",data:a.value,options:l.value,class:"w-full md:w-[30rem]"},null,8,["data","options"])]))}};const Ii=Vi;var xi=Ii;const Ei={style:{"padding-left":"5rem"}};var Ai={__name:"PrimeChart",setup(e){return(e,a)=>((0,u.uX)(),(0,u.CE)("div",Ei,[a[0]||(a[0]=(0,u.Lk)("h2",null,"Bar Basic Chart",-1)),(0,u.bF)(Ku),a[1]||(a[1]=(0,u.Lk)("h2",null,"Bar Horizontal Chart",-1)),(0,u.bF)(zu),a[2]||(a[2]=(0,u.Lk)("h2",null,"Bar Stacked Chart",-1)),(0,u.bF)(Qu),a[3]||(a[3]=(0,u.Lk)("h2",null,"Bar Vertical Chart",-1)),(0,u.bF)(Gu),a[4]||(a[4]=(0,u.Lk)("h2",null,"Combo Chart",-1)),(0,u.bF)(li),a[5]||(a[5]=(0,u.Lk)("h2",null,"Doughnut Chart",-1)),(0,u.bF)(ri),a[6]||(a[6]=(0,u.Lk)("h2",null,"Line Multi-Axis Chart",-1)),(0,u.bF)(vi),a[7]||(a[7]=(0,u.Lk)("h2",null,"Line Style Chart",-1)),(0,u.bF)(fi),a[8]||(a[8]=(0,u.Lk)("h2",null,"Line Chart",-1)),(0,u.bF)(di),a[9]||(a[9]=(0,u.Lk)("h2",null,"Pie Chart",-1)),(0,u.bF)(wi),a[10]||(a[10]=(0,u.Lk)("h2",null,"Polar Area Chart",-1)),(0,u.bF)(Li),a[11]||(a[11]=(0,u.Lk)("h2",null,"Radar Chart",-1)),(0,u.bF)(xi)]))}};const Ti=(0,ie.A)(Ai,[["__scopeId","data-v-4ed957c8"]]);var Wi=Ti;const Si={class:"card"};var Ui={__name:"editDptFuncList_Form",setup(e){const a=(0,d.KR)([]),l=[{label:"InSide",value:"InSide"},{label:"OutSide",value:"OutSide"},{label:"NULL",value:"NULL"}],t=[{id:1,code:"A001",name:"Product A",URL_Side:"InSide",route:"editDptFuncList"},{id:2,code:"B002",name:"Product B",URL_Side:"OutSide",route:"http://192.168.1.133/sys/login/login.php"},{id:3,code:"C003",name:"Product C",URL_Side:"æš«ç„¡é€£çµ",route:30}];(0,u.sV)((()=>{a.value=t}));const o=e=>{switch(e){case"InSide":return"success";case"OutSide":return"info";case"æš«ç„¡é€£çµ":return"danger";default:return null}},n=e=>{const{data:l}=e,t=a.value.findIndex((e=>e.id===l.id));-1!==t&&(a.value[t]={...l})};return(e,t)=>((0,u.uX)(),(0,u.CE)("div",Si,[(0,u.bF)((0,d.R1)(Va.A),{value:a.value,editMode:"cell",dataKey:"id",onRowEditSave:n,pt:{table:{style:"max-width: 100rem; min-width: 30rem"},column:{bodycell:({state:e})=>({style:e["d_editing"]&&"padding-top: 0.75rem; padding-bottom: 0.75rem"})}}},{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(Ia.A),{field:"code",header:"æµæ°´è™Ÿ",style:{width:"5%"}},{editor:(0,u.k6)((({data:e,field:a})=>[(0,u.bF)((0,d.R1)(x.A),{modelValue:e[a],"onUpdate:modelValue":l=>e[a]=l,fluid:""},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),(0,u.bF)((0,d.R1)(Ia.A),{field:"name",header:"é é¢(åŠŸèƒ½)åç¨±",style:{width:"8%"}},{editor:(0,u.k6)((({data:e,field:a})=>[(0,u.bF)((0,d.R1)(x.A),{modelValue:e[a],"onUpdate:modelValue":l=>e[a]=l,fluid:""},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),(0,u.bF)((0,d.R1)(Ia.A),{field:"URL_Side",header:"ç¶²åŸŸ",style:{width:"5%"}},{editor:(0,u.k6)((({data:e,field:a})=>[(0,u.bF)((0,d.R1)(Cu.A),{modelValue:e[a],"onUpdate:modelValue":l=>e[a]=l,options:l,optionLabel:"label",optionValue:"value",placeholder:"Select a Status",fluid:""},{option:(0,u.k6)((e=>[(0,u.bF)((0,d.R1)(Du.A),{value:e.option.value,severity:o(e.option.value)},null,8,["value","severity"])])),_:2},1032,["modelValue","onUpdate:modelValue"])])),body:(0,u.k6)((e=>[(0,u.bF)((0,d.R1)(Du.A),{value:e.data.URL_Side,severity:o(e.data.URL_Side)},null,8,["value","severity"])])),_:1}),(0,u.bF)((0,d.R1)(Ia.A),{field:"route",header:"è·¯å¾‘",style:{width:"20%"}},{body:(0,u.k6)((({data:e,field:a})=>[(0,u.eW)((0,L.v_)(e[a]),1)])),editor:(0,u.k6)((({data:e,field:a})=>[(0,u.bF)((0,d.R1)(x.A),{modelValue:e[a],"onUpdate:modelValue":l=>e[a]=l,style:{width:"100%"},fluid:""},null,8,["modelValue","onUpdate:modelValue"])])),_:1})])),_:1},8,["value","pt"])]))}};const $i=Ui;var Ni=$i,Xi=l(74253);let Ki;function Mi(e){Ki=e}const Pi=()=>Ki,Oi="Mail";var zi={uploadFiles(e){const a=`${Oi}/uploadFiles`;return console.log("Request uploadFiles URL:",a),Pi().post(`${Oi}/uploadFiles`,e,{headers:{"Content-Type":"multipart/form-data"}})},getSecurityMailData(){return console.log("getSecurityMailData Path:"+Oi),Pi().get(`${Oi}/getSecurityMailData`,{headers:{"Content-Type":"application/json"}})},updateSecurityMailDataWithId(e){return Pi().put(`${Oi}/updateSecurityMailDataWithId`,e,{headers:{"Content-Type":"application/json"}})},addSecurityMailData(e){return Pi().post(`${Oi}/addSecurityMailData`,e,{headers:{"Content-Type":"application/json"}})},deleteSecurityMailDataWithId(e){return Pi().delete(`${Oi}/deleteSecurityMailDataWithId/${e}`,{headers:{"Content-Type":"application/json"}})},getLastSendId(){return Pi().get(`${Oi}/getLastSendId/`,{headers:{"Content-Type":"application/json"}})},updateSortId(e){return Pi().patch(`${Oi}/updateSortId/bulk`,e,{headers:{"Content-Type":"application/json"}})},sendTestMailToLoginUser(e){return Pi().get(`${Oi}/sendTestMailToLoginUser/${e}`,{headers:{"Content-Type":"application/json"}})},get_Job_SecurityMail_Trigger_AlarmTime(){return Pi().get(`${Oi}/get_Job_SecurityMail_Trigger_AlarmTime`,{headers:{"Content-Type":"application/json"}})},updateSecurityMailCron(e){return Pi().put(`${Oi}/updateSecurityMailCron`,e,{headers:{"Content-Type":"application/json"}})},toggleSecurityMailIsScheduled(e){return Pi().patch(`${Oi}/toggleSecurityMailIsScheduled/${e}`,{headers:{"Content-Type":"application/json"}})},restartService(){return Pi().get(`${Oi}/restartService`,{headers:{"Content-Type":"application/json"}})},getSendGroup_SendUser(){return Pi().get(`${Oi}/getSendGroup_SendUser`,{headers:{"Content-Type":"application/json"}})},restartService_usePowerShell(){return Pi().get(`${Oi}/restartService_usePowerShell`,{headers:{"Content-Type":"application/json"}})},getSendGroupId_WithMailId(e){return Pi().get(`${Oi}/getSendGroupId_WithMailId/${e}`,{headers:{"Content-Type":"application/json"}})},getUserData(){return Pi().get(`${Oi}/getUserData`,{headers:{"Content-Type":"application/json"}})},addSendGroup_SendUser(e){return Pi().post(`${Oi}/addSendGroup_SendUser`,e,{headers:{"Content-Type":"application/json"}})},updateSendGroup_SendUser(e){return Pi().put(`${Oi}/updateSendGroup_SendUser`,e,{headers:{"Content-Type":"application/json"}})},deleteSendGroup_SendUser(e){return Pi().delete(`${Oi}/deleteSendGroup_SendUser/${e}`,{headers:{"Content-Type":"application/json"}})},updateGroupsOfMail(e){return Pi().put(`${Oi}/updateGroupsOfMail`,e,{headers:{"Content-Type":"application/json"}})},setDefaultSecurityMailCron(){return Pi().get(`${Oi}/setDefaultSecurityMailCron`,{headers:{"Content-Type":"application/json"}})}},Bi=l(72416),ji=l(98945),Yi=l(85797);const Qi={style:{display:"flex","align-items":"start","justify-content":"center",position:"relative"}},Hi={style:{"margin-left":"-10rem","padding-left":"5rem","padding-right":"3rem"}},qi={style:{padding:"10px"}},Ji={style:{"margin-bottom":"15px"}},Gi={class:"p-d-flex p-jc-end"},Zi={style:{padding:"1rem","padding-left":"8rem"}},ed={style:{"margin-bottom":"1rem"}},ad={style:{"margin-bottom":"2rem"}},ld={style:{"margin-bottom":"1rem"},class:"flex flex-column gap-2"},td={key:0},od={style:{"padding-top":"1rem",display:"grid","row-gap":"10px"}},nd={key:1},rd={class:"flex flex-column gap-2"},sd={style:{"padding-top":"1rem",display:"grid","row-gap":"10px"}},ud={style:{display:"grid","row-gap":"10px"}},id={style:{display:"grid","row-gap":"10px"}};var dd={__name:"securityMail_checkBox",setup(e){const a=(0,d.KR)(!0),l=(0,d.KR)(!1),t=(0,d.KR)(!1),o=(0,d.KR)(!1),n=(0,d.KR)(!1),r=(0,d.KR)(!1),s=(0,d.KR)(!1),i=(0,d.KR)(!1),c=(0,d.KR)(!1),p=(0,d.KR)(!1),m=(0,d.KR)(!1),v=(0,d.KR)(!1),b=(0,d.KR)(!1),g=(0,d.KR)(!1),y=(0,d.KR)(!1),f=(0,d.KR)(!1),h=(0,d.KR)(!1),k=(0,d.KR)(!1),_=(0,d.KR)(null),w=(0,d.KR)(""),F=(0,d.KR)(""),C=e=>0===$.value?(k.value=!0,void setTimeout((()=>{k.value=!1}),5e3)):(t.value=!1,l.value=!1,a.value=!0,$.value&&null!==$.value?void _.value.toggle(e):(h.value=!0,void setTimeout((()=>{h.value=!1}),5e3))),D=/^[\u4E00-\u9FFF\u3040-\u30FF\u31F0-\u31FFa-zA-Z0-9_@]+$/,R=e=>e&&!D.test(e),V=()=>{if($.value&&null!==$.value){const e=N.value.find((e=>e.sendGroupId===$.value));zi.deleteSendGroup_SendUser(e.sendGroupId).then((e=>{console.log("åˆªé™¤ç¾¤çµ„æˆåŠŸ:",e.data),O(),S(),f.value=!0,setTimeout((()=>{f.value=!1}),5e3)})).catch((e=>{console.error("åˆªé™¤ç¾¤çµ„å¤±æ•—:",e)}))}},I=()=>{if($.value&&null!==$.value){const e=N.value.find((e=>e.sendGroupId===$.value));return e.label}return""},E=()=>{if(0===$.value)return y.value=!0,void setTimeout((()=>{y.value=!1}),5e3);if(!$.value)return console.log("DDD"),g.value=!0,void setTimeout((()=>{g.value=!1}),1e4);{const e=N.value.find((e=>e.sendGroupId===$.value));e?(F.value=e.label,t.value=!0,l.value=!1,a.value=!1):console.error("æ‰¾ä¸åˆ°å°æ‡‰çš„ç¾¤çµ„è³‡æ–™")}},A=()=>{a.value=!0,t.value=!1,l.value=!1},T=async()=>{if(!w.value)return v.value=!0,void setTimeout((()=>{v.value=!1}),3e3);if(R(w.value))return i.value=!0,void setTimeout((()=>{i.value=!1}),3e3);let e=[];for(const a in K.value)e=e.concat(K.value[a]);if(0===e.length)return p.value=!0,void setTimeout((()=>{p.value=!1}),3e3);const t={SendUserId:JSON.stringify(e),SendGroupName:w.value};try{const e=await zi.addSendGroup_SendUser(t);console.log("æ–°å¢žç¾¤çµ„æˆåŠŸ:",e.data),e&&(O(),w.value="",o.value=!0,a.value=!0,setTimeout((()=>{o.value=!1}),3e3),l.value=!1)}catch(n){console.error("æ–°å¢žç¾¤çµ„å¤±æ•—:",n),a.value=!0,r.value=!0,setTimeout((()=>{r.value=!1}),3e3)}},W=async()=>{if(!F.value)return b.value=!0,void setTimeout((()=>{b.value=!1}),3e3);if(R(F.value))return c.value=!0,void setTimeout((()=>{c.value=!1}),3e3);let e=[];for(const a in K.value)e=e.concat(K.value[a]);if(0===e.length)return m.value=!0,void setTimeout((()=>{m.value=!1}),3e3);const n={SendGroupId:$.value,SendUserId:JSON.stringify(e),SendGroupName:F.value};try{const e=await zi.updateSendGroup_SendUser(n);e&&(O(),F.value="",t.value=!1,o.value=!0,a.value=!0,setTimeout((()=>{o.value=!1}),3e3),l.value=!1)}catch(r){console.error("æ–°å¢žç¾¤çµ„å¤±æ•—:",r),a.value=!0,s.value=!0,setTimeout((()=>{s.value=!1}),3e3)}},S=()=>{_.value.hide(),w.value=""},U=(0,d.KR)([]),$=(0,d.KR)(null),N=(0,d.KR)([]),X=(0,u.EW)((()=>U.value.reduce(((e,a)=>{const l=a.departmentEnName,t=a.departmentChName;return e[l]||(e[l]={departmentEnName:l,departmentChName:t,users:[]}),e[l].users.push(a),e}),{}))),K=(0,d.KR)({}),M=async()=>{try{const e=await zi.getSendGroup_SendUser();console.log("ç¾¤çµ„è³‡æ–™:",e.data),N.value=e.data.map((e=>({sendGroupId:e.sendGroupId,label:e.sendGroupName,sendUserId:e.sendUserId})))}catch(e){console.error("å–å¾—ç¾¤çµ„è³‡æ–™å¤±æ•—:",e)}},P=async()=>{try{const e=await zi.getUserData();console.log("ä½¿ç”¨è€…è³‡æ–™:",e.data),U.value=e.data}catch(e){console.error("å–å¾—ä½¿ç”¨è€…è³‡æ–™å¤±æ•—:",e)}};(0,u.wB)((()=>$.value),(e=>{if(!e)return void(K.value={});const a=N.value.find((a=>a.sendGroupId===e));if(!a)return void(K.value={});let l=[];try{l=JSON.parse(a.sendUserId)}catch(t){console.error("sendUserId è§£æžå¤±æ•—:",a.sendUserId,t),l=[]}K.value={},l.forEach((e=>{const a=U.value.find((a=>a.userId===e));if(a){const l=a.departmentEnName;K.value[l]||(K.value[l]=[]),K.value[l].push(e)}}))})),(0,u.sV)((async()=>{O()}));const O=async()=>{await M(),await P()};return(e,D)=>{const U=(0,u.g2)("el-option"),M=(0,u.g2)("el-select"),P=(0,u.g2)("Panel"),O=(0,u.g2)("Button");return(0,u.uX)(),(0,u.CE)("div",Qi,[(0,u.Lk)("div",Hi,[(0,u.bF)((0,d.R1)(_a.A),{modelValue:$.value,"onUpdate:modelValue":D[0]||(D[0]=e=>$.value=e),options:N.value,optionLabel:"label",optionValue:"sendGroupId",class:"w-full md:w-14rem",placeholder:"è«‹é¸æ“‡ä¸€å€‹ç¾¤çµ„",listStyle:"min-height:10rem;max-height:100rem",onChange:A},null,8,["modelValue","options"])]),(0,u.bF)((0,d.R1)(ji.A),{ref:"ref_SecurityMail_CheckBox",blocked:a.value},{default:(0,u.k6)((()=>[(0,u.bF)(P,{header:"Basic"},{default:(0,u.k6)((()=>[(0,u.Lk)("div",null,[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(X.value,((e,a)=>((0,u.uX)(),(0,u.CE)("div",{key:a,style:{"margin-bottom":"1rem"}},[(0,u.bF)((0,d.R1)(Xi.$g),{tag:"b",style:{display:"block","margin-bottom":"0.5rem"}},{default:(0,u.k6)((()=>[(0,u.eW)((0,L.v_)(e.departmentChName),1)])),_:2},1024),(0,u.bF)(M,{modelValue:K.value[a],"onUpdate:modelValue":e=>K.value[a]=e,multiple:"",placeholder:"é¸æ“‡ "+e.departmentChName,style:{width:"240px"}},{default:(0,u.k6)((()=>[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(e.users,(e=>((0,u.uX)(),(0,u.Wv)(U,{key:e.userId,label:e.userName,value:e.userId},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue","placeholder"])])))),128))])])),_:1})])),_:1},8,["blocked"]),(0,u.bF)((0,d.R1)(Bi.A),{ref_key:"op2",ref:_,dismissable:""},{default:(0,u.k6)((()=>[(0,u.Lk)("div",qi,[(0,u.Lk)("h4",Ji," æ˜¯å¦åˆªé™¤ "+(0,L.v_)(I())+" ? ",1),(0,u.Lk)("div",Gi,[(0,u.bF)(O,{label:"æäº¤",icon:"pi pi-check",onClick:V,class:"p-button-rounded p-button-danger",style:{"margin-right":"10px"}}),(0,u.bF)(O,{label:"é—œé–‰",icon:"pi pi-times",onClick:S,class:"p-button-rounded p-button-secondary"})])])])),_:1},512),(0,u.Lk)("div",Zi,[(0,u.Lk)("div",ed,[(0,u.bF)(O,{onClick:D[1]||(D[1]=()=>{l.value=!0,t.value=!1,a.value=!1}),label:"æ–°å¢ž",severity:"success",text:"",raised:""}),(0,u.bF)(O,{onClick:E,label:"ç·¨è¼¯",severity:"info",text:"",raised:""}),(0,u.bF)(O,{onClick:D[2]||(D[2]=e=>C(e)),label:"åˆªé™¤",severity:"danger",text:"",raised:"",ref:"ref2"},null,512)]),(0,u.Lk)("div",ad,[l.value?((0,u.uX)(),(0,u.Wv)(O,{key:0,label:"å„²å­˜æ–°å¢ž",severity:"help",onClick:T,text:"",raised:""})):(0,u.Q3)("",!0),l.value?((0,u.uX)(),(0,u.Wv)(O,{key:1,label:"å–æ¶ˆæ–°å¢ž",severity:"secondary",onClick:D[3]||(D[3]=()=>{l.value=!1,t.value=!1,a.value=!0}),text:"",raised:""})):(0,u.Q3)("",!0),t.value?((0,u.uX)(),(0,u.Wv)(O,{key:2,label:"å„²å­˜ç·¨è¼¯",severity:"help",onClick:W,text:"",raised:""})):(0,u.Q3)("",!0),t.value?((0,u.uX)(),(0,u.Wv)(O,{key:3,label:"å–æ¶ˆç·¨è¼¯",severity:"secondary",onClick:D[4]||(D[4]=()=>{l.value=!1,t.value=!1,a.value=!0}),text:"",raised:""})):(0,u.Q3)("",!0)]),(0,u.Lk)("div",ld,[l.value?((0,u.uX)(),(0,u.CE)("div",td,[(0,u.bF)((0,d.R1)(tu.A),null,{default:(0,u.k6)((()=>[D[7]||(D[7]=(0,u.Lk)("label",{for:"addGroupName"},"è«‹è¼¸å…¥ç¾¤çµ„åç¨±",-1)),(0,u.bF)((0,d.R1)(x.A),{id:"addGroupName",modelValue:w.value,"onUpdate:modelValue":D[5]||(D[5]=e=>w.value=e),"aria-describedby":"addGroupName-help",invalid:R(w.value)},null,8,["modelValue","invalid"])])),_:1}),(0,u.Lk)("div",od,[R(w.value)||i.value?((0,u.uX)(),(0,u.Wv)((0,d.R1)(Yi.A),{key:0,severity:"warn"},{default:(0,u.k6)((()=>D[8]||(D[8]=[(0,u.eW)("åƒ…é™è¼¸å…¥ä¸­è‹±æ–‡ã€ç‰¹æ®Šå­—å…ƒ '_' å’Œ '@' ")]))),_:1})):(0,u.Q3)("",!0),p.value?((0,u.uX)(),(0,u.Wv)((0,d.R1)(Yi.A),{key:1,severity:"warn"},{default:(0,u.k6)((()=>D[9]||(D[9]=[(0,u.eW)("è«‹è‡³å°‘é¸æ“‡ä¸€åäººå“¡ï¼")]))),_:1})):(0,u.Q3)("",!0),v.value?((0,u.uX)(),(0,u.Wv)((0,d.R1)(Yi.A),{key:2,severity:"warn"},{default:(0,u.k6)((()=>D[10]||(D[10]=[(0,u.eW)("è«‹è¼¸å…¥ç¾¤çµ„åç¨±ï¼")]))),_:1})):(0,u.Q3)("",!0),r.value?((0,u.uX)(),(0,u.Wv)((0,d.R1)(Yi.A),{key:3,severity:"error"},{default:(0,u.k6)((()=>D[11]||(D[11]=[(0,u.eW)("ä¸æ˜ŽåŽŸå› å¤±æ•—ï¼è«‹è‡ªè¡ŒDeBug")]))),_:1})):(0,u.Q3)("",!0)])])):(0,u.Q3)("",!0),(0,u.Lk)("div",null,[o.value?((0,u.uX)(),(0,u.Wv)((0,d.R1)(Yi.A),{key:0,severity:"success"},{default:(0,u.k6)((()=>D[12]||(D[12]=[(0,u.eW)("æ–°å¢žç¾¤çµ„è³‡æ–™æˆåŠŸï¼")]))),_:1})):(0,u.Q3)("",!0)]),t.value?((0,u.uX)(),(0,u.CE)("div",nd,[(0,u.Lk)("div",rd,[D[16]||(D[16]=(0,u.Lk)("label",{for:"updateGroupName"},"ç¾¤çµ„åç¨±",-1)),(0,u.bF)((0,d.R1)(x.A),{id:"updateGroupName",modelValue:F.value,"onUpdate:modelValue":D[6]||(D[6]=e=>F.value=e),"aria-describedby":"updateGroupName-help",invalid:R(F.value)},null,8,["modelValue","invalid"]),D[17]||(D[17]=(0,u.Lk)("small",{id:"updateGroupName-help"},"åƒ…é™è¼¸å…¥ä¸­è‹±æ–‡ã€ç‰¹æ®Šå­—å…ƒ '_' å’Œ '@' ",-1)),(0,u.Lk)("div",sd,[R(F.value)||c.value?((0,u.uX)(),(0,u.Wv)((0,d.R1)(Yi.A),{key:0,severity:"warn"},{default:(0,u.k6)((()=>D[13]||(D[13]=[(0,u.eW)("åƒ…é™è¼¸å…¥ä¸­è‹±æ–‡ã€ç‰¹æ®Šå­—å…ƒ '_' å’Œ '@'")]))),_:1})):(0,u.Q3)("",!0),b.value?((0,u.uX)(),(0,u.Wv)((0,d.R1)(Yi.A),{key:1,severity:"warn"},{default:(0,u.k6)((()=>D[14]||(D[14]=[(0,u.eW)("è«‹è¼¸å…¥æ¬²ç·¨è¼¯çš„ç¾¤çµ„åç¨±ï¼")]))),_:1})):(0,u.Q3)("",!0),s.value?((0,u.uX)(),(0,u.Wv)((0,d.R1)(Yi.A),{key:2,severity:"error"},{default:(0,u.k6)((()=>D[15]||(D[15]=[(0,u.eW)("ä¸æ˜ŽåŽŸå› å¤±æ•—ï¼è«‹è‡ªè¡ŒDeBug")]))),_:1})):(0,u.Q3)("",!0)])])])):(0,u.Q3)("",!0)]),(0,u.Lk)("div",ud,[g.value?((0,u.uX)(),(0,u.Wv)((0,d.R1)(Yi.A),{key:0,severity:"warn"},{default:(0,u.k6)((()=>D[18]||(D[18]=[(0,u.eW)("è«‹é¸æ“‡æ¬²ç·¨è¼¯çš„ç¾¤çµ„ï¼")]))),_:1})):(0,u.Q3)("",!0),m.value?((0,u.uX)(),(0,u.Wv)((0,d.R1)(Yi.A),{key:1,severity:"warn"},{default:(0,u.k6)((()=>D[19]||(D[19]=[(0,u.eW)("è«‹è‡³å°‘é¸æ“‡ä¸€åäººå“¡ï¼")]))),_:1})):(0,u.Q3)("",!0),n.value?((0,u.uX)(),(0,u.Wv)((0,d.R1)(Yi.A),{key:2,severity:"success"},{default:(0,u.k6)((()=>D[20]||(D[20]=[(0,u.eW)("æ›´æ–°ç¾¤çµ„è³‡æ–™æˆåŠŸï¼")]))),_:1})):(0,u.Q3)("",!0),y.value?((0,u.uX)(),(0,u.Wv)((0,d.R1)(Yi.A),{key:3,severity:"contrast"},{default:(0,u.k6)((()=>D[21]||(D[21]=[(0,u.eW)("ç„¡æ³•ç·¨è¼¯å…¨éƒ¨ç¾¤çµ„ï¼è«‹é¸æ“‡åˆ¥çš„å°è±¡ã€‚")]))),_:1})):(0,u.Q3)("",!0)]),(0,u.Lk)("div",id,[h.value?((0,u.uX)(),(0,u.Wv)((0,d.R1)(Yi.A),{key:0,severity:"warn"},{default:(0,u.k6)((()=>D[22]||(D[22]=[(0,u.eW)("è«‹é¸æ“‡æ¬²åˆªé™¤çš„ç¾¤çµ„ï¼")]))),_:1})):(0,u.Q3)("",!0),f.value?((0,u.uX)(),(0,u.Wv)((0,d.R1)(Yi.A),{key:1,severity:"success"},{default:(0,u.k6)((()=>D[23]||(D[23]=[(0,u.eW)("åˆªé™¤ç¾¤çµ„è³‡æ–™æˆåŠŸï¼")]))),_:1})):(0,u.Q3)("",!0),k.value?((0,u.uX)(),(0,u.Wv)((0,d.R1)(Yi.A),{key:2,severity:"contrast"},{default:(0,u.k6)((()=>D[24]||(D[24]=[(0,u.eW)("ç„¡æ³•åˆªé™¤å…¨éƒ¨ç¾¤çµ„ï¼è«‹é¸æ“‡åˆ¥çš„å°è±¡ã€‚")]))),_:1})):(0,u.Q3)("",!0)])])])}}};const cd=(0,ie.A)(dd,[["__scopeId","data-v-6ff2ab36"]]);var pd=cd;const md={style:{"padding-bottom":"2rem","font-size":"20px"}};var vd={__name:"securityMail_transfer",props:{mailId:{type:Number,required:!0},subject:{type:String,required:!0}},emits:["switchTab"],setup(e,{emit:a}){const l=()=>{const e={sendGroupId:JSON.stringify(r.value),mailId:t.mailId};zi.updateGroupsOfMail(e)},t=e,o=a,n=(0,d.KR)([]),r=(0,d.KR)([]),s=()=>{o("switchTab","ç¾¤çµ„è¨­å®š")};async function i(e){try{const a=await zi.getSendGroupId_WithMailId(e);r.value=a.data}catch(a){console.error("å–å¾—è³‡æ–™å¤±æ•—:",a)}}const c=async()=>{try{const e=await zi.getSendGroup_SendUser(),a=e.data.map((e=>({key:e.sendGroupId,label:e.sendGroupName})));n.value=a}catch(e){console.error("å–å¾—è³‡æ–™å¤±æ•—:",e)}};return(0,u.wB)((()=>t.mailId),(e=>{i(e)}),{immediate:!0}),(0,u.sV)((async()=>{i(t.mailId),await c(),console.log("subject",t.subject)})),(0,u.hi)((()=>{n.value=[],r.value=[]})),(e,a)=>{const o=(0,u.g2)("el-empty"),i=(0,u.g2)("el-transfer");return(0,u.uX)(),(0,u.CE)(u.FK,null,[(0,u.Lk)("h1",md,(0,L.v_)(t.subject),1),(0,u.bF)(i,{modelValue:r.value,"onUpdate:modelValue":a[0]||(a[0]=e=>r.value=e),data:n.value,titles:["ç¾¤çµ„","å·²è¨­ç½®ç¾¤çµ„"],onChange:l},{"left-empty":(0,u.k6)((()=>[(0,u.Lk)("div",{class:"addCard",onClick:s},a[1]||(a[1]=[(0,u.Lk)("i",{class:"pi pi-plus",style:{height:"100%","font-size":"3rem",color:"rgb(156, 194, 238)",cursor:"pointer"},title:"æ–°å¢žè³‡å®‰éƒµä»¶"},null,-1)]))])),"right-empty":(0,u.k6)((()=>[(0,u.bF)(o,{"image-size":60,description:"No data"})])),_:1},8,["modelValue","data"])],64)}}};const bd=(0,ie.A)(vd,[["__scopeId","data-v-27539b65"]]);var gd=bd;const yd={style:{"padding-left":"5rem","margin-top":"-5rem"}},fd={class:"dialog-footer"};var hd={__name:"GroupsDialog",props:{mailId:{type:Number,required:!0},subject:{type:String,required:!0}},setup(e){const a=e,l=(0,d.KR)(!1),t=e=>{console.log("Before close triggered"),e()},o=(0,d.KR)("ä¿¡ä»¶ç™¼é€ç¾¤çµ„è¨­ç½®"),n=e=>{console.log(`åˆ‡æ›åˆ° tab: ${e}`),o.value=e,console.log(`tab: ${o.value}`)};return(e,r)=>{const s=(0,u.g2)("el-tab-pane"),i=(0,u.g2)("el-tabs"),d=(0,u.g2)("el-button"),c=(0,u.g2)("el-dialog");return(0,u.uX)(),(0,u.CE)(u.FK,null,[(0,u.bF)(i,{modelValue:o.value,"onUpdate:modelValue":r[0]||(r[0]=e=>o.value=e),"tab-position":"left",class:"demo-tabs"},{default:(0,u.k6)((()=>[(0,u.bF)(s,{label:"ä¿¡ä»¶ç™¼é€ç¾¤çµ„è¨­ç½®",name:"ä¿¡ä»¶ç™¼é€ç¾¤çµ„è¨­ç½®"}),(0,u.bF)(s,{label:"ç¾¤çµ„è¨­å®š",name:"ç¾¤çµ„è¨­å®š"})])),_:1},8,["modelValue"]),(0,u.Lk)("div",yd,["ä¿¡ä»¶ç™¼é€ç¾¤çµ„è¨­ç½®"===o.value?((0,u.uX)(),(0,u.Wv)(gd,{key:0,mailId:a.mailId,subject:a.subject,onSwitchTab:n},null,8,["mailId","subject"])):(0,u.Q3)("",!0),"ç¾¤çµ„è¨­å®š"===o.value?((0,u.uX)(),(0,u.Wv)(pd,{key:1,mailId:a.mailId},null,8,["mailId"])):(0,u.Q3)("",!0)]),(0,u.bF)(c,{modelValue:l.value,"onUpdate:modelValue":r[2]||(r[2]=e=>l.value=e),title:"ç®¡ç†",width:"80rem","before-close":t,draggable:""},{footer:(0,u.k6)((()=>[(0,u.Lk)("div",fd,[(0,u.bF)(d,{onClick:r[1]||(r[1]=e=>l.value=!1)},{default:(0,u.k6)((()=>r[3]||(r[3]=[(0,u.eW)("é—œé–‰")]))),_:1})])])),_:1},8,["modelValue"])],64)}}};const kd=hd;var _d=kd,wd=l(44036),Fd=l(34163),Cd=l.n(Fd),Dd=l(74624),Ld=l(37972),Rd=l(23173),Vd=l(80211);const Id={class:"wrapper"},xd={style:{"justify-content":"center",width:"90%",border:"3px solid #757575","box-shadow":"0 4px 6px rgba(0,0,0,0.2)",padding:"10px"},class:"pt-2"},Ed={class:"text-lightest pt-2",style:{"font-size":"25px"}},Ad={style:{display:"flex","align-items":"center",margin:"0"}},Td={style:{flex:"5",padding:"1rem","padding-right":"4rem","text-align":"center"}},Wd={key:0},Sd={key:1},Ud={class:"pt-6"},$d={style:{"background-color":"mintcream","font-size":"24px","font-weight":"bold",color:"#42b983"}},Nd={key:0,class:"card-container mt-5"},Xd={class:"flex gap-4 mt-1 mb-3 ml-5",style:{width:"80%"}},Kd={class:"Mail_Subject"},Md={class:"card-content"},Pd={key:0,class:"content truncated"},Od=["innerHTML"],zd={key:1,class:"content expanded"},Bd=["innerHTML"],jd={class:"container"},Yd=["onUpdate:modelValue"],Qd={style:{position:"fixed",top:"13rem",right:"5%",margin:"0"}},Hd={class:"field"},qd={class:"field"},Jd={key:0},Gd={key:1},Zd={class:"dialog-footer"};var ec={__name:"SecurityMail",setup(e){(0,S.k)();const a=(0,Vd.S)(),l=(0,T.d)(),o=(0,d.KR)(!1),n=(0,d.KR)("Security Mail"),r=(0,d.KR)([{name:"è³‡è¨Šå®‰å…¨å®£å°Ž",code:"Security Mail"},{name:"å…¬å‘Šéƒµä»¶",code:"Announcement"},{name:"æ´»å‹•é€šçŸ¥éƒµä»¶",code:"Event Notice"},{name:"ç·Šæ€¥é€šçŸ¥",code:"Emergency Notice"},{name:"ç°½æ ¸é€šçŸ¥æ ¼å¼",code:"Approval Notice"}]),s=(0,d.KR)(!1),i=e=>{console.log("Before close triggered"),e()},c=async()=>{U.value=!0;var e=await zi.setDefaultSecurityMailCron();e.data?(U.value=!1,l.add({severity:"success",summary:"é‚„åŽŸæˆåŠŸï¼",detail:"",life:3e3}),f.value=!0,p.value=await ee()):(U.value=!1,l.add({severity:"error",summary:"é‚„åŽŸå¤±æ•—ï¼",detail:"",life:3e3}))},p=(0,d.KR)(""),m=(0,d.KR)(null),v=(0,d.KR)(null),b=(e,a)=>{m.value=e,v.value=a,s.value=!0},g=(0,u.EW)((()=>{try{return Cd().toString(p.value,{locale:"zh_TW"})}catch(e){return"ç„¡æ³•è§£æžçš„ Cron è¡¨é”å¼"+e}})),y=async()=>{o.value=!0;var e=await zi.updateSecurityMailCron({TriggerName:"Job_SecurityMail_Trigger",CronExpression:p.value});e.data?(o.value=!1,l.add({severity:"success",summary:"æ›´æ–°æˆåŠŸï¼",detail:"",life:3e3}),f.value=!0):(o.value=!1,l.add({severity:"error",summary:"æ›´æ–°å¤±æ•—ï¼",detail:"",life:3e3}))},f=(0,d.KR)(!0),h=(0,d.KR)(!1),k=(0,d.KR)("ç·¨è¼¯éƒµä»¶"),_=(0,d.KR)([]),w=(0,d.KR)({sortId:null,subject:"",body:""}),F=(0,u.EW)((()=>ae.value.slice().sort(((e,a)=>e.sortId-a.sortId))));function C(e,a){k.value=a,w.value=e?{...e}:{sortId:null,subject:"",body:""},h.value=!0}const D=async(e,t)=>{a.require({target:t.currentTarget,message:`è«‹å•è¦åˆªé™¤ "${e.subject}" éƒµä»¶å—Ž?`,icon:"pi pi-info-circle",rejectProps:{label:"Cancel",severity:"secondary",outlined:!0},acceptProps:{label:"Delete",severity:"danger"},accept:async()=>{const a=await zi.deleteSecurityMailDataWithId(e.mailId);console.log(a.data),await W(),l.add({severity:"success",summary:"Success",detail:"åˆªé™¤æˆåŠŸ",life:3e3})},reject:()=>{}})};async function R(){try{await zi.updateSecurityMailDataWithId({mailId:w.value.mailId,subject:w.value.subject,body:w.value.body}),h.value=!1,await W()}catch(e){console.error("å„²å­˜è³‡æ–™å¤±æ•—:",e)}}async function V(){if(w.value.subject)try{await zi.addSecurityMailData({subject:w.value.subject,body:w.value.body}),h.value=!1,await W()}catch(e){console.error("å„²å­˜è³‡æ–™å¤±æ•—:",e)}else l.add({severity:"warn",summary:"è«‹è¼¸å…¥ä¸»æ—¨ï¼",detail:"",life:3e3})}async function W(){try{const e=await zi.getSecurityMailData(),a=e.data.map((e=>{const a=e.body.replace(/<img([^>]+)>/gi,((e,a)=>/width=/.test(a)?`<img ${a}>`:`<img ${a} width="250px">`));return{...e,isScheduled:"true"===e.isScheduled.toLowerCase(),fullBody:a}}));_.value=a,ae.value=_.value.slice()}catch(e){console.error("å–å¾—è³‡æ–™å¤±æ•—:",e)}}const U=(0,d.KR)(!1),$=e=>{const a=new DOMParser,l=a.parseFromString(e,"text/html"),t=l.querySelector("img"),o=!!t?.src;return{src:o?t.src:"/no_image.jpg",preview:o}},N=(0,d.KR)(null),X=async()=>{const e=await zi.getLastSendId();N.value=e.data},K=e=>e.mailId===N.value;function M(){ae.value.forEach(((e,a)=>{e.sortId=a})),_.value=[...ae.value],P({value:ae.value})}const P=e=>{const a=e.value;a.forEach(((e,a)=>{e.sortId=a}));const l={items:a.map((e=>({mailId:e.mailId,sortId:e.sortId})))};zi.updateSortId(l).then((e=>{console.log("æ›´æ–°æˆåŠŸ",e.data)})).catch((e=>{console.error("æ›´æ–°å¤±æ•—",e)}))},O=(e,a)=>{const l=a.find((e=>e.mailId===N.value))||"0";if(void 0===l)return"0"===e.sortId;if(!l)return!1;const t=a.indexOf(l),o=a.length;for(let n=1;n<=o;n++){const l=(t+n)%o,r=a[l];if(r&&!0===r.isScheduled)return e.mailId===r.mailId}return!1},z=(0,d.KR)(),B=(0,d.KR)(),j=(0,d.KR)(),Y=(0,d.KR)(),Q=(0,d.KR)(),H=(0,d.KR)(!1),J=(0,d.KR)(0),G=e=>{if(2===e&&f.value){const e=B.value.$el;e.disabled=!1,e.click()}};(0,u.wB)(H,((e,a)=>{if(console.log(`startTour å˜åŒ–: ${a} -> ${e}`),!e&&a&&Y.value?.$el){const e=Y.value.$el;e.disabled=!1,e.click()}})),(0,u.wB)(n,((e,a)=>{e&&0!==e.length||(n.value=a)}));const Z=()=>{f.value=!1,setTimeout((()=>{J.value=2}),500)},ee=async()=>{const e=await zi.get_Job_SecurityMail_Trigger_AlarmTime();return e.data},ae=(0,d.KR)([]);function le(e){e.isScheduled=!e.isScheduled,zi.toggleSecurityMailIsScheduled(e.mailId).then((e=>{_.value=e.data})).catch((e=>{console.error("æ›´æ–°å¤±æ•—",e)}))}return(0,u.sV)((async()=>{await W(),await X(),p.value=await ee()})),(e,a)=>{const l=(0,u.g2)("el-tour-step"),_=(0,u.g2)("el-tour"),T=(0,u.g2)("InfoFilled"),W=(0,u.g2)("el-icon"),S=(0,u.g2)("el-button"),N=(0,u.g2)("el-divider"),X=(0,u.g2)("cron-element-plus"),P=(0,u.g2)("Panel"),J=(0,u.g2)("el-popover"),ee=(0,u.g2)("star-filled"),te=(0,u.g2)("el-dialog");return(0,u.uX)(),(0,u.CE)(u.FK,null,[(0,u.bF)(_,{modelValue:H.value,"onUpdate:modelValue":a[0]||(a[0]=e=>H.value=e),type:"primary",onChange:G},{default:(0,u.k6)((()=>[(0,u.bF)(l,{target:z.value?.$el,title:"è³‡å®‰éƒµä»¶æŽ’ç¨‹",description:"å¯ä»¥åœ¨é€™è£¡æŸ¥çœ‹è³‡å®‰éƒµä»¶çš„æŽ’ç¨‹"},null,8,["target"]),(0,u.bF)(l,{target:B.value?.$el,title:"ç·¨è¼¯",description:"é»žæ“Šç·¨è¼¯ï¼Œé–‹å§‹ç·¨è¼¯"},null,8,["target"]),(0,u.bF)(l,{target:z.value?.$el,title:"ç·¨è¼¯æŽ’ç¨‹",description:"åœ¨é€™è£¡ä¾æ“šè‡ªå·±çš„éœ€æ±‚ä¿®æ”¹æŽ’ç¨‹"},null,8,["target"]),(0,u.bF)(l,{target:j.value?.$el,title:"ç·¨è¼¯å®Œæˆ",description:"æŒ‰ä¸‹å„²å­˜ç·¨è¼¯ï¼Œå³å¯ä¿®æ”¹æŽ’ç¨‹"},null,8,["target"]),(0,u.bF)(l,{target:Q.value?.$el,title:"é‚„åŽŸæŽ’ç¨‹",description:"æŒ‰ä¸‹å¾Œå³å¯å°‡æŽ’ç¨‹é‚„åŽŸå›žé è¨­çš„ã€Œæ¯å‘¨ä¸€æ—©ä¸Š8:00ã€"},null,8,["target"]),(0,u.bF)(l,{target:Y.value?.$el,title:"å–æ¶ˆ",description:"è‹¥è‡¨æ™‚ä¸æƒ³ä¿®æ”¹æŽ’ç¨‹ï¼Œå¯ä»¥æŒ‰ä¸‹å–æ¶ˆ"},null,8,["target"])])),_:1},8,["modelValue"]),(0,u.Lk)("div",Id,[(0,u.bF)(N,{"content-position":"center","margin-top":"20px"},{default:(0,u.k6)((()=>[(0,u.bF)(S,{severity:"info",onClick:a[1]||(a[1]=e=>H.value=!0)},{default:(0,u.k6)((()=>[(0,u.bF)(W,null,{default:(0,u.k6)((()=>[(0,u.bF)(T)])),_:1}),a[16]||(a[16]=(0,u.eW)("Â  é»žæˆ‘æ•™å­¸ "))])),_:1})])),_:1}),(0,u.Lk)("div",xd,[(0,u.bF)((0,d.R1)(ji.A),{ref_key:"ref1",ref:z,blocked:f.value},{default:(0,u.k6)((()=>[(0,u.bF)(P,{header:"Basic"},{default:(0,u.k6)((()=>[(0,u.bF)(X,{modelValue:p.value,"onUpdate:modelValue":a[2]||(a[2]=e=>p.value=e),"button-props":{type:"secondary"}},null,8,["modelValue"]),(0,u.Lk)("p",Ed," ç•¶å‰æŽ’ç¨‹ï¼š"+(0,L.v_)(g.value),1)])),_:1})])),_:1},8,["blocked"]),(0,u.Lk)("div",Ad,[a[22]||(a[22]=(0,u.Lk)("div",{style:{flex:"1"}},null,-1)),(0,u.Lk)("div",Td,[!0===f.value?((0,u.uX)(),(0,u.CE)("div",Wd,[(0,u.bF)((0,d.R1)(E.A),{severity:"contrast",disabled:H.value,ref_key:"ref2",ref:B,onClick:a[3]||(a[3]=e=>Z()),raised:""},{default:(0,u.k6)((()=>a[17]||(a[17]=[(0,u.eW)(" ç·¨è¼¯ ")]))),_:1},8,["disabled"])])):((0,u.uX)(),(0,u.CE)("div",Sd,[(0,u.bF)(S,{style:{height:"40px"},class:"mr-3",ref_key:"ref3",ref:j,type:"primary",disabled:H.value||U.value,loading:o.value,onClick:a[4]||(a[4]=e=>y())},{default:(0,u.k6)((()=>a[18]||(a[18]=[(0,u.eW)(" å„²å­˜ç·¨è¼¯ ")]))),_:1},8,["disabled","loading"]),(0,u.bF)(J,{placement:"top-start",title:"é‚„åŽŸé è¨­",width:200,trigger:"hover",content:"å°‡æŽ’ç¨‹é‚„åŽŸç‚ºã€Œæ¯å€‹ç¦®æ‹œä¸€çš„æ—©ä¸Šå…«é»žã€"},{reference:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(E.A),{style:{height:"40px"},class:"mr-3",ref_key:"ref5",ref:Q,severity:"warn",disabled:H.value,loading:U.value,onClick:a[5]||(a[5]=e=>c())},{default:(0,u.k6)((()=>a[19]||(a[19]=[(0,u.eW)(" é‚„åŽŸæŽ’ç¨‹ ")]))),_:1},8,["disabled","loading"])])),_:1}),(0,u.bF)((0,d.R1)(E.A),{severity:"secondary",ref_key:"ref4",ref:Y,disabled:H.value,onClick:a[6]||(a[6]=e=>f.value=!0),raised:""},{default:(0,u.k6)((()=>a[20]||(a[20]=[(0,u.eW)(" å–æ¶ˆ ")]))),_:1},8,["disabled"])]))]),(0,u.Q3)("",!0)])]),(0,u.Lk)("div",Ud,[(0,u.bF)(N,{"content-position":"center"},{default:(0,u.k6)((()=>[(0,u.bF)(W,{style:{"background-color":"mintcream","font-size":"20px",color:"#42b9a1"}},{default:(0,u.k6)((()=>[(0,u.bF)(ee)])),_:1}),(0,u.Lk)("span",$d,(0,L.v_)((n.value.name,n.value.name)),1),(0,u.bF)(W,{style:{"background-color":"mintcream","font-size":"20px",color:"#42b9a1"}},{default:(0,u.k6)((()=>[(0,u.bF)(ee)])),_:1})])),_:1})]),"Security Mail"===n.value?.code?((0,u.uX)(),(0,u.CE)("div",Nd,[(0,u.bF)((0,d.R1)(Ld.MA),{modelValue:ae.value,"onUpdate:modelValue":a[7]||(a[7]=e=>ae.value=e),"item-key":"mailId",onEnd:M,"ghost-class":"ghost",class:"card-container mt-5"},{default:(0,u.k6)((()=>[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(F.value,((e,l)=>((0,u.uX)(),(0,u.CE)("div",{class:"card-item",key:l},[(0,u.bF)((0,d.R1)(ml.A),{class:"my-card"},{header:(0,u.k6)((()=>[(0,u.bF)(S,{plain:"",onClick:a=>b(e.mailId,e.subject)},{default:(0,u.k6)((()=>a[23]||(a[23]=[(0,u.eW)(" ç¾¤çµ„ ")]))),_:2},1032,["onClick"]),K(e)?((0,u.uX)(),(0,u.Wv)((0,d.R1)(q.A),{key:0,value:"ä¸Šæ¬¡ç™¼é€",size:"xlarge",severity:"warn",class:"badge-top-right"})):(0,u.Q3)("",!0),O(e,F.value)?((0,u.uX)(),(0,u.Wv)((0,d.R1)(q.A),{key:1,value:"ä¸‹æ¬¡ç™¼é€",size:"xlarge",severity:"danger",class:"badge-top-right"})):(0,u.Q3)("",!0),(0,u.bF)((0,d.R1)(Du.A),{severity:e.isScheduled?"success":"danger",value:e.isScheduled?"å•Ÿç”¨":"é—œé–‰",onClick:a=>le(e),rounded:"",style:{cursor:"pointer"}},null,8,["severity","value","onClick"]),(0,u.bF)((0,d.R1)(Dd.A),{modelValue:e.isScheduled,"onUpdate:modelValue":()=>le(e),binary:""},null,8,["modelValue","onUpdate:modelValue"]),(0,u.Lk)("div",Xd,[(0,u.bF)((0,d.R1)(E.A),{label:"åˆªé™¤",severity:"secondary",outlined:"",class:"w-full",onClick:a=>D(e,a)},null,8,["onClick"]),(0,u.bF)((0,d.R1)(E.A),{label:"ç·¨è¼¯",class:"w-full",onClick:a=>C(e,"ç·¨è¼¯éƒµä»¶")},null,8,["onClick"])]),(0,u.bF)((0,d.R1)(Sr.A),{src:$(e.body).src,alt:"User Header",width:"250px",preview:$(e.body).preview},null,8,["src","preview"])])),title:(0,u.k6)((()=>[(0,u.Lk)("div",Kd,(0,L.v_)(e.subject),1)])),content:(0,u.k6)((()=>[(0,u.Lk)("div",Md,[e.showFullContent?((0,u.uX)(),(0,u.CE)("div",zd,[(0,u.Lk)("div",{innerHTML:e.fullBody,class:"content-images"},null,8,Bd)])):((0,u.uX)(),(0,u.CE)("div",Pd,[(0,u.Lk)("div",{innerHTML:e.body},null,8,Od)])),(0,u.Lk)("label",jd,[(0,u.bo)((0,u.Lk)("input",{type:"checkbox","onUpdate:modelValue":a=>e.showFullContent=a},null,8,Yd),[[t.lH,e.showFullContent]]),a[24]||(a[24]=(0,u.Lk)("svg",{viewBox:"0 0 512 512",height:"1em",class:"chevron-down"},[(0,u.Lk)("path",{d:"M233.4 406.6c12.5 12.5 32.8 12.5 45.3 0l192-192\r\n                            c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L256 338.7\r\n                            86.6 169.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8\r\n                            0 45.3l192 192z"})],-1))])])])),_:2},1024)])))),128))])),_:1},8,["modelValue"]),(0,u.Lk)("div",{class:"addSecurityMail",onClick:a[8]||(a[8]=e=>C(null,"æ–°å¢žéƒµä»¶"))},a[25]||(a[25]=[(0,u.Lk)("div",{class:"addCard"},[(0,u.Lk)("i",{class:"pi pi-plus",style:{"font-size":"5rem",color:"orange",cursor:"pointer"},title:"æ–°å¢žè³‡å®‰éƒµä»¶"})],-1)]))])):(0,u.Q3)("",!0),(0,u.Lk)("div",Qd,[(0,u.bF)((0,d.R1)(_a.A),{modelValue:n.value,"onUpdate:modelValue":a[9]||(a[9]=e=>n.value=e),options:r.value,optionLabel:"name",checkmark:"",highlightOnSelect:!1,class:"w-full md:w-56"},null,8,["modelValue","options"])]),a[29]||(a[29]=(0,u.Lk)("div",{style:{position:"absolute",top:"20rem",right:"10%",margin:"0"}},null,-1)),(0,u.bF)((0,d.R1)(I.A),{header:k.value,visible:h.value,"onUpdate:visible":a[13]||(a[13]=e=>h.value=e),style:{width:"50vw",height:"40vw"},modal:""},{footer:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(E.A),{label:"å–æ¶ˆ",onClick:a[12]||(a[12]=e=>h.value=!1),class:"p-button-text"}),"ç·¨è¼¯éƒµä»¶"===k.value?((0,u.uX)(),(0,u.CE)("div",Jd,[(0,u.bF)((0,d.R1)(E.A),{label:"å„²å­˜",onClick:R})])):(0,u.Q3)("",!0),"æ–°å¢žéƒµä»¶"===k.value?((0,u.uX)(),(0,u.CE)("div",Gd,[(0,u.bF)((0,d.R1)(E.A),{label:"æ–°å¢ž",onClick:V})])):(0,u.Q3)("",!0)])),default:(0,u.k6)((()=>[(0,u.Lk)("div",Hd,[a[26]||(a[26]=(0,u.Lk)("label",{for:"subject"},"ä¸»æ—¨ï¼š",-1)),(0,u.bF)((0,d.R1)(x.A),{style:{width:"100%"},modelValue:w.value.subject,"onUpdate:modelValue":a[10]||(a[10]=e=>w.value.subject=e),invalid:!w.value.subject,id:"subject"},null,8,["modelValue","invalid"])]),(0,u.Lk)("div",qd,[a[27]||(a[27]=(0,u.Lk)("label",{for:"body"},"å…§å®¹ï¼š",-1)),(0,u.bF)((0,d.R1)(wd.A),{modelValue:w.value.body,"onUpdate:modelValue":a[11]||(a[11]=e=>w.value.body=e),editorStyle:"height: 320px; width: 100%;"},null,8,["modelValue"])])])),_:1},8,["header","visible"]),(0,u.bF)(te,{modelValue:s.value,"onUpdate:modelValue":a[15]||(a[15]=e=>s.value=e),width:"80rem","before-close":i,draggable:""},{footer:(0,u.k6)((()=>[(0,u.Lk)("div",Zd,[(0,u.bF)(S,{onClick:a[14]||(a[14]=e=>s.value=!1)},{default:(0,u.k6)((()=>a[28]||(a[28]=[(0,u.eW)("é—œé–‰")]))),_:1})])])),default:(0,u.k6)((()=>[s.value?((0,u.uX)(),(0,u.Wv)(_d,{key:0,mailId:m.value,subject:v.value},null,8,["mailId","subject"])):(0,u.Q3)("",!0)])),_:1},8,["modelValue"])]),(0,u.bF)((0,d.R1)(Rd.A)),(0,u.bF)((0,d.R1)(A.A))],64)}}};const ac=(0,ie.A)(ec,[["__scopeId","data-v-5e34c6df"]]);var lc=ac;const tc={class:"card"};var oc={__name:"BulletinBoard",setup(e){const a=(0,d.KR)([]),l=[{label:"InSide",value:"InSide"},{label:"OutSide",value:"OutSide"},{label:"NULL",value:"NULL"}],t=[{id:1,code:"A001",name:"Product A",URL_Side:"InSide",route:"editDptFuncList"},{id:2,code:"B002",name:"Product B",URL_Side:"OutSide",route:"http://192.168.1.133/sys/login/login.php"},{id:3,code:"C003",name:"Product C",URL_Side:"æš«ç„¡é€£çµ",route:30}];(0,u.sV)((()=>{a.value=t}));const o=e=>{switch(e){case"InSide":return"success";case"OutSide":return"info";case"æš«ç„¡é€£çµ":return"danger";default:return null}},n=e=>{const{data:l}=e,t=a.value.findIndex((e=>e.id===l.id));-1!==t&&(a.value[t]={...l})};return(e,t)=>((0,u.uX)(),(0,u.CE)("div",tc,[(0,u.bF)((0,d.R1)(Va.A),{value:a.value,editMode:"cell",dataKey:"id",onRowEditSave:n,pt:{table:{style:"max-width: 100rem; min-width: 30rem"},column:{bodycell:({state:e})=>({style:e["d_editing"]&&"padding-top: 0.75rem; padding-bottom: 0.75rem"})}}},{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(Ia.A),{field:"code",header:"æµæ°´è™Ÿ",style:{width:"5%"}},{editor:(0,u.k6)((({data:e,field:a})=>[(0,u.bF)((0,d.R1)(x.A),{modelValue:e[a],"onUpdate:modelValue":l=>e[a]=l,fluid:""},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),(0,u.bF)((0,d.R1)(Ia.A),{field:"name",header:"é é¢(åŠŸèƒ½)åç¨±",style:{width:"8%"}},{editor:(0,u.k6)((({data:e,field:a})=>[(0,u.bF)((0,d.R1)(x.A),{modelValue:e[a],"onUpdate:modelValue":l=>e[a]=l,fluid:""},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),(0,u.bF)((0,d.R1)(Ia.A),{field:"URL_Side",header:"ç¶²åŸŸ",style:{width:"5%"}},{editor:(0,u.k6)((({data:e,field:a})=>[(0,u.bF)((0,d.R1)(Cu.A),{modelValue:e[a],"onUpdate:modelValue":l=>e[a]=l,options:l,optionLabel:"label",optionValue:"value",placeholder:"Select a Status",fluid:""},{option:(0,u.k6)((e=>[(0,u.bF)((0,d.R1)(Du.A),{value:e.option.value,severity:o(e.option.value)},null,8,["value","severity"])])),_:2},1032,["modelValue","onUpdate:modelValue"])])),body:(0,u.k6)((e=>[(0,u.bF)((0,d.R1)(Du.A),{value:e.data.URL_Side,severity:o(e.data.URL_Side)},null,8,["value","severity"])])),_:1}),(0,u.bF)((0,d.R1)(Ia.A),{field:"route",header:"è·¯å¾‘",style:{width:"20%"}},{body:(0,u.k6)((({data:e,field:a})=>[(0,u.eW)((0,L.v_)(e[a]),1)])),editor:(0,u.k6)((({data:e,field:a})=>[(0,u.bF)((0,d.R1)(x.A),{modelValue:e[a],"onUpdate:modelValue":l=>e[a]=l,style:{width:"100%"},fluid:""},null,8,["modelValue","onUpdate:modelValue"])])),_:1})])),_:1},8,["value","pt"])]))}};const nc=oc;var rc=nc;const sc={class:"card justify-center",style:{display:"flex","flex-direction":"column","align-items":"center","padding-top":"10%"}},uc={style:{"font-size":"3rem","text-align":"center"}};var ic={__name:"login_delay",setup(e){const a=(0,d.KR)("ç™»é™¸é€¾æ™‚ï¼è«‹ç™»å…¥å¾Œå†é€²è¡Œæ“ä½œ"),l=(0,d.KR)("DDD");function t(){"Notification"in window&&("granted"===Notification.permission?new Notification("ç³»çµ±æç¤º",{body:l.value,icon:"https://example.com/icon.png"}):"denied"!==Notification.permission&&Notification.requestPermission().then((e=>{"granted"===e&&new Notification("ç³»çµ±æç¤º",{body:a.value,icon:"https://example.com/icon.png"})})))}return(0,u.sV)((()=>{t()})),(e,l)=>((0,u.uX)(),(0,u.CE)("div",sc,[(0,u.Lk)("div",uc,[l[0]||(l[0]=(0,u.Lk)("i",{class:"pi pi-exclamation-triangle",style:{"font-size":"3rem",color:"orange"}},null,-1)),(0,u.eW)(" "+(0,L.v_)(a.value),1)]),(0,u.Lk)("button",{onClick:t,style:{"margin-top":"20px",padding:"10px 20px"}}," é¡¯ç¤ºé€šçŸ¥ ")]))}};const dc=ic;var cc=dc;const pc={class:"user-info-top-right"},mc={class:"user-info-container"},vc={key:0,class:"tag-container"};var bc={__name:"vLogin",setup(e){const a=(0,S.k)(),t=(0,d.KR)(!1),o=(0,u.EW)((()=>!!m().get("userId")||!!a.userId)),n=(0,u.EW)((()=>m().get("userName")||a.userName||"")),r=()=>{t.value=!0},s=async()=>{try{const{stopPresenceHub:e}=await Promise.resolve().then(l.bind(l,98815)),{stopOnlineHub:a}=await Promise.resolve().then(l.bind(l,11826));await Promise.all([e(),a()]),console.log("SignalR é€£ç·šå·²æ­£ç¢ºæ–·é–‹")}catch(e){console.error("æ–·é–‹ SignalR é€£ç·šæ™‚ç™¼ç”ŸéŒ¯èª¤:",e)}a.clearUserInfo(),m().remove("userId"),m().remove("userName"),m().remove("departmentId"),m().remove("departmentName"),m().remove("dpt_title_Id"),m().remove("titleId"),m().remove("titleName"),m().remove("email"),localStorage.removeItem("auth")},i=()=>{t.value=!1};return(e,a)=>((0,u.uX)(),(0,u.CE)("div",pc,[(0,u.Lk)("div",mc,[o.value?((0,u.uX)(),(0,u.CE)("div",vc,[(0,u.Lk)("span",null,(0,L.v_)(n.value),1)])):(0,u.Q3)("",!0),(0,u.Lk)("div",null,[o.value?(0,u.Q3)("",!0):((0,u.uX)(),(0,u.Wv)((0,d.R1)(E.A),{key:0,label:"ç™»å…¥",icon:"pi pi-user",onClick:r})),o.value?((0,u.uX)(),(0,u.Wv)((0,d.R1)(E.A),{key:1,label:"ç™»å‡º",icon:"pi pi-user",onClick:s})):(0,u.Q3)("",!0)])]),(0,u.bF)(P,{login_visible:t.value,"onUpdate:login_visible":a[0]||(a[0]=e=>t.value=e),onLoginSuccess:i},null,8,["login_visible"])]))}};const gc=(0,ie.A)(bc,[["__scopeId","data-v-4a526273"]]);var yc=gc,fc=l(56030);const hc={class:"panel-menu-container no-scale"};var kc={__name:"PanelMenu",setup(e){const a=(0,C.rd)(),l={MyFavorites:"æˆ‘çš„å¸¸ç”¨é …ç›®",SystemManagement:"ç³»çµ±ç®¡ç†",EventsAndStatistics:"æ´»å‹•æˆ–çµ±è¨ˆ",ResearchAndDevelopment:"ç ”ç™¼éƒ¨",Electronics:"é›»å­èª²",ProdTech:"ç”ŸæŠ€èª²",Warehouse:"å€‰ç®¡èª²",MultiDepartment:"å¤šéƒ¨é–€å…±ç”¨",Administration:"ç®¡ç†éƒ¨",Sales:"æ¥­å‹™èª²",Purchasing:"æŽ¡è³¼èª²",ProductionControl:"ç”Ÿç®¡èª²",PlantOperations:"å» å‹™èª²",QualityAssurance:"å“ä¿èª²"},t=e=>{if(!e)return;const l=e.URL_Side;"InSide"===l?a.push({name:e.Layout||"Home"}):"OutSide"===l&&window.open(e.URL,"_blank")},o=(0,u.EW)((()=>Object.keys(wa).map((e=>{const a=l[e]||e,o=wa[e].map((e=>({label:e.label,items:e.items.map((e=>({...e,command:()=>t(e)})))})));return{label:a,items:o}}))));return(e,a)=>((0,u.uX)(),(0,u.CE)("div",hc,[(0,u.bF)((0,d.R1)(fc.A),{model:o.value,class:"panel-menu",style:{height:"100%"}},null,8,["model"])]))}};const _c=kc;var wc=_c;const Fc={style:{"padding-right":"17%","padding-bottom":"4%"},class:"flex justify-content-end"},Cc={style:{width:"15%",height:"100%",position:"fixed",left:"20rem",top:"0"}},Dc={style:{position:"fixed",top:"30%",left:"50%",transform:"translate(-50%, 0)"},class:"edit-form-container"};var Lc={__name:"editDptFuncList",setup(e){const a=(0,d.KR)(""),l=(0,d.KR)(""),t=(0,d.KR)(""),o=(0,d.KR)(""),n=(0,d.KR)(),r=()=>{const e=m().get("userName"),n=m().get("userDept"),r=m().get("userAccount"),s=m().get("userTitle");a.value=e||"(å°šæœªç™»å…¥å·¥è™Ÿ)",l.value=n||"(å°šæœªç™»å…¥å·¥è™Ÿ)",t.value=r||"(å°šæœªç™»å…¥å·¥è™Ÿ)",o.value=s||"(å°šæœªç™»å…¥å·¥è™Ÿ)"},s=()=>{m().get("userAccount")?(a.value=m().get("userName"),l.value=m().get("userDept"),t.value=m().get("userAccount"),o.value=m().get("userTitle")):(l.value="(è«‹å…ˆç™»å…¥å·¥è™Ÿ)",t.value="(è«‹å…ˆç™»å…¥å·¥è™Ÿ)",a.value="(è«‹å…ˆç™»å…¥å·¥è™Ÿ)",o.value="(è«‹å…ˆç™»å…¥å·¥è™Ÿ)")};return(0,u.sV)((()=>{r();const e=setInterval(s,2e3);(0,u.hi)((()=>{clearInterval(e)}))})),(e,r)=>((0,u.uX)(),(0,u.CE)("div",null,[(0,u.Lk)("div",Fc,[(0,u.bF)(yc)]),(0,u.Lk)("div",Cc,[(0,u.bF)(wc,{loginUser:a.value,loginDpt:l.value,loginId:t.value,loginTitle:o.value,selectedKey:n.value},null,8,["loginUser","loginDpt","loginId","loginTitle","selectedKey"])]),(0,u.Lk)("div",Dc,[(0,u.bF)(Ni)])]))}};const Rc=Lc;var Vc=Rc;const Ic={key:0,class:"flex items-center mb-4",style:{gap:"1rem"}},xc={key:0},Ec={key:1},Ac={style:{color:"#409EFF","text-decoration":"underline",cursor:"pointer"}},Tc={key:0},Wc={key:1},Sc={key:0},Uc={key:1},$c={key:0},Nc={key:1},Xc={key:0},Kc={key:1},Mc={key:0},Pc={key:1},Oc={key:0},zc={key:1},Bc={key:0},jc={key:1},Yc={key:0},Qc={key:1},Hc={key:0},qc={key:1},Jc={key:0},Gc={key:1},Zc={key:0},ep={key:1},ap={key:0},lp={key:1},tp={key:0},op={key:1},np={key:0},rp={key:1},sp={key:0},up={key:1};var ip={__name:"List_ComputerInventory",props:{sysMode:{type:Boolean,default:!1}},setup(e){const a=(0,T.d)(),l=e,t=[{label:"å€åŸŸ",value:"areaName"},{label:"éƒ¨é–€",value:"departmentName"},{label:"è·ç¨±",value:"titleName"},{label:"äººå“¡",value:"userName"},{label:"é›»è…¦æ¨£å¼",value:"deviceName"},{label:"é›»è…¦è³‡ç”¢",value:"computerAsset"},{label:"èž¢å¹•å°ºå‹",value:"screenSize"},{label:"èž¢å¹•è³‡ç”¢",value:"screenAsset"},{label:"ä½œæ¥­ç³»çµ±",value:"os"},{label:"OSç‰ˆæœ¬",value:"oS_Version"},{label:"Officeç‰ˆæœ¬",value:"office_Version"},{label:"Officeè³‡ç”¢",value:"office_Asset"},{label:"å…¶ä»–è»Ÿé«”",value:"otherSoftware"},{label:"å…¶ä»–èªªæ˜Ž",value:"otherDescription"},{label:"é˜²æ¯’è»Ÿé«”",value:"antivirus_SoftWare"},{label:"å¡«å¯«æ™‚é–“",value:"createAt"},{label:"å¡«å¯«äººå“¡",value:"filledBy"},{label:"å·²å ±å»¢",value:"isDisposed"},{label:"å ±å»¢æ—¥æœŸ",value:"disposalDate"},{label:"å ±å»¢äºº",value:"disposedBy"},{label:"å‚™è¨»",value:"remark"}],o=(0,d.KR)(t[0].value),n=(0,d.KR)(""),r=(0,u.EW)((()=>{const e=n.value.trim().toLowerCase(),a=o.value;return e?m.value.filter((l=>{const t=l[a];return null!=t&&String(t).toLowerCase().includes(e)})):m.value})),s=(0,S.k)(),c=(0,i.n)(),p=(0,d.KR)([]),m=(0,d.KR)([]),v=(0,d.KR)(null),b=async e=>{try{let a=await Qn.getComputerInventoryWithDptFilter(e);console.log(a),Array.isArray(a.data)?m.value=a.data.map((e=>({...e,isRegistered:"True"===e.isRegistered||!0===e.isRegistered,isDisposed:"True"===e.isDisposed||!0===e.isDisposed}))):m.value=[...p.value]}catch(a){console.error("æ›´æ–°å¤±æ•—:",a),D.nk.error(a)}},g=e=>new Promise(((a,l)=>e.departmentName?.trim()?e.userName?.trim()?e.areaName?.trim()?void a():l("è«‹è¼¸å…¥å€åŸŸç·¨è™Ÿ"):l("è«‹è¼¸å…¥ä½¿ç”¨äººå“¡"):l("è«‹è¼¸å…¥éƒ¨é–€")));function y(e){const a={...e};return Object.keys(a).forEach((e=>{"string"===typeof a[e]&&""===a[e].trim()&&(a[e]=null)})),a.updateAt=(new Date).toISOString(),a.updateBy=s.userId,a}const f=async(e,a)=>{if(a.isEditing){const e={...a};delete e.isEditing;const t=y(e);try{await g(t),console.log("é€å‡ºjson data:",t),await Qn.updateComputerInventory(a.nanoId,t),await _(),D.nk.success("æ›´æ–°æˆåŠŸ")}catch(l){console.error("æ›´æ–°å¤±æ•—:",l),D.nk.error(l)}}else a.isEditing=!0},h=async e=>{try{const l={newStatus:e.isDisposed,userName:s.userName},t=await Qn.updateComputerInventoryDisposal(e.nanoId,l);if(t){a.add({severity:"success",summary:"å·²å ±å»¢è³‡æ–™æ›´æ–°æˆåŠŸï¼",detail:"",life:3e3});const l=m.value.findIndex((a=>a.nanoId===e.nanoId));-1!==l&&(m.value[l].isDisposed=t.data.isDisposed,m.value[l].disposalDate=t.data.disposalDate,m.value[l].disposedBy=t.data.disposedBy)}else a.add({severity:"warn",summary:"ä¸æ˜ŽåŽŸå› éŒ¯èª¤ï¼",detail:"",life:3e3})}catch(l){console.error("æ›´æ–°å·²å ±å»¢ç‹€æ…‹å¤±æ•—:",l),a.add({severity:"error",summary:"å·²å ±å»¢è³‡æ–™æ›´æ–°å¤±æ•—ï¼",life:3e3})}},k=async(e,a)=>{try{await Sa.s.confirm("ç¢ºå®šè¦åˆªé™¤é€™ç­†è¨˜éŒ„å—Žï¼Ÿ","è­¦å‘Š",{confirmButtonText:"ç¢ºèª",cancelButtonText:"å–æ¶ˆ",type:"warning"}),await Qn.deleteComputerInventory(a.nanoId),await _(),D.nk.success("åˆªé™¤æˆåŠŸ")}catch(l){"cancel"!==l&&(console.error("åˆªé™¤å¤±æ•—:",l),D.nk.error("åˆªé™¤å¤±æ•—"))}},_=async()=>{try{c.user.roles.includes("RO0000")?await C():c.user.managers.length>0?await F():await w(),m.value=[...p.value]}catch(e){console.error("é›»è…¦è³‡ç”¢è³‡æ–™å–å¾—å¤±æ•—:",e)}},w=async()=>{try{const e=await Qn.getComputerInventoryWithDptNameAndEmpName(s.userDeptName,s.userName);console.log("getComputerInventoryWithEmp:",e.data),p.value=Array.isArray(e.data)?e.data:[]}catch(e){console.error("å€‹äººé›»è…¦è³‡ç”¢è³‡æ–™å–å¾—å¤±æ•—:",e),p.value=[]}},F=async()=>{try{console.log(c.user.subDepartments);const e=await Qn.getComputerInventoryWithListDpt(s.userId,c.user.subDepartments);p.value=Array.isArray(e.data)?e.data:[]}catch(e){console.error("éƒ¨é–€é›»è…¦è³‡ç”¢è³‡æ–™å–å¾—å¤±æ•—:",e),p.value=[]}},C=async()=>{try{const e=await Qn.getComputerInventorys();p.value=Array.isArray(e.data)?e.data:[]}catch(e){console.error("å…¨éƒ¨é›»è…¦è³‡ç”¢è³‡æ–™å–å¾—å¤±æ•—:",e)}};function R(e){return e?new Date(e).toLocaleString():""}return(0,u.sV)((async()=>{await _(),or.on("dataUpdated",_)})),(a,s)=>{const i=(0,u.g2)("el-option"),p=(0,u.g2)("el-select"),m=(0,u.g2)("el-input"),g=(0,u.g2)("el-table-column"),y=(0,u.g2)("Filter"),_=(0,u.g2)("el-icon"),w=(0,u.g2)("el-popover"),F=(0,u.g2)("el-button"),C=(0,u.g2)("el-checkbox"),D=(0,u.g2)("el-table");return(0,u.uX)(),(0,u.CE)("div",{style:(0,L.Tr)({"max-width":e.sysMode?"200rem":"80rem"})},[e.sysMode?((0,u.uX)(),(0,u.CE)("div",Ic,[(0,u.bF)(p,{modelValue:o.value,"onUpdate:modelValue":s[0]||(s[0]=e=>o.value=e),placeholder:"é¸æ“‡æŸ¥è©¢æ¬„ä½",style:{width:"100px"}},{default:(0,u.k6)((()=>[((0,u.uX)(),(0,u.CE)(u.FK,null,(0,u.pI)(t,(e=>(0,u.bF)(i,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),64))])),_:1},8,["modelValue"]),(0,u.bF)(m,{modelValue:n.value,"onUpdate:modelValue":s[1]||(s[1]=e=>n.value=e),placeholder:"è¼¸å…¥é—œéµå­—",clearable:"",style:{width:"200px"}},null,8,["modelValue"])])):(0,u.Q3)("",!0),(0,u.Lk)("div",null,[(0,u.bF)(D,{data:r.value,style:{width:"100%"},class:"workflow-form"},{default:(0,u.k6)((()=>[(0,u.bF)(g,{label:"å€åŸŸ",prop:"areaName",width:100},{default:(0,u.k6)((e=>[e.row.isEditing?((0,u.uX)(),(0,u.CE)("div",xc,[(0,u.bF)(ar,{"return-type":"name",modelValue:e.row.areaName,"onUpdate:modelValue":a=>e.row.areaName=a},null,8,["modelValue","onUpdate:modelValue"])])):((0,u.uX)(),(0,u.CE)("div",Ec,(0,L.v_)(e.row.areaName),1))])),_:1}),(0,u.bF)(g,{label:"éƒ¨é–€",prop:"departmentName",width:110},(0,u.eX)({default:(0,u.k6)((e=>[e.row.isEditing?((0,u.uX)(),(0,u.CE)("div",Tc,[(0,u.bF)(Gn,{"return-type":"name",modelValue:e.row.departmentName,"onUpdate:modelValue":a=>e.row.departmentName=a},null,8,["modelValue","onUpdate:modelValue"])])):((0,u.uX)(),(0,u.CE)("div",Wc,(0,L.v_)(e.row.departmentName),1))])),_:2},[!0===l.sysMode?{name:"header",fn:(0,u.k6)((()=>[(0,u.bF)(w,{placement:"bottom-start",title:"é¸æ“‡éƒ¨é–€",width:300,trigger:"click"},{reference:(0,u.k6)((()=>[(0,u.Lk)("span",Ac,[s[3]||(s[3]=(0,u.eW)(" éƒ¨é–€ ")),(0,u.bF)(_,null,{default:(0,u.k6)((()=>[(0,u.bF)(y)])),_:1})])])),default:(0,u.k6)((()=>[(0,u.bF)(Gn,{modelValue:v.value,"onUpdate:modelValue":s[2]||(s[2]=e=>v.value=e),"has-cancel":!0,multiMode:!1,onChange:b},null,8,["modelValue"])])),_:1})])),key:"0"}:void 0]),1024),(0,u.bF)(g,{label:"è·ç¨±",prop:"titleName",width:100},{default:(0,u.k6)((e=>[e.row.isEditing?((0,u.uX)(),(0,u.CE)("div",Sc,[(0,u.bF)(su,{"return-type":"name",modelValue:e.row.titleName,"onUpdate:modelValue":a=>e.row.titleName=a},null,8,["modelValue","onUpdate:modelValue"])])):((0,u.uX)(),(0,u.CE)("div",Uc,(0,L.v_)(e.row.titleName),1))])),_:1}),(0,u.bF)(g,{label:"äººå“¡",prop:"UserName",width:70},{default:(0,u.k6)((e=>[e.row.isEditing?((0,u.uX)(),(0,u.CE)("div",$c,[(0,u.bF)(m,{modelValue:e.row.userName,"onUpdate:modelValue":a=>e.row.userName=a,size:"small"},null,8,["modelValue","onUpdate:modelValue"])])):((0,u.uX)(),(0,u.CE)("div",Nc,(0,L.v_)(e.row.userName),1))])),_:1}),(0,u.bF)(g,{label:"é›»è…¦æ¨£å¼",prop:"DeviceName",width:80},{default:(0,u.k6)((e=>[e.row.isEditing?((0,u.uX)(),(0,u.CE)("div",Xc,[(0,u.bF)(p,{modelValue:e.row.deviceName,"onUpdate:modelValue":a=>e.row.deviceName=a,size:"small"},{default:(0,u.k6)((()=>[(0,u.bF)(i,{label:"",value:""}),(0,u.bF)(i,{label:"æ¡Œæ©Ÿ",value:"æ¡Œæ©Ÿ"}),(0,u.bF)(i,{label:"ç­†é›»",value:"ç­†é›»"}),(0,u.bF)(i,{label:"å¹³æ¿",value:"å¹³æ¿"})])),_:2},1032,["modelValue","onUpdate:modelValue"])])):((0,u.uX)(),(0,u.CE)("div",Kc,(0,L.v_)(e.row.deviceName),1))])),_:1}),(0,u.bF)(g,{label:"é›»è…¦è³‡ç”¢",prop:"ComputerAsset",width:80},{default:(0,u.k6)((e=>[e.row.isEditing?((0,u.uX)(),(0,u.CE)("div",Mc,[(0,u.bF)(p,{modelValue:e.row.computerAsset,"onUpdate:modelValue":a=>e.row.computerAsset=a,size:"small"},{default:(0,u.k6)((()=>[(0,u.bF)(i,{label:"",value:""}),(0,u.bF)(i,{label:"è‡ªæœ‰",value:"è‡ªæœ‰"}),(0,u.bF)(i,{label:"å…¬å¸",value:"å…¬å¸"})])),_:2},1032,["modelValue","onUpdate:modelValue"])])):((0,u.uX)(),(0,u.CE)("div",Pc,(0,L.v_)(e.row.computerAsset),1))])),_:1}),(0,u.bF)(g,{label:"èž¢å¹•å°ºå‹",prop:"ScreenSize",width:80},{default:(0,u.k6)((e=>[e.row.isEditing?((0,u.uX)(),(0,u.CE)("div",Oc,[(0,u.bF)(m,{modelValue:e.row.screenSize,"onUpdate:modelValue":a=>e.row.screenSize=a,size:"small"},null,8,["modelValue","onUpdate:modelValue"])])):((0,u.uX)(),(0,u.CE)("div",zc,(0,L.v_)(e.row.screenSize),1))])),_:1}),(0,u.bF)(g,{label:"èž¢å¹•è³‡ç”¢",prop:"ScreenAsset",width:80},{default:(0,u.k6)((e=>[e.row.isEditing?((0,u.uX)(),(0,u.CE)("div",Bc,[(0,u.bF)(p,{modelValue:e.row.screenAsset,"onUpdate:modelValue":a=>e.row.screenAsset=a,size:"small"},{default:(0,u.k6)((()=>[(0,u.bF)(i,{label:"",value:""}),(0,u.bF)(i,{label:"è‡ªæœ‰",value:"è‡ªæœ‰"}),(0,u.bF)(i,{label:"å…¬å¸",value:"å…¬å¸"})])),_:2},1032,["modelValue","onUpdate:modelValue"])])):((0,u.uX)(),(0,u.CE)("div",jc,(0,L.v_)(e.row.screenAsset),1))])),_:1}),(0,u.bF)(g,{label:"ä½œæ¥­ç³»çµ±",prop:"OS",width:80},{default:(0,u.k6)((e=>[e.row.isEditing?((0,u.uX)(),(0,u.CE)("div",Yc,[(0,u.bF)(p,{modelValue:e.row.os,"onUpdate:modelValue":a=>e.row.os=a,size:"small"},{default:(0,u.k6)((()=>[(0,u.bF)(i,{label:"",value:""}),(0,u.bF)(i,{label:"å®¶ç”¨ç‰ˆ",value:"å®¶ç”¨ç‰ˆ"}),(0,u.bF)(i,{label:"å°ˆæ¥­ç‰ˆ",value:"å°ˆæ¥­ç‰ˆ"})])),_:2},1032,["modelValue","onUpdate:modelValue"])])):((0,u.uX)(),(0,u.CE)("div",Qc,(0,L.v_)(e.row.os),1))])),_:1}),(0,u.bF)(g,{label:"OSç‰ˆæœ¬",prop:"OS_Version",width:150},{default:(0,u.k6)((e=>[e.row.isEditing?((0,u.uX)(),(0,u.CE)("div",Hc,[(0,u.bF)(m,{modelValue:e.row.oS_Version,"onUpdate:modelValue":a=>e.row.oS_Version=a,size:"small"},null,8,["modelValue","onUpdate:modelValue"])])):((0,u.uX)(),(0,u.CE)("div",qc,(0,L.v_)(e.row.oS_Version),1))])),_:1}),(0,u.bF)(g,{label:"Officeç‰ˆæœ¬",prop:"Office_Version",width:130},{default:(0,u.k6)((e=>[e.row.isEditing?((0,u.uX)(),(0,u.CE)("div",Jc,[(0,u.bF)(m,{modelValue:e.row.office_Version,"onUpdate:modelValue":a=>e.row.office_Version=a,size:"small"},null,8,["modelValue","onUpdate:modelValue"])])):((0,u.uX)(),(0,u.CE)("div",Gc,(0,L.v_)(e.row.office_Version),1))])),_:1}),(0,u.bF)(g,{label:"Officeè³‡ç”¢",prop:"Office_Asset",width:90},{default:(0,u.k6)((e=>[e.row.isEditing?((0,u.uX)(),(0,u.CE)("div",Zc,[(0,u.bF)(p,{modelValue:e.row.office_Asset,"onUpdate:modelValue":a=>e.row.office_Asset=a,size:"small"},{default:(0,u.k6)((()=>[(0,u.bF)(i,{label:"",value:""}),(0,u.bF)(i,{label:"è‡ªæœ‰",value:"è‡ªæœ‰"}),(0,u.bF)(i,{label:"å…¬å¸",value:"å…¬å¸"})])),_:2},1032,["modelValue","onUpdate:modelValue"])])):((0,u.uX)(),(0,u.CE)("div",ep,(0,L.v_)(e.row.office_Asset),1))])),_:1}),(0,u.bF)(g,{label:"å…¶ä»–è»Ÿé«”",prop:"OtherSoftware",width:200},{default:(0,u.k6)((e=>[e.row.isEditing?((0,u.uX)(),(0,u.CE)("div",ap,[(0,u.bF)(m,{modelValue:e.row.otherSoftware,"onUpdate:modelValue":a=>e.row.otherSoftware=a,size:"small"},null,8,["modelValue","onUpdate:modelValue"])])):((0,u.uX)(),(0,u.CE)("div",lp,(0,L.v_)(e.row.otherSoftware),1))])),_:1}),(0,u.bF)(g,{label:"èªªæ˜Ž",prop:"OtherDescription",width:200},{default:(0,u.k6)((e=>[e.row.isEditing?((0,u.uX)(),(0,u.CE)("div",tp,[(0,u.bF)(m,{modelValue:e.row.otherDescription,"onUpdate:modelValue":a=>e.row.otherDescription=a,size:"small"},null,8,["modelValue","onUpdate:modelValue"])])):((0,u.uX)(),(0,u.CE)("div",op,(0,L.v_)(e.row.otherDescription),1))])),_:1}),(0,u.bF)(g,{label:"é˜²æ¯’è»Ÿé«”",prop:"Antivirus_SoftWare",width:80},{default:(0,u.k6)((e=>[e.row.isEditing?((0,u.uX)(),(0,u.CE)("div",np,[(0,u.bF)(m,{modelValue:e.row.antivirus_SoftWare,"onUpdate:modelValue":a=>e.row.antivirus_SoftWare=a,size:"small"},null,8,["modelValue","onUpdate:modelValue"])])):((0,u.uX)(),(0,u.CE)("div",rp,(0,L.v_)(e.row.antivirus_SoftWare),1))])),_:1}),(0,u.bF)(g,{label:"å¡«å¯«æ™‚é–“",prop:"createAt",width:100},{default:(0,u.k6)((e=>[(0,u.eW)((0,L.v_)(R(e.row.createAt)),1)])),_:1}),(0,u.bF)(g,{label:"å¡«å¯«äººå“¡",prop:"createBy",width:100},{default:(0,u.k6)((e=>[(0,u.eW)((0,L.v_)(e.row.filledBy),1)])),_:1}),(0,d.R1)(c).user.managers&&(0,d.R1)(c).user.managers.length>0||!0===l.sysMode?((0,u.uX)(),(0,u.Wv)(g,{key:0,label:"æ“ä½œ",width:60,"header-align":"center"},{default:(0,u.k6)((e=>[(0,u.bF)(F,{size:"small",onClick:a=>f(e.$index,e.row)},{default:(0,u.k6)((()=>[(0,u.eW)((0,L.v_)(e.row.isEditing?"å®Œæˆ":"ç·¨è¼¯"),1)])),_:2},1032,["onClick"]),(0,u.bF)(F,{style:{"margin-left":"-0.5px"},size:"small",type:"danger",onClick:a=>k(e.$index,e.row)},{default:(0,u.k6)((()=>s[4]||(s[4]=[(0,u.eW)(" åˆªé™¤ ")]))),_:2},1032,["onClick"])])),_:1})):(0,u.Q3)("",!0),!0===l.sysMode?((0,u.uX)(),(0,u.Wv)(g,{key:1,label:"å·²å ±å»¢",prop:"isDisposed",width:70},{default:(0,u.k6)((e=>[(0,u.bF)(C,{modelValue:e.row.isDisposed,"onUpdate:modelValue":a=>e.row.isDisposed=a,onChange:a=>h(e.row)},null,8,["modelValue","onUpdate:modelValue","onChange"])])),_:1})):(0,u.Q3)("",!0),!0===l.sysMode?((0,u.uX)(),(0,u.Wv)(g,{key:2,label:"å ±å»¢æ—¥æœŸ",prop:"disposalDate",width:120},{default:(0,u.k6)((e=>[(0,u.eW)((0,L.v_)(R(e.row.disposalDate)),1)])),_:1})):(0,u.Q3)("",!0),!0===l.sysMode?((0,u.uX)(),(0,u.Wv)(g,{key:3,label:"å ±å»¢äºº",prop:"disposalDate",width:120},{default:(0,u.k6)((e=>[(0,u.eW)((0,L.v_)(e.row.disposedBy),1)])),_:1})):(0,u.Q3)("",!0),!0===l.sysMode?((0,u.uX)(),(0,u.Wv)(g,{key:4,label:"å‚™è¨»",prop:"remark",width:150},{default:(0,u.k6)((e=>[e.row.isEditing?((0,u.uX)(),(0,u.CE)("div",sp,[(0,u.bF)(m,{modelValue:e.row.remark,"onUpdate:modelValue":a=>e.row.remark=a,size:"small"},null,8,["modelValue","onUpdate:modelValue"])])):((0,u.uX)(),(0,u.CE)("div",up,(0,L.v_)(e.row.remark),1))])),_:1})):(0,u.Q3)("",!0)])),_:1},8,["data"])])],4)}}};const dp=ip;var cp=dp,pp={__name:"Fill_ComputerInventory",setup(e){const a=(0,S.k)(),l=(0,T.d)(),o=(0,d.KR)("default"),n=(0,d.KR)(null),r=(0,d.Kh)({nanoId:"",departmentName:"",titleName:"",userName:"",deviceName:"",computerAsset:"",screenSize:"",screenAsset:"",oS:"",oS_Version:"",office_Version:"",office_Asset:"",otherSoftware:"",otherDescription:"",filledBy:a.userName,isDisposed:!1,disposalDate:null,disposedBy:"",createAt:new Date((new Date).toLocaleString("en-US",{timeZone:"Asia/Taipei"})),createBy:a.userId,updateAt:null,updateBy:null,remark:""});const s=(0,d.Kh)({departmentName:[{required:!0,message:"è«‹é¸æ“‡è·ç¨±",trigger:"blur"}],titleName:[{required:!0,message:"è«‹é¸æ“‡è·ç¨±",trigger:"blur"}],userName:[{required:!0,message:"è«‹è¼¸å…¥äººå“¡",trigger:"blur"}],areaName:[{required:!0,message:"è«‹é¸æ“‡å€åŸŸç·¨è™Ÿ",trigger:"blur"}]}),i=async e=>{e&&(r.nanoId||(r.nanoId=(0,Dr.Ak)(10)),await e.validate(((a,t)=>{a?(console.log("é©—è­‰é€šéŽ!",r),Qn.postComputerInventory(r).then((()=>{l.add({severity:"success",summary:"é›»è…¦è³‡ç”¢æ¸…å–®",detail:"æ–°å¢žæˆåŠŸï¼",life:5e3}),e.resetFields(),r.nanoId="",or.emit("dataUpdated")})).catch((e=>{console.error("é›»è…¦è³‡ç”¢æ¸…å–® æ–°å¢žå¤±æ•—:",e)}))):console.log("é©—è­‰éŒ¯èª¤!",t)})))},c=e=>{e&&e.resetFields()};return(e,l)=>{const p=(0,u.g2)("el-form-item"),m=(0,u.g2)("el-input"),v=(0,u.g2)("el-option"),b=(0,u.g2)("el-select"),g=(0,u.g2)("el-button"),y=(0,u.g2)("el-checkbox"),f=(0,u.g2)("el-form");return(0,u.uX)(),(0,u.CE)("div",null,[l[28]||(l[28]=(0,u.Lk)("div",{style:{"font-size":"1.2rem",width:"32rem","max-width":"32rem"}},[(0,u.Lk)("h4",{style:{"text-align":"center","background-color":"lightgray"}},"é›»è…¦è³‡ç”¢æ¸…å–®ç›¤æŸ¥"),(0,u.Lk)("div",null,"è«‹åŒä»ç›¤é»žå€‹äººè¨­å‚™,ä¸¦ä¾ç…§ä¸‹æ–¹æ¬„ä½å¡«å¯«"),(0,u.Lk)("div",null,"å¦‚æœ‰ä¸æ‡‚å¯è«‹æ‡‚ç›¸é—œé›»è…¦è¨­å‚™äººå“¡å”åŠ©æ¸…æŸ¥ç›¤é»ž")],-1)),(0,u.bF)(f,{ref_key:"computerFormRef",ref:n,style:{"max-width":"32rem"},model:r,rules:s,"label-width":"9rem",class:"workflow-form",size:o.value,"status-icon":""},{default:(0,u.k6)((()=>[(0,u.bF)(p,{label:"å€åŸŸç·¨è™Ÿ",prop:"areaName"},{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(ar),{returnType:"name",modelValue:r.areaName,"onUpdate:modelValue":l[0]||(l[0]=e=>r.areaName=e)},null,8,["modelValue"])])),_:1}),(0,u.bF)(p,{label:"éƒ¨é–€",prop:"departmentName"},{default:(0,u.k6)((()=>[(0,u.bF)(Gn,{style:{width:"300px"},returnType:"name",modelValue:r.departmentName,"onUpdate:modelValue":l[1]||(l[1]=e=>r.departmentName=e)},null,8,["modelValue"])])),_:1}),(0,u.bF)(p,{label:"è·ç¨±",prop:"titleName"},{default:(0,u.k6)((()=>[(0,u.bF)(su,{returnType:"name",modelValue:r.titleName,"onUpdate:modelValue":l[2]||(l[2]=e=>r.titleName=e)},null,8,["modelValue"])])),_:1}),(0,u.bF)(p,{label:"äººå“¡",prop:"userName"},{default:(0,u.k6)((()=>[(0,u.bF)(m,{style:{width:"200px"},modelValue:r.userName,"onUpdate:modelValue":l[3]||(l[3]=e=>r.userName=e),placeholder:"è«‹è¼¸å…¥äººå“¡"},null,8,["modelValue"])])),_:1}),(0,u.bF)(p,{label:"é›»è…¦æ¨£å¼",prop:"deviceName"},{default:(0,u.k6)((()=>[(0,u.bF)(b,{modelValue:r.deviceName,"onUpdate:modelValue":l[4]||(l[4]=e=>r.deviceName=e),placeholder:"è«‹é¸æ“‡é›»è…¦æ¨£å¼",style:{width:"200px"}},{default:(0,u.k6)((()=>[(0,u.bF)(v,{label:"",value:""}),(0,u.bF)(v,{label:"æ¡Œæ©Ÿ",value:"æ¡Œæ©Ÿ"}),(0,u.bF)(v,{label:"ç­†é›»",value:"ç­†é›»"}),(0,u.bF)(v,{label:"å¹³æ¿",value:"å¹³æ¿"})])),_:1},8,["modelValue"])])),_:1}),(0,u.bF)(p,{label:"é›»è…¦è³‡ç”¢",prop:"computerAsset"},{default:(0,u.k6)((()=>[(0,u.bF)(b,{modelValue:r.computerAsset,"onUpdate:modelValue":l[5]||(l[5]=e=>r.computerAsset=e),placeholder:"è«‹é¸æ“‡é›»è…¦è³‡ç”¢é¡žåž‹",style:{width:"200px"}},{default:(0,u.k6)((()=>[(0,u.bF)(v,{label:"",value:""}),(0,u.bF)(v,{label:"è‡ªæœ‰",value:"è‡ªæœ‰"}),(0,u.bF)(v,{label:"å…¬å¸",value:"å…¬å¸"})])),_:1},8,["modelValue"])])),_:1}),(0,u.bF)(p,{label:"é›»è…¦èž¢å¹•å°ºå‹",prop:"screenSize"},{default:(0,u.k6)((()=>[(0,u.bF)(m,{style:{width:"200px"},modelValue:r.screenSize,"onUpdate:modelValue":l[6]||(l[6]=e=>r.screenSize=e),placeholder:"è«‹è¼¸å…¥é›»è…¦èž¢å¹•å°ºå‹"},null,8,["modelValue"])])),_:1}),(0,u.bF)(p,{label:"é›»è…¦èž¢å¹•è³‡ç”¢",prop:"screenAsset"},{default:(0,u.k6)((()=>[(0,u.bF)(b,{modelValue:r.screenAsset,"onUpdate:modelValue":l[7]||(l[7]=e=>r.screenAsset=e),placeholder:"è«‹é¸æ“‡è³‡ç”¢é¡žåž‹",style:{width:"200px"}},{default:(0,u.k6)((()=>[(0,u.bF)(v,{label:"",value:""}),(0,u.bF)(v,{label:"è‡ªæœ‰",value:"è‡ªæœ‰"}),(0,u.bF)(v,{label:"å…¬å¸",value:"å…¬å¸"})])),_:1},8,["modelValue"])])),_:1}),(0,u.bF)(p,{label:"ä½œæ¥­ç³»çµ±ç‰ˆæœ¬",prop:"oS_Version"},{default:(0,u.k6)((()=>[(0,u.bF)(m,{style:{width:"200px"},modelValue:r.oS_Version,"onUpdate:modelValue":l[8]||(l[8]=e=>r.oS_Version=e),placeholder:"è«‹è¼¸å…¥ä½œæ¥­ç³»çµ±ç‰ˆæœ¬"},null,8,["modelValue"])])),_:1}),(0,u.bF)(p,{label:"ä½œæ¥­ç³»çµ±",prop:"oS"},{default:(0,u.k6)((()=>[(0,u.bF)(b,{modelValue:r.oS,"onUpdate:modelValue":l[9]||(l[9]=e=>r.oS=e),placeholder:"è«‹é¸æ“‡ä½œæ¥­ç³»çµ±",style:{width:"200px"}},{default:(0,u.k6)((()=>[(0,u.bF)(v,{label:"",value:""}),(0,u.bF)(v,{label:"å®¶ç”¨ç‰ˆ",value:"å®¶ç”¨ç‰ˆ"}),(0,u.bF)(v,{label:"å°ˆæ¥­ç‰ˆ",value:"å°ˆæ¥­ç‰ˆ"}),(0,u.bF)(v,{label:"Mac",value:"Mac"})])),_:1},8,["modelValue"])])),_:1}),(0,u.bF)(p,{label:"Officeç‰ˆæœ¬",prop:"office_Version"},{default:(0,u.k6)((()=>[(0,u.bF)(m,{style:{width:"200px"},modelValue:r.office_Version,"onUpdate:modelValue":l[10]||(l[10]=e=>r.office_Version=e),placeholder:"è«‹è¼¸å…¥Officeç‰ˆæœ¬"},null,8,["modelValue"])])),_:1}),(0,u.bF)(p,{label:"Officeè³‡ç”¢",prop:"office_Asset"},{default:(0,u.k6)((()=>[(0,u.bF)(b,{modelValue:r.office_Asset,"onUpdate:modelValue":l[11]||(l[11]=e=>r.office_Asset=e),placeholder:"è«‹é¸æ“‡ä½œæ¥­ç³»çµ±ç‰ˆæœ¬",style:{width:"200px"}},{default:(0,u.k6)((()=>[(0,u.bF)(v,{label:"",value:""}),(0,u.bF)(v,{label:"è‡ªæœ‰",value:"è‡ªæœ‰"}),(0,u.bF)(v,{label:"å…¬å¸",value:"å…¬å¸"})])),_:1},8,["modelValue"])])),_:1}),(0,u.bF)(p,{label:"å…¶ä»–è»Ÿé«”",prop:"otherSoftware"},{default:(0,u.k6)((()=>[(0,u.bF)(m,{style:{width:"200px"},modelValue:r.otherSoftware,"onUpdate:modelValue":l[12]||(l[12]=e=>r.otherSoftware=e),placeholder:"è«‹è¼¸å…¥å…¶ä»–è»Ÿé«”"},null,8,["modelValue"])])),_:1}),(0,u.bF)(p,{label:"å…¶ä»–èªªæ˜Ž",prop:"otherDescription"},{default:(0,u.k6)((()=>[(0,u.bF)(m,{style:{width:"200px"},modelValue:r.otherDescription,"onUpdate:modelValue":l[13]||(l[13]=e=>r.otherDescription=e),placeholder:"è«‹è¼¸å…¥å…¶ä»–èªªæ˜Ž"},null,8,["modelValue"])])),_:1}),(0,u.bF)(p,{label:"é˜²æ¯’è»Ÿé«”",prop:"antivirus_SoftWare"},{default:(0,u.k6)((()=>[(0,u.bF)(m,{style:{width:"200px"},modelValue:r.antivirus_SoftWare,"onUpdate:modelValue":l[14]||(l[14]=e=>r.antivirus_SoftWare=e),placeholder:"è«‹è¼¸å…¥é˜²æ¯’è»Ÿé«”"},null,8,["modelValue"])])),_:1}),(0,u.bF)(p,{label:"å¡«å¯«äººæˆ–ä»£å¡«å¯«äºº",prop:"FilledBy"},{default:(0,u.k6)((()=>[(0,u.eW)((0,L.v_)((0,d.R1)(a).userName),1)])),_:1}),(0,u.bF)(p,null,{default:(0,u.k6)((()=>[(0,u.Q3)("",!0),(0,u.bF)(g,{type:"primary",onClick:l[15]||(l[15]=e=>i(n.value))},{default:(0,u.k6)((()=>l[22]||(l[22]=[(0,u.eW)("æäº¤")]))),_:1}),(0,u.bF)(g,{onClick:l[16]||(l[16]=e=>c(n.value))},{default:(0,u.k6)((()=>l[23]||(l[23]=[(0,u.eW)("æ¸…ç©º")]))),_:1})])),_:1}),(0,u.bo)((0,u.bF)(p,{label:"å·²å ±å»¢",prop:"isDisposed"},{default:(0,u.k6)((()=>[(0,u.bF)(y,{modelValue:r.isDisposed,"onUpdate:modelValue":l[17]||(l[17]=e=>r.isDisposed=e),"true-label":"Y","false-label":"N"},{default:(0,u.k6)((()=>l[24]||(l[24]=[(0,u.eW)(" å·²å ±å»¢ ")]))),_:1},8,["modelValue"])])),_:1},512),[[t.aG,!1]]),(0,u.bo)((0,u.bF)(p,{label:"å ±å»¢äºº",prop:"disposedBy"},{default:(0,u.k6)((()=>[(0,u.bF)(y,{modelValue:r.disposedBy,"onUpdate:modelValue":l[18]||(l[18]=e=>r.disposedBy=e)},{default:(0,u.k6)((()=>l[25]||(l[25]=[(0,u.eW)(" å ±å»¢äºº ")]))),_:1},8,["modelValue"])])),_:1},512),[[t.aG,!1]]),(0,u.bo)((0,u.bF)(p,{label:"å ±å»¢æ™‚é–“",prop:"disposalDate"},{default:(0,u.k6)((()=>[(0,u.bF)(y,{modelValue:r.disposalDate,"onUpdate:modelValue":l[19]||(l[19]=e=>r.disposalDate=e)},{default:(0,u.k6)((()=>l[26]||(l[26]=[(0,u.eW)(" å ±å»¢æ™‚é–“ ")]))),_:1},8,["modelValue"])])),_:1},512),[[t.aG,!1]]),(0,u.bo)((0,u.bF)(p,{label:"å‚™è¨»",prop:"remark"},{default:(0,u.k6)((()=>[(0,u.bF)(y,{modelValue:r.remark,"onUpdate:modelValue":l[20]||(l[20]=e=>r.remark=e)},{default:(0,u.k6)((()=>l[27]||(l[27]=[(0,u.eW)(" å‚™è¨» ")]))),_:1},8,["modelValue"])])),_:1},512),[[t.aG,!1]])])),_:1},8,["model","rules","size"])])}}};const mp=pp;var vp=mp;const bp={class:"container"};var gp={__name:"ComputerInventory",props:{sysMode:{type:Boolean,default:!1}},setup(e){const a=e;return(l,t)=>((0,u.uX)(),(0,u.CE)("div",bp,[a.sysMode?(0,u.Q3)("",!0):((0,u.uX)(),(0,u.Wv)(vp,{key:0})),(0,u.bF)(cp,{sysMode:e.sysMode},null,8,["sysMode"])]))}};const yp=(0,ie.A)(gp,[["__scopeId","data-v-4498de1c"]]);var fp=yp;const hp={key:0},kp={key:1},_p={key:0},wp={key:1},Fp={key:0},Cp={key:1};var Dp={__name:"FormsManagement",setup(e){const a=(0,d.KR)([]),l=(0,d.KR)(!1),t=(0,d.KR)(null),o=(0,d.KR)({});async function n(){l.value=!0;try{const e=await Ma.getAllForms();a.value=e.data}catch(e){D.nk.error("è¼‰å…¥è¡¨å–®å¤±æ•—: "+e)}finally{l.value=!1}}function r(e){t.value=e.id,o.value={...e}}async function s(e){try{await Ma.updateForm(e.id,{serialId:o.value.serialId,formName:o.value.formName}),Object.assign(e,o.value),D.nk.success("è¡¨å–®æ›´æ–°æˆåŠŸ"),t.value=null}catch(a){D.nk.error("æ›´æ–°è¡¨å–®å¤±æ•—: "+a)}}function i(){t.value=null}function c(e){Sa.s.confirm("ç¢ºå®šè¦åˆªé™¤æ­¤è¡¨å–®å—Ž?","è­¦å‘Š",{type:"warning"}).then((async()=>{await Ma.deleteForm(e),D.nk.success("åˆªé™¤æˆåŠŸ"),n()})).catch((()=>{}))}return(0,u.sV)((()=>{n()})),(e,n)=>{const d=(0,u.g2)("el-col"),p=(0,u.g2)("el-row"),m=(0,u.g2)("el-input"),v=(0,u.g2)("el-table-column"),b=(0,u.g2)("el-button"),g=(0,u.g2)("el-table"),y=(0,u.gN)("loading");return(0,u.uX)(),(0,u.CE)("div",null,[(0,u.bF)(p,null,{default:(0,u.k6)((()=>[(0,u.bF)(d,{span:24},{default:(0,u.k6)((()=>n[2]||(n[2]=[(0,u.Lk)("h2",null,"è¡¨å–®é¡žåž‹ç®¡ç†",-1)]))),_:1})])),_:1}),(0,u.bo)(((0,u.uX)(),(0,u.Wv)(g,{data:a.value,style:{width:"100%","margin-top":"20px"},"row-key":e=>e.id},{default:(0,u.k6)((()=>[(0,u.bF)(v,{prop:"serialId",label:"Serial ID",width:"150"},{default:(0,u.k6)((({row:e})=>[t.value===e.id?((0,u.uX)(),(0,u.CE)("div",hp,[(0,u.bF)(m,{modelValue:o.value.serialId,"onUpdate:modelValue":n[0]||(n[0]=e=>o.value.serialId=e),size:"small"},null,8,["modelValue"])])):((0,u.uX)(),(0,u.CE)("div",kp,(0,L.v_)(e.serialId),1))])),_:1}),(0,u.bF)(v,{prop:"formName",label:"Form Name",width:"200"},{default:(0,u.k6)((({row:e})=>[t.value===e.id?((0,u.uX)(),(0,u.CE)("div",_p,[(0,u.bF)(m,{modelValue:o.value.formName,"onUpdate:modelValue":n[1]||(n[1]=e=>o.value.formName=e),size:"small"},null,8,["modelValue"])])):((0,u.uX)(),(0,u.CE)("div",wp,(0,L.v_)(e.formName),1))])),_:1}),(0,u.bF)(v,{prop:"created_at",label:"Created Date",width:"250"}),(0,u.bF)(v,{label:"Actions",width:"240"},{default:(0,u.k6)((({row:e})=>[t.value===e.id?((0,u.uX)(),(0,u.CE)("div",Fp,[(0,u.bF)(b,{size:"small",type:"success",onClick:a=>s(e)},{default:(0,u.k6)((()=>n[3]||(n[3]=[(0,u.eW)("ä¿å­˜")]))),_:2},1032,["onClick"]),(0,u.bF)(b,{size:"small",onClick:i},{default:(0,u.k6)((()=>n[4]||(n[4]=[(0,u.eW)("å–æ¶ˆ")]))),_:1})])):((0,u.uX)(),(0,u.CE)("div",Cp,[(0,u.bF)(b,{size:"small",onClick:a=>r(e)},{default:(0,u.k6)((()=>n[5]||(n[5]=[(0,u.eW)("ç·¨è¼¯")]))),_:2},1032,["onClick"]),(0,u.bF)(b,{size:"small",type:"danger",onClick:a=>c(e.id)},{default:(0,u.k6)((()=>n[6]||(n[6]=[(0,u.eW)("åˆªé™¤")]))),_:2},1032,["onClick"])]))])),_:1})])),_:1},8,["data","row-key"])),[[y,l.value]])])}}};const Lp=Dp;var Rp=Lp;const Vp={key:0},Ip={key:1},xp={key:0},Ep={key:1},Ap={key:0},Tp={key:1};var Wp={__name:"ProcessDefinitionManagement",setup(e){const a=(0,d.KR)([]),l=(0,d.KR)(!1),t=(0,d.KR)(!1),o=(0,d.KR)({name:"",description:"",createdAt:(new Date).toISOString(),status:1,version:"1.0.0.0"}),n=(0,d.KR)(null),r=(0,d.KR)({});async function s(){l.value=!0;try{const e=await Ma.getAllProcessDefinitions();a.value=e.data}catch(e){D.nk.error("è¼‰å…¥æµç¨‹å®šç¾©å¤±æ•—: "+e)}finally{l.value=!1}}function i(){o.value={name:"",description:"",createdAt:(new Date).toISOString(),status:1,version:"1.0.0.0"},t.value=!0}async function c(){try{await Ma.ProcessDefinition({Name:o.value.name,Description:o.value.description,CreatedAt:o.value.createdAt,Status:o.value.status,Version:o.value.version}),D.nk.success("æµç¨‹å®šç¾©æ–°å¢žæˆåŠŸ"),t.value=!1,s()}catch(e){D.nk.error("æ–°å¢žå¤±æ•—: "+e)}}function p(e,a){n.value=a,r.value={...e}}async function m(e){try{await Ma.updateProcessDefinition(e.id,{Name:r.value.name,Version:r.value.version,CreatedAt:r.value.createdAt}),Object.assign(e,r.value),D.nk.success("æ›´æ–°æˆåŠŸ"),n.value=null}catch(a){D.nk.error("æ›´æ–°å¤±æ•—: "+a)}}function v(){n.value=null}async function b(e){Sa.s.confirm("ç¢ºå®šè¦åˆªé™¤æ­¤æµç¨‹å®šç¾©å—Ž?","è­¦å‘Š",{type:"warning"}).then((async()=>{await Ma.deleteProcessDefinition(e),D.nk.success("åˆªé™¤æˆåŠŸ"),s()})).catch((()=>{}))}return(0,u.sV)((()=>{s()})),(e,l)=>{const s=(0,u.g2)("el-button"),d=(0,u.g2)("el-input"),g=(0,u.g2)("el-table-column"),y=(0,u.g2)("el-date-picker"),f=(0,u.g2)("el-table"),h=(0,u.g2)("el-form-item"),k=(0,u.g2)("el-input-number"),_=(0,u.g2)("el-form"),w=(0,u.g2)("el-dialog");return(0,u.uX)(),(0,u.CE)("div",null,[l[14]||(l[14]=(0,u.Lk)("h2",null,"æµç¨‹å®šç¾©",-1)),(0,u.bF)(s,{type:"primary",onClick:i},{default:(0,u.k6)((()=>l[7]||(l[7]=[(0,u.eW)("æ–°å¢žæµç¨‹å®šç¾©")]))),_:1}),(0,u.bF)(f,{data:a.value,style:{"margin-top":"20px"}},{default:(0,u.k6)((()=>[(0,u.bF)(g,{prop:"version",label:"ç‰ˆæœ¬",width:"180"},{default:(0,u.k6)((({row:e,$index:a})=>[n.value===a?((0,u.uX)(),(0,u.CE)("div",Vp,[(0,u.bF)(d,{modelValue:r.value.version,"onUpdate:modelValue":l[0]||(l[0]=e=>r.value.version=e),size:"small"},null,8,["modelValue"])])):((0,u.uX)(),(0,u.CE)("div",Ip,(0,L.v_)(e.version),1))])),_:1}),(0,u.bF)(g,{prop:"name",label:"æµç¨‹åç¨±",width:"180"},{default:(0,u.k6)((({row:e,$index:a})=>[n.value===a?((0,u.uX)(),(0,u.CE)("div",xp,[(0,u.bF)(d,{modelValue:r.value.name,"onUpdate:modelValue":l[1]||(l[1]=e=>r.value.name=e),size:"small"},null,8,["modelValue"])])):((0,u.uX)(),(0,u.CE)("div",Ep,(0,L.v_)(e.name),1))])),_:1}),(0,u.bF)(g,{prop:"createdAt",label:"CreatedAt",width:"250"},{default:(0,u.k6)((({row:e,$index:a})=>[n.value===a?((0,u.uX)(),(0,u.CE)("div",Ap,[(0,u.bF)(y,{modelValue:r.value.createdAt,"onUpdate:modelValue":l[2]||(l[2]=e=>r.value.createdAt=e),type:"datetime",size:"small",placeholder:"é¸æ“‡æ—¥æœŸæ™‚é–“"},null,8,["modelValue"])])):((0,u.uX)(),(0,u.CE)("div",Tp,(0,L.v_)(e.createdAt),1))])),_:1}),(0,u.bF)(g,{label:"Actions",width:"240"},{default:(0,u.k6)((({row:e,$index:a})=>[n.value!==a?((0,u.uX)(),(0,u.Wv)(s,{key:0,size:"small",onClick:l=>p(e,a)},{default:(0,u.k6)((()=>l[8]||(l[8]=[(0,u.eW)("ç·¨è¼¯")]))),_:2},1032,["onClick"])):(0,u.Q3)("",!0),n.value===a?((0,u.uX)(),(0,u.Wv)(s,{key:1,size:"small",type:"success",onClick:a=>m(e)},{default:(0,u.k6)((()=>l[9]||(l[9]=[(0,u.eW)("ä¿å­˜")]))),_:2},1032,["onClick"])):(0,u.Q3)("",!0),n.value===a?((0,u.uX)(),(0,u.Wv)(s,{key:2,size:"small",onClick:v},{default:(0,u.k6)((()=>l[10]||(l[10]=[(0,u.eW)("å–æ¶ˆ")]))),_:1})):(0,u.Q3)("",!0),null===n.value?((0,u.uX)(),(0,u.Wv)(s,{key:3,size:"small",type:"danger",onClick:a=>b(e.id)},{default:(0,u.k6)((()=>l[11]||(l[11]=[(0,u.eW)("åˆªé™¤")]))),_:2},1032,["onClick"])):(0,u.Q3)("",!0)])),_:1})])),_:1},8,["data"]),(0,u.bF)(w,{title:"æ–°å¢žæµç¨‹å®šç¾©",modelValue:t.value,"onUpdate:modelValue":l[6]||(l[6]=e=>t.value=e),width:"500px"},{footer:(0,u.k6)((()=>[(0,u.bF)(s,{onClick:l[5]||(l[5]=e=>t.value=!1)},{default:(0,u.k6)((()=>l[12]||(l[12]=[(0,u.eW)("å–æ¶ˆ")]))),_:1}),(0,u.bF)(s,{type:"primary",onClick:c},{default:(0,u.k6)((()=>l[13]||(l[13]=[(0,u.eW)("ç¢ºå®š")]))),_:1})])),default:(0,u.k6)((()=>[(0,u.bF)(_,{model:o.value,"label-width":"100px"},{default:(0,u.k6)((()=>[(0,u.bF)(h,{label:"Name"},{default:(0,u.k6)((()=>[(0,u.bF)(d,{modelValue:o.value.name,"onUpdate:modelValue":l[3]||(l[3]=e=>o.value.name=e)},null,8,["modelValue"])])),_:1}),(0,u.bF)(h,{label:"Status"},{default:(0,u.k6)((()=>[(0,u.bF)(k,{modelValue:o.value.status,"onUpdate:modelValue":l[4]||(l[4]=e=>o.value.status=e)},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue"])])}}};const Sp=Wp;var Up=Sp,$p={__name:"TreeSelect-Role",props:{modelValue:{type:[String,Number,Object],default:""}},emits:["update:modelValue"],setup(e,{emit:a}){const l=e,t=a,o=(0,d.KR)(l.modelValue);(0,u.wB)(o,(e=>{t("update:modelValue",e)})),(0,u.wB)((()=>l.modelValue),(e=>{o.value=e}));const n=(0,d.KR)([]),r=(0,d.KR)([]);function s(e){const a=[],l={};function t(e){e.sort(((e,a)=>e.sortId-a.sortId)),e.forEach((e=>{e.children&&e.children.length>0&&t(e.children)}))}return e.forEach((e=>{l[e.id]={label:e.name,value:e.id,sortId:e.sortId||0,children:[],...e}})),e.forEach((e=>{const t=l[e.id];"-1"!==e.p_dpt_id&&l[e.p_dpt_id]?l[e.p_dpt_id].children.push(t):a.push(t)})),t(a),a}const i=async()=>{try{const e=await ja.getDepartmentData();n.value=e.data,r.value=s(n.value)}catch(e){console.error("å–å¾—éƒ¨é–€è³‡æ–™å¤±æ•—:",e)}};function c(e,a){for(let l of e){if(l.id===a)return l;if(l.children&&l.children.length>0){const e=c(l.children,a);if(e)return e}}return null}function p(e){e.forEach((e=>{if(!e.dpt_id||"-1"===e.dpt_id)return;const a=c(r.value,e.dpt_id);if(a){const l={label:e.name,value:e.id,sortId:e.sort_id||0,isRole:!0,...e};a.children||(a.children=[]),a.children.push(l),a.children.sort(((e,a)=>e.sortId-a.sortId))}}))}const m=async()=>{try{const e=await ja.getRoleData(),a=e.data;p(a)}catch(e){console.error("å–å¾—è§’è‰²è³‡æ–™å¤±æ•—:",e)}};return(0,u.sV)((async()=>{await i(),await m()})),(e,a)=>{const l=(0,u.g2)("el-tree-select");return(0,u.uX)(),(0,u.Wv)(l,{modelValue:o.value,"onUpdate:modelValue":a[0]||(a[0]=e=>o.value=e),data:r.value,"render-after-expand":!1,"default-expand-all":"",placeholder:"è«‹é¸æ“‡éƒ¨é–€",style:{width:"18rem"}},null,8,["modelValue","data"])}}};const Np=$p;var Xp=Np;const Kp={style:{margin:"10px 0"}};var Mp={__name:"ProcessStepDefinitionManagement",setup(e){const a=(0,d.KR)([]),l=(0,d.KR)(""),t=(0,d.KR)([]),o=(0,d.KR)(!1),n=(0,d.KR)(!1),r=(0,d.KR)({id:"",processDefinitionId:"",stepOrder:1,stepName:"",role:"",actionType:"Approve/Reject",nextStepIfApproved:"",nextStepIfRejected:""});let s=!1;const i=ql();async function c(){try{const e=await Ma.getAllProcessDefinitions();a.value=e.data}catch(e){D.nk.error("è¼‰å…¥æµç¨‹å®šç¾©å¤±æ•—: "+e)}}async function p(){if(l.value){o.value=!0;try{const e=await Ma.getStepsByDefinition(l.value);t.value=e.data}catch(e){D.nk.error("è¼‰å…¥æ­¥é©Ÿå¤±æ•—: "+e)}finally{o.value=!1}}}function m(){s=!1,r.value={id:"",processDefinitionId:l.value,stepOrder:1,stepName:"",role:"",actionType:"Approve/Reject",nextStepIfApproved:"",nextStepIfRejected:""},n.value=!0}function v(e){s=!0,r.value={...e},r.value.processDefinitionId=l.value,n.value=!0}async function b(){if(r.value.stepName)try{s?(await Ma.updateProcessStepDefinition(r.value.id,{stepOrder:r.value.stepOrder,stepName:r.value.stepName,role:r.value.role,actionType:r.value.actionType,nextStepIfApproved:r.value.nextStepIfApproved,nextStepIfRejected:r.value.nextStepIfRejected}),D.nk.success("æ­¥é©Ÿæ›´æ–°æˆåŠŸ")):(await Ma.addProcessStepDefinition({...r.value}),D.nk.success("æ­¥é©Ÿæ–°å¢žæˆåŠŸ")),n.value=!1,p()}catch(e){D.nk.error("æ“ä½œå¤±æ•—: "+e)}else D.nk.error("æ­¥é©Ÿåç¨±ä¸èƒ½ç‚ºç©º")}function g(e){Sa.s.confirm("ç¢ºå®šè¦åˆªé™¤æ­¤æ­¥é©Ÿå®šç¾©å—Ž?","è­¦å‘Š",{type:"warning"}).then((async()=>{await Ma.deleteProcessStepDefinition(e),D.nk.success("åˆªé™¤æˆåŠŸ"),p()})).catch((()=>{}))}return(0,u.sV)((()=>{c(),i.fetchRoleData()})),(e,s)=>{const c=(0,u.g2)("el-option"),y=(0,u.g2)("el-select"),f=(0,u.g2)("el-button"),h=(0,u.g2)("el-table-column"),k=(0,u.g2)("el-table"),_=(0,u.g2)("el-input-number"),w=(0,u.g2)("el-form-item"),F=(0,u.g2)("el-input"),C=(0,u.g2)("el-form"),D=(0,u.g2)("el-dialog"),R=(0,u.gN)("loading");return(0,u.uX)(),(0,u.CE)("div",null,[s[14]||(s[14]=(0,u.Lk)("h2",null,"æµç¨‹æ­¥é©Ÿå®šç¾©ç®¡ç† (ProcessStepDefinition)",-1)),(0,u.Lk)("div",Kp,[(0,u.bF)(y,{modelValue:l.value,"onUpdate:modelValue":s[0]||(s[0]=e=>l.value=e),placeholder:"é¸æ“‡æµç¨‹å®šç¾©",style:{width:"300px"},onChange:p},{default:(0,u.k6)((()=>[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(a.value,(e=>((0,u.uX)(),(0,u.Wv)(c,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"]),(0,u.bF)(f,{type:"primary",onClick:m,disabled:!l.value},{default:(0,u.k6)((()=>s[9]||(s[9]=[(0,u.eW)(" æ–°å¢žæ­¥é©Ÿ ")]))),_:1},8,["disabled"])]),(0,u.bo)(((0,u.uX)(),(0,u.Wv)(k,{data:t.value,style:{width:"100%","margin-top":"20px"},"row-key":e=>e.id},{default:(0,u.k6)((()=>[(0,u.bF)(h,{prop:"stepOrder",label:"é †åº",width:"80"}),(0,u.bF)(h,{prop:"stepName",label:"æ­¥é©Ÿåç¨±",width:"180"}),(0,u.bF)(h,{label:"ç°½æ ¸è§’è‰²",width:"180"},{default:(0,u.k6)((({row:e})=>[(0,u.eW)((0,L.v_)((0,d.R1)(i).getRoleName(e.role)),1)])),_:1}),(0,u.bF)(h,{prop:"actionType",label:"å‹•ä½œé¡žåž‹",width:"180"}),(0,u.bF)(h,{prop:"nextStepIfApproved",label:"é€šéŽå¾Œä¸‹ä¸€æ­¥",width:"180"}),(0,u.bF)(h,{prop:"nextStepIfRejected",label:"é€€å›žå¾Œä¸‹ä¸€æ­¥",width:"180"}),(0,u.bF)(h,{label:"æ“ä½œ",width:"220"},{default:(0,u.k6)((({row:e})=>[(0,u.bF)(f,{size:"small",onClick:a=>v(e)},{default:(0,u.k6)((()=>s[10]||(s[10]=[(0,u.eW)("ç·¨è¼¯")]))),_:2},1032,["onClick"]),(0,u.bF)(f,{size:"small",type:"danger",onClick:a=>g(e.id)},{default:(0,u.k6)((()=>s[11]||(s[11]=[(0,u.eW)("åˆªé™¤")]))),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data","row-key"])),[[R,o.value]]),(0,u.bF)(D,{title:"æ­¥é©Ÿå®šç¾©",modelValue:n.value,"onUpdate:modelValue":s[8]||(s[8]=e=>n.value=e),width:"600px"},{footer:(0,u.k6)((()=>[(0,u.bF)(f,{onClick:s[7]||(s[7]=e=>n.value=!1)},{default:(0,u.k6)((()=>s[12]||(s[12]=[(0,u.eW)("å–æ¶ˆ")]))),_:1}),(0,u.bF)(f,{type:"primary",onClick:b},{default:(0,u.k6)((()=>s[13]||(s[13]=[(0,u.eW)("ç¢ºå®š")]))),_:1})])),default:(0,u.k6)((()=>[(0,u.bF)(C,{model:r.value,"label-width":"140px"},{default:(0,u.k6)((()=>[(0,u.bF)(w,{label:"Step Order"},{default:(0,u.k6)((()=>[(0,u.bF)(_,{modelValue:r.value.stepOrder,"onUpdate:modelValue":s[1]||(s[1]=e=>r.value.stepOrder=e),min:1},null,8,["modelValue"])])),_:1}),(0,u.bF)(w,{label:"Step Name"},{default:(0,u.k6)((()=>[(0,u.bF)(F,{modelValue:r.value.stepName,"onUpdate:modelValue":s[2]||(s[2]=e=>r.value.stepName=e)},null,8,["modelValue"])])),_:1}),(0,u.bF)(w,{label:"Role"},{default:(0,u.k6)((()=>[(0,u.bF)(Xp,{modelValue:r.value.role,"onUpdate:modelValue":s[3]||(s[3]=e=>r.value.role=e)},null,8,["modelValue"])])),_:1}),(0,u.bF)(w,{label:"Action Type"},{default:(0,u.k6)((()=>[(0,u.bF)(y,{modelValue:r.value.actionType,"onUpdate:modelValue":s[4]||(s[4]=e=>r.value.actionType=e),placeholder:"é¸æ“‡å‹•ä½œ"},{default:(0,u.k6)((()=>[(0,u.bF)(c,{label:"Approve/Reject",value:"Approve/Reject"}),(0,u.bF)(c,{label:"Notify",value:"Notify"})])),_:1},8,["modelValue"])])),_:1}),(0,u.bF)(w,{label:"Next Step If Approved"},{default:(0,u.k6)((()=>[(0,u.bF)(F,{modelValue:r.value.nextStepIfApproved,"onUpdate:modelValue":s[5]||(s[5]=e=>r.value.nextStepIfApproved=e)},null,8,["modelValue"])])),_:1}),(0,u.bF)(w,{label:"Next Step If Rejected"},{default:(0,u.k6)((()=>[(0,u.bF)(F,{modelValue:r.value.nextStepIfRejected,"onUpdate:modelValue":s[6]||(s[6]=e=>r.value.nextStepIfRejected=e)},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue"])])}}};const Pp=Mp;var Op=Pp;const zp={style:{"margin-left":"8%","margin-top":"3rem"}},Bp={style:{"margin-bottom":"5rem"}},jp={style:{"margin-bottom":"5rem"}};var Yp={__name:"Dpt_System",setup(e){return(e,a)=>((0,u.uX)(),(0,u.CE)("div",zp,[(0,u.Lk)("div",Bp,[(0,u.bF)(Up)]),(0,u.Lk)("div",jp,[(0,u.bF)(Op)]),(0,u.Lk)("div",null,[(0,u.bF)(Rp)])]))}};const Qp=Yp;var Hp=Qp,qp=l.p+"img/DAE_detail(bottom).3d39ea44.png",Jp=l(5242),Gp=l(51910),Zp=l(30506);const em={style:{position:"fixed",top:"10%",left:"50%",transform:"translateX(-50%)",display:"flex","justify-content":"center","align-items":"center","flex-direction":"column"}},am={class:"dialog-footer"};var lm={__name:"EIP_Login",setup(e){const a=(0,i.n)(),l=(0,T.d)(),o=(0,C.rd)(),n=(0,d.KR)(""),r=(0,d.KR)(""),s=(0,d.KR)("NULL"),c=(0,d.KR)(!1),p=(0,d.KR)(!1),m=(0,d.KR)(!1),v=(0,d.KR)(""),b=(0,d.KR)(""),g=(0,d.KR)(""),y=(0,d.KR)(!1),f=(0,d.KR)(!1),h=(0,d.KR)(!1),k=(0,d.KR)(!1),_=(0,d.KR)(!1),w=(0,d.KR)(!1),F=async()=>{try{c.value=!0,h.value=!1,k.value=!1,_.value=!1;const e={userId:n.value,userPwd:r.value};await a.login_EIP(e),s.value="Success",p.value=!0,l.add({severity:"success",summary:"Success",detail:"ç™»å…¥æˆåŠŸ!",life:3e3}),o.push({name:"List_WF_Personal"})}catch(e){if(console.error("Error logging in:",e),e.response){const a=e.response.data.error;404===e.response.status?"User data not found"===a?(m.value=!0,l.add({severity:"error",summary:"éŒ¯èª¤",detail:"ä½¿ç”¨è€…è³‡æ–™ä¸å­˜åœ¨",life:3e3})):"Employee data not found"===a&&(k.value=!0,w.value=!0,setTimeout((()=>{w.value=!1}),500)):"Only specific personnel are allowed to log in."===a?(_.value=!0,w.value=!0,setTimeout((()=>{w.value=!1}),500)):401===e.response.status?(h.value=!0,w.value=!0,setTimeout((()=>{w.value=!1}),500)):l.add({severity:"error",summary:"ç™»å…¥å¤±æ•—",detail:e.response.data.error||e.message,life:3e3})}else l.add({severity:"error",summary:"ç™»å…¥å¤±æ•—",detail:e.message,life:3e3})}finally{c.value=!1}},D=e=>{m.value=!1,e()},R=async()=>{const e=v.value,a=b.value,t=/^(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d]{6,}$/;if(!t.test(e))return g.value="å¯†ç¢¼å¿…é ˆè‡³å°‘6å€‹å­—å…ƒä¸”åŒ…å«è‹±æ–‡èˆ‡æ•¸å­—",f.value=!0,void setTimeout((()=>{f.value=!1}),500);g.value="";const o=["13093059","dae"],r=e.toLowerCase(),s=o.some((e=>r.includes(e.toLowerCase())));if(s)return g.value='å¯†ç¢¼ä¸èƒ½åŒ…å« "13093059" æˆ– "dae" å­—ä¸²',f.value=!0,void setTimeout((()=>{f.value=!1}),500);g.value="";const u=["123","1234","12345","123456","1234567","12345678","123456789"],i=u.some((a=>e.includes(a)));if(i)return g.value="å¯†ç¢¼ä¸èƒ½åŒ…å«é€£çºŒæ•¸å­—ï¼ˆå¦‚ 123ã€1234 ç­‰ï¼‰",f.value=!0,void setTimeout((()=>{f.value=!1}),500);if(g.value="",e!==a)return y.value=!0,f.value=!0,void setTimeout((()=>{f.value=!1}),500);y.value=!1;const d={userId:n.value,userPwd:e};try{await W.A.firstLoginInputPassword(d).then((e=>{"employee data not found"===e.data&&l.add({severity:"error",summary:"éŒ¯èª¤",detail:"å“¡å·¥è³‡æ–™ä¸å­˜åœ¨ï¼Œè«‹è¯ç¹«MISå”åŠ©è™•ç†ã€‚",life:3e3}),m.value=!1}))}catch(c){console.error("è¨­å®šæ–°å¯†ç¢¼å¤±æ•—:",c),l.add({severity:"error",summary:"è¨­å®šæ–°å¯†ç¢¼å¤±æ•—",detail:c.response?.data||c.message,life:3e3})}};return(0,u.wB)(v,(()=>{g.value&&(g.value="")})),(0,u.wB)(b,(()=>{y.value&&(y.value=!1)})),(e,a)=>{const l=(0,u.g2)("el-button"),o=(0,u.g2)("el-row"),i=(0,u.g2)("el-result"),p=(0,u.g2)("el-col"),C=(0,u.g2)("el-input"),V=(0,u.g2)("el-dialog"),I=(0,u.gN)("focus");return(0,u.uX)(),(0,u.CE)(u.FK,null,[(0,u.Lk)("div",em,[a[9]||(a[9]=(0,u.Lk)("div",null,[(0,u.Lk)("img",{src:qp,alt:"Logo",style:{width:"22rem","padding-bottom":"1rem",height:"auto"}})],-1)),(0,u.Lk)("div",null,[(0,u.bF)((0,d.R1)(Gp.A),null,{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(Jp.A),null,{default:(0,u.k6)((()=>a[6]||(a[6]=[(0,u.Lk)("i",{class:"pi pi-user"},null,-1)]))),_:1}),(0,u.bo)((0,u.bF)((0,d.R1)(x.A),{placeholder:"å·¥è™Ÿ",modelValue:n.value,"onUpdate:modelValue":a[0]||(a[0]=e=>n.value=e),invalid:null===n.value,onKeyup:(0,t.jR)(F,["enter"])},null,8,["modelValue","invalid"]),[[I]])])),_:1}),(0,u.bF)((0,d.R1)(Gp.A),null,{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(Jp.A),null,{default:(0,u.k6)((()=>a[7]||(a[7]=[(0,u.Lk)("i",{class:"pi pi-key"},null,-1)]))),_:1}),(0,u.bF)((0,d.R1)(Zp.A),{placeholder:"å¯†ç¢¼",modelValue:r.value,"onUpdate:modelValue":a[1]||(a[1]=e=>r.value=e),invalid:null===r.value,onKeyup:(0,t.jR)(F,["enter"]),feedback:!1,toggleMask:""},null,8,["modelValue","invalid"])])),_:1}),h.value?((0,u.uX)(),(0,u.CE)("div",{key:0,class:(0,L.C4)({shake:w.value}),style:{color:"red","margin-left":"3rem","margin-top":"0.5rem"}}," å¯†ç¢¼éŒ¯èª¤ï¼Œè«‹å†ç¢ºèªï¼ ",2)):k.value?((0,u.uX)(),(0,u.CE)("div",{key:1,class:(0,L.C4)({shake:w.value}),style:{width:"10rem",color:"red","margin-left":"3rem","margin-top":"0.5rem"}}," å“¡å·¥è³‡æ–™ä¸å­˜åœ¨ï¼Œè«‹è¯ç¹«ITäººå“¡å»ºç½®ï¼ ",2)):_.value?((0,u.uX)(),(0,u.CE)("div",{key:2,class:(0,L.C4)({shake:w.value}),style:{width:"10rem",color:"red","margin-left":"3rem","margin-top":"0.5rem"}}," åƒ…å…è¨±ç‰¹å®šäººå“¡ç™»å…¥ ",2)):(0,u.Q3)("",!0),(0,u.bF)(o,{style:{"justify-content":"center","margin-top":"20px"}},{default:(0,u.k6)((()=>[(0,u.bF)(l,{type:"primary",loading:c.value,onClick:F},{default:(0,u.k6)((()=>a[8]||(a[8]=[(0,u.eW)("ç™»å…¥")]))),_:1},8,["loading"])])),_:1})]),(0,u.bF)(o,null,{default:(0,u.k6)((()=>["Success"===s.value?((0,u.uX)(),(0,u.Wv)(p,{key:0},{default:(0,u.k6)((()=>[(0,u.bF)(i,{icon:"success",title:"ç™»å…¥æˆåŠŸ"})])),_:1})):"False"===s.value?((0,u.uX)(),(0,u.Wv)(p,{key:1},{default:(0,u.k6)((()=>[(0,u.bF)(i,{icon:"error",title:"ç™»å…¥å¤±æ•—","sub-title":"è«‹é‡æ–°è¼¸å…¥å·¥è™Ÿ(1è‹±æ–‡+4æ•¸å­—)"})])),_:1})):(0,u.Q3)("",!0)])),_:1})]),(0,u.bF)(V,{modelValue:m.value,"onUpdate:modelValue":a[5]||(a[5]=e=>m.value=e),title:"è¼¸å…¥å€‹äººå¯†ç¢¼",width:"500","before-close":D},{footer:(0,u.k6)((()=>[(0,u.Lk)("div",am,[(0,u.bF)(l,{type:"primary",onClick:R},{default:(0,u.k6)((()=>a[11]||(a[11]=[(0,u.eW)("Confirm")]))),_:1}),(0,u.bF)(l,{onClick:a[4]||(a[4]=e=>m.value=!1)},{default:(0,u.k6)((()=>a[12]||(a[12]=[(0,u.eW)("Cancel")]))),_:1})])])),default:(0,u.k6)((()=>[(0,u.Lk)("div",null,[a[10]||(a[10]=(0,u.Lk)("span",null,"é¦–æ¬¡ç™»å…¥ï¼Œè«‹è¼¸å…¥æ–°å¯†ç¢¼ä»¥å»ºç«‹è³‡æ–™ï¼š",-1)),(0,u.bF)(C,{modelValue:v.value,"onUpdate:modelValue":a[2]||(a[2]=e=>v.value=e),placeholder:"è«‹è¼¸å…¥æ–°å¯†ç¢¼","show-password":"",style:{"margin-top":"1rem"}},null,8,["modelValue"]),(0,u.Lk)("div",{class:(0,L.C4)({shake:f.value}),style:(0,L.Tr)({color:g.value?"red":"gray",marginTop:"0.5rem"})},' å¯†ç¢¼å¿…é ˆè‡³å°‘6å€‹å­—å…ƒä¸”åŒ…å«è‹±æ–‡èˆ‡æ•¸å­—ï¼Œä¸èƒ½åŒ…å« "13093059"ã€"dae" å­—ä¸²æˆ–é€£çºŒæ•¸å­—ï¼ˆå¦‚ 123ã€1234 ç­‰ï¼‰ ',6),(0,u.bF)(C,{modelValue:b.value,"onUpdate:modelValue":a[3]||(a[3]=e=>b.value=e),placeholder:"è«‹å†æ¬¡è¼¸å…¥æ–°å¯†ç¢¼","show-password":"",style:{"margin-top":"1rem"}},null,8,["modelValue"]),y.value?((0,u.uX)(),(0,u.CE)("div",{key:0,class:(0,L.C4)({shake:f.value}),style:{color:"red","margin-top":"0.5rem"}}," å…©æ¬¡è¼¸å…¥çš„å¯†ç¢¼ä¸ä¸€è‡´ï¼Œè«‹é‡æ–°ç¢ºèªï¼ ",2)):(0,u.Q3)("",!0)])])),_:1},8,["modelValue"])],64)}}};const tm=(0,ie.A)(lm,[["__scopeId","data-v-70f8a3f0"]]);var om=tm;class nm{constructor(){this.cache=new Map,this.pendingRequests=new Map,this.debounceTimers=new Map,this.isLoading=!1,this.cacheExpireTime=3e5}async getSalaryData(e,a,l=!1){if(!e||!a)throw new Error("å“¡å·¥IDå’Œæ—¥æœŸä¸èƒ½ç‚ºç©º");const t=`${e}-${a}`;return this.debounceTimers.has(t)&&clearTimeout(this.debounceTimers.get(t)),l&&(this.clearCache(e,a),console.log(`ðŸ§¹ å¼·åˆ¶æ¸…é™¤ç·©å­˜: ${t}`)),new Promise(((o,n)=>{const r=setTimeout((async()=>{try{if(!l&&this._isCacheValid(t))return void o(this.cache.get(t).data);if(this.pendingRequests.has(t)){const e=await this.pendingRequests.get(t);return void o(e)}const n=this._fetchAndProcessData(e,a);this.pendingRequests.set(t,n);const r=await n;this.pendingRequests.delete(t),this._setCacheData(t,r),o(r)}catch(r){console.error(`âŒ ç²å–è–ªè³‡æ•¸æ“šå¤±æ•—: ${t}`,r),this.pendingRequests.delete(t),n(r)}finally{this.debounceTimers.delete(t)}}),150);this.debounceTimers.set(t,r)}))}async _fetchAndProcessData(e,a){const[l,t]=await Promise.all([Wa.getSalarySlips_Eid_Date(e,a),Wa.getLeaveRecord(e,a)]);console.log("ðŸ“Š è–ªè³‡æ•¸æ“šéŸ¿æ‡‰:",l),console.log("ðŸ“Š è–ªè³‡æ•¸æ“šä¸­çš„ CompanyInsurance:",l?.data?.CompanyInsurance),console.log("ðŸ“Š è«‹å‡æ•¸æ“šéŸ¿æ‡‰:",t),console.log("ðŸ“Š è«‹å‡æ•¸æ“šå…§å®¹:",t?.data);const o=this._processRawData(l.data,t.data);return console.log("âœ… æ•¸æ“šè™•ç†å®Œæˆ"),o}_processRawData(e,a){try{const l=this._parseBlockData(e?.block);console.log("åŠ å·¥å¾Œçš„salaryData::",l);const t=a?.leaveRecords||[],o=a?.overtimeRecord||{},n=this._extractBlocks(l),r=this._extractInsuranceCompany(e,l);let s=n.blockD;const u=this._parseSalaryHeadInfo(e?.salaryHeadInfo),i=t.map((e=>({...e,yearlyTotalHours:(e.minutes/60).toFixed(2)})));console.log("ðŸŽ¯ æœ€çµ‚è¿”å›žçš„ blockD:",s),console.log("processedLeaveRecords:",i),console.log("ðŸ” åŽŸå§‹ salaryData:",e);const d=!1!==e?.success;return console.log("ðŸ” æª¢æŸ¥è–ªè³‡çµæ§‹ç‹€æ…‹:",{"salaryData?.success":e?.success,"salaryData?.success !== false":!1!==e?.success,hasValidSalaryStructure:d,"hasValidSalaryStructure === false":!1===d,message:e?.message}),!1===e?.success?(console.log("âš ï¸ æ²’æœ‰è–ªè³‡çµæ§‹è³‡æ–™ï¼Œå¼·åˆ¶æ¸…ç©º blockD ä¿éšªè²»æ¬„ä½"),console.log("æ¸…ç©ºå‰çš„ enhancedBlockD:",JSON.stringify(s,null,2)),s=this._clearBlockDInsuranceFields(s),console.log("æ¸…ç©ºå¾Œçš„ enhancedBlockD:",JSON.stringify(s,null,2))):(console.log("âœ… æœ‰è–ªè³‡çµæ§‹è³‡æ–™æˆ–ç‹€æ…‹ä¸æ˜Žç¢ºï¼Œä¿æŒåŽŸæœ‰ blockD æ•¸æ“š"),console.log("salaryData?.success çš„å€¼:",e?.success)),console.log("ðŸŽ¯ æœ€çµ‚è¿”å›žçš„æ•¸æ“šçµæ§‹:"),console.log("- blockD:",JSON.stringify(s,null,2)),{blockA:n.blockA,blockB:n.blockB,blockD:s,blockAnnualLeave:n.blockAnnualLeave,insuranceCompany:r,salaryHeadInfo:u,leaveRecords:i,overtimeRecord:o,isInitial:!0===l[0]?.isInitial,timestamp:Date.now()}}catch(l){throw console.error("âŒ æ•¸æ“šè™•ç†å¤±æ•—:",l),new Error(`æ•¸æ“šè™•ç†å¤±æ•—: ${l.message}`)}}_parseBlockData(e){if(!e)return[];console.log("_parseBlockData::",e);try{return"string"===typeof e?JSON.parse(e):e}catch(a){return console.error("âŒ è§£æž block æ•¸æ“šå¤±æ•—:",a),[]}}_extractBlocks(e){console.log("ðŸ” é–‹å§‹æå–å€å¡Šï¼ŒblockArr:",e);const a={blockA:e.find((e=>"total_A"in e))||{items:[]},blockB:e.find((e=>"total_B"in e))||{items:[]},blockD:e.find((e=>"total_D"in e))||{items:[]},blockAnnualLeave:e.find((e=>"annualLeave"in e))||{items:[{id:"annualUsed",ch_name:"å·²ä¼‘ç‰¹ä¼‘æ™‚æ•¸",time:0},{id:"annualRemaining",ch_name:"",time:0},{id:"annualLeave",ch_name:"",time:0}]}};return console.log("ðŸ“Š æå–çš„ blocks.blockAnnualLeave:",a.blockAnnualLeave),a.blockD&&a.blockD.items&&(console.log("ðŸ“‹ blockD.items å…§å®¹:"),a.blockD.items.forEach(((e,a)=>{console.log(`  ${a}: id=${e.id}, ch_name=${e.ch_name}, time=${e.time}, amount=${e.amount}`)}))),console.log("ðŸ“Š æå–çš„ blockAnnualLeave:",a.blockAnnualLeave),a.blockAnnualLeave&&a.blockAnnualLeave.items?(console.log("ðŸ“‹ blockAnnualLeave.items å…§å®¹:"),a.blockAnnualLeave.items.forEach(((e,a)=>{console.log(`  ${a}: id=${e.id}, ch_name=${e.ch_name}, time=${e.time}`)}))):(console.log("âŒ blockAnnualLeave æ²’æœ‰æ‰¾åˆ°æˆ–æ²’æœ‰ items"),console.log("åŽŸå§‹ blockArr:",e)),a}_parseSalaryHeadInfo(e){if(!e)return{empName:"",empDpt:"",empTitleGrade:"",insuranceLevel:"",empTitleName:"",empTitleLevel:""};try{return JSON.parse(e)}catch(a){return console.error("âŒ è§£æž salaryHeadInfo å¤±æ•—:",a),{}}}_isCacheValid(e){if(!this.cache.has(e))return!1;const a=this.cache.get(e),l=Date.now();return l-a.timestamp<this.cacheExpireTime}_setCacheData(e,a){this.cache.set(e,{data:a,timestamp:Date.now()})}clearCache(e=null,a=null){if(e&&a){const l=`${e}-${a}`;this.cache.delete(l)}else this.cache.clear()}cancelAllRequests(){this.debounceTimers.forEach((e=>clearTimeout(e))),this.debounceTimers.clear(),this.pendingRequests.clear()}_clearBlockDInsuranceFields(e){console.log("ðŸ” é–‹å§‹åŸ·è¡Œæ¸…ç©ºä¿éšªè²»é‚è¼¯"),console.log("blockDObj:",e),e||(console.log("âš ï¸ blockDObj ä¸å­˜åœ¨ï¼Œå‰µå»ºåŸºæœ¬çµæ§‹"),e={items:[]}),e.items&&Array.isArray(e.items)||(console.log("âš ï¸ blockDObj.items ä¸å­˜åœ¨æˆ–ä¸æ˜¯é™£åˆ—ï¼Œå‰µå»ºç©ºé™£åˆ—"),e.items=[]);const a=["laborInsurance","healthInsurance","healthFamily"];let l=!1;const t=e.items.map((e=>a.includes(e.id)?(console.log(`ðŸ§¹ æ¸…ç©ºä¿éšªè²»é …ç›®: ${e.id} (åŽŸå€¼: ${e.amount})`),l=!0,{...e,amount:""}):e));return l?console.log("âœ… å‰ç«¯æ¸…ç©ºä¿éšªè²»å®Œæˆ"):(console.log("â„¹ï¸ æ²’æœ‰æ‰¾åˆ°éœ€è¦æ¸…ç©ºçš„ä¿éšªè²»é …ç›®"),console.log("å¯ç”¨çš„é …ç›® IDs:",e.items.map((e=>e.id)))),{...e,items:t}}_extractInsuranceCompany(e,a){console.log("ðŸ” é–‹å§‹æå–ä¿éšªå…¬ä»˜æ•¸æ“š"),console.log("ðŸ“Š å®Œæ•´çš„ salaryData:",e),console.log("ðŸ“Š salaryData.CompanyInsurance:",e?.CompanyInsurance),console.log("ðŸ“Š salaryData.companyInsurance:",e?.companyInsurance);const l=e?.CompanyInsurance||e?.companyInsurance;if(console.log("ðŸ“Š æ‰¾åˆ°çš„ companyInsuranceField:",l),l)try{const e=JSON.parse(l);return console.log("âœ… æˆåŠŸè§£æžå¾Œç«¯ CompanyInsurance æ•¸æ“š:",e),e}catch(o){console.error("âŒ è§£æž CompanyInsurance å¤±æ•—:",o),console.log("åŽŸå§‹ CompanyInsurance æ•¸æ“š:",l)}else console.log("âš ï¸ æ²’æœ‰æ‰¾åˆ° CompanyInsurance æˆ– companyInsurance å­—æ®µ");console.log("âš ï¸ å¾Œç«¯ CompanyInsurance ä¸å¯ç”¨ï¼Œå˜—è©¦å¾ž blockArr æå–");const t={pensionCompany:{content:""},laborCompany:{content:"",calculatedLaborCompany:""},healthCompany:{content:""}};return a.forEach((e=>{e.items&&Array.isArray(e.items)&&e.items.forEach((e=>{"pensionCompany"===e.id?t.pensionCompany={content:e.content||e.amount||"",...e}:"laborCompany"===e.id?t.laborCompany={content:e.content||e.amount||"",calculatedLaborCompany:e.calculatedLaborCompany||e.content||e.amount||"",...e}:"healthCompany"===e.id&&(t.healthCompany={content:e.content||e.amount||"",...e})}))})),console.log("ðŸ“Š å¾ž blockArr æå–çš„ä¿éšªå…¬ä»˜æ•¸æ“š:",t),t}extractCompanyInsuranceData(e){const a={pensionCompany:{content:""},laborCompany:{content:"",calculatedLaborCompany:""},healthCompany:{content:""}};try{if(!e)return console.log("âš ï¸ CompanyInsurance ç‚ºç©ºï¼Œä½¿ç”¨é è¨­å€¼"),a;const l=JSON.parse(e);console.log("ðŸ“Š è§£æž CompanyInsurance æ•¸æ“š:",l);const t={...a};return l.pensionCompany&&(t.pensionCompany={content:l.pensionCompany.content||"",...l.pensionCompany}),l.laborCompany&&(t.laborCompany={content:l.laborCompany.content||"",calculatedLaborCompany:l.laborCompany.calculatedLaborCompany||l.laborCompany.content||"",...l.laborCompany},console.log("âœ… å‹žä¿å…¬ä»˜æ•¸æ“š:",{"åŽŸå§‹å€¼":l.laborCompany.content,"è¨ˆç®—å¾Œå€¼":l.laborCompany.calculatedLaborCompany})),l.healthCompany&&(t.healthCompany={content:l.healthCompany.content||"",...l.healthCompany}),console.log("ðŸ“Š å¾ž CompanyInsurance æå–çš„ä¿éšªå…¬ä»˜æ•¸æ“š:",t),t}catch(l){return console.error("âŒ è§£æž CompanyInsurance å¤±æ•—:",l),a}}getCacheStats(){return{cacheSize:this.cache.size,pendingRequests:this.pendingRequests.size,debounceTimers:this.debounceTimers.size}}}const rm=new nm;var sm=rm;const um={key:0,style:{color:"red"}};var im={__name:"Block_A",props:{data:{type:Object,default:()=>({total_A:0,items:[]})}},emits:["updateSalaryATotal","updateBlockAAggregate"],setup(e,{emit:a}){function l(){return{height:"41px",lineHeight:"41px"}}const t=e,o=a,n=(0,d.KR)([{category:"åŸºæœ¬è–ªè³‡",id:"basicSalary",hours:"",amount:""},{category:"è·ç­‰åŠ çµ¦",id:"rankAllowance",hours:"",amount:""},{category:"è·å‹™æ´¥è²¼",id:"positionAllowance",hours:"",amount:""},{category:"ä¼™é£Ÿæ´¥è²¼",id:"mealAllowance",hours:"",amount:""},{category:"æ™‚è–ª(å…¼è·äººå“¡)",id:"hourlyWagePartTime",hours:"",amount:""},{category:"ç´„å®šå·¥è³‡å°è¨ˆ(A)",id:"subtotal",hours:"",amount:""}]);(0,u.wB)((()=>t.data),(e=>{if(e&&Array.isArray(e.items)){const{total_A:a,items:l}=e;n.value=n.value.map((e=>{if("ç´„å®šå·¥è³‡å°è¨ˆ(A)"===e.category)return{...e,hours:"",amount:a};{const a=l.find((a=>a.id===e.id))||{};return{...e,hours:a.time||"",amount:a.amount||""}}}))}else n.value=n.value.map((e=>({...e,hours:"",amount:""})))}),{immediate:!0,deep:!0});const r=(0,u.EW)((()=>{const e=n.value.find((e=>"hourlyWagePartTime"===e.id)),a=e&&parseFloat(e.hours)||0,l=e&&parseFloat(e.amount)||0;return a>0?a*l:n.value.reduce(((e,a)=>"ç´„å®šå·¥è³‡å°è¨ˆ(A)"===a.category||"hourlyWagePartTime"===a.id?e:e+(parseFloat(a.amount)||0)),0)})),s=e=>{const a={total_A:e,items:n.value.filter((e=>"ç´„å®šå·¥è³‡å°è¨ˆ(A)"!==e.category)).map((e=>({id:e.id,ch_name:e.category,time:e.hours||"",amount:e.amount||""})))};o("updateBlockAAggregate",a)};function i(){return{height:"41px"}}return(0,u.wB)(r,(e=>{o("updateSalaryATotal",e),s(e)}),{immediate:!0}),(e,a)=>{const t=(0,u.g2)("el-table-column"),o=(0,u.g2)("el-table");return(0,u.uX)(),(0,u.Wv)(o,{class:"grid-lines",data:n.value,"max-width":"380","row-style":i,"header-cell-style":l,resizable:!1},{default:(0,u.k6)((()=>[(0,u.bF)(t,{label:"ç´„å®šå·¥è³‡",width:"180"},{default:(0,u.k6)((({row:e})=>[(0,u.eW)((0,L.v_)(e.category),1)])),_:1}),(0,u.bF)(t,{label:"æ™‚æ•¸",width:"100"},{default:(0,u.k6)((({row:e})=>[(0,u.eW)((0,L.v_)(e.hours),1)])),_:1}),(0,u.bF)(t,{label:"é‡‘é¡",width:"100"},{default:(0,u.k6)((({row:e})=>["ç´„å®šå·¥è³‡å°è¨ˆ(A)"===e.category?((0,u.uX)(),(0,u.CE)("span",um,(0,L.v_)(r.value),1)):((0,u.uX)(),(0,u.CE)(u.FK,{key:1},[(0,u.eW)((0,L.v_)(e.amount),1)],64))])),_:1})])),_:1},8,["data"])}}};const dm=im;var cm=dm;const pm={key:0},mm={key:1},vm={key:0},bm={key:0},gm={key:1},ym={key:0},fm={style:{color:"red"}},hm={key:1},km={style:{color:"red"}},_m={key:2},wm={style:{color:"red"}},Fm={key:3},Cm={key:0},Dm={key:1},Lm={key:4},Rm={key:0},Vm={key:1},Im={key:5},xm={key:0},Em={key:1},Am={key:6},Tm={key:0},Wm={key:1},Sm={key:7},Um={key:0},$m={key:1};var Nm={__name:"Block_B",props:{editMode:{type:Boolean,default:!1},totalA:{type:[Number,String],default:0},totalD:{type:[Number,String],default:0},data:{type:Object,default:()=>({total_B:0,items:[]})}},emits:["updateSalaryB_Aggregate"],setup(e,{emit:a}){const l=(0,d.KR)(""),t=(0,d.KR)(""),o=(0,d.KR)(""),n=(0,d.KR)(""),r=(0,u.EW)((()=>{const e=m.value.find((e=>"publicHolidayOvertime"===e.id)),a=parseFloat(e?.hours)||0,l=parseFloat(c.totalA)||0;return Math.ceil(a*(l/30/8)*1)})),s=(0,u.EW)({get(){return""!==n.value?n.value:r.value},set(e){n.value=e}});function i(){return{height:"41px",lineHeight:"41px"}}const c=e,p=a,m=(0,d.KR)([{category:"åŠ ç­åˆ†é˜æ•¸*4/3",hours:"",amount:"",id:"overtime1_3"},{category:"åŠ ç­åˆ†é˜æ•¸*5/3",hours:"",amount:"",id:"overtime2_3"},{category:"åŠ ç­åˆ†é˜æ•¸*6/3",hours:"",amount:"",id:"overtime5_3"},{category:"åœ‹å®šå‡æ—¥åŠ ç­",hours:"",amount:"",id:"publicHolidayOvertime"},{category:"å…¨å‹¤çŽé‡‘",hours:"",amount:"",id:"perfectAttendanceBonus"},{category:"äº¤éš›è²»",hours:"",amount:"",id:"entertainmentExpenses"},{category:"é€šè¨Šæ´¥è²¼",hours:"",amount:"",id:"communicationAllowance"},{category:"äº¤é€šè£œåŠ©è²»",hours:"",amount:"",id:"transportationSubsidy"},{category:"",hours:"",amount:"",id:"B_other1"},{category:"",hours:"",amount:"",id:"B_other2"},{category:"",hours:"",amount:"",id:"B_other3"},{category:"",hours:"",amount:"",id:"B_other4"},{category:"",hours:"",amount:"",id:"B_other5"},{category:"",hours:"",amount:"",id:"B_other6"},{category:"",hours:"",amount:"",id:"B_other7"},{category:"",hours:"",amount:"",id:"B_other8"},{category:"å‡ºå·®ä»£å¢Šè²»ç”¨",hours:"",amount:"",id:"reimburse"},{category:"å…¶ä»–å·¥è³‡å°è¨ˆ(B)",hours:"",amount:"",id:"subtotalB"},{category:"æ‡‰é ˜è–ªè³‡å°è¨ˆ(C)=A+B",hours:"",amount:"",id:"subtotalC"},{category:"å¯¦é ˜è–ªè³‡(E)=C-D",hours:"",amount:"",id:"subtotalE"}]);function v(){return{height:"41px"}}const b=["åŠ ç­åˆ†é˜æ•¸*4/3","åŠ ç­åˆ†é˜æ•¸*5/3","åŠ ç­åˆ†é˜æ•¸*6/3","åœ‹å®šå‡æ—¥åŠ ç­"],g=["åŠ ç­åˆ†é˜æ•¸*4/3","åŠ ç­åˆ†é˜æ•¸*5/3","åŠ ç­åˆ†é˜æ•¸*6/3","åœ‹å®šå‡æ—¥åŠ ç­","å…¨å‹¤çŽé‡‘","äº¤éš›è²»","é€šè¨Šæ´¥è²¼","äº¤é€šè£œåŠ©è²»","å‡ºå·®ä»£å¢Šè²»ç”¨","å…¶ä»–å·¥è³‡å°è¨ˆ(B)","æ‡‰é ˜è–ªè³‡å°è¨ˆ(C)=A+B","å¯¦é ˜è–ªè³‡(E)=C-D"," "],y=(0,u.EW)((()=>{const e=m.value.reduce(((e,a)=>{if("å…¶ä»–å·¥è³‡å°è¨ˆ(B)"===a.category||"æ‡‰é ˜è–ªè³‡å°è¨ˆ(C)=A+B"===a.category||"å¯¦é ˜è–ªè³‡(E)=C-D"===a.category)return e;let l=0;return l="åŠ ç­åˆ†é˜æ•¸*4/3"===a.category?parseFloat(k.value)||0:"åŠ ç­åˆ†é˜æ•¸*5/3"===a.category?parseFloat(_.value)||0:"åŠ ç­åˆ†é˜æ•¸*6/3"===a.category?parseFloat(w.value)||0:"åœ‹å®šå‡æ—¥åŠ ç­"===a.category?parseFloat(s.value)||0:parseFloat(a.amount)||0,e+l}),0);return Math.round(e)})),f=(0,u.EW)((()=>(parseFloat(c.totalA)||0)+y.value)),h=(0,u.EW)((()=>f.value-(parseFloat(c.totalD)||0))),k=(0,u.EW)({get(){return""!==l.value?l.value:F.value},set(e){l.value=e}}),_=(0,u.EW)({get(){return""!==t.value?t.value:C.value},set(e){t.value=e}}),w=(0,u.EW)({get(){return""!==o.value?o.value:D.value},set(e){o.value=e}}),F=(0,u.EW)((()=>{const e=m.value.find((e=>"overtime1_3"===e.id)),a=parseFloat(e?.hours)||0,l=parseFloat(c.totalA)||0;return Math.ceil(a*(l/30/8)*1.34)})),C=(0,u.EW)((()=>{const e=m.value.find((e=>"overtime2_3"===e.id)),a=parseFloat(e?.hours)||0,l=parseFloat(c.totalA)||0;return Math.ceil(a*(l/30/8)*1.67)})),D=(0,u.EW)((()=>{const e=m.value.find((e=>"overtime5_3"===e.id)),a=parseFloat(e?.hours)||0,l=parseFloat(c.totalA)||0;return Math.ceil(a*(l/30/8)*2)})),R=({row:e})=>"å…¶ä»–å·¥è³‡å°è¨ˆ(B)"===e.category?"hide-right-border":"";return(0,u.wB)((()=>c.editMode),((e,a)=>{if(!0===a&&!1===e){const e=e=>{const a=m.value.find((a=>a.id===e));if(!a)return{ch_name:"",time:0,amount:0,id:e};let l=a.amount||0;return"overtime1_3"===e?l=parseFloat(k.value)||0:"overtime2_3"===e?l=parseFloat(_.value)||0:"overtime5_3"===e?l=parseFloat(w.value)||0:"publicHolidayOvertime"===e&&(l=parseFloat(s.value)||0),{id:a.id,ch_name:a.category,time:a.hours||0,amount:l}},a={items:[{...e("overtime1_3"),isMinute:!0},{...e("overtime2_3"),isMinute:!0},{...e("overtime5_3"),isMinute:!0},{...e("publicHolidayOvertime")},{...e("perfectAttendanceBonus")},{...e("entertainmentExpenses")},{...e("communicationAllowance")},{...e("transportationSubsidy")},{...e("reimburse")},{...e("B_other1")},{...e("B_other2")},{...e("B_other3")},{...e("B_other4")},{...e("B_other5")},{...e("B_other6")},{...e("subtotalB")},{...e("subtotalC")},{...e("subtotalE")}],total_B:y.value,total_C:f.value,total_E:h.value};p("updateSalaryB_Aggregate",a)}})),(0,u.wB)((()=>c.data),(e=>{e&&Array.isArray(e.items)?m.value=m.value.map((a=>{if("subtotalB"===a.id)return{...a,hours:"",amount:e.total_B};if("subtotalC"===a.id)return{...a,hours:"",amount:e.total_C};if("subtotalE"===a.id)return{...a,hours:"",amount:e.total_E};if(["B_other1","B_other2","B_other3","B_other4","B_other5","B_other6"].includes(a.id)){const l=e.items.find((e=>e.id===a.id))||{};return{...a,category:l.ch_name||"",hours:void 0!==l.time?l.time:a.hours,amount:void 0!==l.amount?l.amount:a.amount}}const r=e.items.find((e=>e.ch_name===a.category))||{};return"åŠ ç­åˆ†é˜æ•¸*4/3"===a.category?l.value=void 0!==r.amount&&""!==r.amount?r.amount:"":"åŠ ç­åˆ†é˜æ•¸*5/3"===a.category?t.value=void 0!==r.amount&&""!==r.amount?r.amount:"":"åŠ ç­åˆ†é˜æ•¸*6/3"===a.category?o.value=void 0!==r.amount&&""!==r.amount?r.amount:"":"åœ‹å®šå‡æ—¥åŠ ç­"===a.category&&(n.value=void 0!==r.amount&&""!==r.amount?r.amount:""),{...a,hours:void 0!==r.time?r.time:a.hours||"",amount:void 0!==r.amount?r.amount:a.amount||""}})):(l.value="",t.value="",o.value="",n.value="",m.value.forEach((e=>{["B_other1","B_other2","B_other3","B_other4","B_other5","B_other6"].includes(e.id)&&(e.category=""),e.hours="",e.amount=""})))}),{immediate:!0,deep:!0}),(e,a)=>{const l=(0,u.g2)("el-input"),t=(0,u.g2)("el-table-column"),o=(0,u.g2)("el-table");return(0,u.uX)(),(0,u.Wv)(o,{class:"grid-lines",data:m.value,width:"380","row-style":v,"header-cell-style":i,resizable:!1},{default:(0,u.k6)((()=>[(0,u.bF)(t,{label:"å…¶ä»–å·¥è³‡",width:"180"},{default:(0,u.k6)((({row:e})=>[c.editMode&&!g.includes(e.category)?((0,u.uX)(),(0,u.CE)("div",pm,[(0,u.bF)(l,{modelValue:e.category,"onUpdate:modelValue":a=>e.category=a,placeholder:"è«‹è¼¸å…¥åç›®",size:"small",style:{width:"100%"}},null,8,["modelValue","onUpdate:modelValue"])])):((0,u.uX)(),(0,u.CE)("div",mm,(0,L.v_)(e.category),1))])),_:1}),(0,u.bF)(t,{label:"æ™‚æ•¸",width:"100"},{default:(0,u.k6)((({row:e})=>[c.editMode?((0,u.uX)(),(0,u.CE)("div",vm,[b.includes(e.category)?((0,u.uX)(),(0,u.CE)("div",bm,[(0,u.bF)(l,{modelValue:e.hours,"onUpdate:modelValue":a=>e.hours=a,placeholder:"è«‹è¼¸å…¥time",size:"small",style:{width:"100%"}},null,8,["modelValue","onUpdate:modelValue"])])):(0,u.Q3)("",!0)])):((0,u.uX)(),(0,u.CE)("div",gm,(0,L.v_)(void 0!==e.hours&&""!==e.hours?e.hours:"0"),1))])),_:1}),(0,u.bF)(t,{label:"é‡‘é¡",width:"100","cell-class-name":R},{default:(0,u.k6)((({row:e})=>["å…¶ä»–å·¥è³‡å°è¨ˆ(B)"===e.category?((0,u.uX)(),(0,u.CE)("div",ym,[(0,u.Lk)("span",fm,(0,L.v_)(y.value),1)])):"æ‡‰é ˜è–ªè³‡å°è¨ˆ(C)=A+B"===e.category?((0,u.uX)(),(0,u.CE)("div",hm,[(0,u.Lk)("span",km,(0,L.v_)(f.value),1)])):"å¯¦é ˜è–ªè³‡(E)=C-D"===e.category?((0,u.uX)(),(0,u.CE)("div",_m,[(0,u.Lk)("span",wm,(0,L.v_)(h.value),1)])):"åœ‹å®šå‡æ—¥åŠ ç­"===e.category?((0,u.uX)(),(0,u.CE)("div",Fm,[c.editMode?((0,u.uX)(),(0,u.CE)("div",Cm,[(0,u.bF)(l,{modelValue:s.value,"onUpdate:modelValue":a[0]||(a[0]=e=>s.value=e),placeholder:"è«‹è¼¸å…¥",size:"small",style:{width:"100%"}},null,8,["modelValue"])])):((0,u.uX)(),(0,u.CE)("div",Dm,(0,L.v_)(s.value),1))])):"åŠ ç­åˆ†é˜æ•¸*4/3"===e.category?((0,u.uX)(),(0,u.CE)("div",Lm,[c.editMode?((0,u.uX)(),(0,u.CE)("div",Rm,[(0,u.bF)(l,{modelValue:k.value,"onUpdate:modelValue":a[1]||(a[1]=e=>k.value=e),placeholder:"è«‹è¼¸å…¥",size:"small",style:{width:"100%"}},null,8,["modelValue"])])):((0,u.uX)(),(0,u.CE)("div",Vm,(0,L.v_)(k.value),1))])):"åŠ ç­åˆ†é˜æ•¸*5/3"===e.category?((0,u.uX)(),(0,u.CE)("div",Im,[c.editMode?((0,u.uX)(),(0,u.CE)("div",xm,[(0,u.bF)(l,{modelValue:_.value,"onUpdate:modelValue":a[2]||(a[2]=e=>_.value=e),placeholder:"è«‹è¼¸å…¥",size:"small",style:{width:"100%"}},null,8,["modelValue"])])):((0,u.uX)(),(0,u.CE)("div",Em,(0,L.v_)(_.value),1))])):"åŠ ç­åˆ†é˜æ•¸*6/3"===e.category?((0,u.uX)(),(0,u.CE)("div",Am,[c.editMode?((0,u.uX)(),(0,u.CE)("div",Tm,[(0,u.bF)(l,{modelValue:w.value,"onUpdate:modelValue":a[3]||(a[3]=e=>w.value=e),placeholder:"è«‹è¼¸å…¥",size:"small",style:{width:"100%"}},null,8,["modelValue"])])):((0,u.uX)(),(0,u.CE)("div",Wm,(0,L.v_)(w.value),1))])):((0,u.uX)(),(0,u.CE)("div",Sm,[c.editMode&&"å¯¦é ˜è–ªè³‡(E)=C-D"!==e.category&&"blank"!==e.id?((0,u.uX)(),(0,u.CE)("div",Um,[(0,u.bF)(l,{modelValue:e.amount,"onUpdate:modelValue":a=>e.amount=a,placeholder:"è«‹è¼¸å…¥",size:"small",style:{width:"100%"}},null,8,["modelValue","onUpdate:modelValue"])])):((0,u.uX)(),(0,u.CE)("div",$m,(0,L.v_)(e.amount),1))]))])),_:1})])),_:1},8,["data"])}}};const Xm=(0,ie.A)(Nm,[["__scopeId","data-v-3795447c"]]);var Km=Xm;const Mm=[{id:"laborInsurance",category:"å‹žä¿è²»",hours:"",amount:"",insurance:{laborPersonal:"",healthPersonal:""}},{id:"healthInsurance",category:"å¥ä¿è²»",hours:"",amount:"",insurance:{laborPersonal:"",healthPersonal:""}},{id:"healthFamily",category:"å®¶å±¬å¥ä¿è²»",hours:"",amount:"",insurance:{healthFamily:""}},{id:"personalLeave",category:"äº‹å‡",hours:"",amount:""},{id:"typhoonLeave",category:"é¢±é¢¨å‡",hours:"",amount:""},{id:"familyCareLeave",category:"å®¶åº­ç…§é¡§",hours:"",amount:""},{id:"sickLeaveWithin30",category:"ç—…å‡ï¼ˆ30å¤©å…§ï¼‰",hours:"",amount:""},{id:"sickLeaveBeyond30",category:"ç—…å‡ï¼ˆè¶…éŽ30å¤©ï¼‰",hours:"",amount:""},{id:"menstrualLeave",category:"ç”Ÿç†å‡",hours:"",amount:""},{id:"lateMinutes",category:"é²åˆ°åˆ†é˜æ•¸",hours:"",amount:""},{id:"welfare",category:"ç¦åˆ©é‡‘",hours:"",amount:""},{id:"mealAdvance",category:"ä»£å¢Šé¤è²»",hours:"",amount:""},{id:"laborPensionContribution",category:"å‹žé€€è‡ªæ",hours:"",amount:""},{id:"deductions",category:"ä»£æ‰£æ¬¾",hours:"",amount:""},{id:"workInjuryLeave",category:"å·¥å‚·å‡",hours:"",amount:""},{id:"maternityParentalLeave",category:"é™ªç”¢å‡/ç”¢æª¢å‡",hours:"",amount:""},{id:"bereavementLeave",category:"å–ªå‡",hours:"",amount:""},{id:"marriageLeave",category:"å©šå‡",hours:"",amount:""},{id:"otherLeave",category:"å…¶ä»–å‡",hours:"",amount:""},{id:"absenteeism",category:"æ› è·",hours:"",amount:""},{id:"lunchFee",category:"åˆé¤è²»ç”¨",hours:"",amount:""},{id:"D_other1",category:"",hours:"",amount:""},{id:"D_other2",category:"",hours:"",amount:""},{id:"D_other3",category:"",hours:"",amount:""},{id:"deductionSubtotal",category:"æ‡‰æ‰£å°è¨ˆ(D)",hours:"",amount:""}],Pm={key:0},Om={key:1},zm={key:0},Bm={key:1},jm={key:0},Ym={key:1},Qm={key:0,style:{color:"red"}},Hm={key:0},qm={key:1},Jm={key:0},Gm={key:1},Zm={key:0},ev={key:1},av={key:0},lv={key:1},tv={key:0},ov={key:1},nv={key:0},rv={key:1},sv={key:0},uv={key:1},iv={key:0},dv={key:1},cv={key:0},pv={key:1};var mv={__name:"Block_C",props:{editMode:{type:Boolean,default:!1},totalA:{type:[Number,String],default:0},data:{type:Object,default:()=>({total_D:0,items:[]})},lateTotal:{type:[Number,String],default:0}},emits:["updateDeductionD","updateSalaryDAggregate"],setup(e,{emit:a}){const l=e,t=a,o=e=>{if(!e&&0!==e)return"";const a=parseFloat(e);return isNaN(a)?"":a.toString()},n=((0,u.nI)(),(0,u.EW)((()=>{const e=F.value.find((e=>"ç¦åˆ©é‡‘"===e.category));return e?.amount||""}))),r=(0,u.EW)((()=>{const e=F.value.find((e=>"äº‹å‡"===e.category)),a=e?.amount||"";if(a&&!isNaN(parseFloat(a))){const e=parseFloat(a);return e.toString()}return a})),s=(0,u.EW)((()=>{const e=F.value.find((e=>"é¢±é¢¨å‡"===e.category));return e?.amount||""})),i=(0,u.EW)((()=>{const e=F.value.find((e=>"æ› è·"===e.category));return e?.amount||""})),c=(0,u.EW)((()=>{const e=F.value.find((e=>"é²åˆ°åˆ†é˜æ•¸"===e.category)),a=parseFloat(e?.hours)||0,t=parseFloat(l.totalA)||0;return Math.floor(a*(t/30/8/60))})),p=((0,u.EW)({get(){return n.value},set(e){f(e)}}),(0,u.EW)({get(){const e=F.value.find((e=>"é²åˆ°åˆ†é˜æ•¸"===e.category));return e?.amount||c.value},set(e){const a=F.value.find((e=>"é²åˆ°åˆ†é˜æ•¸"===e.category));a&&(a.amount=e)}})),m=(0,d.KR)(""),v=((0,d.KR)(""),(0,d.KR)("")),b=(0,d.KR)(""),g=((0,d.KR)(""),(0,u.EW)({get(){return r.value},set(e){h(e)}})),y=(0,u.EW)({get(){return s.value},set(e){k(e)}}),f=e=>{m.value=e;const a=F.value.find((e=>"ç¦åˆ©é‡‘"===e.category));a&&(a.amount=e)},h=e=>{v.value=e;const a=F.value.find((e=>"äº‹å‡"===e.category));a&&(a.amount=e)},k=e=>{b.value=e;const a=F.value.find((e=>"é¢±é¢¨å‡"===e.category));a&&(a.amount=e)};function _(){return{height:"41px"}}function w(){return{height:"41px",lineHeight:"41px"}}const F=(0,d.KR)(JSON.parse(JSON.stringify(Mm)).map((e=>({...e,hours:e.hours||"",amount:e.amount||""})))),C=["å‹žä¿è²»","å¥ä¿è²»","å®¶å±¬å¥ä¿è²»","ç¦åˆ©é‡‘","ä»£å¢Šé¤è²»","å‹žé€€è‡ªæ","ä»£æ‰£æ¬¾","ç‰¹ä¼‘æ™‚æ•¸","å·¥å‚·å‡","é™ªç”¢å‡/ç”¢æª¢å‡","å–ªå‡","å©šå‡","å…¶ä»–å‡","åˆé¤è²»ç”¨","æ‡‰æ‰£å°è¨ˆ(D)",""];(0,d.KR)([]);(0,u.wB)((()=>l.data),(e=>{e&&Array.isArray(e.items)?F.value=F.value.map((a=>{const l=e.items.find((e=>e.id===a.id))||{};if(["laborInsurance","healthInsurance","healthFamily"].includes(a.id))a.insurance||(a.insurance={}),"laborInsurance"===a.id?a.insurance.laborPersonal=(void 0!==l.amount?l.amount:a.amount)+"":"healthInsurance"===a.id?a.insurance.healthPersonal=(void 0!==l.amount?l.amount:a.amount)+"":"healthFamily"===a.id&&(a.insurance.healthFamily=(void 0!==l.amount?l.amount:a.amount)+""),a.amount=void 0!==l.amount?l.amount:a.amount;else{if(["subtotalB","subtotalC","subtotalE"].includes(a.id))return{...a,hours:"",amount:e[`total_${a.id.slice(-1)}`]};if(["B_other1","B_other2","B_other3","B_other4","B_other5","B_other6"].includes(a.id))return{...a,category:l.ch_name||"",hours:void 0!==l.time?l.time:a.hours,amount:void 0!==l.amount?l.amount:a.amount}}return{...a,hours:void 0!==l.time?null===l.time?"":String(l.time):a.hours||"",amount:void 0!==l.amount?null===l.amount?"":String(l.amount):a.amount||""}})):F.value.forEach((e=>{"lateMinutes"!==e.id?(e.hours&&"0"!==e.hours||(e.hours=""),e.amount&&"0"!==e.amount||(e.amount=""),["B_other1","B_other2","B_other3","B_other4","B_other5","B_other6"].includes(e.id)&&(e.category=""),["laborInsurance","healthInsurance","healthFamily"].includes(e.id)&&e.insurance&&("laborInsurance"===e.id?e.insurance.laborPersonal="":"healthInsurance"===e.id?e.insurance.healthPersonal="":"healthFamily"===e.id&&(e.insurance.healthFamily=""))):console.log("ðŸ”’ ä¿è­·é²åˆ°åˆ†é˜æ•¸ï¼Œé¿å…è¢«æ¸…ç©º:",{hours:e.hours,amount:e.amount})}))}),{immediate:!0,deep:!0}),(0,u.wB)((()=>l.data),(e=>{e&&Array.isArray(e.items)&&e.items.forEach((e=>{const a=F.value.find((a=>a.id===e.id));if(a){const l=a.amount&&"0"!==a.amount&&""!==a.amount;l?console.log(`ðŸ”’ ä¿ç•™ç”¨æˆ¶è¼¸å…¥çš„ ${a.category}:`,{amount:a.amount}):"lateMinutes"===e.id?(a.hours=e.time||"",a.amount=e.amount||"",console.log("âœ… é²åˆ°åˆ†é˜æ•¸ä½¿ç”¨å¾Œç«¯æ•¸æ“š:",{hours:e.time,amount:e.amount})):(a.hours=e.time||"",a.amount=e.amount||"",console.log(`âœ… ${a.category} ä½¿ç”¨å¾Œç«¯æ•¸æ“š:`,{hours:e.time,amount:e.amount}))}}));const a=F.value.find((e=>"é²åˆ°åˆ†é˜æ•¸"===e.category));!a||!l.lateTotal||a.amount&&"0"!==a.amount||(a.hours=l.lateTotal.toString(),a.amount=c.value.toString(),console.log("âš ï¸ é²åˆ°åˆ†é˜æ•¸ä½¿ç”¨è¨ˆç®—å€¼:",{hours:l.lateTotal,amount:c.value}))}),{immediate:!0,deep:!0});(0,u.EW)((()=>{const e=F.value.find((e=>"å®¶å±¬å¥ä¿è²»"===e.category)),a=F.value.find((e=>"å¥ä¿è²»"===e.category)),l=parseFloat(e?.hours)||0,t=parseFloat(a?.amount)||0;return l*t}));const D=(0,u.EW)((()=>F.value.reduce(((e,a)=>{if("deductionSubtotal"===a.id)return e;let l=0;return l="é²åˆ°åˆ†é˜æ•¸"===a.category?parseFloat(p.value)||0:"ç¦åˆ©é‡‘"===a.category?parseFloat(a.amount)||0:"äº‹å‡"===a.category?parseFloat(g.value)||0:"é¢±é¢¨å‡"===a.category?parseFloat(y.value)||0:"æ› è·"===a.category?parseFloat(i.value)||0:"å‹žä¿è²»"===a.category?parseFloat(a.insurance?.laborPersonal)||0:"å¥ä¿è²»"===a.category?parseFloat(a.insurance?.healthPersonal)||0:"å®¶å±¬å¥ä¿è²»"===a.category?parseFloat(a.insurance?.healthFamily)||0:parseFloat(a.amount)||0,e+l}),0))),R=["å‹žä¿è²»","å¥ä¿è²»","å®¶å±¬å¥ä¿è²»","äº‹å‡","é¢±é¢¨å‡","æ› è·","å®¶åº­ç…§é¡§","ç—…å‡ï¼ˆ30å¤©å…§ï¼‰","ç—…å‡ï¼ˆè¶…éŽ30å¤©ï¼‰","ç”Ÿç†å‡","é²åˆ°åˆ†é˜æ•¸","ç¦åˆ©é‡‘","ä»£å¢Šé¤è²»","å‹žé€€è‡ªæ","ä»£æ‰£æ¬¾","å·¥å‚·å‡","é™ªç”¢å‡/ç”¢æª¢å‡","å–ªå‡","å©šå‡","å…¶ä»–å‡","åˆé¤è²»ç”¨","æ‡‰æ‰£å°è¨ˆ(D)"];function V({row:e}){return""}return(0,u.wB)((()=>{const e=F.value.find((e=>"é²åˆ°åˆ†é˜æ•¸"===e.category));return e?e.hours:null}),(e=>{const a=F.value.find((e=>"é²åˆ°åˆ†é˜æ•¸"===e.category));a&&(a.amount=p.value)})),(0,u.wB)((()=>l.lateTotal),(e=>{const a=F.value.find((e=>"lateMinutes"===e.id));if(a){const t=l.data?.items?.find((e=>"lateMinutes"===e.id));t?console.log("â„¹ï¸ å·²æœ‰å¾Œç«¯æ•¸æ“šï¼Œè·³éŽ lateTotal æ›´æ–°"):(a.hours=e?.toString()??"",e&&(a.amount=c.value.toString()),console.log("ðŸ”„ ä½¿ç”¨ lateTotal æ›´æ–°é²åˆ°åˆ†é˜æ•¸:",{hours:e,amount:a.amount}))}}),{immediate:!0,flush:"post"}),(0,u.wB)((()=>l.editMode),((e,a)=>{if(!e&&a){console.log("ðŸ”„ Block_C: é€€å‡ºç·¨è¼¯æ¨¡å¼ï¼Œé‡ç½®æ‰‹å‹•è®Šæ•¸");const e={};F.value.forEach((a=>{a.amount&&"0"!==a.amount&&""!==a.amount&&(e[a.id]={hours:a.hours,amount:a.amount})})),console.log("ðŸ’¾ ä¿å­˜ç”¨æˆ¶è¼¸å…¥çš„æ•¸æ“š:",e),F.value=JSON.parse(JSON.stringify(Mm)).map((e=>({...e,hours:e.hours||"",amount:e.amount||""}))),Object.keys(e).forEach((a=>{const l=F.value.find((e=>e.id===a));l&&(l.hours=e[a].hours,l.amount=e[a].amount,console.log(`ðŸ”’ å·²ä¿è­·ä¸¦æ¢å¾© ${l.category}:`,e[a]))})),console.log("âœ… Block_C: æ‰‹å‹•è®Šæ•¸å·²é‡ç½®ï¼Œæ‰€æœ‰ç”¨æˆ¶è¼¸å…¥å·²ä¿è­·")}})),(0,u.wB)(D,(e=>{t("updateDeductionD",e)}),{immediate:!0}),(0,u.wB)((()=>l.editMode),((e,a)=>{if(!0===a&&!1===e){const e={total_D:D.value,items:F.value.map((e=>{let a=e.amount;return"ç¦åˆ©é‡‘"===e.category?(a=e.amount||"",console.log("ðŸ’° ç¦åˆ©é‡‘é‡‘é¡è™•ç†:",{category:e.category,rowAmount:e.amount,finalAmount:a,rowData:e})):"äº‹å‡"===e.category||"é¢±é¢¨å‡"===e.category||"æ› è·"===e.category?a=e.amount||"":"å‹žä¿è²»"===e.category?a=e.amount||e.insurance?.laborPersonal||"":"å¥ä¿è²»"===e.category?a=e.amount||e.insurance?.healthPersonal||"":"å®¶å±¬å¥ä¿è²»"===e.category&&(a=e.amount||e.insurance?.healthFamily||""),{id:e.id,ch_name:e.category,time:e.hours||"",amount:a||""}}))};t("updateSalaryDAggregate",e)}})),(e,a)=>{const t=(0,u.g2)("el-input"),n=(0,u.g2)("el-table-column"),r=(0,u.g2)("el-table");return(0,u.uX)(),(0,u.Wv)(r,{class:"grid-lines",data:F.value,width:"380","row-style":_,"header-cell-style":w,resizable:!1},{default:(0,u.k6)((()=>[(0,u.bF)(n,{label:"æ‡‰æ‰£å·¥è³‡",width:"180"},{default:(0,u.k6)((({row:e})=>[l.editMode&&!R.includes(e.category)?((0,u.uX)(),(0,u.CE)("div",Pm,[(0,u.bF)(t,{modelValue:e.category,"onUpdate:modelValue":a=>e.category=a,placeholder:"è«‹è¼¸å…¥åç›®",size:"small",style:{width:"100%"}},null,8,["modelValue","onUpdate:modelValue"])])):((0,u.uX)(),(0,u.CE)("div",Om,(0,L.v_)(e.category),1))])),_:1}),(0,u.bF)(n,{label:"æ™‚æ•¸",width:"100"},{default:(0,u.k6)((({row:e})=>[C.includes(e.category)?((0,u.uX)(),(0,u.CE)("div",zm,(0,L.v_)(o(e.hours)),1)):((0,u.uX)(),(0,u.CE)("div",Bm,[l.editMode?((0,u.uX)(),(0,u.CE)("div",jm,[(0,u.bF)(t,{modelValue:e.hours,"onUpdate:modelValue":a=>e.hours=a,placeholder:"è«‹è¼¸å…¥æ™‚æ•¸",size:"small",style:{width:"100%"}},null,8,["modelValue","onUpdate:modelValue"])])):((0,u.uX)(),(0,u.CE)("div",Ym,(0,L.v_)(o(e.hours)),1))]))])),_:1}),(0,u.bF)(n,{label:"é‡‘é¡",width:"100","cell-class-name":V},{default:(0,u.k6)((({row:e})=>["æ‡‰æ‰£å°è¨ˆ(D)"===e.category?((0,u.uX)(),(0,u.CE)("span",Qm,(0,L.v_)(D.value),1)):"å®¶å±¬å¥ä¿è²»"===e.category?((0,u.uX)(),(0,u.CE)(u.FK,{key:1},[l.editMode?((0,u.uX)(),(0,u.CE)("div",Hm,[(0,u.bF)(t,{modelValue:e.amount,"onUpdate:modelValue":a=>e.amount=a,placeholder:"å®¶å±¬å¥ä¿è²»",size:"small",style:{width:"100%"}},null,8,["modelValue","onUpdate:modelValue"])])):((0,u.uX)(),(0,u.CE)("div",qm,(0,L.v_)(e.insurance?.healthFamily||e.amount),1))],64)):"ç¦åˆ©é‡‘"===e.category?((0,u.uX)(),(0,u.CE)(u.FK,{key:2},[l.editMode?((0,u.uX)(),(0,u.CE)("div",Jm,[(0,u.bF)(t,{modelValue:e.amount,"onUpdate:modelValue":a=>e.amount=a,placeholder:"è«‹è¼¸å…¥",size:"small",style:{width:"100%"}},null,8,["modelValue","onUpdate:modelValue"])])):((0,u.uX)(),(0,u.CE)("div",Gm,(0,L.v_)(e.amount),1))],64)):"å‹žä¿è²»"===e.category?((0,u.uX)(),(0,u.CE)(u.FK,{key:3},[l.editMode?((0,u.uX)(),(0,u.CE)("div",Zm,[(0,u.bF)(t,{modelValue:e.amount,"onUpdate:modelValue":a=>e.amount=a,placeholder:"å‹žä¿è²»",size:"small",style:{width:"100%"}},null,8,["modelValue","onUpdate:modelValue"])])):((0,u.uX)(),(0,u.CE)("div",ev,(0,L.v_)(e.insurance?.laborPersonal||e.amount),1))],64)):"å¥ä¿è²»"===e.category?((0,u.uX)(),(0,u.CE)(u.FK,{key:4},[l.editMode?((0,u.uX)(),(0,u.CE)("div",av,[(0,u.bF)(t,{modelValue:e.amount,"onUpdate:modelValue":a=>e.amount=a,placeholder:"å¥ä¿è²»",size:"small",style:{width:"100%"}},null,8,["modelValue","onUpdate:modelValue"])])):((0,u.uX)(),(0,u.CE)("div",lv,(0,L.v_)(e.insurance?.healthPersonal||e.amount),1))],64)):"é²åˆ°åˆ†é˜æ•¸"===e.category?((0,u.uX)(),(0,u.CE)(u.FK,{key:5},[l.editMode?((0,u.uX)(),(0,u.CE)("div",tv,[(0,u.bF)(t,{modelValue:e.amount,"onUpdate:modelValue":a=>e.amount=a,placeholder:"è«‹è¼¸å…¥é‡‘é¡",size:"small",style:{width:"100%"}},null,8,["modelValue","onUpdate:modelValue"])])):((0,u.uX)(),(0,u.CE)("div",ov,(0,L.v_)(e.amount),1))],64)):"äº‹å‡"===e.category?((0,u.uX)(),(0,u.CE)(u.FK,{key:6},[l.editMode?((0,u.uX)(),(0,u.CE)("div",nv,[(0,u.bF)(t,{modelValue:e.amount,"onUpdate:modelValue":a=>e.amount=a,placeholder:"è«‹è¼¸å…¥é‡‘é¡",size:"small",style:{width:"100%"}},null,8,["modelValue","onUpdate:modelValue"])])):((0,u.uX)(),(0,u.CE)("div",rv,(0,L.v_)(e.amount),1))],64)):"é¢±é¢¨å‡"===e.category?((0,u.uX)(),(0,u.CE)(u.FK,{key:7},[l.editMode?((0,u.uX)(),(0,u.CE)("div",sv,[(0,u.bF)(t,{modelValue:e.amount,"onUpdate:modelValue":a=>e.amount=a,placeholder:"è«‹è¼¸å…¥é‡‘é¡",size:"small",style:{width:"100%"}},null,8,["modelValue","onUpdate:modelValue"])])):((0,u.uX)(),(0,u.CE)("div",uv,(0,L.v_)(e.amount),1))],64)):"æ› è·"===e.category?((0,u.uX)(),(0,u.CE)(u.FK,{key:8},[l.editMode?((0,u.uX)(),(0,u.CE)("div",iv,[(0,u.bF)(t,{modelValue:e.amount,"onUpdate:modelValue":a=>e.amount=a,placeholder:"è«‹è¼¸å…¥é‡‘é¡",size:"small",style:{width:"100%"}},null,8,["modelValue","onUpdate:modelValue"])])):((0,u.uX)(),(0,u.CE)("div",dv,(0,L.v_)(e.amount),1))],64)):((0,u.uX)(),(0,u.CE)(u.FK,{key:9},[l.editMode?((0,u.uX)(),(0,u.CE)("div",cv,[(0,u.bF)(t,{modelValue:e.amount,"onUpdate:modelValue":a=>e.amount=a,placeholder:"è«‹è¼¸å…¥",size:"small",style:{width:"100%"}},null,8,["modelValue","onUpdate:modelValue"])])):((0,u.uX)(),(0,u.CE)("div",pv,(0,L.v_)(e.amount||""),1))],64))])),_:1})])),_:1},8,["data"])}}};const vv=(0,ie.A)(mv,[["__scopeId","data-v-6cf598a0"]]);var bv=vv,gv={__name:"Block_AnnualLeave",props:{editMode:{type:Boolean,default:!1},data:{type:Object,default:()=>({id:"block_AnnualLeave",items:[{id:"annualUsed",ch_name:"å·²ä¼‘ç‰¹ä¼‘æ™‚æ•¸",time:0},{id:"annualRemaining",ch_name:"",time:0}]})}},emits:["updateAnnualLeaveData"],setup(e,{emit:a}){function l(){return{height:"41px"}}function t(){return{height:"41px",lineHeight:"41px"}}const o=e,n=a,r=[{id:"annualUsed",ch_name:"å·²ä¼‘ç‰¹ä¼‘æ™‚æ•¸",time:0},{id:"annualRemaining",ch_name:"",time:0}],s=(0,d.KR)([...r]),i=()=>{o.data&&Array.isArray(o.data.items)&&o.data.items.length>0?s.value=o.data.items.map((e=>({...e}))):s.value=[...r]};return i(),(0,u.wB)((()=>o.data),(e=>{console.log("ðŸ” Block_AnnualLeave æŽ¥æ”¶åˆ°æ–°æ•¸æ“š:",e),e&&Array.isArray(e.items)&&e.items.length>0?(console.log("âœ… ä½¿ç”¨æŽ¥æ”¶åˆ°çš„æ•¸æ“š"),s.value=e.items.map((e=>({...e})))):(console.log("âš ï¸ æ²’æœ‰æœ‰æ•ˆæ•¸æ“šï¼Œä½¿ç”¨é è¨­å€¼"),s.value=[...r]),console.log("ðŸ“‹ æœ€çµ‚ tableData:",s.value)}),{immediate:!0,deep:!0}),(0,u.wB)((()=>o.editMode),((e,a)=>{if(!0===a&&!1===e){const e={annualLeave:"annualLeave",items:s.value.map((e=>({id:e.id,ch_name:e.ch_name,time:e.time})))};n("updateAnnualLeaveData",e)}})),(a,o)=>{const n=(0,u.g2)("el-table-column"),r=(0,u.g2)("el-input"),i=(0,u.g2)("el-table");return(0,u.uX)(),(0,u.Wv)(i,{class:"grid-lines",data:s.value,"show-header":!1,style:{"max-width":"380px"},"row-style":l,"header-cell-style":t,resizable:!1},{default:(0,u.k6)((()=>[(0,u.bF)(n,{prop:"ch_name",label:"ç‰¹ä¼‘é …ç›®",width:"180"}),(0,u.bF)(n,{label:"æ™‚æ•¸",width:"100"},{default:(0,u.k6)((a=>[e.editMode?((0,u.uX)(),(0,u.Wv)(r,{key:0,modelValue:a.row.time,"onUpdate:modelValue":e=>a.row.time=e,type:"number",size:"small"},null,8,["modelValue","onUpdate:modelValue"])):((0,u.uX)(),(0,u.CE)(u.FK,{key:1},[(0,u.eW)((0,L.v_)(a.row.time),1)],64))])),_:1}),(0,u.bF)(n,{label:"é‡‘é¡",width:"100"},{default:(0,u.k6)((()=>o[0]||(o[0]=[]))),_:1})])),_:1},8,["data"])}}};const yv=gv;var fv=yv,hv={__name:"Block_InsuranceCompany",props:{editMode:{type:Boolean,default:!1},selectedUser:{type:Object,default:null},insuranceCompany:{type:Object,default:()=>({pensionCompany:"",laborCompany:"",healthCompany:""})}},emits:["updateInsuranceValues"],setup(e,{emit:a}){const l=e,t=a,o=()=>({height:"30px",lineHeight:"10px"}),n=(0,d.KR)([{col1:"å‹žé€€å…¬ä»˜",col2:"",col3:"å‹žä¿å…¬ä»˜",col4:"",col5:"å¥ä¿å…¬ä»˜",col6:""}]);return(0,u.wB)((()=>l.selectedUser),(e=>{e&&e.namE_FIRST?n.value[0].col2=e.namE_FIRST:n.value[0].col2=""}),{immediate:!0}),(0,u.wB)((()=>l.editMode),((e,a)=>{!0===a&&!1===e&&t("updateInsuranceValues",{publicLaborPension:n.value[0].col2,publicLaborInsurance:n.value[0].col4,publicHealthInsurance:n.value[0].col6})})),(0,u.wB)((()=>l.insuranceCompany),(e=>{e&&e.pensionCompany&&e.laborCompany&&e.healthCompany?(n.value[0].col2=e.pensionCompany.content||"",n.value[0].col4=e.laborCompany.calculatedLaborCompany||"",n.value[0].col6=e.healthCompany.content||""):n.value=[{col1:"å‹žé€€å…¬ä»˜",col2:"",col3:"å‹žä¿å…¬ä»˜",col4:"",col5:"å¥ä¿å…¬ä»˜",col6:""}]}),{deep:!0}),(e,a)=>{const l=(0,u.g2)("el-table-column"),t=(0,u.g2)("el-table");return(0,u.uX)(),(0,u.Wv)(t,{class:"grid-lines block-public-contribution",style:{width:"762px","margin-top":"-2px","table-layout":"fixed"},data:n.value,"show-header":!1,"row-style":o},{default:(0,u.k6)((()=>[(0,u.bF)(l,{prop:"col1",width:"93"},{default:(0,u.k6)((({row:e})=>[(0,u.Lk)("div",null,(0,L.v_)(e.col1),1)])),_:1}),(0,u.bF)(l,{prop:"col2",width:"160"},{default:(0,u.k6)((({row:e})=>[(0,u.eW)((0,L.v_)(e.col2),1)])),_:1}),(0,u.bF)(l,{prop:"col3",width:"95"},{default:(0,u.k6)((({row:e})=>[(0,u.Lk)("div",null,(0,L.v_)(e.col3),1)])),_:1}),(0,u.bF)(l,{prop:"col4",width:"160"},{default:(0,u.k6)((({row:e})=>[(0,u.eW)((0,L.v_)(e.col4),1)])),_:1}),(0,u.bF)(l,{prop:"col5",width:"93"},{default:(0,u.k6)((({row:e})=>[(0,u.Lk)("div",null,(0,L.v_)(e.col5),1)])),_:1}),(0,u.bF)(l,{prop:"col6",width:"160"},{default:(0,u.k6)((({row:e})=>[(0,u.eW)((0,L.v_)(e.col6),1)])),_:1})])),_:1},8,["data"])}}};const kv=hv;var _v=kv;let wv;function Fv(e){wv=e}const Cv=()=>wv,Dv="External";var Lv={GetAllInsuranceRates(){return Cv().get(`${Dv}/GetAllInsuranceRates`,{headers:{"Content-Type":"application/json"}})}};const Rv={key:0},Vv={key:1},Iv={key:0},xv={style:{display:"flex","justify-content":"space-between"}},Ev={style:{"font-size":"13px"}},Av={key:1},Tv={key:0},Wv={key:1},Sv={key:0},Uv={key:1};var $v={__name:"SalaryInfo",props:{editMode:{type:Boolean,default:!1},selectedUser:{type:Object,default:null},salaryHeadInfoRef:{type:Object,default:null}},emits:["update:salaryHeadInfoRef"],setup(e,{emit:a}){const l=(0,d.KR)(0),t=e,o=a,n=()=>({height:"10px",lineHeight:"10px"}),r=(0,d.KR)([{col1:"å§“åï¼š",col2:"",col3:"éƒ¨é–€ï¼š",col4:"",col5:"è·ç­‰ï¼š",col6:""},{col1:"å‹žå¥ä¿ç´šè·ï¼š",col2:"",col3:"è·ç¨±ï¼š",col4:"",col5:"è·ç´šï¼š",col6:""}]),s=(0,d.KR)([]);function i(e){let a={};if(e.salaryHeadInfo)if("string"===typeof e.salaryHeadInfo&&""!==e.salaryHeadInfo.trim())try{a=JSON.parse(e.salaryHeadInfo)}catch(n){console.error("è§£æž salaryHeadInfo å¤±æ•—ï¼š",n),a={},r.value=r.value.map((e=>({...e,col2:"",col4:"",col6:""})))}else a={},r.value=r.value.map((e=>({...e,col2:"",col4:"",col6:""})));else a=e;const l=e=>void 0!==a[e]&&null!==a[e]?a[e]:"";if(r.value.length<2)return void console.error("tableData çš„åˆ—æ•¸ä¸è¶³ï¼Œè«‹ç¢ºèªåˆå§‹åŒ–è³‡æ–™");const o=l("empName");o?r.value[0].col2=o:t.selectedUser?.namE_FIRST?r.value[0].col2=t.selectedUser.namE_FIRST:r.value[0].col2="",r.value[0].col4=l("empDpt"),r.value[0].col6=l("empTitleGrade"),r.value[1].col2=l("insuranceLevel"),r.value[1].col4=l("empTitleName"),r.value[1].col6=l("empTitleLevel")}(0,u.wB)((()=>[t.selectedUser,l.value]),(async([e])=>{e&&e.namE_FIRST?r.value[0].col2=e.namE_FIRST:r.value[0].col2=""}),{immediate:!0}),(0,u.wB)((()=>t.salaryHeadInfoRef),(e=>{e&&i(e)}),{immediate:!0});const c=(0,u.EW)((()=>{const e={};return s.value.forEach((a=>{e[a.laborPersonal]=(e[a.laborPersonal]||0)+1})),e})),p=(0,u.EW)((()=>{const e={};return s.value.map((a=>{const l={id:a.id,insuranceLevel:a.insuranceLevel,laborLevel:a.insuranceLevel,healthLevel:a.insuranceLevel};return c.value[a.laborPersonal]>1&&(a.laborPersonal in e||(e[a.laborPersonal]=a.insuranceLevel),l.laborLevel=e[a.laborPersonal],l.healthLevel=a.insuranceLevel),l.combinedLevel=`${l.laborLevel} / ${l.healthLevel}`,l}))}));(0,u.sV)((async()=>{try{const e=await Lv.GetAllInsuranceRates();s.value=e.data}catch(e){console.error("Fetch error:",e)}}));const m=(e,a)=>{"å‹žå¥ä¿ç´šè·ï¼š"===e.col1&&(e.col2=a),v()},v=()=>{const e={empName:r.value[0].col2,empDpt:r.value[0].col4,empTitleGrade:r.value[0].col6,insuranceLevel:r.value[1].col2,empTitleName:r.value[1].col4,empTitleLevel:r.value[1].col6};o("update:salaryHeadInfoRef",e)};return(0,u.wB)((()=>r.value),(()=>{t.editMode&&v()}),{deep:!0}),(e,a)=>{const l=(0,u.g2)("el-table-column"),o=(0,u.g2)("el-option"),s=(0,u.g2)("el-select"),i=(0,u.g2)("el-input"),d=(0,u.g2)("el-table");return(0,u.uX)(),(0,u.Wv)(d,{class:"custom-table",style:{width:"763.5px","table-layout":"fixed"},data:r.value,"show-header":!1,"row-style":n,border:""},{default:(0,u.k6)((()=>[(0,u.bF)(l,{prop:"col1",width:"120"},{default:(0,u.k6)((({row:e})=>[(0,u.Lk)("div",null,(0,L.v_)(e.col1),1)])),_:1}),(0,u.bF)(l,{prop:"col2",width:"170"},{default:(0,u.k6)((({row:e})=>["å§“åï¼š"===e.col1?((0,u.uX)(),(0,u.CE)("div",Rv,(0,L.v_)(e.col2),1)):((0,u.uX)(),(0,u.CE)("div",Vv,[t.editMode?((0,u.uX)(),(0,u.CE)("div",Iv,["å‹žå¥ä¿ç´šè·ï¼š"===e.col1?((0,u.uX)(),(0,u.Wv)(s,{key:0,modelValue:e.col2,"onUpdate:modelValue":a=>e.col2=a,placeholder:"è«‹é¸æ“‡",style:{width:"8rem"},"allow-create":"",size:"small",filterable:"",width:"100",onChange:a=>m(e,a)},{default:(0,u.k6)((()=>[(0,u.bF)(o,{disabled:"",value:""},{default:(0,u.k6)((()=>a[0]||(a[0]=[(0,u.Lk)("div",{style:{display:"flex","justify-content":"center","font-weight":"bold",padding:"4px 8px","border-bottom":"1px solid #ebeef5"}},[(0,u.Lk)("span",null,"å‹žä¿/å¥ä¿ç´šè·")],-1)]))),_:1}),((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(p.value,(e=>((0,u.uX)(),(0,u.Wv)(o,(0,u.v6)({key:e.id,label:e.combinedLevel,value:e.combinedLevel,ref_for:!0},{laborFee:e.laborLevel,healthFee:e.healthLevel}),{default:(0,u.k6)((()=>[(0,u.Lk)("div",xv,[(0,u.Lk)("span",Ev,(0,L.v_)(e.combinedLevel),1)])])),_:2},1040,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])):((0,u.uX)(),(0,u.Wv)(i,{key:1,modelValue:e.col2,"onUpdate:modelValue":a=>e.col2=a,placeholder:"è«‹è¼¸å…¥",size:"small",style:{width:"100%"},onInput:v},null,8,["modelValue","onUpdate:modelValue"]))])):((0,u.uX)(),(0,u.CE)("div",Av,(0,L.v_)(e.col2),1))]))])),_:1}),(0,u.bF)(l,{prop:"col3",width:"80"}),(0,u.bF)(l,{prop:"col4",width:"140"},{default:(0,u.k6)((({row:e})=>[t.editMode?((0,u.uX)(),(0,u.CE)("div",Tv,["å§“åï¼š"===e.col1?((0,u.uX)(),(0,u.Wv)(Gn,{key:0,modelValue:e.col4,"onUpdate:modelValue":[a=>e.col4=a,v],size:"small"},null,8,["modelValue","onUpdate:modelValue"])):"å‹žå¥ä¿ç´šè·ï¼š"===e.col1?((0,u.uX)(),(0,u.Wv)(su,{key:1,modelValue:e.col4,"onUpdate:modelValue":[a=>e.col4=a,v],size:"small"},null,8,["modelValue","onUpdate:modelValue"])):((0,u.uX)(),(0,u.Wv)(i,{key:2,modelValue:e.col4,"onUpdate:modelValue":a=>e.col4=a,placeholder:"è«‹è¼¸å…¥",size:"small",onInput:v},null,8,["modelValue","onUpdate:modelValue"]))])):((0,u.uX)(),(0,u.CE)("div",Wv,["å§“åï¼š"===e.col1?((0,u.uX)(),(0,u.Wv)(_l,{key:0,deptId:e.col4},null,8,["deptId"])):"å‹žå¥ä¿ç´šè·ï¼š"===e.col1?((0,u.uX)(),(0,u.Wv)(Dl,{key:1,mode:"Description",titleId:e.col4},null,8,["titleId"])):((0,u.uX)(),(0,u.CE)(u.FK,{key:2},[(0,u.eW)((0,L.v_)(e.col4),1)],64))]))])),_:1}),(0,u.bF)(l,{prop:"col5",width:"100"}),(0,u.bF)(l,{prop:"col6",width:"152"},{default:(0,u.k6)((({row:e})=>[t.editMode?((0,u.uX)(),(0,u.CE)("div",Sv,[(0,u.bF)(i,{modelValue:e.col6,"onUpdate:modelValue":a=>e.col6=a,placeholder:"è«‹è¼¸å…¥",size:"small",onInput:v},null,8,["modelValue","onUpdate:modelValue"])])):((0,u.uX)(),(0,u.CE)("div",Uv,(0,L.v_)(e.col6),1))])),_:1})])),_:1},8,["data"])}}};const Nv=(0,ie.A)($v,[["__scopeId","data-v-5b228660"]]);var Xv=Nv;const Kv={class:"user-list-block"},Mv={class:"tab-container"};var Pv={__name:"Horizontal-User-List-Block",props:{editMode:{type:Boolean,default:!1},sysMode:{type:Boolean,default:!1}},emits:["row-selected"],setup(e,{emit:a}){const l=(0,i.n)(),t=a,o=e,n=(0,d.KR)(""),r=(0,d.KR)(null),s=(0,d.KR)([]),c=(0,d.KR)(null),p=(0,d.KR)(null),m=(0,u.EW)((()=>s.value.filter((e=>!n.value||e.namE_FIRST.toLowerCase().includes(n.value.toLowerCase())))));function v(e){const a=s.value.find((a=>a.emploY_ID===e.props.name));if(a)if(o.editMode&&p.value!==a.emploY_ID)Sa.s.confirm("ç•¶å‰ç·¨è¼¯çš„å…§å®¹å°šæœªå„²å­˜ï¼Œè«‹å•æ˜¯å¦è¦åˆ‡æ›åˆ°ä¸åŒè³‡æ–™ï¼Ÿ","æç¤º",{confirmButtonText:"ç¢ºèª",cancelButtonText:"å–æ¶ˆ",type:"warning"}).then((()=>{p.value=a.emploY_ID,r.value=a.emploY_ID;const e=new Date,l=e.getFullYear();let o=e.getMonth();o=o<10?"0"+o:o;const n=`${l}-${o}`;t("row-selected",a,n)})).catch((()=>{r.value=p.value}));else{p.value=a.emploY_ID,r.value=a.emploY_ID;const e=new Date,l=e.getFullYear();let o=e.getMonth();o=o<10?"0"+o:o;const n=`${l}-${o}`;t("row-selected",a,n)}}return(0,u.sV)((async()=>{try{const e=await ja.getEmployeeData(),a=e.data.filter((e=>"Inactive"!==e.emp_status&&"vincent"!==e.id)),t=l.user.areaInfo.id||"",o=t.startsWith("AR03");if(l.user.roles.includes("RO0000")){const e=a.map((({id:e,name:a})=>({emploY_ID:e,namE_FIRST:a})));return void(s.value=e.sort(((e,a)=>{const l=e=>e.startsWith("TW")?1:e.startsWith("OP")?2:3,t=l(e.emploY_ID),o=l(a.emploY_ID);return t!==o?t-o:e.emploY_ID.localeCompare(a.emploY_ID)})))}const n=a.filter((e=>{const a=e.area_id||"";return o?a.startsWith("AR03"):!a.startsWith("AR03")})),r=n.map((({id:e,name:a})=>({emploY_ID:e,namE_FIRST:a})));s.value=r.sort(((e,a)=>{const l=e=>e.startsWith("TW")?1:e.startsWith("OP")?2:3,t=l(e.emploY_ID),o=l(a.emploY_ID);return t!==o?t-o:e.emploY_ID.localeCompare(a.emploY_ID)})),console.log("æœ€çµ‚ users:",s.value)}catch(e){console.error("Horizontal-User-List-Block å–å¾—ä½¿ç”¨è€…åå–®éŒ¯èª¤ï¼š",e)}})),(0,u.wB)(r,(e=>{null===p.value&&(p.value=e)})),(a,l)=>{const t=(0,u.g2)("el-tooltip"),o=(0,u.g2)("el-tab-pane"),s=(0,u.g2)("el-tabs");return(0,u.uX)(),(0,u.CE)("div",Kv,[(0,u.bF)((0,d.R1)(x.A),{modelValue:n.value,"onUpdate:modelValue":l[0]||(l[0]=e=>n.value=e),placeholder:"è¼¸å…¥å“¡å·¥å§“å",class:"search-input mb-3"},null,8,["modelValue"]),(0,u.Lk)("div",Mv,[(0,u.Lk)("div",{class:"tabs-wrapper",ref_key:"tabsWrapper",ref:c},[(0,u.bF)(s,{modelValue:r.value,"onUpdate:modelValue":l[1]||(l[1]=e=>r.value=e),type:"card",class:(0,L.C4)(["user-tabs",{"sys-mode-tabs":e.sysMode}]),onTabClick:v},{default:(0,u.k6)((()=>[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(m.value,(e=>((0,u.uX)(),(0,u.Wv)(o,{key:e.emploY_ID,name:e.emploY_ID},{label:(0,u.k6)((()=>[(0,u.bF)(t,{class:"item",effect:"dark",content:e.namE_FIRST,placement:"top"},{default:(0,u.k6)((()=>[(0,u.Lk)("span",null,(0,L.v_)(e.namE_FIRST),1)])),_:2},1032,["content"])])),_:2},1032,["name"])))),128))])),_:1},8,["modelValue","class"])],512)])])}}};const Ov=Pv;var zv=Ov,Bv=l(25320);const jv={class:"report-buttons-container btn-report-dialog"},Yv={class:"btn-3"},Qv={class:"btn-4"},Hv={class:"btn-5"},qv={class:"btn-6"},Jv={class:"btn-7"},Gv={class:"btn-8"},Zv={class:"btn-9"},eb={class:"btn-10"};var ab={__name:"ReportFunctionsDialog",props:{showReportDialog:Boolean,selectedUser:Object,attendanceDate:String},emits:["update:showReportDialog"],setup(e,{emit:a}){const l=e,t=a,o=(0,d.KR)(l.showReportDialog);(0,u.wB)((()=>l.showReportDialog),(e=>{o.value=e})),(0,u.wB)(o,(e=>{t("update:showReportDialog",e)}));const n=(0,S.k)(),r=(0,d.KR)(!1),s=(0,d.KR)(!1),i=(0,d.KR)(!1),c=(0,d.KR)(!1),p=(0,d.KR)(!1),m=(0,d.KR)(!1),v=(0,d.KR)(!1),b=(0,d.KR)(!1),g=async()=>{try{r.value=!0;const e=await Wa.downloadInternalAttendanceMonthly(l.attendanceDate,n.userId,{responseType:"blob"});if(e){const a=e.headers["content-disposition"];let t=`${l.attendanceDate}_DAE_Attendance(Internal).xlsx`;if(a){const e=a.match(/filename\*?=UTF-8''(.+)/i);if(e&&e[1])t=decodeURIComponent(e[1]);else{const e=a.match(/filename="(.+)"/i);e&&e[1]&&(t=e[1])}}const o=new Blob([e.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),n=window.URL.createObjectURL(o),r=document.createElement("a");r.href=n,r.setAttribute("download",t),document.body.appendChild(r),r.click(),document.body.removeChild(r),window.URL.revokeObjectURL(n)}}catch(e){console.error("æœˆå ±è¡¨åŒ¯å‡ºéŒ¯èª¤:",e),D.nk.error("ä¸‹è¼‰å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦ã€‚")}finally{r.value=!1}},y=async()=>{try{if(l.attendanceDate){s.value=!0;const e=await Wa.downloadExternalAttendanceMonthly(l.attendanceDate,l.selectedUser.emploY_ID),a=e.headers["content-disposition"];let t=`${l.attendanceDate}_DAE_Attendance(External).xlsx`;if(a){const e=a.match(/filename\*?=UTF-8''(.+)/i);if(e&&e[1])t=decodeURIComponent(e[1]);else{const e=a.match(/filename="(.+)"/i);e&&e[1]&&(t=e[1])}}const o=new Blob([e.data],{type:e.headers["content-type"]}),n=document.createElement("a");n.href=URL.createObjectURL(o),n.download=t,document.body.appendChild(n),n.click(),URL.revokeObjectURL(n.href),document.body.removeChild(n)}else D.nk.warn("è«‹é¸æ“‡æ—¥æœŸ")}catch(e){console.error("æœˆå ±è¡¨åŒ¯å‡ºéŒ¯èª¤:",e),D.nk.error("ä¸‹è¼‰å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦ã€‚")}finally{s.value=!1}},f=async()=>{try{if(l.attendanceDate){i.value=!0;const e=await Wa.downloadCompanySalaryMonthly(l.attendanceDate,l.selectedUser.emploY_ID),a=e.headers["content-disposition"];let t=`${l.attendanceDate}_DAE_Salary(Company).xlsx`;if(a){const e=a.match(/filename\*?=UTF-8''(.+)/i);if(e&&e[1])t=decodeURIComponent(e[1]);else{const e=a.match(/filename="(.+)"/i);e&&e[1]&&(t=e[1])}}const o=new Blob([e.data],{type:e.headers["content-type"]}),n=document.createElement("a");n.href=URL.createObjectURL(o),n.download=t,document.body.appendChild(n),n.click(),URL.revokeObjectURL(n.href),document.body.removeChild(n)}else D.nk.warn("è«‹é¸æ“‡æ—¥æœŸ")}catch(e){console.error("æœˆå ±è¡¨åŒ¯å‡ºéŒ¯èª¤:",e),D.nk.error("ä¸‹è¼‰å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦ã€‚")}finally{i.value=!1}},h=async()=>{try{if(l.attendanceDate){c.value=!0;const e=await Wa.downloadEmployeeSalaryMonthly(l.attendanceDate,l.selectedUser.emploY_ID);if("è©²æœˆä»½æ²’æœ‰è–ªè³‡è³‡æ–™"===e.data)return void D.nk.warn("è©²æœˆä»½æ²’æœ‰è–ªè³‡è³‡æ–™");const a=e.headers["content-disposition"];let t=`${l.attendanceDate}_DAE_Salary(Employee).xlsx`;if(a){const e=a.match(/filename\*?=UTF-8''(.+)/i);if(e&&e[1])t=decodeURIComponent(e[1]);else{const e=a.match(/filename="(.+)"/i);e&&e[1]&&(t=e[1])}}const o=new Blob([e.data],{type:e.headers["content-type"]}),n=document.createElement("a");n.href=URL.createObjectURL(o),n.download=t,document.body.appendChild(n),n.click(),URL.revokeObjectURL(n.href),document.body.removeChild(n)}else D.nk.warn("è«‹é¸æ“‡æ—¥æœŸ")}catch(e){console.error("æœˆå ±è¡¨åŒ¯å‡ºéŒ¯èª¤:",e),D.nk.error("ä¸‹è¼‰å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦ã€‚")}finally{c.value=!1}},k=async()=>{try{p.value=!0;const e=await Wa.downloadInternalAttendanceMonthlyOP(l.attendanceDate,{responseType:"blob"});if(e){const a=e.headers["content-disposition"];let t=`${l.attendanceDate}_OP_Attendance(Internal).xlsx`;if(a){const e=a.match(/filename\*?=UTF-8''(.+)/i);if(e&&e[1])t=decodeURIComponent(e[1]);else{const e=a.match(/filename="(.+)"/i);e&&e[1]&&(t=e[1])}}const o=new Blob([e.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),n=window.URL.createObjectURL(o),r=document.createElement("a");r.href=n,r.setAttribute("download",t),document.body.appendChild(r),r.click(),document.body.removeChild(r),window.URL.revokeObjectURL(n)}}catch(e){console.error("æœˆå ±è¡¨åŒ¯å‡ºéŒ¯èª¤:",e),D.nk.error("ä¸‹è¼‰å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦ã€‚")}finally{p.value=!1}},_=async()=>{try{if(l.attendanceDate){m.value=!0;const e=await Wa.downloadExternalAttendanceMonthlyOP(l.attendanceDate),a=e.headers["content-disposition"];let t=`${l.attendanceDate}_OP_Attendance(External).xlsx`;if(a){const e=a.match(/filename\*?=UTF-8''(.+)/i);if(e&&e[1])t=decodeURIComponent(e[1]);else{const e=a.match(/filename="(.+)"/i);e&&e[1]&&(t=e[1])}}const o=new Blob([e.data],{type:e.headers["content-type"]}),n=document.createElement("a");n.href=URL.createObjectURL(o),n.download=t,document.body.appendChild(n),n.click(),URL.revokeObjectURL(n.href),document.body.removeChild(n)}else D.nk.warn("è«‹é¸æ“‡æ—¥æœŸ")}catch(e){console.error("æœˆå ±è¡¨åŒ¯å‡ºéŒ¯èª¤:",e),D.nk.error("ä¸‹è¼‰å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦ã€‚")}finally{m.value=!1}},w=async()=>{try{if(l.attendanceDate){v.value=!0;const e=await Wa.downloadCompanySalaryMonthlyOP(l.attendanceDate),a=e.headers["content-disposition"];let t=`${l.attendanceDate}_OP_Salary(Company).xlsx`;if(a){const e=a.match(/filename\*?=UTF-8''(.+)/i);if(e&&e[1])t=decodeURIComponent(e[1]);else{const e=a.match(/filename="(.+)"/i);e&&e[1]&&(t=e[1])}}const o=new Blob([e.data],{type:e.headers["content-type"]}),n=document.createElement("a");n.href=URL.createObjectURL(o),n.download=t,document.body.appendChild(n),n.click(),URL.revokeObjectURL(n.href),document.body.removeChild(n)}else D.nk.warn("è«‹é¸æ“‡æ—¥æœŸ")}catch(e){console.error("æœˆå ±è¡¨åŒ¯å‡ºéŒ¯èª¤:",e),D.nk.error("ä¸‹è¼‰å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦ã€‚")}finally{v.value=!1}},F=async()=>{try{if(l.attendanceDate){b.value=!0;const e=await Wa.downloadEmployeeSalaryMonthlyOP(l.attendanceDate);if("è©²æœˆä»½æ²’æœ‰è–ªè³‡è³‡æ–™"===e.data)return void D.nk.warn("è©²æœˆä»½æ²’æœ‰è–ªè³‡è³‡æ–™");const a=e.headers["content-disposition"];let t=`${l.attendanceDate}_OP_Salary(Employee).xlsx`;if(a){const e=a.match(/filename\*?=UTF-8''(.+)/i);if(e&&e[1])t=decodeURIComponent(e[1]);else{const e=a.match(/filename="(.+)"/i);e&&e[1]&&(t=e[1])}}const o=new Blob([e.data],{type:e.headers["content-type"]}),n=document.createElement("a");n.href=URL.createObjectURL(o),n.download=t,document.body.appendChild(n),n.click(),URL.revokeObjectURL(n.href),document.body.removeChild(n)}else D.nk.warn("è«‹é¸æ“‡æ—¥æœŸ")}catch(e){console.error("æœˆå ±è¡¨åŒ¯å‡ºéŒ¯èª¤:",e),D.nk.error("ä¸‹è¼‰å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦ã€‚")}finally{b.value=!1}};return(a,l)=>((0,u.uX)(),(0,u.Wv)((0,d.R1)(I.A),{visible:o.value,"onUpdate:visible":l[0]||(l[0]=e=>o.value=e),header:"å ±è¡¨ç›¸é—œåŠŸèƒ½",style:{width:"28rem",height:"18rem"}},{default:(0,u.k6)((()=>[(0,u.Lk)("div",jv,[(0,u.Lk)("div",Yv,[(0,u.bF)((0,d.R1)(Bt.S2),{disabled:null===e.selectedUser,color:"#4a57e3","loading-icon":"Eleme",loading:r.value,onClick:g,class:"report-button",style:{width:"11rem"}},{default:(0,u.k6)((()=>l[1]||(l[1]=[(0,u.eW)(" è€ƒå‹¤æœˆå ±è¡¨(å°å…§) ")]))),_:1},8,["disabled","loading"])]),(0,u.Lk)("div",Qv,[(0,u.bF)((0,d.R1)(Bt.S2),{disabled:null===e.selectedUser,color:"#4a57e3","loading-icon":"Eleme",loading:s.value,onClick:y,class:"report-button",style:{width:"11rem"}},{default:(0,u.k6)((()=>l[2]||(l[2]=[(0,u.eW)(" è€ƒå‹¤æœˆå ±è¡¨(å°å¤–) ")]))),_:1},8,["disabled","loading"])]),(0,u.Lk)("div",Hv,[(0,u.bF)((0,d.R1)(Bt.S2),{disabled:null===e.selectedUser,color:"#8a93f3","loading-icon":"Eleme",loading:i.value,onClick:f,class:"report-button",style:{width:"11rem"}},{default:(0,u.k6)((()=>l[3]||(l[3]=[(0,u.eW)(" è–ªè³‡å–®(å…¬å¸) ")]))),_:1},8,["disabled","loading"])]),(0,u.Lk)("div",qv,[(0,u.bF)((0,d.R1)(Bt.S2),{disabled:null===e.selectedUser,color:"#8a93f3","loading-icon":"Eleme",loading:c.value,onClick:h,class:"report-button",style:{width:"11rem"}},{default:(0,u.k6)((()=>l[4]||(l[4]=[(0,u.eW)(" è–ªè³‡å–®(å“¡å·¥) ")]))),_:1},8,["disabled","loading"])]),(0,u.Lk)("div",Jv,[(0,u.bF)((0,d.R1)(Bt.S2),{disabled:null===e.selectedUser,color:"#1bbf75","loading-icon":"Eleme",loading:p.value,onClick:k,class:"report-button-op",style:{width:"11rem"}},{default:(0,u.k6)((()=>l[5]||(l[5]=[(0,u.eW)(" (OP)è€ƒå‹¤æœˆå ±è¡¨(å°å…§) ")]))),_:1},8,["disabled","loading"])]),(0,u.Lk)("div",Gv,[(0,u.bF)((0,d.R1)(Bt.S2),{disabled:null===e.selectedUser,color:"#1bbf75","loading-icon":"Eleme",loading:m.value,onClick:_,class:"report-button-op",style:{width:"11rem"}},{default:(0,u.k6)((()=>l[6]||(l[6]=[(0,u.eW)(" (OP)è€ƒå‹¤æœˆå ±è¡¨(å°å¤–) ")]))),_:1},8,["disabled","loading"])]),(0,u.Lk)("div",Zv,[(0,u.bF)((0,d.R1)(Bt.S2),{disabled:null===e.selectedUser,color:"#70e1b9","loading-icon":"Eleme",loading:v.value,onClick:w,class:"report-button-op",style:{width:"11rem"}},{default:(0,u.k6)((()=>l[7]||(l[7]=[(0,u.eW)(" (OP)è–ªè³‡å–®(å…¬å¸) ")]))),_:1},8,["disabled","loading"])]),(0,u.Lk)("div",eb,[(0,u.bF)((0,d.R1)(Bt.S2),{disabled:null===e.selectedUser,color:"#70e1b9","loading-icon":"Eleme",loading:b.value,onClick:F,class:"report-button-op",style:{width:"11rem"}},{default:(0,u.k6)((()=>l[8]||(l[8]=[(0,u.eW)(" (OP)è–ªè³‡å–®(å“¡å·¥) ")]))),_:1},8,["disabled","loading"])])])])),_:1},8,["visible"]))}};const lb=(0,ie.A)(ab,[["__scopeId","data-v-fa51cfee"]]);var tb=lb;const ob={class:"parent",style:{"margin-left":"5rem","margin-top":"6rem"}},nb={class:"div1"},rb={class:"comlumn"},sb={class:"row-block"},ub={class:"div2"},ib={class:"div3"},db={style:{"margin-right":"-1rem","margin-top":"1.5rem"},class:"btn-group"},cb={class:"btn-0"},pb={class:"btn-report-dialog"},mb={key:0},vb=["onClick"],bb={key:1},gb=["onClick"],yb={key:2,style:{"text-align":"center",padding:"20px",color:"#999"}},fb={class:"dialog-footer"},hb={class:"salary-slip",style:{"padding-left":"0rem","margin-top":"1.5rem"}},kb={class:"big-parent"},_b={class:"left-parent"},wb={class:"right-parent"},Fb={style:{"margin-top":"1px"}};var Cb={__name:"SalarySlip",setup(e){const a=(0,T.d)(),l=(0,S.k)(),t=(0,d.KR)(null),o=(0,d.KR)(!1),n=(0,d.KR)(!1),r=(0,d.KR)({}),s=(0,d.KR)({}),i=(0,d.KR)({}),c=(0,d.KR)({}),p=(0,d.KR)(),m=(0,d.KR)(0),v=(0,d.KR)(0),b=(0,d.KR)(),g=(0,d.KR)(),y=(0,d.KR)(),f=(0,d.KR)(),h=(0,d.KR)(""),k=(0,d.KR)(""),_=(0,d.KR)(!1),w=(0,d.KR)(!1),F=(0,d.KR)([]),C=(0,d.KR)({}),R=(0,d.KR)(null),V=(0,d.KR)(!1),x=(0,d.KR)({blockAData:null,blockBData:null,blockDData:null,blockAnnualLeaveData:null,salaryHeadInfoRef:null,totalAValue:0,totalDValue:0,A_aggregate:null,B_aggregate:null,D_aggregate:null,AnnualLeaveData:null,publicContribution:null,insuranceCompany:null}),E=(0,d.KR)(!1),A=(0,d.KR)(!1),W=(0,d.KR)(null),U=((0,d.KR)(!1),(0,d.KR)({leaveDate:(new Date).toISOString().split("T")[0],leaveType:"fullDay",startTime:"09:00:00",endTime:"18:00:00"})),$={leaveDate:[{required:!0,message:"è«‹é¸æ“‡è«‹å‡æ—¥æœŸ",trigger:"change"}],startTime:[{required:!0,message:"è«‹é¸æ“‡é–‹å§‹æ™‚é–“",trigger:"change",validator:(e,a,l)=>{"timeRange"!==U.value.leaveType||a?l():l(new Error("è«‹é¸æ“‡é–‹å§‹æ™‚é–“"))}}],endTime:[{required:!0,message:"è«‹é¸æ“‡çµæŸæ™‚é–“",trigger:"change",validator:(e,a,l)=>{"timeRange"!==U.value.leaveType||a?"timeRange"===U.value.leaveType&&U.value.startTime&&a<=U.value.startTime?l(new Error("çµæŸæ™‚é–“å¿…é ˆæ™šæ–¼é–‹å§‹æ™‚é–“")):l():l(new Error("è«‹é¸æ“‡çµæŸæ™‚é–“"))}}]},N=async()=>{X(),o.value=!0},X=()=>{x.value={blockAData:JSON.parse(JSON.stringify(r.value||{})),blockBData:JSON.parse(JSON.stringify(s.value||{})),blockDData:JSON.parse(JSON.stringify(i.value||{})),blockAnnualLeaveData:JSON.parse(JSON.stringify(c.value||{})),salaryHeadInfoRef:JSON.parse(JSON.stringify(j.value||{})),totalAValue:m.value,totalDValue:v.value,A_aggregate:JSON.parse(JSON.stringify(b.value||{})),B_aggregate:JSON.parse(JSON.stringify(g.value||{})),D_aggregate:JSON.parse(JSON.stringify(y.value||{})),AnnualLeaveData:JSON.parse(JSON.stringify(p.value||{})),publicContribution:JSON.parse(JSON.stringify(f.value||{})),insuranceCompany:JSON.parse(JSON.stringify(Y.value||{}))}},K=()=>{x.value&&(r.value=JSON.parse(JSON.stringify(x.value.blockAData||{})),s.value=JSON.parse(JSON.stringify(x.value.blockBData||{})),i.value=JSON.parse(JSON.stringify(x.value.blockDData||{})),c.value=JSON.parse(JSON.stringify(x.value.blockAnnualLeaveData||{})),j.value=JSON.parse(JSON.stringify(x.value.salaryHeadInfoRef||{})),m.value=x.value.totalAValue,v.value=x.value.totalDValue,b.value=JSON.parse(JSON.stringify(x.value.A_aggregate||{})),g.value=JSON.parse(JSON.stringify(x.value.B_aggregate||{})),y.value=JSON.parse(JSON.stringify(x.value.D_aggregate||{})),p.value=JSON.parse(JSON.stringify(x.value.AnnualLeaveData||{})),f.value=JSON.parse(JSON.stringify(x.value.publicContribution||{})),Y.value=JSON.parse(JSON.stringify(x.value.insuranceCompany||{})))},M=async()=>{o.value=!1,await(0,u.dY)(),await re()},P=async()=>{K(),o.value=!1},O=async()=>{try{const a=await Wa.getSalaryStructureWithEmpId(t.value.emploY_ID);let l=a.data;if("no data"===l)return Y.value={},Q.value={},void(j.value={});if(a&&l){console.log("å¸¶å…¥è–ªè³‡çµæ§‹è³‡æ–™ API å›žæ‡‰:",l),console.log("responseData.salaryHeadInfo å­˜åœ¨:",!!l.salaryHeadInfo),console.log("responseData.salaryHeadInfo å…§å®¹:",l.salaryHeadInfo);let a={};try{a=JSON.parse(l.salaryHeadInfo),j.value=a,console.log("âœ… substituteStructureForIntoSalary æˆåŠŸè³¦å€¼ headInfo:",a),console.log("âœ… salaryHeadInfoRef.value æ›´æ–°å¾Œ:",j.value)}catch(e){console.error("è§£æž salaryHeadInfo å¤±æ•—ï¼š",e),console.error("åŽŸå§‹ salaryHeadInfo æ•¸æ“š:",l.salaryHeadInfo),a={},j.value={}}let t=[];try{t=JSON.parse(l.structure)}catch(e){console.error("è§£æž structure å¤±æ•—ï¼š",e),t=[]}const o=["pensionCompany","laborCompany","healthCompany"],n={},s={};t.forEach((e=>{o.includes(e.id)?n[e.id]=e:s[e.id]=e})),Y.value=n,Q.value=s,r.value&&Array.isArray(r.value.items)||(r.value={total_A:0,items:[{id:"basicSalary",ch_name:"åŸºæœ¬è–ªè³‡",time:"",amount:"0"},{id:"rankAllowance",ch_name:"è·ç­‰åŠ çµ¦",time:"",amount:"0"},{id:"positionAllowance",ch_name:"è·å‹™æ´¥è²¼",time:"",amount:"0"},{id:"mealAllowance",ch_name:"ä¼™é£Ÿæ´¥è²¼",time:"",amount:"0"},{id:"hourlyWagePartTime",ch_name:"æ™‚è–ª(å…¼è·äººå“¡)",time:"",amount:"0"}]}),r.value.items.forEach((e=>{const a=t.find((a=>a.id===e.id));a&&(e.amount=a.content)})),i.value&&Array.isArray(i.value.items)||(i.value={total_D:0,items:JSON.parse(JSON.stringify(Mm))});const u={laborInsurance:"laborPersonal",healthInsurance:"healthPersonal",healthFamily:"healthFamily"};return i.value.items.forEach((e=>{if(u[e.id]){const a=t.find((a=>a.id===u[e.id]));e.amount=a?a.content:""}})),i.value.items=[...i.value.items],alert("è–ªè³‡çµæ§‹è³‡æ–™å¸¶å…¥æˆåŠŸï¼"),"success"}}catch(a){return console.error("å¸¶å…¥è–ªè³‡çµæ§‹è³‡æ–™éŒ¯èª¤:",a),alert("å¸¶å…¥è–ªè³‡çµæ§‹è³‡æ–™ç™¼ç”ŸéŒ¯èª¤: "+a.message),"error"}},z=async(e,a)=>{const l=Bv.Ks.service({lock:!0,text:"è®€å–è–ªè³‡è³‡æ–™ä¸­ï¼Œè«‹ç¨å€™...",background:"rgba(0, 0, 0, 0.7)"});if(!a){const e=new Date;e.setMonth(e.getMonth());const l=e.getFullYear();let t=e.getMonth()+1;t=t<10?"0"+t:t,a=`${l}-${t}`}o.value=!1;const n={empName:e.name||"",empDpt:e.dpt_name||"",empTitleGrade:e.title_grade||"",insuranceLevel:"",empTitleName:e.title_name||"",empTitleLevel:e.title_level||""};j.value&&j.value.empName===e.name||(j.value=n),await B(e.emploY_ID,a),t.value=e,l.close()},B=async(e,a,l=!1)=>{if(e&&a)try{n.value=!0,l&&ne();const t=await sm.getSalaryData(e,a,l);await(0,u.dY)((()=>{if(console.log("æŽ¥æ”¶åˆ°çš„ salaryData.blockD:",JSON.stringify(t.blockD,null,2)),r.value=t.blockA,s.value=t.blockB,i.value=t.blockD,c.value=t.blockAnnualLeave,t.insuranceCompany&&(Y.value=t.insuranceCompany,console.log("âœ… ä¿éšªå…¬ä»˜æ•¸æ“šå·²æ›´æ–°:",Y.value)),oe(i.value),t.salaryHeadInfo&&Object.keys(t.salaryHeadInfo).length>0){const e=t.salaryHeadInfo.empName||t.salaryHeadInfo.empDpt||t.salaryHeadInfo.empTitleName||t.salaryHeadInfo.insuranceLevel;e&&(j.value={empName:t.salaryHeadInfo.empName||j.value.empName||"",empDpt:t.salaryHeadInfo.empDpt||j.value.empDpt||"",empTitleGrade:t.salaryHeadInfo.empTitleGrade||j.value.empTitleGrade||"",empTitleName:t.salaryHeadInfo.empTitleName||j.value.empTitleName||"",empTitleLevel:t.salaryHeadInfo.empTitleLevel||j.value.empTitleLevel||"",insuranceLevel:t.salaryHeadInfo.insuranceLevel||j.value.insuranceLevel||""})}F.value=t.leaveRecords,C.value=t.overtimeRecord})),t.isInitial?await Z(e,a):(await ee(e,a),await ae())}catch(t){ne()}finally{n.value=!1}},j=(0,d.KR)({}),Y=(0,d.KR)({}),Q=(0,d.KR)({}),H=(e,a="LR")=>{R.value={documentID:e,documentTypeID:a},V.value=!0},q=()=>{},J=async(e,a)=>{try{const[l,t]=a.split("-"),o=`${l}-${t}-01`,n=new Date(l,t,0).getDate(),r=`${l}-${t}-${n.toString().padStart(2,"0")}`,s={userId:e,page:1,pageSize:1e3,startDate:o,endDate:r},u=await Wa.getPersonalOvertimeRecords(s),i=u.data?.records||[];let d=0;const c=[];if(i.forEach((e=>{if(e.actualOvertimeDate){const a=new Date(e.actualOvertimeDate),l=a.getDay();if(0===l||6===l){const a=e.actualOvertimeHours||0,t=e.actualOvertimeMinutes||0,o=a+t/60;o>0&&(d+=o,c.push({date:e.actualOvertimeDate,actualHours:a,actualMinutes:t,totalHours:o,dayType:0===l?"é€±æ—¥":"é€±å…­"}))}}})),d>0){const e=G(d);le(e)}}catch(l){}},G=e=>{const a={hours_1_33:0,hours_1_67:0,hours_2_67:0};let l=e;return l>0&&(a.hours_1_33=Math.min(l,2),l-=a.hours_1_33),l>0&&(a.hours_1_67=Math.min(l,6),l-=a.hours_1_67),l>0&&(a.hours_2_67=l),a},Z=async(e,a)=>{try{await J(e,a),await ee(e,a),await ae()}catch(l){}},ee=async(e,a)=>{try{const[e,l]=a.split("-"),t=new Date(e,l-1,1),o=new Date(e,l,0),n=await Wa.getTyphoonLeaveRecords({startDate:t.toISOString().split("T")[0],endDate:o.toISOString().split("T")[0]}),r=n.data?.data||n.data||[];if(r.length>0){const e=r.reduce(((e,a)=>{const l=a.Hours||a.hours||0;return e+l}),0);if(i.value&&i.value.items){const a=i.value.items.find((e=>"typhoonLeave"===e.id||"é¢±é¢¨å‡"===e.ch_name));a&&(a.time=e,i.value={...i.value})}}}catch(l){}},ae=async()=>{console.log("=== autoFillLeaveRecords é–‹å§‹åŸ·è¡Œ ===");try{if(console.log("personalLeaveRecords.value:",F.value),console.log("blockAnnualLeaveData.value:",c.value),F.value&&F.value.length>0){console.log(`æ‰¾åˆ° ${F.value.length} ç­†è«‹å‡è¨˜éŒ„`);let e=!1;F.value.forEach((a=>{if(console.log("è™•ç†è«‹å‡è¨˜éŒ„:",a),console.log(`- leaveEnName: ${a.leaveEnName}`),console.log(`- leaveChName: ${a.leaveChName}`),console.log(`- yearlyTotalMinutes: ${a.yearlyTotalMinutes}`),"AnnualLeave"!==a.leaveEnName){if(i.value&&i.value.items){let e="";switch(a.leaveChName){case"äº‹å‡":return void console.log("âš ï¸ è·³éŽäº‹å‡è‡ªå‹•å¡«å…¥ï¼Œä½¿ç”¨å¾Œç«¯æä¾›çš„æ•¸æ“š");case"ç—…å‡":e="sickLeaveWithin30";break;case"å®¶åº­ç…§é¡§å‡":e="familyCareLeave";break;case"ç”Ÿç†å‡":e="menstrualLeave";break;case"å©šå‡":e="marriageLeave";break;case"å–ªå‡":e="bereavementLeave";break;case"å…¶ä»–å‡":e="otherLeave";break;default:return}const l=i.value.items.find((a=>a.id===e));if(l){const e=a.yearlyTotalMinutes||0,t=Math.floor(e/60),o=t;!isNaN(o)&&isFinite(o)?l.time=o:l.time=""}}}else if(e=!0,console.log("blockAnnualLeaveData.value å­˜åœ¨å—Ž?",!!c.value),console.log("blockAnnualLeaveData.value.items å­˜åœ¨å—Ž?",!(!c.value||!c.value.items)),c.value&&c.value.items){console.log("blockAnnualLeaveData.value.items:",c.value.items);const e=c.value.items.find((e=>"annualUsed"===e.id));if(console.log("æ‰¾åˆ°çš„ annualUsedItem:",e),e){console.log(`åŽŸå§‹ yearlyTotalMinutes: ${a.yearlyTotalMinutes}`),console.log("yearlyTotalMinutes é¡žåž‹: "+typeof a.yearlyTotalMinutes);const l=a.minutes||0,t=Math.floor(l/60);console.log(`è¨ˆç®—éŽç¨‹: ${l} åˆ†é˜ Ã· 60 = ${t} å°æ™‚`);const o=parseFloat(t);console.log(`æœ€çµ‚æ™‚æ•¸ (parseFloat): ${o}`),e.time=o,console.log(`âœ… æˆåŠŸå¡«å…¥å·²ä¼‘ç‰¹ä¼‘æ™‚æ•¸: ${o} å°æ™‚ (ä¾†æº: ${l} åˆ†é˜)`),console.log("æ›´æ–°å¾Œçš„ annualUsedItem:",e)}else console.log("âŒ æ‰¾ä¸åˆ° id ç‚º annualUsed çš„é …ç›®"),console.log("å¯ç”¨çš„ items:",c.value.items.map((e=>({id:e.id,ch_name:e.ch_name}))));c.value={...c.value},console.log("å·²è§¸ç™¼ blockAnnualLeaveData æ›´æ–°"),console.log("æ›´æ–°å¾Œçš„ blockAnnualLeaveData:",c.value)}else console.log("âŒ blockAnnualLeaveData æˆ–å…¶ items ä¸å­˜åœ¨"),console.log("blockAnnualLeaveData.value:",c.value)})),e?console.log("âœ… å·²è™•ç†ç‰¹ä¼‘è¨˜éŒ„"):console.log("æ‰€æœ‰è¨˜éŒ„çš„ leaveEnName å€¼:",F.value.map((e=>e.leaveEnName))),i.value={...i.value}}else console.log("âŒ æ²’æœ‰æ‰¾åˆ°è«‹å‡è¨˜éŒ„è³‡æ–™")}catch(e){}},le=e=>{if(s.value&&s.value.items){const a=s.value.items,l=a.find((e=>"overtime1_3"===e.id||"åŠ ç­åˆ†é˜æ•¸*4/3"===e.ch_name));l&&(l.time=e.hours_1_33.toFixed(2));const t=a.find((e=>"overtime2_3"===e.id||"åŠ ç­åˆ†é˜æ•¸*5/3"===e.ch_name));t&&(t.time=e.hours_1_67.toFixed(2));const o=a.find((e=>"overtime5_3"===e.id||"åŠ ç­åˆ†é˜æ•¸*6/3"===e.ch_name));o&&(o.time=e.hours_2_67.toFixed(2)),s.value={...s.value}}};(0,u.wB)((()=>[t.value?.emploY_ID,h.value]),(async([e,a],[l,t])=>{e&&a&&(e!==l||a!==t)&&await B(e,a)}),{immediate:!1,deep:!1});const te=async()=>{const e=t.value?.emploY_ID,a=h.value;e&&a&&(sm.clearCache(e,a),await B(e,a,!0))},oe=e=>{if(!e||!e.items||!Array.isArray(e.items))return;const a=[];if(e.items.forEach((e=>{if("-1"===e.amount||-1===e.amount){const l=e.ch_name||e.id||"æœªçŸ¥é …ç›®";a.push(l)}})),a.length>0){const e=`ä»¥ä¸‹é …ç›®è¨ˆç®—å¤±æ•—ï¼š${a.join("ã€")}ã€‚å¯èƒ½åŽŸå› ï¼šåŸºæœ¬è–ªè³‡ç‚ºé›¶æˆ–æ™‚æ•¸ç•°å¸¸ï¼Œè«‹æª¢æŸ¥è–ªè³‡çµæ§‹è¨­å®šæˆ–è¯ç¹«ç³»çµ±ç®¡ç†å“¡ã€‚`;console.error("âŒ ç™¼ç¾è¨ˆç®—éŒ¯èª¤:",e),(0,D.nk)({message:e,type:"error",duration:8e3,showClose:!0})}},ne=()=>{console.log("ðŸ—‘ï¸ æ¸…ç©ºè–ªè³‡æ•¸æ“š"),r.value={total_A:0,items:[]},s.value={total_B:0,items:[]},i.value={total_D:0,items:[]},c.value={items:[]},m.value=0,v.value=0,b.value={},g.value={},y.value={},p.value={},j.value={empName:"",empDpt:"",empTitleGrade:"",insuranceLevel:"",empTitleName:"",empTitleLevel:""},F.value=[],C.value={},console.log("âœ… è–ªè³‡æ•¸æ“šæ¸…ç©ºå®Œæˆ")};(0,u.hi)((()=>{sm.cancelAllRequests()}));const re=async()=>{const e=Date.now(),o=Bv.Ks.service({lock:!0,text:"æ­£åœ¨å„²å­˜è–ªè³‡å–®...",background:"rgba(0, 0, 0, 0.7)"});try{const e=j?.value||{},a=[];b?.value&&Object.keys(b.value).length>0&&a.push(b.value),g?.value&&Object.keys(g.value).length>0&&a.push(g.value),y?.value&&Object.keys(y.value).length>0?(a.push(y.value),console.log("âœ… åŒ…å« block_C è³‡æ–™:",y.value)):console.warn("âš ï¸ D_aggregate ç‚ºç©ºï¼Œæª¢æŸ¥ blockDData æ˜¯å¦æ­£ç¢ºå‚³éž"),p?.value&&Object.keys(p.value).length>0&&a.push(p.value);const o={isInitial:!1};a.push(o);const n={id:"",emp_id:t.value.emploY_ID,date:h.value,salaryHeadInfo:JSON.stringify(e),block:JSON.stringify(a),Create_At:(new Date).toISOString(),Create_By:"system",Update_Time:null,Update_By:null};let r=l.userId;await Wa.postSalarySlip(r,n),console.log("ðŸ’¾ è–ªè³‡å–®å„²å­˜æˆåŠŸï¼Œé‡æ–°è¼‰å…¥æ•¸æ“šä»¥ç¢ºä¿è³‡æ–™å®Œæ•´æ€§");const s=t.value?.emploY_ID,u=h.value;s&&u&&(sm.clearCache(s,u),await B(s,u,!0))}catch(n){console.error("å„²å­˜è–ªè³‡å–®å¤±æ•—ï¼š",n);const e=t.value?.emploY_ID,a=h.value;e&&a&&(console.log("âš ï¸ å„²å­˜å¤±æ•—ï¼Œé‡æ–°è¼‰å…¥æ•¸æ“šä»¥æ¢å¾©æ­£ç¢ºç‹€æ…‹"),await B(e,a,!0))}finally{const l=Date.now()-e,t=0;l<t&&await new Promise((e=>setTimeout(e,t-l))),o.close(),a.add({severity:"success",summary:"Success",detail:"è–ªè³‡è³‡æ–™å„²å­˜æˆåŠŸ!",life:3e3})}},se=e=>{m.value=e},ue=e=>{b.value=e},ie=e=>{y.value=e},de=e=>{g.value=e},ce=e=>{v.value=e},pe=e=>{f.value=e},me=e=>{h.value=e,z(t.value,h.value)},ve=e=>{k.value=e},be=e=>{p.value=e},ge=e=>{j.value={...e}},ye=()=>{E.value=!1,U.value={leaveDate:(new Date).toISOString().split("T")[0],leaveType:"fullDay",startTime:"09:00:00",endTime:"18:00:00"},W.value&&W.value.resetFields()},fe=async()=>{if(W.value)try{await W.value.validate();const e={leaveDate:U.value.leaveDate,createdBy:t.value.emploY_ID};"timeRange"===U.value.leaveType?(e.startTime=U.value.startTime,e.endTime=U.value.endTime):(e.startTime="08:30:00",e.endTime="17:30:00"),await Sa.s.confirm(`ç¢ºå®šè¦è¨­å®š ${U.value.leaveDate} çš„é¢±é¢¨å‡å—Žï¼Ÿ\né¡žåž‹ï¼š${"fullDay"===U.value.leaveType?"æ•´æ—¥":"æ™‚é–“æ®µ"}\n`+("timeRange"===U.value.leaveType?`æ™‚é–“ï¼š${U.value.startTime.substring(0,5)} - ${U.value.endTime.substring(0,5)}`:"æ™‚é–“ï¼š08:30 - 17:30ï¼ˆæ¨™æº–å·¥æ™‚8å°æ™‚ï¼‰"),"ç¢ºèªè¨­å®šé¢±é¢¨å‡",{confirmButtonText:"ç¢ºå®š",cancelButtonText:"å–æ¶ˆ",type:"warning"}),A.value=!0;const a=await Wa.createTyphoonLeaveRecord(e);a.data.success?(D.nk.success("é¢±é¢¨å‡è¨­å®šæˆåŠŸï¼"),ye(),t.value&&await z(t.value,h.value)):D.nk.error(a.data.message||"é¢±é¢¨å‡è¨­å®šå¤±æ•—")}catch(e){"cancel"!==e&&(console.error("è¨­å®šé¢±é¢¨å‡éŒ¯èª¤:",e),D.nk.error("è¨­å®šé¢±é¢¨å‡æ™‚ç™¼ç”ŸéŒ¯èª¤"))}finally{A.value=!1}};return(e,a)=>{const l=(0,u.g2)("el-button"),p=(0,u.g2)("el-table-column"),b=(0,u.g2)("el-table"),g=(0,u.g2)("el-date-picker"),y=(0,u.g2)("el-form-item"),f=(0,u.g2)("el-radio"),D=(0,u.g2)("el-radio-group"),x=(0,u.g2)("el-time-picker"),T=(0,u.g2)("el-form"),S=(0,u.g2)("el-dialog");return(0,u.uX)(),(0,u.CE)("div",ob,[(0,u.Lk)("div",nb,[(0,u.bF)(zv,{editMode:o.value,onRowSelected:z},null,8,["editMode"])]),(0,u.Lk)("div",rb,[(0,u.Lk)("div",sb,[(0,u.Lk)("div",ub,[(0,u.bF)($n,{editMode:o.value,onLateTotal:ve,onAttendanceDate:me,selectedUser:t.value},null,8,["editMode","selectedUser"])]),(0,u.Lk)("div",ib,[(0,u.Lk)("div",db,[(0,u.Lk)("div",cb,[!1===o.value?((0,u.uX)(),(0,u.Wv)(l,{key:0,disabled:!t.value,type:"primary",onClick:N},{default:(0,u.k6)((()=>a[11]||(a[11]=[(0,u.eW)((0,L.v_)("ç·¨è¼¯"))]))),_:1},8,["disabled"])):((0,u.uX)(),(0,u.Wv)(l,{key:1,type:"success",onClick:M},{default:(0,u.k6)((()=>a[12]||(a[12]=[(0,u.eW)((0,L.v_)("å®Œæˆ"))]))),_:1})),(0,u.Q3)("",!0),(0,u.bF)(l,{type:"info",onClick:te,loading:n.value,disabled:!t.value,style:{"margin-left":"10px"}},{default:(0,u.k6)((()=>a[14]||(a[14]=[(0,u.eW)(" åˆ·æ–°æ•¸æ“š ")]))),_:1},8,["loading","disabled"]),!0===o.value?((0,u.uX)(),(0,u.Wv)(l,{key:3,disabled:!t.value&&!o.value,type:"info",plain:"",onClick:P},{default:(0,u.k6)((()=>a[15]||(a[15]=[(0,u.eW)((0,L.v_)("å–æ¶ˆ"))]))),_:1},8,["disabled"])):(0,u.Q3)("",!0),(0,u.bF)(l,{disabled:!t.value||!o.value,type:"success",onClick:O},{default:(0,u.k6)((()=>a[16]||(a[16]=[(0,u.eW)((0,L.v_)("å¸¶å…¥è–ªè³‡çµæ§‹è³‡æ–™"))]))),_:1},8,["disabled"]),(0,u.bF)(l,{disabled:!t.value,type:"success",onClick:a[0]||(a[0]=e=>w.value=!0)},{default:(0,u.k6)((()=>a[17]||(a[17]=[(0,u.eW)((0,L.v_)(" å€‹ äºº å‡ åˆ¥ æŸ¥ è©¢ "))]))),_:1},8,["disabled"])]),(0,u.Lk)("div",pb,[(0,u.bF)(l,{type:"primary",onClick:a[1]||(a[1]=e=>_.value=!0)},{default:(0,u.k6)((()=>a[18]||(a[18]=[(0,u.eW)(" å ±è¡¨ç›¸é—œåŠŸèƒ½ ")]))),_:1}),(0,u.bF)(l,{type:"primary",onClick:a[2]||(a[2]=e=>E.value=!0),disabled:!t.value,style:{"background-color":"#5CADAD","border-color":"#5CADAD","margin-left":"8px"}},{default:(0,u.k6)((()=>a[19]||(a[19]=[(0,u.eW)(" è¨­å®šé¢±é¢¨å‡ ")]))),_:1},8,["disabled"])]),(0,u.bF)((0,d.R1)(tb),{showReportDialog:_.value,"onUpdate:showReportDialog":a[3]||(a[3]=e=>_.value=e),selectedUser:t.value,attendanceDate:h.value},null,8,["showReportDialog","selectedUser","attendanceDate"]),(0,u.bF)((0,d.R1)(I.A),{visible:w.value,"onUpdate:visible":a[4]||(a[4]=e=>w.value=e),header:h.value+" å€‹äººå‡åˆ¥æŸ¥è©¢",style:{width:"50rem"}},{default:(0,u.k6)((()=>[F.value.length>0?((0,u.uX)(),(0,u.CE)("div",mb,[a[20]||(a[20]=(0,u.Lk)("h4",{style:{"margin-bottom":"10px"}},"è«‹å‡è¨˜éŒ„",-1)),(0,u.bF)(b,{data:F.value,style:{width:"100%","margin-bottom":"20px"},border:""},{default:(0,u.k6)((()=>[(0,u.bF)(p,{prop:"leaveChName",label:"å‡åˆ¥åç¨±",width:"120"}),(0,u.bF)(p,{label:"æ™‚æ•¸",width:"80"},{default:(0,u.k6)((({row:e})=>[(0,u.eW)((0,L.v_)(e.hours)+" å°æ™‚ ",1)])),_:1}),(0,u.bF)(p,{label:"åˆ†é˜æ•¸",width:"100"},{default:(0,u.k6)((({row:e})=>[(0,u.eW)((0,L.v_)(e.minutes)+" åˆ†é˜ ",1)])),_:1}),(0,u.Q3)("",!0),(0,u.Q3)("",!0),(0,u.Q3)("",!0),(0,u.bF)(p,{label:"å¹´åº¦ç¸½æ™‚æ•¸",width:"120"},{default:(0,u.k6)((({row:e})=>[(0,u.eW)((0,L.v_)(e.yearlyTotalHours)+" å°æ™‚ ",1)])),_:1}),(0,u.bF)(p,{label:"å–®æ“šç·¨è™Ÿ",width:"180"},{default:(0,u.k6)((({row:e})=>[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(e.leaveRequestFormID,(e=>((0,u.uX)(),(0,u.CE)("div",{key:e,onClick:a=>H(e,"LR"),style:{cursor:"pointer","text-decoration":"underline",color:"blue"}},(0,L.v_)(e),9,vb)))),128))])),_:1})])),_:1},8,["data"])])):(0,u.Q3)("",!0),C.value&&C.value.count>0?((0,u.uX)(),(0,u.CE)("div",bb,[a[21]||(a[21]=(0,u.Lk)("h4",{style:{"margin-bottom":"10px"}},"åŠ ç­è¨˜éŒ„",-1)),(0,u.bF)(b,{data:[C.value],style:{width:"100%"},border:""},{default:(0,u.k6)((()=>[(0,u.bF)(p,{label:"åŠ ç­æ™‚æ•¸",width:"100"},{default:(0,u.k6)((({row:e})=>[(0,u.eW)((0,L.v_)(e.hours)+" å°æ™‚ ",1)])),_:1}),(0,u.bF)(p,{label:"åŠ ç­åˆ†é˜æ•¸",width:"120"},{default:(0,u.k6)((({row:e})=>[(0,u.eW)((0,L.v_)(e.minutes)+" åˆ†é˜ ",1)])),_:1}),(0,u.bF)(p,{label:"é¤è²»è£œåŠ©",width:"100"},{default:(0,u.k6)((({row:e})=>[(0,u.eW)((0,L.v_)(e.mealAllowance)+" å…ƒ ",1)])),_:1}),(0,u.bF)(p,{label:"åŠ ç­æ¬¡æ•¸",width:"100"},{default:(0,u.k6)((({row:e})=>[(0,u.eW)((0,L.v_)(e.count)+" æ¬¡ ",1)])),_:1}),(0,u.bF)(p,{label:"å¹´åº¦ç¸½æ™‚æ•¸",width:"120"},{default:(0,u.k6)((({row:e})=>[(0,u.eW)((0,L.v_)(Math.floor(e.yearlyTotalMinutes/60))+" å°æ™‚ ",1)])),_:1}),(0,u.bF)(p,{label:"å–®æ“šç·¨è™Ÿ",width:"180"},{default:(0,u.k6)((({row:e})=>[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(e.overtimeRequestFormID,(e=>((0,u.uX)(),(0,u.CE)("div",{key:e,onClick:a=>H(e,"OR"),style:{cursor:"pointer","text-decoration":"underline",color:"green"}},(0,L.v_)(e),9,gb)))),128))])),_:1})])),_:1},8,["data"])])):(0,u.Q3)("",!0),0!==F.value.length||C.value&&0!==C.value.count?(0,u.Q3)("",!0):((0,u.uX)(),(0,u.CE)("div",yb," æœ¬æœˆç„¡è«‹å‡æˆ–åŠ ç­è¨˜éŒ„ "))])),_:1},8,["visible","header"]),(0,u.bF)(S,{modelValue:E.value,"onUpdate:modelValue":a[9]||(a[9]=e=>E.value=e),title:"è¨­å®šé¢±é¢¨å‡",width:"500px","before-close":ye},{footer:(0,u.k6)((()=>[(0,u.Lk)("span",fb,[(0,u.bF)(l,{onClick:ye},{default:(0,u.k6)((()=>a[24]||(a[24]=[(0,u.eW)("å–æ¶ˆ")]))),_:1}),(0,u.bF)(l,{type:"primary",onClick:fe,loading:A.value,style:{"background-color":"#5CADAD","border-color":"#5CADAD"}},{default:(0,u.k6)((()=>a[25]||(a[25]=[(0,u.eW)(" ç¢ºèªè¨­å®š ")]))),_:1},8,["loading"])])])),default:(0,u.k6)((()=>[(0,u.bF)(T,{model:U.value,rules:$,ref_key:"typhoonLeaveFormRef",ref:W,"label-width":"100px"},{default:(0,u.k6)((()=>[(0,u.bF)(y,{label:"è«‹å‡æ—¥æœŸ",prop:"leaveDate"},{default:(0,u.k6)((()=>[(0,u.bF)(g,{modelValue:U.value.leaveDate,"onUpdate:modelValue":a[5]||(a[5]=e=>U.value.leaveDate=e),type:"date",placeholder:"é¸æ“‡è«‹å‡æ—¥æœŸ",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",style:{width:"100%"}},null,8,["modelValue"])])),_:1}),(0,u.bF)(y,{label:"è«‹å‡é¡žåž‹"},{default:(0,u.k6)((()=>[(0,u.bF)(D,{modelValue:U.value.leaveType,"onUpdate:modelValue":a[6]||(a[6]=e=>U.value.leaveType=e)},{default:(0,u.k6)((()=>[(0,u.bF)(f,{label:"fullDay"},{default:(0,u.k6)((()=>a[22]||(a[22]=[(0,u.eW)("æ•´æ—¥")]))),_:1}),(0,u.bF)(f,{label:"timeRange"},{default:(0,u.k6)((()=>a[23]||(a[23]=[(0,u.eW)("æ™‚é–“æ®µ")]))),_:1})])),_:1},8,["modelValue"])])),_:1}),"timeRange"===U.value.leaveType?((0,u.uX)(),(0,u.CE)(u.FK,{key:0},[(0,u.bF)(y,{label:"é–‹å§‹æ™‚é–“",prop:"startTime"},{default:(0,u.k6)((()=>[(0,u.bF)(x,{modelValue:U.value.startTime,"onUpdate:modelValue":a[7]||(a[7]=e=>U.value.startTime=e),placeholder:"é¸æ“‡é–‹å§‹æ™‚é–“",format:"HH:mm","value-format":"HH:mm:ss",style:{width:"100%"}},null,8,["modelValue"])])),_:1}),(0,u.bF)(y,{label:"çµæŸæ™‚é–“",prop:"endTime"},{default:(0,u.k6)((()=>[(0,u.bF)(x,{modelValue:U.value.endTime,"onUpdate:modelValue":a[8]||(a[8]=e=>U.value.endTime=e),placeholder:"é¸æ“‡çµæŸæ™‚é–“",format:"HH:mm","value-format":"HH:mm:ss",style:{width:"100%"}},null,8,["modelValue"])])),_:1})],64)):(0,u.Q3)("",!0)])),_:1},8,["model"])])),_:1},8,["modelValue"]),V.value?((0,u.uX)(),(0,u.Wv)(en,{key:0,visible:V.value,"onUpdate:visible":a[10]||(a[10]=e=>V.value=e),doc:R.value,buttonGroupPosition:"dialog",onRefreshList:q},null,8,["visible","doc"])):(0,u.Q3)("",!0)]),(0,u.Lk)("div",hb,[(0,u.Lk)("div",null,[(0,u.bF)(Xv,{salaryHeadInfoRef:j.value,editMode:o.value,selectedUser:t.value,"onUpdate:salaryHeadInfoRef":ge},null,8,["salaryHeadInfoRef","editMode","selectedUser"])]),(0,u.Lk)("div",kb,[(0,u.Lk)("div",_b,[(0,u.bF)(cm,{data:r.value,onUpdateSalaryATotal:se,onUpdateBlockAAggregate:ue},null,8,["data"]),(0,u.bF)(Km,{editMode:o.value,data:s.value,totalA:m.value,totalD:v.value,onUpdateSalaryB_Aggregate:de},null,8,["editMode","data","totalA","totalD"])]),(0,u.Lk)("div",wb,[(0,u.bF)(bv,{style:{"margin-left":"-0.1px","margin-top":"0.1px"},lateTotal:k.value,editMode:o.value,data:i.value,totalA:m.value,onUpdateDeductionD:ce,onUpdateSalaryDAggregate:ie},null,8,["lateTotal","editMode","data","totalA"]),(0,u.bF)(fv,{style:{"margin-left":"0.2px"},editMode:o.value,data:c.value,onUpdateAnnualLeaveData:be},null,8,["editMode","data"])])]),(0,u.Lk)("div",Fb,[(0,u.bF)(_v,{insuranceCompany:Y.value,editMode:o.value,onUpdateInsuranceValues:pe},null,8,["insuranceCompany","editMode"])])])])])])])}}};const Db=(0,ie.A)(Cb,[["__scopeId","data-v-1313d881"]]);var Lb=Db;const Rb={style:{"margin-left":"7rem","margin-top":"5rem"}},Vb={class:"gap-container"},Ib={class:"div1"},xb={key:0},Eb={style:{display:"flex","justify-content":"space-between"}},Ab={style:{"font-size":"13px"}},Tb={key:1},Wb={class:"div2"},Sb={key:0},Ub={style:{display:"flex","justify-content":"space-between"}},$b={style:{color:"var(--el-text-color-secondary)","font-size":"13px"}},Nb={style:{"margin-right":"8px"}},Xb={style:{display:"flex","justify-content":"space-between"}},Kb={style:{color:"var(--el-text-color-secondary)","font-size":"13px"}},Mb={style:{"margin-right":"8px"}},Pb={style:{display:"flex","justify-content":"space-between"}},Ob={style:{color:"var(--el-text-color-secondary)","font-size":"13px"}},zb={style:{"margin-right":"8px"}},Bb={style:{display:"flex","justify-content":"space-between"}},jb={style:{color:"var(--el-text-color-secondary)","font-size":"13px"}},Yb={style:{"margin-right":"8px"}},Qb={style:{display:"flex","justify-content":"space-between"}},Hb={style:{color:"var(--el-text-color-secondary)","font-size":"13px"}},qb={style:{"margin-right":"8px"}},Jb={style:{display:"flex","justify-content":"space-between"}},Gb={style:{color:"var(--el-text-color-secondary)","font-size":"13px"}},Zb={style:{"margin-right":"8px"}},eg={key:1},ag={class:"div3"},lg={key:0},tg={key:1},og={key:0},ng={key:1};var rg={__name:"SalaryStructure",setup(e){const a=(0,i.n)(),l=(0,S.k)(),t=(0,d.KR)(!1),o=(0,_.Jud)(),n=(0,d.KR)(null),r=(0,d.KR)([]),s=(0,d.KR)([]),c=(0,d.KR)([{category:"å§“å",id:"empName",content:""},{category:"éƒ¨é–€",id:"empDpt",content:""},{category:"è·ç¨±",id:"empTitleName",content:""},{category:"è·ç­‰",id:"empTitleGrade",content:""},{category:"è·ç´š",id:"empTitleLevel",content:""},{category:"å‹žå¥ä¿ç´šè·ï¼š",id:"insuranceLevel",content:""}]),p=(0,d.KR)([{category:"",content:""},{category:"",content:""},{category:"",content:""},{category:"",content:""},{category:"",content:""},{category:"",content:""}]),m=(0,d.KR)([{category:"åŸºæœ¬è–ªè³‡",id:"basicSalary",content:""},{category:"è·ç­‰åŠ çµ¦",id:"rankAllowance",content:""},{category:"è·å‹™æ´¥è²¼",id:"positionAllowance",content:""},{category:"ä¼™é£Ÿæ´¥è²¼",id:"mealAllowance",content:""},{category:"æ™‚è–ª(å…¼è·äººå“¡)",id:"hourlyWagePartTime",content:""},{category:"å‹žä¿è²»",id:"laborPersonal",content:"",insurance:{laborPersonal:""}},{category:"å¥ä¿è²»",id:"healthPersonal",content:"",insurance:{healthPersonal:""}},{category:"å®¶å±¬å¥ä¿è²»",id:"healthFamily",content:"",insurance:{healthFamily:""}},{category:"å‹žé€€å…¬ä»˜",id:"pensionCompany",content:"",insurance:{pensionCompany:""}},{category:"å‹žä¿å…¬ä»˜",id:"laborCompany",content:0,insurance:{laborCompany:0},originalLaborCompany:0},{category:"å¥ä¿å…¬ä»˜",id:"healthCompany",content:"",insurance:{healthCompany:""}}]),v=async e=>{await C(e.emploY_ID),n.value=e};function b(){return{height:"40.3px"}}function g(e,a){"å‹žä¿å…¬ä»˜"===e.category?(e.content=a,e.insurance.laborCompany=a):"å¥ä¿å…¬ä»˜"===e.category?(e.content=a,e.insurance.healthCompany=a):"å‹žé€€å…¬ä»˜"===e.category?(e.content=a,e.insurance.pensionCompany=a):"å‹žä¿è²»"===e.category?(e.content=a,e.insurance.laborPersonal=a):"å¥ä¿è²»"===e.category?(e.content=a,e.insurance.healthPersonal=a):"å®¶å±¬å¥ä¿è²»"===e.category&&(e.content=a,e.insurance.healthFamily=a)}const y=(0,u.EW)((()=>{const e={};return r.value.forEach((a=>{e[a.laborCompany]=(e[a.laborCompany]||0)+1})),e})),f=(0,u.EW)((()=>{const e={};return r.value.map((a=>{const l={id:a.id,insuranceLevel:a.insuranceLevel,laborLevel:a.insuranceLevel,healthLevel:a.insuranceLevel};return y.value[a.laborCompany]>1&&(a.laborCompany in e||(e[a.laborCompany]=a.insuranceLevel),l.laborLevel=e[a.laborCompany],l.healthLevel=a.insuranceLevel),l.combinedLevel=`${l.laborLevel} / ${l.healthLevel}`,l}))}));function h(e){const a=JSON.parse(e.salaryHeadInfo);c.value.forEach((e=>{e.content=a[e.id]??""}));const l=JSON.parse(e.structure);m.value.forEach((e=>{const a=l.find((a=>a.id===e.id));e.content=a&&parseFloat(a.content)||0,"å‹žé€€å…¬ä»˜"===e.category?e.insurance.pensionCompany=e.content:"å‹žä¿å…¬ä»˜"===e.category?e.insurance.laborCompany=e.content:"å¥ä¿å…¬ä»˜"===e.category?e.insurance.healthCompany=e.content:"å‹žä¿è²»"===e.category?e.insurance.laborPersonal=e.content:"å¥ä¿è²»"===e.category?e.insurance.healthPersonal=e.content:"å®¶å±¬å¥ä¿è²»"===e.category&&(e.insurance.healthFamily=e.content)}));const t=c.value.find((e=>"å‹žå¥ä¿ç´šè·ï¼š"===e.category)),o=m.value.find((e=>"å‹žä¿å…¬ä»˜"===e.category));if(t&&o&&s.value.length>0){o.originalLaborCompany=parseFloat(o.content)||0;const e=t.content.split("/"),a=parseFloat(e[1]?.trim()),l=s.value[0].dae,r=s.value[0].op;if(!isNaN(a)&&!isNaN(l)){let e=l;n.value&&n.value.emploY_ID&&n.value.emploY_ID.startsWith("OP")&&(e=r);const t=a*e,s=o.originalLaborCompany,u=t+s;o.content=u.toFixed(2),o.insurance.laborCompany=u.toFixed(2)}}}const k=Date.now(),w=async()=>{await Wa.encryptSalaryStructure()},F=async e=>{let a=await Wa.getSalaryStructureWithEmpId(e);"no data"===a.data?(c.value.forEach((e=>{"empName"!==e.id&&(e.content="")})),m.value.forEach((e=>{e.content="",e.insurance&&(e.insurance={pensionCompany:"",laborCompany:"",healthCompany:"",laborPersonal:"",healthPersonal:"",healthFamily:""})}))):h(a.data)},C=async e=>{o.loading.show({spinner:_.hV_,message:"è–ªè³‡çµæ§‹è³‡æ–™è®€å–ä¸­..."});try{m.value.forEach((e=>{e.insurance&&(e.insurance={pensionCompany:"",laborCompany:"",healthCompany:"",laborPersonal:"",healthPersonal:"",healthFamily:""})})),F(e)}catch(a){console.error("è§£æžè–ªè³‡å–®è³‡æ–™å¤±æ•—ï¼š",a),c.value.forEach((e=>{e.content=""})),m.value.forEach((e=>{e.content="",e.insurance&&(e.insurance={pensionCompany:"",laborCompany:"",healthCompany:"",laborPersonal:"",healthPersonal:"",healthFamily:""})}))}finally{const e=Date.now()-k,a=300-e;a>0&&await new Promise((e=>setTimeout(e,a))),o.loading.hide()}},R=async()=>{t.value=!1},V=async()=>{t.value=!0},I=(0,d.KR)(!1),x=async()=>{if(I.value){o.loading.show({spinner:_.hV_,message:"æ­£åœ¨ä¿å­˜å‹žä¿å…¬ä»˜çµ¦ä»˜%æ•¸..."});try{let e=l.userId;const a={...s.value[0],dae:parseFloat(s.value[0].dae),op:parseFloat(s.value[0].op)};await Wa.putCompanyLaborRate(e,a),(0,D.nk)({type:"success",message:"å‹žä¿å…¬ä»˜çµ¦ä»˜%æ•¸æ›´æ–°æˆåŠŸï¼",duration:800})}catch(e){console.error("æ›´æ–°å‹žä¿å…¬ä»˜çµ¦ä»˜%æ•¸å¤±æ•—ï¼š",e),(0,D.nk)({type:"error",message:"å‹žä¿å…¬ä»˜çµ¦ä»˜%æ•¸æ›´æ–°å¤±æ•—ï¼",duration:800})}finally{o.loading.hide(),I.value=!1}}else I.value=!0},E=async()=>{t.value=!1,await(0,u.dY)(),await A()},A=async()=>{o.loading.show({spinner:_.hV_,message:"æ­£åœ¨ä¿å­˜è³‡æ–™..."});try{const e={};c.value.forEach((a=>{e[a.id]=a.content}));const a=JSON.stringify(e),t=m.value.map((e=>{if("laborCompany"===e.id){const a=e.originalLaborCompany,l=parseFloat(e.content);return{id:e.id,ch_name:e.category,content:a,calculatedLaborCompany:l}}return{id:e.id,ch_name:e.category,content:e.content}})).concat(c.value.map((e=>({id:e.id,ch_name:e.category,content:e.content})))),o={Id:"",emp_id:n.value?.emploY_ID||"",structure:JSON.stringify(t),Create_At:new Date,Create_By:l.userId,Update_Time:null,Update_By:null,salaryHeadInfo:a},r=l.userId;await Wa.postSalaryStructures(r,o),F(o.emp_id),(0,D.nk)({type:"success",message:"ä¿å­˜å®Œæˆï¼",duration:800})}catch(e){console.error("ä¿å­˜è³‡æ–™å¤±æ•—ï¼š",e)}finally{o.loading.hide()}};return(0,u.sV)((async()=>{o.loading.show({spinner:_.hV_,message:"è¼‰å…¥ä¿éšªè²»çŽ‡è³‡æ–™..."});try{const e=await Lv.GetAllInsuranceRates();r.value=e.data;const a=await Wa.getCompanyLaborRate();a.data&&Array.isArray(a.data)?s.value=a.data:s.value=[]}catch(e){s.value=[]}finally{const e=Date.now()-k,a=300-e;a>0&&await new Promise((e=>setTimeout(e,a))),o.loading.hide()}})),(0,u.wB)(n,(e=>{if(e){const a=c.value.find((e=>"empName"===e.id));a&&(a.content=e.namE_FIRST||"")}}),{immediate:!0}),(e,l)=>{const o=(0,u.g2)("el-button"),i=(0,u.g2)("el-table-column"),y=(0,u.g2)("el-option"),h=(0,u.g2)("el-select"),k=(0,u.g2)("el-input"),_=(0,u.g2)("el-table");return(0,u.uX)(),(0,u.CE)("div",Rb,[!1===t.value?((0,u.uX)(),(0,u.Wv)(o,{key:0,disabled:!n.value,type:"primary",onClick:V},{default:(0,u.k6)((()=>l[0]||(l[0]=[(0,u.eW)((0,L.v_)("ç·¨è¼¯"))]))),_:1},8,["disabled"])):((0,u.uX)(),(0,u.Wv)(o,{key:1,type:"success",onClick:E},{default:(0,u.k6)((()=>l[1]||(l[1]=[(0,u.eW)((0,L.v_)("å®Œæˆ"))]))),_:1})),(0,u.bF)(o,{disabled:!n.value&&!t.value,type:"info",plain:"",onClick:R},{default:(0,u.k6)((()=>l[2]||(l[2]=[(0,u.eW)((0,L.v_)("å–æ¶ˆ"))]))),_:1},8,["disabled"]),(0,u.Lk)("div",null,[(0,u.bF)(zv,{editMode:t.value,onRowSelected:v,style:{"margin-top":"1rem","max-width":"85rem"}},null,8,["editMode"])]),(0,d.R1)(a).user.permissions.includes("dev")?((0,u.uX)(),(0,u.Wv)(o,{key:2,onClick:w},{default:(0,u.k6)((()=>l[3]||(l[3]=[(0,u.eW)((0,L.v_)("è½‰æ›å¯†æ–‡"))]))),_:1})):(0,u.Q3)("",!0),(0,u.Lk)("div",Vb,[(0,u.Lk)("div",Ib,[(0,u.bF)(_,{"empty-text":"","show-header":!1,class:"grid-lines",data:c.value,border:"",style:{width:"400px"}},{default:(0,u.k6)((()=>[(0,u.bF)(i,{label:"æ¬„ä½",width:"180"},{default:(0,u.k6)((({row:e})=>[(0,u.eW)((0,L.v_)(e.category),1)])),_:1}),(0,u.bF)(i,{label:"è³‡æ–™",width:"220"},{default:(0,u.k6)((({row:e})=>[t.value&&"empName"!==e.id?((0,u.uX)(),(0,u.CE)("div",xb,["éƒ¨é–€"===e.category?((0,u.uX)(),(0,u.Wv)(Gn,{key:0,modelValue:e.content,"onUpdate:modelValue":a=>e.content=a,size:"small"},null,8,["modelValue","onUpdate:modelValue"])):"è·ç¨±"===e.category?((0,u.uX)(),(0,u.Wv)(su,{key:1,modelValue:e.content,"onUpdate:modelValue":a=>e.content=a,size:"small"},null,8,["modelValue","onUpdate:modelValue"])):"å‹žå¥ä¿ç´šè·ï¼š"===e.category?((0,u.uX)(),(0,u.Wv)(h,{key:2,modelValue:e.content,"onUpdate:modelValue":a=>e.content=a,placeholder:"è«‹é¸æ“‡",style:{width:"12rem"},"allow-create":"",size:"small",filterable:"",onChange:a=>g(e,a)},{default:(0,u.k6)((()=>[(0,u.bF)(y,{disabled:"",value:""},{default:(0,u.k6)((()=>l[4]||(l[4]=[(0,u.Lk)("div",{style:{display:"flex","justify-content":"center","font-weight":"bold",padding:"4px 8px","border-bottom":"1px solid #ebeef5"}},[(0,u.Lk)("span",null,"å‹žä¿/å¥ä¿ç´šè·")],-1)]))),_:1}),((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(f.value,(e=>((0,u.uX)(),(0,u.Wv)(y,{key:e.id,label:e.combinedLevel,value:e.combinedLevel},{default:(0,u.k6)((()=>[(0,u.Lk)("div",Eb,[(0,u.Lk)("span",Ab,(0,L.v_)(e.combinedLevel),1)])])),_:2},1032,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])):((0,u.uX)(),(0,u.Wv)(k,{key:3,modelValue:e.content,"onUpdate:modelValue":a=>e.content=a,placeholder:"è«‹è¼¸å…¥",size:"small",style:{width:"100%"}},null,8,["modelValue","onUpdate:modelValue"]))])):((0,u.uX)(),(0,u.CE)("div",Tb,["éƒ¨é–€"===e.category?((0,u.uX)(),(0,u.Wv)(_l,{key:0,deptId:e.content},null,8,["deptId"])):"è·ç¨±"===e.category?((0,u.uX)(),(0,u.Wv)(Dl,{key:1,mode:"Description",titleId:e.content},null,8,["titleId"])):((0,u.uX)(),(0,u.CE)(u.FK,{key:2},[(0,u.eW)((0,L.v_)(e.content),1)],64))]))])),_:1})])),_:1},8,["data"]),(0,u.bF)(_,{class:"grid-lines",data:p.value,border:"","show-header":!1,style:{width:"400px"},"row-style":b},{default:(0,u.k6)((()=>[(0,u.bF)(i,{label:"æ¬„ä½",width:"180"},{default:(0,u.k6)((({})=>l[5]||(l[5]=[]))),_:1}),(0,u.bF)(i,{label:"è³‡æ–™",width:"220"},{default:(0,u.k6)((({})=>l[6]||(l[6]=[]))),_:1})])),_:1},8,["data"])]),(0,u.Lk)("div",Wb,[(0,u.bF)(_,{"empty-text":"",class:"grid-lines",data:m.value,border:"",style:{width:"400px"}},{default:(0,u.k6)((()=>[(0,u.bF)(i,{label:"ç´„å®šå·¥è³‡",width:"180"},{default:(0,u.k6)((({row:e})=>[(0,u.eW)((0,L.v_)(e.category),1)])),_:1}),(0,u.bF)(i,{label:"é‡‘é¡",width:"220"},{default:(0,u.k6)((({row:e})=>[t.value?((0,u.uX)(),(0,u.CE)("div",Sb,["éƒ¨é–€"===e.category?((0,u.uX)(),(0,u.Wv)(Gn,{key:0,modelValue:e.content,"onUpdate:modelValue":a=>e.content=a,size:"small"},null,8,["modelValue","onUpdate:modelValue"])):"è·ç¨±"===e.category?((0,u.uX)(),(0,u.Wv)(su,{key:1,modelValue:e.content,"onUpdate:modelValue":a=>e.content=a,size:"small"},null,8,["modelValue","onUpdate:modelValue"])):"å‹žé€€å…¬ä»˜"===e.category?((0,u.uX)(),(0,u.Wv)(h,{key:2,modelValue:e.insurance.pensionCompany,"onUpdate:modelValue":a=>e.insurance.pensionCompany=a,placeholder:"å‹žé€€å…¬ä»˜",style:{width:"12rem"},"allow-create":"",filterable:"",size:"small",onChange:a=>g(e,a)},{default:(0,u.k6)((()=>[(0,u.bF)(y,{disabled:"",value:""},{default:(0,u.k6)((()=>l[7]||(l[7]=[(0,u.Lk)("div",{style:{display:"flex","justify-content":"space-between","font-weight":"bold",padding:"4px 8px","border-bottom":"1px solid #ebeef5"}},[(0,u.Lk)("span",null,"ç´šè·"),(0,u.Lk)("span",null,"å‹žé€€é‡‘é¡")],-1)]))),_:1}),((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(r.value,(e=>((0,u.uX)(),(0,u.Wv)(y,{key:e.id,label:String(e.pensionCompany),value:e.pensionCompany},{default:(0,u.k6)((()=>[(0,u.Lk)("div",Ub,[(0,u.Lk)("span",$b,(0,L.v_)(e.insuranceLevel),1),(0,u.Lk)("span",Nb,(0,L.v_)(e.pensionCompany),1)])])),_:2},1032,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])):"å‹žä¿å…¬ä»˜"===e.category?((0,u.uX)(),(0,u.Wv)(h,{key:3,modelValue:e.originalLaborCompany,"onUpdate:modelValue":a=>e.originalLaborCompany=a,placeholder:"å‹žä¿å…¬ä»˜",style:{width:"12rem"},"allow-create":"",filterable:"",size:"small",onChange:a=>g(e,a)},{default:(0,u.k6)((()=>[(0,u.bF)(y,{disabled:"",value:""},{default:(0,u.k6)((()=>l[8]||(l[8]=[(0,u.Lk)("div",{style:{display:"flex","justify-content":"space-between","font-weight":"bold",padding:"4px 8px","border-bottom":"1px solid #ebeef5"}},[(0,u.Lk)("span",null,"ç´šè·"),(0,u.Lk)("span",null,"å‹žä¿è²»")],-1)]))),_:1}),((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(r.value,(e=>((0,u.uX)(),(0,u.Wv)(y,{key:e.id,label:String(e.laborCompany),value:e.laborCompany},{default:(0,u.k6)((()=>[(0,u.Lk)("div",Xb,[(0,u.Lk)("span",Kb,(0,L.v_)(e.insuranceLevel),1),(0,u.Lk)("span",Mb,(0,L.v_)(e.laborCompany),1)])])),_:2},1032,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])):"å¥ä¿å…¬ä»˜"===e.category?((0,u.uX)(),(0,u.Wv)(h,{key:4,modelValue:e.insurance.healthCompany,"onUpdate:modelValue":a=>e.insurance.healthCompany=a,placeholder:"å¥ä¿å…¬ä»˜",style:{width:"12rem"},"allow-create":"",filterable:"",size:"small",onChange:a=>g(e,a)},{default:(0,u.k6)((()=>[(0,u.bF)(y,{disabled:"",value:""},{default:(0,u.k6)((()=>l[9]||(l[9]=[(0,u.Lk)("div",{style:{display:"flex","justify-content":"space-between","font-weight":"bold",padding:"4px 8px","border-bottom":"1px solid #ebeef5"}},[(0,u.Lk)("span",null,"ç´šè·"),(0,u.Lk)("span",null,"å¥ä¿è²»")],-1)]))),_:1}),((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(r.value,(e=>((0,u.uX)(),(0,u.Wv)(y,{key:e.id,label:String(e.healthCompany),value:e.healthCompany},{default:(0,u.k6)((()=>[(0,u.Lk)("div",Pb,[(0,u.Lk)("span",Ob,(0,L.v_)(e.insuranceLevel),1),(0,u.Lk)("span",zb,(0,L.v_)(e.healthCompany),1)])])),_:2},1032,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])):"å‹žä¿è²»"===e.category?((0,u.uX)(),(0,u.Wv)(h,{key:5,modelValue:e.insurance.laborPersonal,"onUpdate:modelValue":a=>e.insurance.laborPersonal=a,placeholder:"å‹žä¿è²»",style:{width:"12rem"},"allow-create":"",filterable:"",size:"small",onChange:a=>g(e,a)},{default:(0,u.k6)((()=>[(0,u.bF)(y,{disabled:"",value:""},{default:(0,u.k6)((()=>l[10]||(l[10]=[(0,u.Lk)("div",{style:{display:"flex","justify-content":"space-between","font-weight":"bold",padding:"4px 8px","border-bottom":"1px solid #ebeef5"}},[(0,u.Lk)("span",null,"ç´šè·"),(0,u.Lk)("span",null,"å‹žä¿è²»")],-1)]))),_:1}),((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(r.value,(e=>((0,u.uX)(),(0,u.Wv)(y,{key:e.id,label:String(e.laborPersonal),value:e.laborPersonal},{default:(0,u.k6)((()=>[(0,u.Lk)("div",Bb,[(0,u.Lk)("span",jb,(0,L.v_)(e.insuranceLevel),1),(0,u.Lk)("span",Yb,(0,L.v_)(e.laborPersonal),1)])])),_:2},1032,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])):"å¥ä¿è²»"===e.category?((0,u.uX)(),(0,u.Wv)(h,{key:6,modelValue:e.insurance.healthPersonal,"onUpdate:modelValue":a=>e.insurance.healthPersonal=a,placeholder:"å¥ä¿è²»",style:{width:"12rem"},"allow-create":"",filterable:"",size:"small",onChange:a=>g(e,a)},{default:(0,u.k6)((()=>[(0,u.bF)(y,{disabled:"",value:""},{default:(0,u.k6)((()=>l[11]||(l[11]=[(0,u.Lk)("div",{style:{display:"flex","justify-content":"space-between","font-weight":"bold",padding:"4px 8px","border-bottom":"1px solid #ebeef5"}},[(0,u.Lk)("span",null,"ç´šè·"),(0,u.Lk)("span",null,"å¥ä¿è²»")],-1)]))),_:1}),((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(r.value,(e=>((0,u.uX)(),(0,u.Wv)(y,{key:e.id,label:String(e.healthPersonal),value:e.healthPersonal},{default:(0,u.k6)((()=>[(0,u.Lk)("div",Qb,[(0,u.Lk)("span",Hb,(0,L.v_)(e.insuranceLevel),1),(0,u.Lk)("span",qb,(0,L.v_)(e.healthPersonal),1)])])),_:2},1032,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])):"å®¶å±¬å¥ä¿è²»"===e.category?((0,u.uX)(),(0,u.Wv)(h,{key:7,modelValue:e.insurance.healthFamily,"onUpdate:modelValue":a=>e.insurance.healthFamily=a,placeholder:"å®¶å±¬å¥ä¿è²»",style:{width:"12rem"},"allow-create":"",filterable:"",size:"small",onChange:a=>g(e,a)},{default:(0,u.k6)((()=>[(0,u.bF)(y,{disabled:"",value:""},{default:(0,u.k6)((()=>l[12]||(l[12]=[(0,u.Lk)("div",{style:{display:"flex","justify-content":"space-between","font-weight":"bold",padding:"4px 8px","border-bottom":"1px solid #ebeef5"}},[(0,u.Lk)("span",null,"ç´šè·"),(0,u.Lk)("span",null,"å®¶å±¬å¥ä¿è²»")],-1)]))),_:1}),((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(r.value,(e=>((0,u.uX)(),(0,u.Wv)(y,{key:e.id,label:String(e.healthPersonal),value:e.healthPersonal},{default:(0,u.k6)((()=>[(0,u.Lk)("div",Jb,[(0,u.Lk)("span",Gb,(0,L.v_)(e.insuranceLevel),1),(0,u.Lk)("span",Zb,(0,L.v_)(e.healthPersonal),1)])])),_:2},1032,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])):((0,u.uX)(),(0,u.Wv)(k,{key:8,modelValue:e.content,"onUpdate:modelValue":a=>e.content=a,placeholder:"è«‹è¼¸å…¥",size:"small"},null,8,["modelValue","onUpdate:modelValue"]))])):((0,u.uX)(),(0,u.CE)("div",eg,["å‹žä¿å…¬ä»˜"===e.category?((0,u.uX)(),(0,u.CE)(u.FK,{key:0},[(0,u.eW)(" (å‰) "+(0,L.v_)(e.originalLaborCompany)+" / (å¾Œ) "+(0,L.v_)(e.content),1)],64)):((0,u.uX)(),(0,u.CE)(u.FK,{key:1},[(0,u.eW)((0,L.v_)(e.content),1)],64))]))])),_:1})])),_:1},8,["data"])]),(0,u.Lk)("div",ag,[(0,u.bF)(_,{"empty-text":"",class:"grid-lines",data:s.value,border:"",style:{width:"21.7rem"},onDblclick:x},{default:(0,u.k6)((()=>[(0,u.bF)(i,{label:"",width:"145"},{default:(0,u.k6)((()=>l[13]||(l[13]=[(0,u.eW)((0,L.v_)("å‹žä¿å…¬ä»˜çµ¦ä»˜%æ•¸"))]))),_:1}),(0,u.bF)(i,{label:"TW",width:"100"},{default:(0,u.k6)((({row:e})=>[I.value?((0,u.uX)(),(0,u.CE)("div",lg,[(0,u.bF)(k,{modelValue:e.dae,"onUpdate:modelValue":a=>e.dae=a,step:"0.0001",size:"small"},null,8,["modelValue","onUpdate:modelValue"])])):((0,u.uX)(),(0,u.CE)("div",tg,(0,L.v_)((100*e.dae).toFixed(2)+"%"),1))])),_:1}),(0,u.bF)(i,{label:"OP",width:"100"},{default:(0,u.k6)((({row:e})=>[I.value?((0,u.uX)(),(0,u.CE)("div",og,[(0,u.bF)(k,{modelValue:e.op,"onUpdate:modelValue":a=>e.op=a,step:"0.0001",size:"small"},null,8,["modelValue","onUpdate:modelValue"])])):((0,u.uX)(),(0,u.CE)("div",ng,(0,L.v_)((100*e.op).toFixed(2)+"%"),1))])),_:1})])),_:1},8,["data"])])])])}}};const sg=(0,ie.A)(rg,[["__scopeId","data-v-63403922"]]);var ug=sg;const ig={class:"meal-allowance-summary mt-5"},dg={class:"header-section"},cg={class:"date-selector"},pg={class:"table-section"},mg={class:"table-container"},vg={class:"amount"},bg={key:0,class:"summary-section"},gg={class:"total-summary"},yg={class:"total-employees"},fg={class:"dialog-footer"};var hg={__name:"MealAllowanceSummary",setup(e){const a=(0,d.KR)(!1),l=(0,d.KR)(!1),t=(0,d.KR)(""),o=(0,d.KR)([]),n=(0,d.KR)(!1),r=(0,d.KR)(null),s=(0,d.KR)([]),i=(0,u.EW)((()=>o.value.reduce(((e,a)=>e+(a.totalAmount||0)),0))),c=()=>{const e=new Date,a=e.getFullYear(),l=String(e.getMonth()+1).padStart(2,"0");t.value=`${a}-${l}`},p=e=>null==e||""===e?"0":new Intl.NumberFormat("zh-TW",{style:"currency",currency:"TWD",minimumFractionDigits:0}).format(e),m=async()=>{if(t.value){a.value=!0;try{const e=await Wa.getMealAllowanceSummary({month:t.value});e&&e.data&&Array.isArray(e.data)?o.value=e.data:e&&e.data&&e.data.data&&Array.isArray(e.data.data)?o.value=e.data.data:(console.warn("èª¤é¤åŠ ç¸½ API å›žå‚³çš„è³‡æ–™æ ¼å¼ä¸æ­£ç¢º:",e),o.value=[]),0===o.value.length&&D.nk.info("è©²æœˆä»½ç„¡èª¤é¤è¨˜éŒ„")}catch(e){console.error("å–å¾—èª¤é¤åŠ ç¸½è³‡æ–™å¤±æ•—:",e),D.nk.error("å–å¾—è³‡æ–™å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦"),o.value=[]}finally{a.value=!1}}else D.nk.warning("è«‹é¸æ“‡æŸ¥è©¢æœˆä»½")},v=async e=>{r.value=e,n.value=!0,l.value=!0;try{const a=await Wa.getMealAllowanceDetails({employeeId:e.employeeId,month:t.value});s.value=a.data||[]}catch(a){console.error("å–å¾—è©³ç´°è¨˜éŒ„å¤±æ•—:",a),D.nk.error("å–å¾—è©³ç´°è¨˜éŒ„å¤±æ•—"),s.value=[]}finally{l.value=!1}},b=()=>{n.value=!1,r.value=null,s.value=[]};return(0,u.sV)((()=>{c(),m()})),(e,d)=>{const c=(0,u.g2)("el-date-picker"),g=(0,u.g2)("el-button"),y=(0,u.g2)("el-table-column"),f=(0,u.g2)("el-table"),h=(0,u.g2)("el-dialog"),k=(0,u.gN)("loading");return(0,u.uX)(),(0,u.CE)("div",ig,[(0,u.Lk)("div",dg,[d[4]||(d[4]=(0,u.Lk)("h2",null,"èª¤é¤åŠ ç¸½",-1)),(0,u.Lk)("div",cg,[d[3]||(d[3]=(0,u.Lk)("label",null,"æŸ¥è©¢æœˆä»½ï¼š",-1)),(0,u.bF)(c,{modelValue:t.value,"onUpdate:modelValue":d[0]||(d[0]=e=>t.value=e),type:"month",placeholder:"é¸æ“‡æœˆä»½",format:"YYYY-MM","value-format":"YYYY-MM",onChange:m},null,8,["modelValue"]),(0,u.bF)(g,{type:"primary",onClick:m,loading:a.value},{default:(0,u.k6)((()=>d[2]||(d[2]=[(0,u.eW)(" æŸ¥è©¢ ")]))),_:1},8,["loading"])])]),(0,u.Lk)("div",pg,[(0,u.Lk)("div",mg,[(0,u.bo)(((0,u.uX)(),(0,u.Wv)(f,{data:o.value,stripe:"",border:"",style:{width:"100%"},"default-sort":{prop:"totalAmount",order:"descending"}},{default:(0,u.k6)((()=>[(0,u.bF)(y,{prop:"employeeName",label:"å§“å",width:"200",sortable:""}),(0,u.bF)(y,{prop:"totalAmount",label:"èª¤é¤è²»åŠ ç¸½",width:"150",sortable:"",align:"right"},{default:(0,u.k6)((({row:e})=>[(0,u.Lk)("span",vg,(0,L.v_)(p(e.totalAmount)),1)])),_:1}),(0,u.bF)(y,{prop:"recordCount",label:"è¨˜éŒ„ç­†æ•¸",width:"120",sortable:"",align:"center"}),(0,u.bF)(y,{label:"æ“ä½œ",width:"120",align:"center"},{default:(0,u.k6)((({row:e})=>[(0,u.bF)(g,{type:"text",size:"small",onClick:a=>v(e)},{default:(0,u.k6)((()=>d[5]||(d[5]=[(0,u.eW)(" æŸ¥çœ‹è©³ç´° ")]))),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])),[[k,a.value]])])]),o.value.length>0?((0,u.uX)(),(0,u.CE)("div",bg,[(0,u.Lk)("div",gg,[(0,u.Lk)("strong",null,"ç¸½è¨ˆï¼š"+(0,L.v_)(p(i.value)),1),(0,u.Lk)("span",yg,"ï¼ˆå…± "+(0,L.v_)(o.value.length)+" äººï¼‰",1)])])):(0,u.Q3)("",!0),(0,u.bF)(h,{modelValue:n.value,"onUpdate:modelValue":d[1]||(d[1]=e=>n.value=e),title:`${r.value?.employeeName} - èª¤é¤è¨˜éŒ„è©³ç´°`,width:"80%","before-close":b},{footer:(0,u.k6)((()=>[(0,u.Lk)("span",fg,[(0,u.bF)(g,{onClick:b},{default:(0,u.k6)((()=>d[6]||(d[6]=[(0,u.eW)("é—œé–‰")]))),_:1})])])),default:(0,u.k6)((()=>[(0,u.bo)(((0,u.uX)(),(0,u.Wv)(f,{data:s.value,stripe:"",border:"",style:{width:"100%"}},{default:(0,u.k6)((()=>[(0,u.bF)(y,{prop:"date",label:"æ—¥æœŸ",width:"120",sortable:""}),(0,u.bF)(y,{prop:"mealAllowance",label:"èª¤é¤è²»",width:"100",align:"right"},{default:(0,u.k6)((({row:e})=>[(0,u.eW)((0,L.v_)(p(e.mealAllowance)),1)])),_:1}),(0,u.bF)(y,{prop:"overtimeHours",label:"åŠ ç­æ™‚æ•¸",width:"100",align:"right"}),(0,u.bF)(y,{prop:"remarks",label:"å‚™è¨»","show-overflow-tooltip":""})])),_:1},8,["data"])),[[k,l.value]])])),_:1},8,["modelValue","title"])])}}};const kg=(0,ie.A)(hg,[["__scopeId","data-v-be62d4ba"]]);var _g=kg;let wg;function Fg(e){wg=e}const Cg=()=>wg,Dg="SpecialLeave";var Lg={calculateSpecialLeave(e){return Cg().post(`/${Dg}/calculate`,e,{headers:{"Content-Type":"application/json"}})},calculateSpecialLeaveBatch(e){return Cg().post(`/${Dg}/calculate-batch`,e,{headers:{"Content-Type":"application/json"}})},calculateSpecialLeaveByEmployee(e,a,l=null,t=null){const o={leaveSystemType:a,...l&&{customYearStartDate:l},...t&&{anniversaryDate:t}};return Cg().get(`/${Dg}/calculate-by-employee/${e}`,{params:o,headers:{"Content-Type":"application/json"}})},getLeaveSystemTypes(){return Cg().get(`/${Dg}/leave-system-types`,{headers:{"Content-Type":"application/json"}})},getLeaveDaysTable(){return Cg().get(`/${Dg}/leave-days-table`,{headers:{"Content-Type":"application/json"}})},getAnnualLeaveSummary(e={}){return Cg().get(`/${Dg}/getAnnualLeaveSummary`,{params:e})}},Rg=l(1576),Vg=l.n(Rg);const Ig={class:"annual-leave-summary mt-5"},xg={class:"header-section"},Eg={class:"filter-section"},Ag={class:"filter-item"},Tg={class:"action-buttons"},Wg={class:"table-section"},Sg={class:"table-container"},Ug={class:"total-hours"},$g={class:"used-hours"},Ng={class:"hours-display"},Xg={class:"minutes-display"},Kg={class:"dialog-footer"};var Mg={__name:"AnnualLeaveSummary",setup(e){const a=(0,d.KR)(Vg()().startOf("year").format("YYYY-MM-DD")),l=()=>{g()},t=(0,d.KR)(!1),o=(0,d.KR)(!1),n=(0,d.KR)([]),r=(0,d.KR)(!1),s=(0,d.KR)(null),i=(0,d.KR)([]),c=(0,d.KR)(""),p=((0,u.EW)((()=>Array.isArray(n.value)?n.value.reduce(((e,a)=>e+(a.totalAnnualLeaveHours||0)),0):0)),(0,u.EW)((()=>Array.isArray(n.value)?n.value.reduce(((e,a)=>e+(a.usedLeaveHours||0)),0):0)),(0,u.EW)((()=>Array.isArray(n.value)?n.value.reduce(((e,a)=>e+(a.unusedLeaveHours||0)),0):0)),e=>null==e||""===e?"0":`${parseFloat(e).toFixed(1)} å°æ™‚`),m=e=>null==e||""===e?"0":`${Math.round(e)} åˆ†é˜`,v=e=>e.unusedLeaveHours&&0!==e.unusedLeaveHours?60*e.unusedLeaveHours:0,b=()=>{g()},g=async()=>{t.value=!0;try{const e={};c.value&&(e.area=c.value),a.value&&(e.refYearStart=a.value);const l=await Lg.getAnnualLeaveSummary(e);l&&l.data&&Array.isArray(l.data)?n.value=l.data:l&&l.data&&l.data.data&&Array.isArray(l.data.data)?n.value=l.data.data:(console.warn("API å›žå‚³çš„è³‡æ–™æ ¼å¼ä¸æ­£ç¢º:",l),n.value=[]),0===n.value.length?D.nk.info("ç›®å‰ç„¡ç‰¹ä¼‘è³‡æ–™"):D.nk.success("è³‡æ–™è¼‰å…¥æˆåŠŸ")}catch(e){console.error("å–å¾—ç‰¹ä¼‘æ—¥æ•¸è³‡æ–™å¤±æ•—:",e),D.nk.error("å–å¾—è³‡æ–™å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦"),n.value=[]}finally{t.value=!1}},y=()=>{r.value=!1,s.value=null,i.value=[]};return(0,u.sV)((()=>{g()})),(e,f)=>{const h=(0,u.g2)("el-option"),k=(0,u.g2)("el-select"),_=(0,u.g2)("el-date-picker"),w=(0,u.g2)("el-icon"),F=(0,u.g2)("el-button"),C=(0,u.g2)("el-table-column"),D=((0,u.g2)("el-progress"),(0,u.g2)("el-table")),R=(0,u.g2)("el-dialog"),V=(0,u.gN)("loading");return(0,u.uX)(),(0,u.CE)("div",Ig,[(0,u.Lk)("div",xg,[f[7]||(f[7]=(0,u.Lk)("h2",null,"ç‰¹ä¼‘æ—¥æ•¸",-1)),(0,u.Lk)("div",Eg,[(0,u.Lk)("div",Ag,[f[3]||(f[3]=(0,u.Lk)("label",{class:"filter-label"},"å€åŸŸç¯©é¸ï¼š",-1)),(0,u.bF)(k,{modelValue:c.value,"onUpdate:modelValue":f[0]||(f[0]=e=>c.value=e),onChange:b,placeholder:"è«‹é¸æ“‡å€åŸŸ",style:{width:"120px"}},{default:(0,u.k6)((()=>[(0,u.bF)(h,{label:"å…¨éƒ¨",value:""}),(0,u.bF)(h,{label:"å—",value:"south"}),(0,u.bF)(h,{label:"åŒ—",value:"north"})])),_:1},8,["modelValue"]),f[4]||(f[4]=(0,u.Lk)("label",{class:"filter-label"},"å¹´åº¦èµ·å§‹æ—¥ï¼š",-1)),(0,u.bF)(_,{modelValue:a.value,"onUpdate:modelValue":f[1]||(f[1]=e=>a.value=e),type:"year",placeholder:"é¸æ“‡èµ·å§‹æ—¥","value-format":"YYYY-MM-DD",format:"YYYY/MM/DD",style:{width:"160px"},clearable:!0,onChange:l},null,8,["modelValue"])])]),(0,u.Lk)("div",Tg,[(0,u.bF)(F,{type:"primary",onClick:g,loading:t.value},{default:(0,u.k6)((()=>[(0,u.bF)(w,null,{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.Refresh))])),_:1}),f[5]||(f[5]=(0,u.eW)(" åˆ·æ–°è³‡æ–™ "))])),_:1},8,["loading"]),(0,u.Q3)("",!0)])]),(0,u.Lk)("div",Wg,[(0,u.Lk)("div",Sg,[(0,u.bo)(((0,u.uX)(),(0,u.Wv)(D,{data:n.value,stripe:"",border:"",style:{width:"100%"},"default-sort":{prop:"unusedLeaveHours",order:"descending"}},{default:(0,u.k6)((()=>[(0,u.bF)(C,{prop:"employeeName",label:"å§“å",width:"150",sortable:"",fixed:"left"}),(0,u.bF)(C,{prop:"totalAnnualLeaveHours",label:"å…¨å¹´åœ¨è·ç‰¹ä¼‘æ™‚æ•¸",width:"180",sortable:"",align:"right"},{default:(0,u.k6)((({row:e})=>[(0,u.Lk)("span",Ug,(0,L.v_)(p(e.totalAnnualLeaveHours)),1)])),_:1}),(0,u.bF)(C,{prop:"usedLeaveHours",label:"å·²ä¼‘ç‰¹ä¼‘æ™‚æ•¸",width:"150",sortable:"",align:"right"},{default:(0,u.k6)((({row:e})=>[(0,u.Lk)("span",$g,(0,L.v_)(p(e.usedLeaveHours)),1)])),_:1}),(0,u.bF)(C,{prop:"unusedLeaveHours",label:"æœªä¼‘ç‰¹ä¼‘æ™‚æ•¸",width:"150",sortable:"",align:"right"},{default:(0,u.k6)((({row:e})=>[(0,u.Lk)("span",Ng,(0,L.v_)(p(e.unusedLeaveHours)),1)])),_:1}),(0,u.bF)(C,{label:"æœªä¼‘ç‰¹ä¼‘åˆ†é˜æ•¸",width:"160",sortable:"",align:"right","sort-method":(e,a)=>v(e)-v(a)},{default:(0,u.k6)((({row:e})=>[(0,u.Lk)("span",Xg,(0,L.v_)(m(v(e))),1)])),_:1},8,["sort-method"]),(0,u.Q3)("",!0),(0,u.Q3)("",!0)])),_:1},8,["data"])),[[V,t.value]])])]),(0,u.Q3)("",!0),(0,u.bF)(R,{modelValue:r.value,"onUpdate:modelValue":f[2]||(f[2]=e=>r.value=e),title:`${s.value?.employeeName} - ç‰¹ä¼‘ä½¿ç”¨è¨˜éŒ„`,width:"80%","before-close":y},{footer:(0,u.k6)((()=>[(0,u.Lk)("span",Kg,[(0,u.bF)(F,{onClick:y},{default:(0,u.k6)((()=>f[13]||(f[13]=[(0,u.eW)("é—œé–‰")]))),_:1})])])),default:(0,u.k6)((()=>[(0,u.bo)(((0,u.uX)(),(0,u.Wv)(D,{data:i.value,stripe:"",border:"",style:{width:"100%"}},{default:(0,u.k6)((()=>[(0,u.bF)(C,{prop:"leaveStartDate",label:"è«‹å‡é–‹å§‹æ—¥æœŸ",width:"140",sortable:""}),(0,u.bF)(C,{prop:"leaveEndDate",label:"è«‹å‡çµæŸæ—¥æœŸ",width:"140",sortable:""}),(0,u.bF)(C,{prop:"leaveTotalInUnitsOfHours",label:"è«‹å‡æ™‚æ•¸",width:"100",align:"right"},{default:(0,u.k6)((({row:e})=>[(0,u.eW)((0,L.v_)(p(e.leaveTotalInUnitsOfHours)),1)])),_:1}),(0,u.bF)(C,{prop:"applyDate",label:"ç”³è«‹æ—¥æœŸ",width:"120",sortable:""}),(0,u.bF)(C,{prop:"leaveRequestID",label:"è«‹å‡å–®è™Ÿ",width:"150","show-overflow-tooltip":""})])),_:1},8,["data"])),[[V,o.value]])])),_:1},8,["modelValue","title"])])}}};const Pg=(0,ie.A)(Mg,[["__scopeId","data-v-c764c596"]]);var Og=Pg,zg=l(93230);const Bg={class:"overtime-page-info"},jg={class:"header-section"},Yg={class:"filter-section"},Qg={class:"filter-row"},Hg={class:"filter-item"},qg={class:"filter-row"},Jg={class:"filter-item"},Gg={class:"filter-item"},Zg={class:"filter-item"},ey={class:"table-section"},ay={key:1,class:"text-gray-400"},ly={class:"dialog-footer"};var ty={__name:"OvertimePageInfo",setup(e){const a=(0,d.KR)(!1),l=(0,d.KR)(!1),o=(0,d.KR)(!1),n=(0,d.KR)(!1),r=(0,d.KR)(""),s=(0,d.KR)((new Date).getFullYear().toString()),i=(0,d.KR)(((new Date).getMonth()+1).toString()),c=(0,d.KR)([]),p=(0,d.KR)([]),m=(0,d.KR)(null),v=(0,d.KR)(!1),b=(0,d.KR)(""),g=(0,d.KR)(null),y=(0,u.EW)((()=>{const e=(new Date).getFullYear(),a=[];for(let l=e;l>=e-4;l--)a.push(l.toString());return a})),f=(0,u.EW)((()=>[{label:"1æœˆ",value:"1"},{label:"2æœˆ",value:"2"},{label:"3æœˆ",value:"3"},{label:"4æœˆ",value:"4"},{label:"5æœˆ",value:"5"},{label:"6æœˆ",value:"6"},{label:"7æœˆ",value:"7"},{label:"8æœˆ",value:"8"},{label:"9æœˆ",value:"9"},{label:"10æœˆ",value:"10"},{label:"11æœˆ",value:"11"},{label:"12æœˆ",value:"12"}])),h=async()=>{a.value=!0;try{const e={area:r.value||void 0,year:s.value||void 0,month:i.value||void 0},a=await Wa.getOvertimePageInfo(e);if(console.log(a.data),a.data.success){const e=a.data.data.map((e=>({...e,overtimeHours2Plus:e.overtimeHours2Plus||(e.overtimeHours2To4||0)+(e.overtimeHours4Plus||0)}))),l=e.filter((e=>{const a=(e.overtimeHours0To2||0)>0||(e.overtimeHours2Plus||0)>0,l=(e.overtimeRecordsCount||0)>0,t=(e.mealAllowanceTotal||0)>0;return a||l||t}));c.value=l}else D.nk.error("å–å¾—åŠ ç­è³‡æ–™å¤±æ•—")}catch(e){console.error("å–å¾—åŠ ç­è³‡æ–™éŒ¯èª¤:",e),D.nk.error("å–å¾—åŠ ç­è³‡æ–™æ™‚ç™¼ç”ŸéŒ¯èª¤")}finally{a.value=!1}},k=async e=>{m.value=e,n.value=!0,o.value=!0;try{const a={employeeId:e.employeeId,year:s.value||void 0,month:i.value||void 0},l=await Wa.getEmployeeOvertimeDetails(a);l.data.success?p.value=l.data.data:D.nk.error("å–å¾—å“¡å·¥è©³ç´°è¨˜éŒ„å¤±æ•—")}catch(a){console.error("å–å¾—å“¡å·¥è©³ç´°è¨˜éŒ„éŒ¯èª¤:",a),D.nk.error("å–å¾—å“¡å·¥è©³ç´°è¨˜éŒ„æ™‚ç™¼ç”ŸéŒ¯èª¤")}finally{o.value=!1}},_=()=>{n.value=!1,m.value=null,p.value=[]},w=()=>{if(0!==c.value.length){l.value=!0;try{const e=c.value.map((e=>({"å·¥è™Ÿ":e.employeeId,"å§“å":e.employeeName,"éƒ¨é–€":e.department,"åœ°å€":e.area,"åŠ ç­èª¤é¤è²»":e.mealAllowanceTotal||0,"åŠ ç­å‰2å°æ™‚":e.overtimeHours0To2||0,"åŠ ç­2å°æ™‚ä»¥ä¸Š":e.overtimeHours2Plus||0,"åŠ ç­æ¬¡æ•¸":e.overtimeRecordsCount||0}))),a=zg.Wp.json_to_sheet(e),l=zg.Wp.book_new();zg.Wp.book_append_sheet(l,a,"åŠ ç­è³‡æ–™");const t=[{wch:10},{wch:15},{wch:20},{wch:10},{wch:15},{wch:15},{wch:18},{wch:12}];a["!cols"]=t;const o=[];if(r.value){const e="south"===r.value?"å—éƒ¨":"north"===r.value?"åŒ—éƒ¨":"å…¨éƒ¨";o.push(`äººå“¡å€åŸŸï¼š${e}`)}if(s.value&&o.push(`å¹´ä»½ï¼š${s.value}`),i.value){const e=f.value.find((e=>e.value===i.value))?.label||i.value;o.push(`æœˆä»½ï¼š${e}`)}const n=(new Date).toISOString().slice(0,10),u=o.length>0?`_${o.join("_")}`:"",d=`åŠ ç­è³‡æ–™${u}_${n}.xlsx`;zg._h(l,d),D.nk.success("Excelæª”æ¡ˆå·²ä¸‹è¼‰")}catch(e){console.error("åŒ¯å‡ºExceléŒ¯èª¤:",e),D.nk.error("åŒ¯å‡ºExcelæ™‚ç™¼ç”ŸéŒ¯èª¤")}finally{l.value=!1}}else D.nk.warning("æ²’æœ‰è³‡æ–™å¯ä»¥åŒ¯å‡º")},F=()=>{if(0!==c.value.length)try{const e=C(),a=window.open("","_blank");a.document.write(e),a.document.close(),a.onload=()=>{a.print(),a.close()},D.nk.success("åˆ—å°è¦–çª—å·²é–‹å•Ÿ")}catch(e){console.error("åˆ—å°å¤±æ•—:",e),D.nk.error("åˆ—å°å¤±æ•—")}else D.nk.warning("æ²’æœ‰è³‡æ–™å¯ä»¥åˆ—å°")},C=()=>{const e=(new Date).toLocaleDateString("zh-TW"),a=(new Date).toLocaleTimeString("zh-TW"),l=[];if(r.value){const e="south"===r.value?"å—éƒ¨":"north"===r.value?"åŒ—éƒ¨":"å…¨éƒ¨";l.push(`äººå“¡å€åŸŸï¼š${e}`)}if(s.value&&l.push(`å¹´ä»½ï¼š${s.value}`),i.value){const e=f.value.find((e=>e.value===i.value))?.label||i.value;l.push(`æœˆä»½ï¼š${e}`)}let t=`\n    <!DOCTYPE html>\n    <html>\n    <head>\n      <meta charset="UTF-8">\n      <title>åŠ ç­é é¢è³‡è¨Š</title>\n      <style>\n        @page {\n          size: A4 landscape;\n          margin: 15mm;\n        }\n        body { \n          font-family: 'Microsoft JhengHei', Arial, sans-serif; \n          margin: 10px; \n          font-size: 10px;\n          line-height: 1.3;\n        }\n        .header { \n          text-align: center; \n          margin-bottom: 15px; \n          border-bottom: 2px solid #333;\n          padding-bottom: 8px;\n        }\n        .header h1 { \n          margin: 0; \n          font-size: 16px; \n          color: #333;\n        }\n        .print-info { \n          text-align: right; \n          margin-bottom: 10px; \n          font-size: 9px;\n          color: #666;\n        }\n        .query-conditions {\n          margin-bottom: 10px;\n          padding: 8px;\n          background-color: #f5f5f5;\n          border-radius: 4px;\n          font-size: 9px;\n        }\n        .query-conditions h3 {\n          margin: 0 0 8px 0;\n          font-size: 12px;\n        }\n        .condition-item {\n          display: inline-block;\n          margin-right: 15px;\n          margin-bottom: 3px;\n        }\n        table { \n          width: 100%; \n          border-collapse: collapse; \n          margin-bottom: 15px;\n          table-layout: fixed;\n        }\n        th, td { \n          border: 1px solid #ddd; \n          padding: 4px; \n          text-align: left;\n          font-size: 9px;\n          word-wrap: break-word;\n          overflow: hidden;\n        }\n        th { \n          background-color: #f2f2f2; \n          font-weight: bold;\n          text-align: center;\n          font-size: 10px;\n        }\n        /* è¨­å®šå„æ¬„ä½å¯¬åº¦ */\n        .col-id { width: 8%; }\n        .col-name { width: 10%; }\n        .col-dept { width: 12%; }\n        .col-area { width: 8%; }\n        .col-meal { width: 10%; }\n        .col-hours1 { width: 10%; }\n        .col-hours2 { width: 12%; }\n        .col-count { width: 8%; }\n        \n        .number { text-align: right; }\n        .center { text-align: center; }\n        .summary {\n          margin-top: 10px;\n          text-align: right;\n          font-weight: bold;\n          font-size: 11px;\n        }\n        @media print {\n          body { \n            margin: 0; \n            -webkit-print-color-adjust: exact;\n            print-color-adjust: exact;\n          }\n          .no-print { display: none; }\n          @page {\n            size: A4 landscape;\n            margin: 10mm;\n          }\n        }\n      </style>\n    </head>\n    <body>\n      <div class="header">\n        <h1>åŠ ç­é é¢è³‡è¨Š</h1>\n      </div>\n      \n      <div class="print-info">\n        åˆ—å°æ—¥æœŸï¼š${e} ${a}\n      </div>\n      \n      <div class="query-conditions">\n        <h3>æŸ¥è©¢æ¢ä»¶ï¼š</h3>\n        ${l.length>0?l.map((e=>`<span class="condition-item">${e}</span>`)).join(""):'<span class="condition-item">å…¨éƒ¨è³‡æ–™</span>'}\n      </div>\n      \n      <table>\n        <thead>\n          <tr>\n            <th class="col-id">å·¥è™Ÿ</th>\n            <th class="col-name">å§“å</th>\n            <th class="col-dept">éƒ¨é–€</th>\n            <th class="col-area">åœ°å€</th>\n            <th class="col-meal">åŠ ç­èª¤é¤è²»</th>\n            <th class="col-hours1">åŠ ç­å‰2å°æ™‚</th>\n            <th class="col-hours2">åŠ ç­2å°æ™‚ä»¥ä¸Š</th>\n            <th class="col-count">åŠ ç­æ¬¡æ•¸</th>\n          </tr>\n        </thead>\n        <tbody>\n  `;c.value.forEach((e=>{t+=`\n      <tr>\n        <td class="col-id center">${e.employeeId||""}</td>\n        <td class="col-name">${e.employeeName||""}</td>\n        <td class="col-dept">${e.department||""}</td>\n        <td class="col-area center">${e.area||""}</td>\n        <td class="col-meal number">$${(e.mealAllowanceTotal||0).toFixed(0)}</td>\n        <td class="col-hours1 number">${(e.overtimeHours0To2||0).toFixed(1)}h</td>\n        <td class="col-hours2 number">${(e.overtimeHours2Plus||0).toFixed(1)}h</td>\n        <td class="col-count center">${e.overtimeRecordsCount||0}</td>\n      </tr>\n    `}));const o=c.value.reduce(((e,a)=>e+(a.mealAllowanceTotal||0)),0),n=c.value.reduce(((e,a)=>e+(a.overtimeHours0To2||0)),0),u=c.value.reduce(((e,a)=>e+(a.overtimeHours2Plus||0)),0),d=c.value.reduce(((e,a)=>e+(a.overtimeRecordsCount||0)),0);return t+=`\n        </tbody>\n      </table>\n      \n      <div class="summary">\n        <div>ç¸½äººæ•¸ï¼š${c.value.length} äºº</div>\n        <div>èª¤é¤è²»ç¸½è¨ˆï¼š$${o.toFixed(0)}</div>\n        <div>åŠ ç­å‰2å°æ™‚ç¸½è¨ˆï¼š${n.toFixed(1)}h</div>\n        <div>åŠ ç­2å°æ™‚ä»¥ä¸Šç¸½è¨ˆï¼š${u.toFixed(1)}h</div>\n        <div>åŠ ç­æ¬¡æ•¸ç¸½è¨ˆï¼š${d} æ¬¡</div>\n      </div>\n    </body>\n    </html>\n  `,t},R=(e,a,l)=>l?`$${l.toFixed(0)}`:"$0",V=(e,a,l)=>l?`${l.toFixed(1)}h`:"0h",I=e=>e?new Date(e).toLocaleDateString("zh-TW"):"",x=(e,a)=>e&&a?`${e} ~ ${a}`:"",E=(e,a)=>{if(!e&&!a)return"0h";const l=(e||0)+(a||0)/60;return`${l.toFixed(1)}h`},A=async e=>{try{const a=await W(e);a?(b.value=a,g.value={documentID:a,documentTypeID:"OR"},v.value=!0):D.nk.warning("æ‰¾ä¸åˆ°å°æ‡‰çš„åŠ ç­ç”³è«‹å–®")}catch(a){console.error("é–‹å•Ÿå·¥ä½œæµç¨‹å°è©±æ¡†éŒ¯èª¤:",a),D.nk.error("é–‹å•Ÿå·¥ä½œæµç¨‹å°è©±æ¡†æ™‚ç™¼ç”ŸéŒ¯èª¤")}},T=()=>{v.value=!1,b.value="",g.value=null},W=async e=>{try{if(e.documentNumber)return e.documentNumber;if(e.overtimeRequestId)return e.overtimeRequestId;if(e.recordId){const a=[e.recordId.toString(),`OR-${e.recordId}`,`OT-${e.recordId}`,`OvertimeRequest-${e.recordId}`];return a[0]}return null}catch(a){return console.error("ç²å–æ–‡ä»¶IDéŒ¯èª¤:",a),null}};return(0,u.sV)((()=>{h()})),(e,b)=>{const C=(0,u.g2)("el-radio"),D=(0,u.g2)("el-radio-group"),W=(0,u.g2)("el-option"),S=(0,u.g2)("el-select"),U=(0,u.g2)("el-icon"),$=(0,u.g2)("el-button"),N=(0,u.g2)("el-table-column"),X=(0,u.g2)("el-table"),K=(0,u.g2)("el-tag"),M=(0,u.g2)("el-dialog"),P=(0,u.gN)("loading");return(0,u.uX)(),(0,u.CE)("div",Bg,[(0,u.Lk)("div",jg,[b[14]||(b[14]=(0,u.Lk)("h2",null,"åŠ ç­é é¢è³‡è¨Š",-1)),(0,u.Lk)("div",Yg,[(0,u.Lk)("div",Qg,[(0,u.Lk)("div",Hg,[b[8]||(b[8]=(0,u.Lk)("label",null,"äººå“¡å€åŸŸï¼š",-1)),(0,u.bF)(D,{modelValue:r.value,"onUpdate:modelValue":b[0]||(b[0]=e=>r.value=e),onChange:h},{default:(0,u.k6)((()=>[(0,u.bF)(C,{label:""},{default:(0,u.k6)((()=>b[5]||(b[5]=[(0,u.eW)("å…¨éƒ¨")]))),_:1}),(0,u.bF)(C,{label:"south"},{default:(0,u.k6)((()=>b[6]||(b[6]=[(0,u.eW)("å—éƒ¨")]))),_:1}),(0,u.bF)(C,{label:"north"},{default:(0,u.k6)((()=>b[7]||(b[7]=[(0,u.eW)("åŒ—éƒ¨")]))),_:1})])),_:1},8,["modelValue"])])]),(0,u.Lk)("div",qg,[(0,u.Lk)("div",Jg,[b[9]||(b[9]=(0,u.Lk)("label",null,"å¹´ä»½ï¼š",-1)),(0,u.bF)(S,{modelValue:s.value,"onUpdate:modelValue":b[1]||(b[1]=e=>s.value=e),placeholder:"é¸æ“‡å¹´ä»½",onChange:h,style:{width:"5rem"}},{default:(0,u.k6)((()=>[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(y.value,(e=>((0,u.uX)(),(0,u.Wv)(W,{key:e,label:e,value:e},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])]),(0,u.Lk)("div",Gg,[b[10]||(b[10]=(0,u.Lk)("label",null,"æœˆä»½ï¼š",-1)),(0,u.bF)(S,{modelValue:i.value,"onUpdate:modelValue":b[2]||(b[2]=e=>i.value=e),placeholder:"é¸æ“‡æœˆä»½",onChange:h,style:{width:"5rem"}},{default:(0,u.k6)((()=>[(0,u.bF)(W,{label:"å…¨å¹´",value:""}),((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(f.value,(e=>((0,u.uX)(),(0,u.Wv)(W,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])]),(0,u.Lk)("div",Zg,[(0,u.bF)($,{type:"primary",onClick:h,loading:a.value},{default:(0,u.k6)((()=>[(0,u.bF)(U,null,{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.Search))])),_:1}),b[11]||(b[11]=(0,u.eW)(" æŸ¥è©¢ "))])),_:1},8,["loading"]),(0,u.bF)($,{type:"success",onClick:w,loading:l.value},{default:(0,u.k6)((()=>[(0,u.bF)(U,null,{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.Download))])),_:1}),b[12]||(b[12]=(0,u.eW)(" åŒ¯å‡ºExcel "))])),_:1},8,["loading"]),(0,u.bF)($,{type:"info",onClick:F},{default:(0,u.k6)((()=>[(0,u.bF)(U,null,{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.Printer))])),_:1}),b[13]||(b[13]=(0,u.eW)(" åˆ—å° "))])),_:1})])])])]),(0,u.Lk)("div",ey,[(0,u.bo)(((0,u.uX)(),(0,u.Wv)(X,{data:c.value,stripe:"",border:"",style:{width:"1170px"},"default-sort":{prop:"mealAllowanceTotal",order:"descending"},onRowClick:k,class:"overtime-table"},{default:(0,u.k6)((()=>[(0,u.bF)(N,{prop:"employeeId",label:"å·¥è™Ÿ",width:"100",sortable:""}),(0,u.bF)(N,{prop:"employeeName",label:"å§“å",width:"120",sortable:""}),(0,u.bF)(N,{prop:"department",label:"éƒ¨é–€",width:"150",sortable:""}),(0,u.bF)(N,{prop:"area",label:"åœ°å€",width:"100",sortable:""}),(0,u.bF)(N,{prop:"mealAllowanceTotal",label:"åŠ ç­èª¤é¤è²»",width:"120",sortable:"",formatter:R}),(0,u.bF)(N,{prop:"overtimeHours0To2",label:"åŠ ç­å‰2å°æ™‚",width:"120",sortable:"",formatter:V}),(0,u.bF)(N,{prop:"overtimeHours2Plus",label:"åŠ ç­2å°æ™‚ä»¥ä¸Š",width:"130",sortable:"",formatter:V}),(0,u.bF)(N,{prop:"overtimeRecordsCount",label:"åŠ ç­æ¬¡æ•¸",width:"100",sortable:""}),(0,u.bF)(N,{label:"æ“ä½œ",width:"100",fixed:"right"},{default:(0,u.k6)((e=>[(0,u.bF)($,{type:"primary",size:"small",onClick:(0,t.D$)((a=>k(e.row)),["stop"])},{default:(0,u.k6)((()=>b[15]||(b[15]=[(0,u.eW)(" è©³ç´° ")]))),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])),[[P,a.value]])]),(0,u.bF)(M,{modelValue:n.value,"onUpdate:modelValue":b[3]||(b[3]=e=>n.value=e),title:`${m.value?.employeeName} çš„åŠ ç­è¨˜éŒ„è©³ç´°`,width:"80%","before-close":_},{footer:(0,u.k6)((()=>[(0,u.Lk)("span",ly,[(0,u.bF)($,{onClick:_},{default:(0,u.k6)((()=>b[17]||(b[17]=[(0,u.eW)("é—œé–‰")]))),_:1})])])),default:(0,u.k6)((()=>[(0,u.bo)(((0,u.uX)(),(0,u.Wv)(X,{data:p.value,stripe:"",border:"",style:{width:"100%"},class:"detail-table"},{default:(0,u.k6)((()=>[(0,u.bF)(N,{prop:"documentNumber",label:"å–®è™Ÿ",width:"150",sortable:""},{default:(0,u.k6)((e=>[e.row.documentNumber?((0,u.uX)(),(0,u.Wv)(K,{key:0,type:"info"},{default:(0,u.k6)((()=>[(0,u.eW)((0,L.v_)(e.row.documentNumber),1)])),_:2},1024)):((0,u.uX)(),(0,u.CE)("span",ay,"ç„¡å–®è™Ÿ"))])),_:1}),(0,u.bF)(N,{prop:"actualOvertimeDate",label:"åŠ ç­æ—¥æœŸ",width:"120"},{default:(0,u.k6)((e=>[(0,u.eW)((0,L.v_)(I(e.row.actualOvertimeDate)),1)])),_:1}),(0,u.bF)(N,{label:"åŠ ç­æ™‚é–“",width:"200"},{default:(0,u.k6)((e=>[(0,u.eW)((0,L.v_)(x(e.row.actualOvertimeStartTime,e.row.actualOvertimeEndTime)),1)])),_:1}),(0,u.bF)(N,{prop:"actualMealAllowance",label:"èª¤é¤è²»",width:"100",formatter:R}),(0,u.bF)(N,{label:"åŠ ç­æ™‚æ•¸",width:"100"},{default:(0,u.k6)((e=>[(0,u.eW)((0,L.v_)(E(e.row.actualOvertimeHours,e.row.actualOvertimeMinutes)),1)])),_:1}),(0,u.bF)(N,{prop:"actualOvertimeContent",label:"åŠ ç­å…§å®¹","min-width":"200"}),(0,u.bF)(N,{label:"æ“ä½œ",width:"120",fixed:"right"},{default:(0,u.k6)((e=>[(0,u.bF)($,{type:"primary",size:"small",onClick:(0,t.D$)((a=>A(e.row)),["stop"]),disabled:!e.row.documentNumber},{default:(0,u.k6)((()=>b[16]||(b[16]=[(0,u.eW)(" æŸ¥çœ‹å–®æ“š ")]))),_:2},1032,["onClick","disabled"])])),_:1})])),_:1},8,["data"])),[[P,o.value]])])),_:1},8,["modelValue","title"]),(0,u.bF)(en,{visible:v.value,doc:g.value,"onUpdate:visible":b[4]||(b[4]=e=>v.value=e),onClose:T},null,8,["visible","doc"])])}}};const oy=(0,ie.A)(ty,[["__scopeId","data-v-d865b6e2"]]);var ny=oy;const ry={class:"leave-page-info"},sy={class:"header-section"},uy={class:"filter-section"},iy={class:"filter-row"},dy={class:"filter-item"},cy={class:"filter-row"},py={class:"filter-item"},my={class:"filter-item"},vy={class:"filter-item"},by={class:"table-section"},gy={key:0},yy={key:1,class:"no-documents"},fy={class:"dialog-footer"};var hy={__name:"LeavePageInfo",setup(e){const a=(0,d.KR)(!1),l=(0,d.KR)(!1),o=(0,d.KR)(!1),n=(0,d.KR)(!1),r=(0,d.KR)(""),s=(0,d.KR)((new Date).getFullYear().toString()),i=(0,d.KR)(((new Date).getMonth()+1).toString()),c=(0,d.KR)([]),p=(0,d.KR)([]),m=(0,d.KR)(null),v=(0,d.KR)(!1),b=(0,d.KR)(null),g=(0,u.EW)((()=>{const e=(new Date).getFullYear(),a=[];for(let l=e;l>=e-4;l--)a.push(l.toString());return a})),y=(0,u.EW)((()=>[{label:"1æœˆ",value:"1"},{label:"2æœˆ",value:"2"},{label:"3æœˆ",value:"3"},{label:"4æœˆ",value:"4"},{label:"5æœˆ",value:"5"},{label:"6æœˆ",value:"6"},{label:"7æœˆ",value:"7"},{label:"8æœˆ",value:"8"},{label:"9æœˆ",value:"9"},{label:"10æœˆ",value:"10"},{label:"11æœˆ",value:"11"},{label:"12æœˆ",value:"12"}])),f=async()=>{a.value=!0;try{const e={area:r.value||void 0,year:s.value||void 0,month:i.value||void 0},a=await Wa.getLeavePageInfo(e);a.data.success?c.value=a.data.data:D.nk.error("å–å¾—è«‹å‡è³‡æ–™å¤±æ•—")}catch(e){console.error("å–å¾—è«‹å‡è³‡æ–™éŒ¯èª¤:",e),D.nk.error("å–å¾—è«‹å‡è³‡æ–™æ™‚ç™¼ç”ŸéŒ¯èª¤")}finally{a.value=!1}},h=e=>{m.value=e,n.value=!0;const a=[{leaveType:"ç‰¹ä¼‘",hours:e.annualLeave,documents:e.annualLeaveDocuments},{leaveType:"ç—…å‡",hours:e.sickLeave,documents:e.sickLeaveDocuments},{leaveType:"äº‹å‡",hours:e.personalLeave,documents:e.personalLeaveDocuments},{leaveType:"ç”Ÿç†å‡",hours:e.menstrualLeave,documents:e.menstrualLeaveDocuments},{leaveType:"å…¬å‡",hours:e.officialLeave,documents:e.officialLeaveDocuments},{leaveType:"å·¥å‚·å‡",hours:e.workInjuryLeave,documents:e.workInjuryLeaveDocuments},{leaveType:"å®¶åº­ç…§é¡§å‡",hours:e.familyCareLeave,documents:e.familyCareLeaveDocuments},{leaveType:"å©šå‡",hours:e.marriageLeave,documents:e.marriageLeaveDocuments},{leaveType:"ç”¢å‡",hours:e.maternityLeave,documents:e.maternityLeaveDocuments},{leaveType:"ç”¢æª¢å‡",hours:e.prenatalCheckupLeave,documents:e.prenatalCheckupLeaveDocuments},{leaveType:"é™ªç”¢å‡",hours:e.paternityLeave,documents:e.paternityLeaveDocuments},{leaveType:"å–ªå‡",hours:e.funeralLeave,documents:e.funeralLeaveDocuments},{leaveType:"è¬€è·å‡",hours:e.jobSeekingLeave,documents:e.jobSeekingLeaveDocuments}].filter((e=>e.hours>0));p.value=a},k=()=>{n.value=!1,m.value=null,p.value=[]},_=async e=>{try{const a=await pl.getDocDetail("LR",e);console.log("æ ¹æ“šå–®æ“šIDç²å–å–®æ“šè©³ç´°è³‡è¨Š:",a.data),a.data&&a.data.id?(b.value={documentID:e,documentTypeID:"LR"},v.value=!0):D.nk.error("ç²å–å–®æ“šè©³ç´°è³‡è¨Šå¤±æ•—")}catch(a){console.error("ç²å–å–®æ“šè©³ç´°è³‡è¨ŠéŒ¯èª¤:",a),D.nk.error("ç²å–å–®æ“šè©³ç´°è³‡è¨Šæ™‚ç™¼ç”ŸéŒ¯èª¤")}},w=()=>{v.value=!1,b.value=null},F=()=>{if(0!==c.value.length){l.value=!0;try{const e=c.value.map((e=>({"å·¥è™Ÿ":e.employeeId,"å§“å":e.employeeName,"éƒ¨é–€":e.department,"åœ°å€":e.area,"ç‰¹ä¼‘":e.annualLeave||0,"ç—…å‡":e.sickLeave||0,"äº‹å‡":e.personalLeave||0,"ç”Ÿç†å‡":e.menstrualLeave||0,"å…¬å‡":e.officialLeave||0,"å·¥å‚·å‡":e.workInjuryLeave||0,"å®¶åº­ç…§é¡§å‡":e.familyCareLeave||0,"å©šå‡":e.marriageLeave||0,"ç”¢å‡":e.maternityLeave||0,"ç”¢æª¢å‡":e.prenatalCheckupLeave||0,"é™ªç”¢å‡":e.paternityLeave||0,"å–ªå‡":e.funeralLeave||0,"è¬€è·å‡":e.jobSeekingLeave||0,"ç¸½è¨ˆæ™‚æ•¸":e.totalLeaveHours||0}))),a=zg.Wp.json_to_sheet(e),l=zg.Wp.book_new();zg.Wp.book_append_sheet(l,a,"è«‹å‡è³‡æ–™");const t=[{wch:10},{wch:15},{wch:20},{wch:10},{wch:8},{wch:8},{wch:8},{wch:8},{wch:8},{wch:8},{wch:12},{wch:8},{wch:8},{wch:8},{wch:8},{wch:8},{wch:8},{wch:10}];a["!cols"]=t;const o=[];if(r.value){const e="south"===r.value?"å—éƒ¨":"north"===r.value?"åŒ—éƒ¨":"å…¨éƒ¨";o.push(`äººå“¡å€åŸŸï¼š${e}`)}if(s.value&&o.push(`å¹´ä»½ï¼š${s.value}`),i.value){const e=y.value.find((e=>e.value===i.value))?.label||i.value;o.push(`æœˆä»½ï¼š${e}`)}const n=(new Date).toISOString().slice(0,10),u=o.length>0?`_${o.join("_")}`:"",d=`è«‹å‡è³‡æ–™${u}_${n}.xlsx`;zg._h(l,d),D.nk.success("Excelæª”æ¡ˆå·²ä¸‹è¼‰")}catch(e){console.error("åŒ¯å‡ºExceléŒ¯èª¤:",e),D.nk.error("åŒ¯å‡ºExcelæ™‚ç™¼ç”ŸéŒ¯èª¤")}finally{l.value=!1}}else D.nk.warning("æ²’æœ‰è³‡æ–™å¯ä»¥åŒ¯å‡º")},C=()=>{if(0!==c.value.length)try{const e=R(),a=window.open("","_blank");a.document.write(e),a.document.close(),a.onload=()=>{a.print(),a.close()},D.nk.success("åˆ—å°è¦–çª—å·²é–‹å•Ÿ")}catch(e){console.error("åˆ—å°å¤±æ•—:",e),D.nk.error("åˆ—å°å¤±æ•—")}else D.nk.warning("æ²’æœ‰è³‡æ–™å¯ä»¥åˆ—å°")},R=()=>{const e=(new Date).toLocaleDateString("zh-TW"),a=(new Date).toLocaleTimeString("zh-TW"),l=[];if(r.value){const e="south"===r.value?"å—éƒ¨":"north"===r.value?"åŒ—éƒ¨":"å…¨éƒ¨";l.push(`äººå“¡å€åŸŸï¼š${e}`)}if(s.value&&l.push(`å¹´ä»½ï¼š${s.value}`),i.value){const e=y.value.find((e=>e.value===i.value))?.label||i.value;l.push(`æœˆä»½ï¼š${e}`)}let t=`\n    <!DOCTYPE html>\n    <html>\n    <head>\n      <meta charset="UTF-8">\n      <title>è«‹å‡é é¢è³‡è¨Š</title>\n      <style>\n        @page {\n          size: A4 landscape;\n          margin: 15mm;\n        }\n        body { \n          font-family: 'Microsoft JhengHei', Arial, sans-serif; \n          margin: 10px; \n          font-size: 10px;\n          line-height: 1.3;\n        }\n        .header { \n          text-align: center; \n          margin-bottom: 15px; \n          border-bottom: 2px solid #333;\n          padding-bottom: 8px;\n        }\n        .header h1 { \n          margin: 0; \n          font-size: 16px; \n          color: #333;\n        }\n        .print-info { \n          text-align: right; \n          margin-bottom: 10px; \n          font-size: 9px;\n          color: #666;\n        }\n        .query-conditions {\n          margin-bottom: 10px;\n          padding: 8px;\n          background-color: #f5f5f5;\n          border-radius: 4px;\n          font-size: 9px;\n        }\n        .query-conditions h3 {\n          margin: 0 0 8px 0;\n          font-size: 12px;\n        }\n        .condition-item {\n          display: inline-block;\n          margin-right: 15px;\n          margin-bottom: 3px;\n        }\n        table { \n          width: 100%; \n          border-collapse: collapse; \n          margin-bottom: 15px;\n          table-layout: fixed;\n        }\n        th, td { \n          border: 1px solid #ddd; \n          padding: 4px; \n          text-align: left;\n          font-size: 9px;\n          word-wrap: break-word;\n          overflow: hidden;\n        }\n        th { \n          background-color: #f2f2f2; \n          font-weight: bold;\n          text-align: center;\n          font-size: 10px;\n        }\n        /* è¨­å®šå„æ¬„ä½å¯¬åº¦ */\n        .col-id { width: 8%; }\n        .col-name { width: 12%; }\n        .col-dept { width: 15%; }\n        .col-area { width: 8%; }\n        .col-range { width: 30%; }\n        .col-type { width: 12%; }\n        .col-hours { width: 10%; }\n        \n        .number { text-align: right; }\n        .center { text-align: center; }\n        .summary {\n          margin-top: 10px;\n          text-align: right;\n          font-weight: bold;\n          font-size: 11px;\n        }\n        @media print {\n          body { \n            margin: 0; \n            -webkit-print-color-adjust: exact;\n            print-color-adjust: exact;\n          }\n          .no-print { display: none; }\n          @page {\n            size: A4 landscape;\n            margin: 10mm;\n          }\n        }\n      </style>\n    </head>\n    <body>\n      <div class="header">\n        <h1>è«‹å‡é é¢è³‡è¨Š</h1>\n      </div>\n      \n      <div class="print-info">\n        åˆ—å°æ—¥æœŸï¼š${e} ${a}\n      </div>\n      \n      <div class="query-conditions">\n        <h3>æŸ¥è©¢æ¢ä»¶ï¼š</h3>\n        ${l.length>0?l.map((e=>`<span class="condition-item">${e}</span>`)).join(""):'<span class="condition-item">å…¨éƒ¨è³‡æ–™</span>'}\n      </div>\n      \n      <table>\n        <thead>\n          <tr>\n            <th class="col-id">å·¥è™Ÿ</th>\n            <th class="col-name">å§“å</th>\n            <th class="col-dept">éƒ¨é–€</th>\n            <th class="col-area">åœ°å€</th>\n            <th class="col-leave">ç‰¹ä¼‘</th>\n            <th class="col-leave">ç—…å‡</th>\n            <th class="col-leave">äº‹å‡</th>\n            <th class="col-leave">ç”Ÿç†å‡</th>\n            <th class="col-leave">å…¬å‡</th>\n            <th class="col-leave">å·¥å‚·å‡</th>\n            <th class="col-leave">å®¶åº­ç…§é¡§å‡</th>\n            <th class="col-leave">å©šå‡</th>\n            <th class="col-leave">ç”¢å‡</th>\n            <th class="col-leave">ç”¢æª¢å‡</th>\n            <th class="col-leave">é™ªç”¢å‡</th>\n            <th class="col-leave">å–ªå‡</th>\n            <th class="col-leave">è¬€è·å‡</th>\n            <th class="col-total">ç¸½è¨ˆæ™‚æ•¸</th>\n          </tr>\n        </thead>\n        <tbody>\n  `;c.value.forEach((e=>{t+=`\n      <tr>\n        <td class="col-id center">${e.employeeId||""}</td>\n        <td class="col-name">${e.employeeName||""}</td>\n        <td class="col-dept">${e.department||""}</td>\n        <td class="col-area center">${e.area||""}</td>\n        <td class="col-leave number">${(e.annualLeave||0).toFixed(1)}h</td>\n        <td class="col-leave number">${(e.sickLeave||0).toFixed(1)}h</td>\n        <td class="col-leave number">${(e.personalLeave||0).toFixed(1)}h</td>\n        <td class="col-leave number">${(e.menstrualLeave||0).toFixed(1)}h</td>\n        <td class="col-leave number">${(e.officialLeave||0).toFixed(1)}h</td>\n        <td class="col-leave number">${(e.workInjuryLeave||0).toFixed(1)}h</td>\n        <td class="col-leave number">${(e.familyCareLeave||0).toFixed(1)}h</td>\n        <td class="col-leave number">${(e.marriageLeave||0).toFixed(1)}h</td>\n        <td class="col-leave number">${(e.maternityLeave||0).toFixed(1)}h</td>\n        <td class="col-leave number">${(e.prenatalCheckupLeave||0).toFixed(1)}h</td>\n        <td class="col-leave number">${(e.paternityLeave||0).toFixed(1)}h</td>\n        <td class="col-leave number">${(e.funeralLeave||0).toFixed(1)}h</td>\n        <td class="col-leave number">${(e.jobSeekingLeave||0).toFixed(1)}h</td>\n        <td class="col-total number">${(e.totalLeaveHours||0).toFixed(1)}h</td>\n      </tr>\n    `}));const o=c.value.reduce(((e,a)=>e+(a.totalLeaveHours||0)),0);return t+=`\n        </tbody>\n      </table>\n      \n      <div class="summary">\n        <div>ç¸½ç­†æ•¸ï¼š${c.value.length} ç­†</div>\n        <div>è«‹å‡æ™‚æ•¸ç¸½è¨ˆï¼š${o.toFixed(1)}h</div>\n      </div>\n    </body>\n    </html>\n  `,t};return(0,u.sV)((()=>{f()})),(e,D)=>{const R=(0,u.g2)("el-radio"),V=(0,u.g2)("el-radio-group"),I=(0,u.g2)("el-option"),x=(0,u.g2)("el-select"),E=(0,u.g2)("el-icon"),A=(0,u.g2)("el-button"),T=(0,u.g2)("el-table-column"),W=(0,u.g2)("el-table"),S=(0,u.g2)("el-tag"),U=(0,u.g2)("el-dialog"),$=(0,u.gN)("loading");return(0,u.uX)(),(0,u.CE)("div",ry,[(0,u.Lk)("div",sy,[D[14]||(D[14]=(0,u.Lk)("h2",null,"è«‹å‡é é¢è³‡è¨Š",-1)),(0,u.Lk)("div",uy,[(0,u.Lk)("div",iy,[(0,u.Lk)("div",dy,[D[8]||(D[8]=(0,u.Lk)("label",null,"äººå“¡å€åŸŸï¼š",-1)),(0,u.bF)(V,{modelValue:r.value,"onUpdate:modelValue":D[0]||(D[0]=e=>r.value=e),onChange:f},{default:(0,u.k6)((()=>[(0,u.bF)(R,{label:""},{default:(0,u.k6)((()=>D[5]||(D[5]=[(0,u.eW)("å…¨éƒ¨")]))),_:1}),(0,u.bF)(R,{label:"south"},{default:(0,u.k6)((()=>D[6]||(D[6]=[(0,u.eW)("å—éƒ¨")]))),_:1}),(0,u.bF)(R,{label:"north"},{default:(0,u.k6)((()=>D[7]||(D[7]=[(0,u.eW)("åŒ—éƒ¨")]))),_:1})])),_:1},8,["modelValue"])])]),(0,u.Lk)("div",cy,[(0,u.Lk)("div",py,[D[9]||(D[9]=(0,u.Lk)("label",null,"å¹´ä»½ï¼š",-1)),(0,u.bF)(x,{modelValue:s.value,"onUpdate:modelValue":D[1]||(D[1]=e=>s.value=e),placeholder:"é¸æ“‡å¹´ä»½",onChange:f,style:{width:"5rem"}},{default:(0,u.k6)((()=>[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(g.value,(e=>((0,u.uX)(),(0,u.Wv)(I,{key:e,label:e,value:e},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])]),(0,u.Lk)("div",my,[D[10]||(D[10]=(0,u.Lk)("label",null,"æœˆä»½ï¼š",-1)),(0,u.bF)(x,{modelValue:i.value,"onUpdate:modelValue":D[2]||(D[2]=e=>i.value=e),placeholder:"é¸æ“‡æœˆä»½",onChange:f,style:{width:"5rem"}},{default:(0,u.k6)((()=>[(0,u.bF)(I,{label:"å…¨å¹´",value:""}),((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(y.value,(e=>((0,u.uX)(),(0,u.Wv)(I,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])]),(0,u.Lk)("div",vy,[(0,u.bF)(A,{type:"primary",onClick:f,loading:a.value},{default:(0,u.k6)((()=>[(0,u.bF)(E,null,{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.Search))])),_:1}),D[11]||(D[11]=(0,u.eW)(" æŸ¥è©¢ "))])),_:1},8,["loading"]),(0,u.bF)(A,{type:"success",onClick:F,loading:l.value},{default:(0,u.k6)((()=>[(0,u.bF)(E,null,{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.Download))])),_:1}),D[12]||(D[12]=(0,u.eW)(" åŒ¯å‡ºExcel "))])),_:1},8,["loading"]),(0,u.bF)(A,{type:"info",onClick:C},{default:(0,u.k6)((()=>[(0,u.bF)(E,null,{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.Printer))])),_:1}),D[13]||(D[13]=(0,u.eW)(" åˆ—å° "))])),_:1})])])])]),(0,u.Lk)("div",by,[(0,u.bo)(((0,u.uX)(),(0,u.Wv)(W,{data:c.value,stripe:"",border:"",style:{width:"100%"},"default-sort":{prop:"leaveStartDate",order:"descending"},onRowClick:h,class:"leave-table"},{default:(0,u.k6)((()=>[(0,u.bF)(T,{prop:"employeeId",label:"å·¥è™Ÿ",width:"100",sortable:""}),(0,u.bF)(T,{prop:"employeeName",label:"å§“å",width:"120",sortable:""}),(0,u.bF)(T,{prop:"department",label:"éƒ¨é–€",width:"150",sortable:""}),(0,u.bF)(T,{prop:"area",label:"åœ°å€",width:"100",sortable:""}),(0,u.bF)(T,{prop:"annualLeave",label:"ç‰¹ä¼‘",width:"80",sortable:""},{default:(0,u.k6)((e=>[(0,u.eW)((0,L.v_)(e.row.annualLeave)+"h ",1)])),_:1}),(0,u.bF)(T,{prop:"sickLeave",label:"ç—…å‡",width:"80",sortable:""},{default:(0,u.k6)((e=>[(0,u.eW)((0,L.v_)(e.row.sickLeave)+"h ",1)])),_:1}),(0,u.bF)(T,{prop:"personalLeave",label:"äº‹å‡",width:"80",sortable:""},{default:(0,u.k6)((e=>[(0,u.eW)((0,L.v_)(e.row.personalLeave)+"h ",1)])),_:1}),(0,u.bF)(T,{prop:"menstrualLeave",label:"ç”Ÿç†å‡",width:"80",sortable:""},{default:(0,u.k6)((e=>[(0,u.eW)((0,L.v_)(e.row.menstrualLeave)+"h ",1)])),_:1}),(0,u.bF)(T,{prop:"officialLeave",label:"å…¬å‡",width:"80",sortable:""},{default:(0,u.k6)((e=>[(0,u.eW)((0,L.v_)(e.row.officialLeave)+"h ",1)])),_:1}),(0,u.bF)(T,{prop:"workInjuryLeave",label:"å·¥å‚·å‡",width:"80",sortable:""},{default:(0,u.k6)((e=>[(0,u.eW)((0,L.v_)(e.row.workInjuryLeave)+"h ",1)])),_:1}),(0,u.bF)(T,{prop:"familyCareLeave",label:"å®¶åº­ç…§é¡§å‡",width:"100",sortable:""},{default:(0,u.k6)((e=>[(0,u.eW)((0,L.v_)(e.row.familyCareLeave)+"h ",1)])),_:1}),(0,u.bF)(T,{prop:"marriageLeave",label:"å©šå‡",width:"80",sortable:""},{default:(0,u.k6)((e=>[(0,u.eW)((0,L.v_)(e.row.marriageLeave)+"h ",1)])),_:1}),(0,u.bF)(T,{prop:"maternityLeave",label:"ç”¢å‡",width:"80",sortable:""},{default:(0,u.k6)((e=>[(0,u.eW)((0,L.v_)(e.row.maternityLeave)+"h ",1)])),_:1}),(0,u.bF)(T,{prop:"prenatalCheckupLeave",label:"ç”¢æª¢å‡",width:"80",sortable:""},{default:(0,u.k6)((e=>[(0,u.eW)((0,L.v_)(e.row.prenatalCheckupLeave)+"h ",1)])),_:1}),(0,u.bF)(T,{prop:"paternityLeave",label:"é™ªç”¢å‡",width:"80",sortable:""},{default:(0,u.k6)((e=>[(0,u.eW)((0,L.v_)(e.row.paternityLeave)+"h ",1)])),_:1}),(0,u.bF)(T,{prop:"funeralLeave",label:"å–ªå‡",width:"80",sortable:""},{default:(0,u.k6)((e=>[(0,u.eW)((0,L.v_)(e.row.funeralLeave)+"h ",1)])),_:1}),(0,u.bF)(T,{prop:"jobSeekingLeave",label:"è¬€è·å‡",width:"80",sortable:""},{default:(0,u.k6)((e=>[(0,u.eW)((0,L.v_)(e.row.jobSeekingLeave)+"h ",1)])),_:1}),(0,u.Q3)("",!0),(0,u.bF)(T,{label:"æ“ä½œ",width:"100",fixed:"right"},{default:(0,u.k6)((e=>[(0,u.bF)(A,{type:"primary",size:"small",onClick:(0,t.D$)((a=>h(e.row)),["stop"])},{default:(0,u.k6)((()=>D[15]||(D[15]=[(0,u.eW)(" è©³ç´° ")]))),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])),[[$,a.value]])]),(0,u.bF)(U,{modelValue:n.value,"onUpdate:modelValue":D[3]||(D[3]=e=>n.value=e),title:`${m.value?.employeeName} çš„è«‹å‡è¨˜éŒ„è©³ç´°`,width:"50%","before-close":k},{footer:(0,u.k6)((()=>[(0,u.Lk)("span",fy,[(0,u.bF)(A,{onClick:k},{default:(0,u.k6)((()=>D[16]||(D[16]=[(0,u.eW)("é—œé–‰")]))),_:1})])])),default:(0,u.k6)((()=>[(0,u.bo)(((0,u.uX)(),(0,u.Wv)(W,{data:p.value,stripe:"",border:"",style:{width:"100%"},class:"detail-table"},{default:(0,u.k6)((()=>[(0,u.bF)(T,{prop:"leaveType",label:"å‡åˆ¥",width:"120"}),(0,u.bF)(T,{prop:"hours",label:"è«‹å‡æ™‚æ•¸",width:"100"},{default:(0,u.k6)((e=>[(0,u.eW)((0,L.v_)(e.row.hours)+"h ",1)])),_:1}),(0,u.bF)(T,{prop:"documents",label:"å–®æ“š","min-width":"200"},{default:(0,u.k6)((e=>[e.row.documents&&e.row.documents.length>0?((0,u.uX)(),(0,u.CE)("div",gy,[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(e.row.documents,(e=>((0,u.uX)(),(0,u.Wv)(S,{key:e,type:"primary",class:"document-tag",onClick:a=>_(e),style:{cursor:"pointer","margin-right":"5px","margin-bottom":"2px"}},{default:(0,u.k6)((()=>[(0,u.eW)((0,L.v_)(e),1)])),_:2},1032,["onClick"])))),128))])):((0,u.uX)(),(0,u.CE)("span",yy,"ç„¡å–®æ“š"))])),_:1})])),_:1},8,["data"])),[[$,o.value]])])),_:1},8,["modelValue","title"]),(0,u.bF)(en,{visible:v.value,doc:b.value,"onUpdate:visible":D[4]||(D[4]=e=>v.value=e),onClose:w},null,8,["visible","doc"])])}}};const ky=(0,ie.A)(hy,[["__scopeId","data-v-21aa9076"]]);var _y=ky,wy={__name:"sys_MacForm",setup(e){return(e,a)=>((0,u.uX)(),(0,u.Wv)((0,d.R1)(Kr),{sysMode:!0}))}};const Fy=wy;var Cy=Fy,Dy={__name:"sys_ComputerInventory",setup(e){return(e,a)=>((0,u.uX)(),(0,u.Wv)(fp,{sysMode:!0}))}};const Ly=Dy;var Ry=Ly;const Vy={class:"tool-bar",style:{display:"flex","justify-content":"left",height:"2.5rem","margin-right":"10px","margin-bottom":"1rem",gap:"1rem"}},Iy={class:"dialog-footer"};var xy={__name:"DAE_UserTable",setup(e){const a=(0,d.KR)(""),l=(0,u.EW)((()=>{const e=a.value.toLowerCase();return o.value.filter((a=>a.id&&a.id.toLowerCase().includes(e)||a.name&&a.name.toLowerCase().includes(e)))})),t=(0,d.KR)({currentPage:1,pageSize:15,total:0}),o=(0,d.KR)([]),n=(0,d.KR)(!1),r=(0,d.KR)({id:"",name:"",password_hash:"",email:"",status:""}),s=(0,d.KR)(!1),i=()=>{s.value=!1,r.value={id:"",name:"",password_hash:"",email:"",status:""},n.value=!0},c=e=>{s.value=!0,r.value={...e},n.value=!0},p=async()=>{try{s.value?(await ja.updateUser(r.value),D.nk.success("ä½¿ç”¨è€…æ›´æ–°æˆåŠŸï¼")):(await ja.addUser(r.value),D.nk.success("ä½¿ç”¨è€…æ–°å¢žæˆåŠŸï¼")),n.value=!1;const e=await ja.getUserData();o.value=e.data,v()}catch(e){console.error("å„²å­˜ä½¿ç”¨è€…éŒ¯èª¤ï¼š",e),D.nk.error("å„²å­˜ä½¿ç”¨è€…å¤±æ•—ã€‚")}},m=async e=>{try{await ja.deleteUser(e),D.nk.success("ä½¿ç”¨è€…åˆªé™¤æˆåŠŸï¼");const a=await ja.getUserData();o.value=a.data,v()}catch(a){console.error("åˆªé™¤ä½¿ç”¨è€…éŒ¯èª¤ï¼š",a),D.nk.error("åˆªé™¤ä½¿ç”¨è€…å¤±æ•—ã€‚")}},v=()=>{t.value.currentPage=1};return(0,u.sV)((async()=>{try{const e=await ja.getUserData();o.value=e.data,v()}catch(e){console.error("ç²å–è³‡æ–™éŒ¯èª¤ï¼š",e)}})),(e,t)=>{const o=(0,u.g2)("el-input"),d=(0,u.g2)("Plus"),v=(0,u.g2)("el-icon"),b=(0,u.g2)("el-button"),g=(0,u.g2)("el-table-column"),y=(0,u.g2)("el-table"),f=(0,u.g2)("el-form-item"),h=(0,u.g2)("el-option"),k=(0,u.g2)("el-select"),_=(0,u.g2)("el-form"),w=(0,u.g2)("el-dialog");return(0,u.uX)(),(0,u.CE)("div",null,[(0,u.Lk)("div",Vy,[(0,u.bF)(o,{modelValue:a.value,"onUpdate:modelValue":t[0]||(t[0]=e=>a.value=e),placeholder:"ä¾ å¸³è™Ÿ æˆ– åç¨±æœå°‹",style:{width:"10rem"}},null,8,["modelValue"]),(0,u.bF)(b,{type:"success",onClick:i,style:{height:"2.5rem","font-size":"1rem"},round:""},{default:(0,u.k6)((()=>[(0,u.bF)(v,null,{default:(0,u.k6)((()=>[(0,u.bF)(d)])),_:1}),t[8]||(t[8]=(0,u.eW)(" æ–°å¢žä½¿ç”¨è€…å¸³è™Ÿ"))])),_:1})]),(0,u.bF)(y,{data:l.value,style:{width:"100%"}},{default:(0,u.k6)((()=>[(0,u.bF)(g,{prop:"name",label:"å§“å"}),(0,u.bF)(g,{prop:"id",label:"å¸³è™Ÿ"}),(0,u.bF)(g,{prop:"password_hash",label:"å¯†ç¢¼"}),(0,u.bF)(g,{prop:"email",label:"é›»å­éƒµä»¶"}),(0,u.bF)(g,{prop:"status",label:"ç‹€æ…‹"},{default:(0,u.k6)((e=>[(0,u.Lk)("span",null,(0,L.v_)("Active"===e.row.status?"ä½¿ç”¨ä¸­":"Inactive"===e.row.status?"æœªå•Ÿç”¨":e.row.status),1)])),_:1}),(0,u.bF)(g,{label:"æ“ä½œ"},{default:(0,u.k6)((e=>[(0,u.bF)(b,{size:"small",onClick:a=>c(e.row)},{default:(0,u.k6)((()=>t[9]||(t[9]=[(0,u.eW)("ç·¨è¼¯")]))),_:2},1032,["onClick"]),(0,u.bF)(b,{size:"small",type:"danger",onClick:a=>m(e.row.id)},{default:(0,u.k6)((()=>t[10]||(t[10]=[(0,u.eW)("åˆªé™¤")]))),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"]),(0,u.bF)(w,{modelValue:n.value,"onUpdate:modelValue":t[7]||(t[7]=e=>n.value=e),title:s.value?"ç·¨è¼¯ä½¿ç”¨è€…å¸³è™Ÿ":"æ–°å¢žä½¿ç”¨è€…å¸³è™Ÿ",width:"500px"},{footer:(0,u.k6)((()=>[(0,u.Lk)("span",Iy,[(0,u.bF)(b,{onClick:t[6]||(t[6]=e=>n.value=!1)},{default:(0,u.k6)((()=>t[11]||(t[11]=[(0,u.eW)("å–æ¶ˆ")]))),_:1}),(0,u.bF)(b,{type:"primary",onClick:p},{default:(0,u.k6)((()=>t[12]||(t[12]=[(0,u.eW)("å„²å­˜")]))),_:1})])])),default:(0,u.k6)((()=>[(0,u.bF)(_,{model:r.value,"label-width":"120px"},{default:(0,u.k6)((()=>[(0,u.bF)(f,{label:"å¸³è™Ÿ"},{default:(0,u.k6)((()=>[(0,u.bF)(o,{modelValue:r.value.id,"onUpdate:modelValue":t[1]||(t[1]=e=>r.value.id=e),disabled:s.value},null,8,["modelValue","disabled"])])),_:1}),(0,u.bF)(f,{label:"å§“å"},{default:(0,u.k6)((()=>[(0,u.bF)(o,{modelValue:r.value.name,"onUpdate:modelValue":t[2]||(t[2]=e=>r.value.name=e)},null,8,["modelValue"])])),_:1}),(0,u.bF)(f,{label:"å¯†ç¢¼"},{default:(0,u.k6)((()=>[(0,u.bF)(o,{modelValue:r.value.password_hash,"onUpdate:modelValue":t[3]||(t[3]=e=>r.value.password_hash=e),type:"password"},null,8,["modelValue"])])),_:1}),(0,u.bF)(f,{label:"é›»å­éƒµä»¶"},{default:(0,u.k6)((()=>[(0,u.bF)(o,{modelValue:r.value.email,"onUpdate:modelValue":t[4]||(t[4]=e=>r.value.email=e)},null,8,["modelValue"])])),_:1}),(0,u.bF)(f,{label:"å•Ÿç”¨ç‹€æ…‹"},{default:(0,u.k6)((()=>[(0,u.bF)(k,{modelValue:r.value.status,"onUpdate:modelValue":t[5]||(t[5]=e=>r.value.status=e),placeholder:"è«‹é¸æ“‡ç‹€æ…‹",style:{width:"100%"}},{default:(0,u.k6)((()=>[(0,u.bF)(h,{label:"ä½¿ç”¨ä¸­",value:"Active"}),(0,u.bF)(h,{label:"æœªå•Ÿç”¨",value:"Inactive"})])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue","title"])])}}};const Ey=xy;var Ay=Ey;const Ty={class:"tool-bar",style:{display:"flex","justify-content":"left",height:"2.5rem","margin-right":"10px","margin-bottom":"1rem",gap:"1rem"}},Wy={class:"dept"},Sy={class:"title"},Uy={class:"dept"};var $y={__name:"DAE_EmployeeTable",setup(e){const a=(0,d.KR)(""),l=(0,d.KR)([]),t=(0,d.KR)({}),o=(0,d.KR)(!1),n=(0,d.KR)(null),r=(0,d.KR)(!1),s=()=>{r.value=!1,t.value={id:"",name:"",en_name:"",dpt_id:null,title_id:null,ext_group:"",ext_num:"",area_id:null,email:"",startDate:null,endDate:null,birthday:null,sex:"",emp_status:"Active"},o.value=!0},i={id:[{required:!0,message:"å·¥è™Ÿä¸å¯ç‚ºç©º",trigger:"blur"},{validator:(e,a,l)=>{const t=/^(TW|OP)\d{4}$/;t.test(a)?l():l(new Error('é ˆä»¥"TW"ã€"OP" é–‹é ­,ä¸”å…±6ç¢¼'))},trigger:"blur"}],name:[{required:!0,message:"å§“åä¸å¯ç‚ºç©º",trigger:"blur"}],dpt_id:[{required:!0,message:"éƒ¨é–€ä¸å¯ç‚ºç©º",trigger:"change"}],title_id:[{required:!0,message:"è·ç¨±ä¸å¯ç‚ºç©º",trigger:"change"}],area_id:[{required:!0,message:"åœ°å€ä¸å¯ç‚ºç©º",trigger:"change"}],emp_status:[{required:!0,message:"åœ¨è·ç‹€æ…‹ä¸å¯ç‚ºç©º",trigger:"change"}]},c=e=>{r.value=!0,t.value={...e},o.value=!0},p=(0,u.EW)((()=>{const e=a.value.toLowerCase();return l.value.filter((a=>a.id&&a.id.toLowerCase().includes(e)||a.name&&a.name.toLowerCase().includes(e)))})),m=async()=>{if(n.value)try{await n.value.validate((async e=>{if(!e)return D.nk.error("è«‹æª¢æŸ¥å¿…å¡«æ¬„ä½"),!1;{if(r.value)await ja.updateEmployeeData(t.value),D.nk.success("æ›´æ–°æˆåŠŸ"),o.value=!1;else try{let e=await ja.addEmployeeData(t.value);e&&(D.nk.success("æ–°å¢žæˆåŠŸ"),o.value=!1)}catch(a){if(!a.response||409!==a.response.status)throw a;D.nk.error("è©²å·¥è™Ÿå·²å»ºç«‹")}const e=await ja.getEmployeeData();l.value=e.data}}))}catch(e){console.error("æ“ä½œå¤±æ•—:",e),D.nk.error("æ“ä½œå¤±æ•—: "+e.message)}},v=async e=>{try{await Sa.s.confirm("ç¢ºå®šè¦åˆªé™¤æ­¤ç­†è³‡æ–™å—Žï¼Ÿ","æç¤º",{confirmButtonText:"ç¢ºå®š",cancelButtonText:"å–æ¶ˆ",type:"warning"}),await ja.deleteEmployeeData(e.id),D.nk.success("åˆªé™¤æˆåŠŸ");const a=await ja.getEmployeeData();l.value=a.data}catch(a){"cancel"!==a&&(console.error("åˆªé™¤å¤±æ•—:",a),D.nk.error("åˆªé™¤å¤±æ•—: "+a.message))}};(0,u.sV)((async()=>{const e=await ja.getEmployeeData();l.value=e.data}));const b=e=>"Inactive"===e.row.emp_status?"inactive-row":"";return(e,l)=>{const d=(0,u.g2)("el-input"),g=(0,u.g2)("Plus"),y=(0,u.g2)("el-icon"),f=(0,u.g2)("el-button"),h=(0,u.g2)("el-table-column"),k=(0,u.g2)("el-table"),_=(0,u.g2)("el-form-item"),w=(0,u.g2)("el-date-picker"),F=(0,u.g2)("el-option"),C=(0,u.g2)("el-select"),D=(0,u.g2)("el-form"),R=(0,u.g2)("el-dialog");return(0,u.uX)(),(0,u.CE)("div",null,[(0,u.Lk)("div",Ty,[(0,u.bF)(d,{modelValue:a.value,"onUpdate:modelValue":l[0]||(l[0]=e=>a.value=e),placeholder:"å·¥è™Ÿ or å§“å",style:{width:"10rem","margin-right":"10px"}},null,8,["modelValue"]),(0,u.bF)(f,{type:"success",onClick:s,style:{height:"2.5rem","font-size":"1rem"},round:""},{default:(0,u.k6)((()=>[(0,u.bF)(y,null,{default:(0,u.k6)((()=>[(0,u.bF)(g)])),_:1}),l[17]||(l[17]=(0,u.eW)(" æ–°å¢žå“¡å·¥è³‡æ–™ "))])),_:1})]),(0,u.bF)(k,{data:p.value,style:{width:"100%"},"row-class-name":b},{default:(0,u.k6)((()=>[(0,u.bF)(h,{prop:"id",label:"å·¥è™Ÿ",width:"100"}),(0,u.bF)(h,{prop:"name",label:"å§“å",width:"100"}),(0,u.bF)(h,{prop:"en_name",label:"English Name",width:"120"}),(0,u.bF)(h,{label:"éƒ¨é–€",width:"130"},{default:(0,u.k6)((e=>[(0,u.Lk)("span",Wy,[(0,u.bF)(_l,{mode:"Description","dept-id":e.row.dpt_id},null,8,["dept-id"])])])),_:1}),(0,u.bF)(h,{label:"è·ç¨±",width:"150"},{default:(0,u.k6)((e=>[(0,u.Lk)("span",Sy,[(0,u.bF)(Dl,{"title-id":e.row.title_id,mode:"Description"},null,8,["title-id"])])])),_:1}),(0,u.bF)(h,{prop:"ext_group",label:"åˆ†æ©Ÿç¾¤çµ„",width:"80"}),(0,u.bF)(h,{prop:"ext_num",label:"åˆ†æ©Ÿè™Ÿç¢¼",width:"80"}),(0,u.bF)(h,{prop:"area_id",label:"åœ°å€",width:"100"},{default:(0,u.k6)((e=>[(0,u.Lk)("span",Uy,[(0,u.bF)(rt,{areaId:e.row.area_id},null,8,["areaId"])])])),_:1}),(0,u.bF)(h,{prop:"email",label:"ä¿¡ç®±"}),(0,u.bF)(h,{prop:"startDate",label:"åˆ°è·æ—¥æœŸ",width:"120"},{default:(0,u.k6)((e=>[(0,u.Lk)("span",null,(0,L.v_)(e.row.startDate?new Date(e.row.startDate).toLocaleDateString("zh-TW"):""),1)])),_:1}),(0,u.bF)(h,{prop:"endDate",label:"é›¢è·æ—¥æœŸ",width:"120"},{default:(0,u.k6)((e=>[(0,u.Lk)("span",null,(0,L.v_)(e.row.endDate?new Date(e.row.endDate).toLocaleDateString("zh-TW"):""),1)])),_:1}),(0,u.bF)(h,{prop:"birthday",label:"ç”Ÿæ—¥",width:"120"},{default:(0,u.k6)((e=>[(0,u.Lk)("span",null,(0,L.v_)(e.row.birthday?new Date(e.row.birthday).toLocaleDateString("zh-TW"):""),1)])),_:1}),(0,u.bF)(h,{prop:"sex",label:"æ€§åˆ¥",width:"80"},{default:(0,u.k6)((e=>[(0,u.Lk)("span",null,(0,L.v_)("M"===e.row.sex?"ç”·":"F"===e.row.sex?"å¥³":e.row.sex),1)])),_:1}),(0,u.bF)(h,{prop:"emp_status",label:"åœ¨è·ç‹€æ…‹"},{default:(0,u.k6)((e=>[(0,u.Lk)("span",null,(0,L.v_)("Active"===e.row.emp_status?"åœ¨è·":"Inactive"===e.row.emp_status?"é›¢è·":e.row.emp_status),1)])),_:1}),(0,u.bF)(h,{label:"æ“ä½œ"},{default:(0,u.k6)((e=>[(0,u.bF)(f,{type:"primary",onClick:a=>c(e.row)},{default:(0,u.k6)((()=>l[18]||(l[18]=[(0,u.eW)("ç·¨è¼¯")]))),_:2},1032,["onClick"]),(0,u.bF)(f,{type:"danger",onClick:a=>v(e.row)},{default:(0,u.k6)((()=>l[19]||(l[19]=[(0,u.eW)("åˆªé™¤")]))),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"]),(0,u.bF)(R,{modelValue:o.value,"onUpdate:modelValue":l[16]||(l[16]=e=>o.value=e),title:r.value?"ç·¨è¼¯å“¡å·¥è³‡æ–™":"æ–°å¢žå“¡å·¥è³‡æ–™",style:{width:"20rem"}},{footer:(0,u.k6)((()=>[(0,u.bF)(f,{onClick:l[15]||(l[15]=e=>o.value=!1)},{default:(0,u.k6)((()=>l[20]||(l[20]=[(0,u.eW)("å–æ¶ˆ")]))),_:1}),(0,u.bF)(f,{type:"primary",onClick:m},{default:(0,u.k6)((()=>l[21]||(l[21]=[(0,u.eW)("å®Œæˆ")]))),_:1})])),default:(0,u.k6)((()=>[(0,u.bF)(D,{model:t.value,ref_key:"editFormRef",ref:n,rules:i,"label-width":"100px"},{default:(0,u.k6)((()=>[(0,u.bF)(_,{label:"å·¥è™Ÿ",prop:"id"},{default:(0,u.k6)((()=>[(0,u.bF)(d,{modelValue:t.value.id,"onUpdate:modelValue":l[1]||(l[1]=e=>t.value.id=e),disabled:r.value,style:{width:"100%"}},null,8,["modelValue","disabled"])])),_:1}),(0,u.bF)(_,{label:"å§“å",prop:"name"},{default:(0,u.k6)((()=>[(0,u.bF)(d,{modelValue:t.value.name,"onUpdate:modelValue":l[2]||(l[2]=e=>t.value.name=e),style:{width:"100%"}},null,8,["modelValue"])])),_:1}),(0,u.bF)(_,{label:"è‹±æ–‡å§“å"},{default:(0,u.k6)((()=>[(0,u.bF)(d,{modelValue:t.value.en_name,"onUpdate:modelValue":l[3]||(l[3]=e=>t.value.en_name=e),style:{width:"100%"}},null,8,["modelValue"])])),_:1}),(0,u.bF)(_,{label:"éƒ¨é–€ ID",prop:"dpt_id"},{default:(0,u.k6)((()=>[(0,u.bF)(Gn,{modelValue:t.value.dpt_id,"onUpdate:modelValue":l[4]||(l[4]=e=>t.value.dpt_id=e),size:"middle",style:{width:"100%"}},null,8,["modelValue"])])),_:1}),(0,u.bF)(_,{label:"è·ç¨± ID",prop:"title_id"},{default:(0,u.k6)((()=>[(0,u.bF)(su,{modelValue:t.value.title_id,"onUpdate:modelValue":l[5]||(l[5]=e=>t.value.title_id=e),size:"middle",style:{width:"100%"}},null,8,["modelValue"])])),_:1}),(0,u.bF)(_,{label:"åˆ†æ©Ÿç¾¤çµ„"},{default:(0,u.k6)((()=>[(0,u.bF)(d,{modelValue:t.value.ext_group,"onUpdate:modelValue":l[6]||(l[6]=e=>t.value.ext_group=e),style:{width:"100%"}},null,8,["modelValue"])])),_:1}),(0,u.bF)(_,{label:"åˆ†æ©Ÿè™Ÿç¢¼"},{default:(0,u.k6)((()=>[(0,u.bF)(d,{modelValue:t.value.ext_num,"onUpdate:modelValue":l[7]||(l[7]=e=>t.value.ext_num=e),style:{width:"100%"}},null,8,["modelValue"])])),_:1}),(0,u.bF)(_,{label:"åœ°å€ ID",prop:"area_id"},{default:(0,u.k6)((()=>[(0,u.bF)(ar,{modelValue:t.value.area_id,"onUpdate:modelValue":l[8]||(l[8]=e=>t.value.area_id=e),style:{width:"100%"}},null,8,["modelValue"])])),_:1}),(0,u.bF)(_,{label:"é›»å­éƒµä»¶"},{default:(0,u.k6)((()=>[(0,u.bF)(d,{modelValue:t.value.email,"onUpdate:modelValue":l[9]||(l[9]=e=>t.value.email=e),style:{width:"100%"}},null,8,["modelValue"])])),_:1}),(0,u.bF)(_,{label:"åˆ°è·æ—¥æœŸ"},{default:(0,u.k6)((()=>[(0,u.bF)(w,{modelValue:t.value.startDate,"onUpdate:modelValue":l[10]||(l[10]=e=>t.value.startDate=e),type:"date",placeholder:"é¸æ“‡åˆ°è·æ—¥æœŸ",style:{width:"100%"},format:"YYYY/MM/DD","value-format":"YYYY-MM-DDTHH:mm:ss"},null,8,["modelValue"])])),_:1}),(0,u.bF)(_,{label:"é›¢è·æ—¥æœŸ"},{default:(0,u.k6)((()=>[(0,u.bF)(w,{modelValue:t.value.endDate,"onUpdate:modelValue":l[11]||(l[11]=e=>t.value.endDate=e),type:"date",placeholder:"é¸æ“‡é›¢è·æ—¥æœŸ",style:{width:"100%"},format:"YYYY/MM/DD","value-format":"YYYY-MM-DDTHH:mm:ss"},null,8,["modelValue"])])),_:1}),(0,u.bF)(_,{label:"ç”Ÿæ—¥"},{default:(0,u.k6)((()=>[(0,u.bF)(w,{modelValue:t.value.birthday,"onUpdate:modelValue":l[12]||(l[12]=e=>t.value.birthday=e),type:"date",placeholder:"é¸æ“‡ç”Ÿæ—¥",style:{width:"100%"},format:"YYYY/MM/DD","value-format":"YYYY-MM-DDTHH:mm:ss"},null,8,["modelValue"])])),_:1}),(0,u.bF)(_,{label:"æ€§åˆ¥"},{default:(0,u.k6)((()=>[(0,u.bF)(C,{modelValue:t.value.sex,"onUpdate:modelValue":l[13]||(l[13]=e=>t.value.sex=e),placeholder:"è«‹é¸æ“‡æ€§åˆ¥",style:{width:"100%"}},{default:(0,u.k6)((()=>[(0,u.bF)(F,{label:"ç”·",value:"M"}),(0,u.bF)(F,{label:"å¥³",value:"F"})])),_:1},8,["modelValue"])])),_:1}),(0,u.bF)(_,{label:"åœ¨è·ç‹€æ…‹",prop:"emp_status"},{default:(0,u.k6)((()=>[(0,u.bF)(C,{modelValue:t.value.emp_status,"onUpdate:modelValue":l[14]||(l[14]=e=>t.value.emp_status=e),placeholder:"è«‹é¸æ“‡ç‹€æ…‹",style:{width:"100%"}},{default:(0,u.k6)((()=>[(0,u.bF)(F,{label:"åœ¨è·",value:"Active"}),(0,u.bF)(F,{label:"é›¢è·",value:"Inactive"})])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue","title"])])}}};const Ny=(0,ie.A)($y,[["__scopeId","data-v-5b5606d1"]]);var Xy=Ny;const Ky={class:"tool-bar",style:{display:"flex","justify-content":"left",height:"2.5rem","margin-right":"10px","margin-bottom":"1rem",gap:"1rem"}},My={class:"dialog-footer"};var Py={__name:"DAE_PermissionTable",setup(e){const a=(0,d.KR)(""),l=(0,d.KR)({currentPage:1,pageSize:15,total:0}),t=(0,d.KR)([]),o=(0,d.KR)(!1),n=(0,d.KR)({id:"",name:"",description:"",remark:"",page:"",module:"",action:"",isActive:"",createdAt:"",createdBy:"",updatedAt:"",updatedBy:"",parentPermissionId:null}),r=(0,d.KR)(!1),s=()=>{r.value=!1,n.value={id:"",name:"",description:"",remark:"",page:"",module:"",action:"",isActive:"",createdAt:"",createdBy:"",updatedAt:"",updatedBy:"",parentPermissionId:null},o.value=!0},i=e=>{r.value=!0,n.value={...e},o.value=!0},c=async()=>{try{r.value?(await ja.updatePermission(n.value),D.nk.success("æ¬Šé™æ›´æ–°æˆåŠŸï¼")):(await ja.addPermission(n.value),D.nk.success("æ¬Šé™æ–°å¢žæˆåŠŸï¼")),o.value=!1;const e=await ja.getPermissionData();t.value=e.data,m()}catch(e){console.error("å„²å­˜æ¬Šé™éŒ¯èª¤ï¼š",e),D.nk.error("å„²å­˜æ¬Šé™å¤±æ•—ã€‚")}},p=async e=>{try{await ja.deletePermission(e),D.nk.success("æ¬Šé™åˆªé™¤æˆåŠŸï¼");const a=await ja.getPermissionData();t.value=a.data,m()}catch(a){console.error("åˆªé™¤æ¬Šé™éŒ¯èª¤ï¼š",a),D.nk.error("åˆªé™¤æ¬Šé™å¤±æ•—ã€‚")}},m=()=>{l.value.currentPage=1};return(0,u.sV)((async()=>{const e=await ja.getPermissionData();t.value=e.data,m()})),(e,l)=>{const d=(0,u.g2)("el-input"),m=(0,u.g2)("Plus"),v=(0,u.g2)("el-icon"),b=(0,u.g2)("el-button"),g=(0,u.g2)("el-table-column"),y=(0,u.g2)("el-table"),f=(0,u.g2)("el-form-item"),h=(0,u.g2)("el-form"),k=(0,u.g2)("el-dialog");return(0,u.uX)(),(0,u.CE)("div",null,[(0,u.Lk)("div",Ky,[(0,u.bF)(d,{modelValue:a.value,"onUpdate:modelValue":l[0]||(l[0]=e=>a.value=e),placeholder:"ä¾ ID æˆ–åç¨±æœå°‹",style:{width:"10rem","margin-right":"10px"}},null,8,["modelValue"]),(0,u.bF)(b,{type:"success",onClick:s,style:{height:"2.5rem","font-size":"1rem"},round:""},{default:(0,u.k6)((()=>[(0,u.bF)(v,null,{default:(0,u.k6)((()=>[(0,u.bF)(m)])),_:1}),l[16]||(l[16]=(0,u.eW)(" æ–°å¢žæ¬Šé™è³‡è¨Š "))])),_:1})]),(0,u.bF)(y,{data:t.value,style:{width:"100%"}},{default:(0,u.k6)((()=>[(0,u.bF)(g,{prop:"id",label:"ID"}),(0,u.bF)(g,{prop:"name",label:"åç¨±"}),(0,u.bF)(g,{prop:"description",label:"æè¿°"}),(0,u.bF)(g,{prop:"remark",label:"å‚™è¨»"}),(0,u.bF)(g,{prop:"page",label:"é é¢"}),(0,u.bF)(g,{prop:"module",label:"æ¨¡çµ„"}),(0,u.bF)(g,{prop:"action",label:"å‹•ä½œ"}),(0,u.bF)(g,{prop:"isActive",label:"æ˜¯å¦å•Ÿç”¨"}),(0,u.bF)(g,{prop:"createdAt",label:"å»ºç«‹æ™‚é–“"}),(0,u.bF)(g,{prop:"createdBy",label:"å»ºç«‹è€…"}),(0,u.bF)(g,{prop:"updatedAt",label:"æ›´æ–°æ™‚é–“"}),(0,u.bF)(g,{prop:"updatedBy",label:"æ›´æ–°è€…"}),(0,u.bF)(g,{prop:"parentPermissionId",label:"çˆ¶æ¬Šé™ ID"}),(0,u.bF)(g,{label:"æ“ä½œ"},{default:(0,u.k6)((e=>[(0,u.bF)(b,{size:"small",onClick:a=>i(e.row)},{default:(0,u.k6)((()=>l[17]||(l[17]=[(0,u.eW)("ç·¨è¼¯")]))),_:2},1032,["onClick"]),(0,u.bF)(b,{size:"small",type:"danger",onClick:a=>p(e.row.id)},{default:(0,u.k6)((()=>l[18]||(l[18]=[(0,u.eW)("åˆªé™¤")]))),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"]),(0,u.bF)(k,{modelValue:o.value,"onUpdate:modelValue":l[15]||(l[15]=e=>o.value=e),title:r.value?"ç·¨è¼¯æ¬Šé™è³‡è¨Š":"æ–°å¢žæ¬Šé™è³‡è¨Š",width:"500px"},{footer:(0,u.k6)((()=>[(0,u.Lk)("span",My,[(0,u.bF)(b,{onClick:l[14]||(l[14]=e=>o.value=!1)},{default:(0,u.k6)((()=>l[19]||(l[19]=[(0,u.eW)("å–æ¶ˆ")]))),_:1}),(0,u.bF)(b,{type:"primary",onClick:c},{default:(0,u.k6)((()=>l[20]||(l[20]=[(0,u.eW)("å„²å­˜")]))),_:1})])])),default:(0,u.k6)((()=>[(0,u.bF)(h,{model:n.value,"label-width":"120px"},{default:(0,u.k6)((()=>[r.value?((0,u.uX)(),(0,u.Wv)(f,{key:0,label:"ID"},{default:(0,u.k6)((()=>[(0,u.bF)(d,{modelValue:n.value.id,"onUpdate:modelValue":l[1]||(l[1]=e=>n.value.id=e),disabled:""},null,8,["modelValue"])])),_:1})):(0,u.Q3)("",!0),(0,u.bF)(f,{label:"åç¨±"},{default:(0,u.k6)((()=>[(0,u.bF)(d,{modelValue:n.value.name,"onUpdate:modelValue":l[2]||(l[2]=e=>n.value.name=e)},null,8,["modelValue"])])),_:1}),(0,u.bF)(f,{label:"æè¿°"},{default:(0,u.k6)((()=>[(0,u.bF)(d,{modelValue:n.value.description,"onUpdate:modelValue":l[3]||(l[3]=e=>n.value.description=e)},null,8,["modelValue"])])),_:1}),(0,u.bF)(f,{label:"å‚™è¨»"},{default:(0,u.k6)((()=>[(0,u.bF)(d,{modelValue:n.value.remark,"onUpdate:modelValue":l[4]||(l[4]=e=>n.value.remark=e)},null,8,["modelValue"])])),_:1}),(0,u.bF)(f,{label:"é é¢"},{default:(0,u.k6)((()=>[(0,u.bF)(d,{modelValue:n.value.page,"onUpdate:modelValue":l[5]||(l[5]=e=>n.value.page=e)},null,8,["modelValue"])])),_:1}),(0,u.bF)(f,{label:"æ¨¡çµ„"},{default:(0,u.k6)((()=>[(0,u.bF)(d,{modelValue:n.value.module,"onUpdate:modelValue":l[6]||(l[6]=e=>n.value.module=e)},null,8,["modelValue"])])),_:1}),(0,u.bF)(f,{label:"å‹•ä½œ"},{default:(0,u.k6)((()=>[(0,u.bF)(d,{modelValue:n.value.action,"onUpdate:modelValue":l[7]||(l[7]=e=>n.value.action=e)},null,8,["modelValue"])])),_:1}),(0,u.bF)(f,{label:"æ˜¯å¦å•Ÿç”¨"},{default:(0,u.k6)((()=>[(0,u.bF)(d,{modelValue:n.value.isActive,"onUpdate:modelValue":l[8]||(l[8]=e=>n.value.isActive=e)},null,8,["modelValue"])])),_:1}),(0,u.bF)(f,{label:"å»ºç«‹æ™‚é–“"},{default:(0,u.k6)((()=>[(0,u.bF)(d,{modelValue:n.value.createdAt,"onUpdate:modelValue":l[9]||(l[9]=e=>n.value.createdAt=e)},null,8,["modelValue"])])),_:1}),(0,u.bF)(f,{label:"å»ºç«‹è€…"},{default:(0,u.k6)((()=>[(0,u.bF)(d,{modelValue:n.value.createdBy,"onUpdate:modelValue":l[10]||(l[10]=e=>n.value.createdBy=e)},null,8,["modelValue"])])),_:1}),(0,u.bF)(f,{label:"æ›´æ–°æ™‚é–“"},{default:(0,u.k6)((()=>[(0,u.bF)(d,{modelValue:n.value.updatedAt,"onUpdate:modelValue":l[11]||(l[11]=e=>n.value.updatedAt=e)},null,8,["modelValue"])])),_:1}),(0,u.bF)(f,{label:"æ›´æ–°è€…"},{default:(0,u.k6)((()=>[(0,u.bF)(d,{modelValue:n.value.updatedBy,"onUpdate:modelValue":l[12]||(l[12]=e=>n.value.updatedBy=e)},null,8,["modelValue"])])),_:1}),(0,u.bF)(f,{label:"çˆ¶æ¬Šé™ ID"},{default:(0,u.k6)((()=>[(0,u.bF)(d,{modelValue:n.value.parentPermissionId,"onUpdate:modelValue":l[13]||(l[13]=e=>n.value.parentPermissionId=e)},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue","title"])])}}};const Oy=Py;var zy=Oy,By={__name:"DAE_TitleTable",setup(e){const a=(0,d.KR)(""),l=(0,d.KR)([]),t=(0,d.KR)({}),o=(0,d.KR)(!1),n=(0,d.KR)(null),r=(0,d.KR)(!1),s=()=>{r.value=!1,t.value={id:"",name:"",description:"",en_name:"",sortId:0,grade:0,level:0},o.value=!0},i={name:[{required:!0,message:"è·ç¨±åç¨±ä¸å¯ç‚ºç©º",trigger:"blur"}]},c=e=>{r.value=!0,t.value={...e},o.value=!0},p=(0,u.EW)((()=>{const e=a.value.toLowerCase();return l.value.filter((a=>a.id&&a.id.toLowerCase().includes(e)||a.name&&a.name.toLowerCase().includes(e)))})),m=async()=>{if(n.value)try{await n.value.validate((async e=>{if(!e)return D.nk.error("è«‹æª¢æŸ¥å¿…å¡«æ¬„ä½"),!1;{r.value?(await ja.updateTitleData(t.value),D.nk.success("è·ç¨±æ›´æ–°æˆåŠŸï¼")):(await ja.addTitleData(t.value),D.nk.success("è·ç¨±æ–°å¢žæˆåŠŸï¼")),o.value=!1;const e=await ja.getTitleData();l.value=e.data}}))}catch(e){console.error("å„²å­˜è·ç¨±éŒ¯èª¤ï¼š",e),D.nk.error("å„²å­˜è·ç¨±å¤±æ•—ã€‚")}},v=async e=>{try{await ja.deleteTitleData(e),D.nk.success("è·ç¨±åˆªé™¤æˆåŠŸï¼");const a=await ja.getTitleData();l.value=a.data}catch(a){console.error("åˆªé™¤è·ç¨±éŒ¯èª¤ï¼š",a),D.nk.error("åˆªé™¤è·ç¨±å¤±æ•—ã€‚")}};return(0,u.sV)((async()=>{const e=await ja.getTitleData();l.value=e.data})),(e,l)=>{const d=(0,u.g2)("el-input"),b=(0,u.g2)("el-button"),g=(0,u.g2)("el-table-column"),y=(0,u.g2)("el-table"),f=(0,u.g2)("el-form-item"),h=(0,u.g2)("el-form"),k=(0,u.g2)("el-dialog");return(0,u.uX)(),(0,u.CE)("div",null,[(0,u.bF)(d,{modelValue:a.value,"onUpdate:modelValue":l[0]||(l[0]=e=>a.value=e),placeholder:"ä¾ ID æˆ–è·ç¨±åç¨±æœå°‹",style:{width:"200px","margin-right":"10px"}},null,8,["modelValue"]),(0,u.bF)(b,{type:"success",onClick:s},{default:(0,u.k6)((()=>l[10]||(l[10]=[(0,u.eW)("æ–°å¢žè·ç¨±")]))),_:1}),(0,u.bF)(y,{data:p.value,style:{width:"100%"}},{default:(0,u.k6)((()=>[(0,u.bF)(g,{prop:"id",label:"ID",width:"100"}),(0,u.bF)(g,{prop:"name",label:"è·ç¨±åç¨±",width:"150"}),(0,u.bF)(g,{prop:"description",label:"æè¿°",width:"150"}),(0,u.bF)(g,{prop:"en_name",label:"è‹±æ–‡åç¨±",width:"150"}),(0,u.bF)(g,{prop:"sortId",label:"æŽ’åº ID",width:"100"}),(0,u.bF)(g,{prop:"grade",label:"ç­‰ç´š",width:"100"}),(0,u.bF)(g,{prop:"level",label:"å±¤ç´š",width:"100"}),(0,u.bF)(g,{label:"æ“ä½œ",width:"180"},{default:(0,u.k6)((e=>[(0,u.bF)(b,{type:"primary",onClick:a=>c(e.row)},{default:(0,u.k6)((()=>l[11]||(l[11]=[(0,u.eW)("ç·¨è¼¯")]))),_:2},1032,["onClick"]),(0,u.bF)(b,{type:"danger",onClick:a=>v(e.row.id)},{default:(0,u.k6)((()=>l[12]||(l[12]=[(0,u.eW)("åˆªé™¤")]))),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"]),(0,u.bF)(k,{modelValue:o.value,"onUpdate:modelValue":l[9]||(l[9]=e=>o.value=e),title:r.value?"ç·¨è¼¯è·ç¨±è³‡æ–™":"æ–°å¢žè·ç¨±è³‡æ–™",style:{width:"20rem"}},{footer:(0,u.k6)((()=>[(0,u.bF)(b,{onClick:l[8]||(l[8]=e=>o.value=!1)},{default:(0,u.k6)((()=>l[13]||(l[13]=[(0,u.eW)("å–æ¶ˆ")]))),_:1}),(0,u.bF)(b,{type:"primary",onClick:m},{default:(0,u.k6)((()=>l[14]||(l[14]=[(0,u.eW)("å®Œæˆ")]))),_:1})])),default:(0,u.k6)((()=>[(0,u.bF)(h,{model:t.value,ref_key:"editFormRef",ref:n,rules:i,"label-width":"100px"},{default:(0,u.k6)((()=>[(0,u.bF)(f,{label:"ID",prop:"id"},{default:(0,u.k6)((()=>[(0,u.bF)(d,{modelValue:t.value.id,"onUpdate:modelValue":l[1]||(l[1]=e=>t.value.id=e),disabled:r.value,style:{width:"100%"}},null,8,["modelValue","disabled"])])),_:1}),(0,u.bF)(f,{label:"è·ç¨±åç¨±",prop:"name"},{default:(0,u.k6)((()=>[(0,u.bF)(d,{modelValue:t.value.name,"onUpdate:modelValue":l[2]||(l[2]=e=>t.value.name=e),style:{width:"100%"}},null,8,["modelValue"])])),_:1}),(0,u.bF)(f,{label:"æè¿°"},{default:(0,u.k6)((()=>[(0,u.bF)(d,{modelValue:t.value.description,"onUpdate:modelValue":l[3]||(l[3]=e=>t.value.description=e),style:{width:"100%"}},null,8,["modelValue"])])),_:1}),(0,u.bF)(f,{label:"è‹±æ–‡åç¨±"},{default:(0,u.k6)((()=>[(0,u.bF)(d,{modelValue:t.value.en_name,"onUpdate:modelValue":l[4]||(l[4]=e=>t.value.en_name=e),style:{width:"100%"}},null,8,["modelValue"])])),_:1}),(0,u.bF)(f,{label:"æŽ’åº ID"},{default:(0,u.k6)((()=>[(0,u.bF)(d,{modelValue:t.value.sortId,"onUpdate:modelValue":l[5]||(l[5]=e=>t.value.sortId=e),type:"number",style:{width:"100%"}},null,8,["modelValue"])])),_:1}),(0,u.bF)(f,{label:"ç­‰ç´š"},{default:(0,u.k6)((()=>[(0,u.bF)(d,{modelValue:t.value.grade,"onUpdate:modelValue":l[6]||(l[6]=e=>t.value.grade=e),type:"number",style:{width:"100%"}},null,8,["modelValue"])])),_:1}),(0,u.bF)(f,{label:"å±¤ç´š"},{default:(0,u.k6)((()=>[(0,u.bF)(d,{modelValue:t.value.level,"onUpdate:modelValue":l[7]||(l[7]=e=>t.value.level=e),type:"number",style:{width:"100%"}},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue","title"])])}}};const jy=(0,ie.A)(By,[["__scopeId","data-v-1373a62f"]]);var Yy=jy;const Qy={class:"dialog-footer"};var Hy={__name:"DAE_RoleTable",setup(e){const a=(0,d.KR)([]),l=(0,d.KR)(""),t=(0,d.KR)({currentPage:1,pageSize:15,total:0}),o=(0,d.KR)(!1),n=(0,d.KR)({id:null,sort_id:null,name:"",created_at:"",remark:"",area_id:null,dpt_id:null}),r=(0,d.KR)(!1),s=()=>{r.value=!1,n.value={id:null,sort_id:null,name:"",created_at:"",remark:"",area_id:null,dpt_id:null},o.value=!0},i=e=>{r.value=!0,n.value={...e},o.value=!0},c=async()=>{try{r.value?(await ja.updateRole(n.value),D.nk.success("è§’è‰²æ›´æ–°æˆåŠŸï¼")):(await ja.addRole(n.value),D.nk.success("è§’è‰²æ–°å¢žæˆåŠŸï¼")),o.value=!1;const e=await ja.getRoleData();a.value=e.data,v()}catch(e){console.error("å„²å­˜è§’è‰²éŒ¯èª¤ï¼š",e),D.nk.error("å„²å­˜è§’è‰²å¤±æ•—ã€‚")}},p=async e=>{try{await ja.deleteRole(e),D.nk.success("è§’è‰²åˆªé™¤æˆåŠŸï¼");const l=await ja.getRoleData();a.value=l.data,v()}catch(l){console.error("åˆªé™¤è§’è‰²éŒ¯èª¤ï¼š",l),D.nk.error("åˆªé™¤è§’è‰²å¤±æ•—ã€‚")}},m=(0,u.EW)((()=>{const e=l.value.toLowerCase(),o=a.value.filter((a=>a.id&&a.id.toLowerCase().includes(e)||a.name&&a.name.toLowerCase().includes(e))),n=(t.value.currentPage-1)*t.value.pageSize,r=n+t.value.pageSize;return o.slice(n,r)})),v=()=>{const e=l.value.toLowerCase(),o=a.value.filter((a=>a.id&&a.id.toLowerCase().includes(e)||a.name&&a.name.toLowerCase().includes(e)));t.value.total=o.length,t.value.currentPage=1},b=e=>{t.value.pageSize=e,t.value.currentPage=1,v()},g=e=>{t.value.currentPage=e};return(0,u.sV)((async()=>{try{const e=await ja.getRoleData();a.value=e.data,v()}catch(e){console.error("ç²å–è§’è‰²è³‡æ–™éŒ¯èª¤ï¼š",e)}})),(e,a)=>{const d=(0,u.g2)("el-input"),y=(0,u.g2)("el-button"),f=(0,u.g2)("el-pagination"),h=(0,u.g2)("el-table-column"),k=(0,u.g2)("el-table"),_=(0,u.g2)("el-form-item"),w=(0,u.g2)("el-form"),F=(0,u.g2)("el-dialog");return(0,u.uX)(),(0,u.CE)(u.FK,null,[(0,u.Lk)("div",null,[(0,u.bF)(d,{modelValue:l.value,"onUpdate:modelValue":a[0]||(a[0]=e=>l.value=e),placeholder:"ä¾ ID æˆ–åç¨±æœå°‹",style:{width:"200px","margin-right":"10px"}},null,8,["modelValue"]),(0,u.bF)(y,{type:"primary",onClick:v},{default:(0,u.k6)((()=>a[10]||(a[10]=[(0,u.eW)("æœå°‹")]))),_:1}),(0,u.bF)(y,{type:"success",onClick:s},{default:(0,u.k6)((()=>a[11]||(a[11]=[(0,u.eW)("æ–°å¢žè§’è‰²")]))),_:1}),(0,u.bF)(f,{onSizeChange:b,onCurrentChange:g,"current-page":t.value.currentPage,"page-sizes":[10,15,20,50],"page-size":t.value.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.value.total},null,8,["current-page","page-size","total"]),(0,u.bF)(k,{data:m.value,style:{width:"100%"}},{default:(0,u.k6)((()=>[(0,u.bF)(h,{prop:"id",label:"ID"}),(0,u.bF)(h,{prop:"sort_id",label:"æŽ’åº ID"}),(0,u.bF)(h,{prop:"name",label:"åç¨±"}),(0,u.bF)(h,{prop:"created_at",label:"å»ºç«‹æ™‚é–“"}),(0,u.bF)(h,{prop:"remark",label:"å‚™è¨»"}),(0,u.bF)(h,{label:"åœ°å€"},{default:(0,u.k6)((e=>[(0,u.bF)(rt,{areaId:e.row.area_id},null,8,["areaId"])])),_:1}),(0,u.bF)(h,{label:"éƒ¨é–€"},{default:(0,u.k6)((e=>[(0,u.bF)(_l,{mode:"Description","dept-id":e.row.dpt_id},null,8,["dept-id"])])),_:1}),(0,u.bF)(h,{label:"æ“ä½œ"},{default:(0,u.k6)((e=>[(0,u.bF)(y,{size:"small",onClick:a=>i(e.row)},{default:(0,u.k6)((()=>a[12]||(a[12]=[(0,u.eW)("ç·¨è¼¯")]))),_:2},1032,["onClick"]),(0,u.bF)(y,{size:"small",type:"danger",onClick:a=>p(e.row.id)},{default:(0,u.k6)((()=>a[13]||(a[13]=[(0,u.eW)("åˆªé™¤")]))),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])]),(0,u.bF)(F,{modelValue:o.value,"onUpdate:modelValue":a[9]||(a[9]=e=>o.value=e),title:r.value?"ç·¨è¼¯è§’è‰²":"æ–°å¢žè§’è‰²",width:"500px"},{footer:(0,u.k6)((()=>[(0,u.Lk)("span",Qy,[(0,u.bF)(y,{onClick:a[8]||(a[8]=e=>o.value=!1)},{default:(0,u.k6)((()=>a[14]||(a[14]=[(0,u.eW)("å–æ¶ˆ")]))),_:1}),(0,u.bF)(y,{type:"primary",onClick:c},{default:(0,u.k6)((()=>a[15]||(a[15]=[(0,u.eW)("å„²å­˜")]))),_:1})])])),default:(0,u.k6)((()=>[(0,u.bF)(w,{model:n.value,"label-width":"120px"},{default:(0,u.k6)((()=>[r.value?((0,u.uX)(),(0,u.Wv)(_,{key:0,label:"ID"},{default:(0,u.k6)((()=>[(0,u.bF)(d,{modelValue:n.value.id,"onUpdate:modelValue":a[1]||(a[1]=e=>n.value.id=e),disabled:""},null,8,["modelValue"])])),_:1})):(0,u.Q3)("",!0),(0,u.bF)(_,{label:"æŽ’åº ID"},{default:(0,u.k6)((()=>[(0,u.bF)(d,{modelValue:n.value.sort_id,"onUpdate:modelValue":a[2]||(a[2]=e=>n.value.sort_id=e),type:"number"},null,8,["modelValue"])])),_:1}),(0,u.bF)(_,{label:"åç¨±"},{default:(0,u.k6)((()=>[(0,u.bF)(d,{modelValue:n.value.name,"onUpdate:modelValue":a[3]||(a[3]=e=>n.value.name=e)},null,8,["modelValue"])])),_:1}),(0,u.bF)(_,{label:"å»ºç«‹æ™‚é–“"},{default:(0,u.k6)((()=>[(0,u.bF)(d,{modelValue:n.value.created_at,"onUpdate:modelValue":a[4]||(a[4]=e=>n.value.created_at=e)},null,8,["modelValue"])])),_:1}),(0,u.bF)(_,{label:"å‚™è¨»"},{default:(0,u.k6)((()=>[(0,u.bF)(d,{modelValue:n.value.remark,"onUpdate:modelValue":a[5]||(a[5]=e=>n.value.remark=e)},null,8,["modelValue"])])),_:1}),(0,u.bF)(_,{label:"åœ°å€ ID"},{default:(0,u.k6)((()=>[(0,u.bF)(d,{modelValue:n.value.area_id,"onUpdate:modelValue":a[6]||(a[6]=e=>n.value.area_id=e)},null,8,["modelValue"])])),_:1}),(0,u.bF)(_,{label:"éƒ¨é–€ ID"},{default:(0,u.k6)((()=>[(0,u.bF)(d,{modelValue:n.value.dpt_id,"onUpdate:modelValue":a[7]||(a[7]=e=>n.value.dpt_id=e)},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue","title"])],64)}}};const qy=(0,ie.A)(Hy,[["__scopeId","data-v-bac7e93a"]]);var Jy=qy;const Gy={class:"dialog-footer"};var Zy={__name:"DAE_DepartmentTable",setup(e){const a=(0,d.KR)([]),l=(0,d.KR)(""),t=(0,d.KR)({currentPage:1,pageSize:15,total:0}),o=(0,d.KR)(!1),n=(0,d.KR)({id:null,sortId:null,name:"",p_dpt_id:null,dpt_en_name:"",manager_id:null,area_id:null}),r=(0,d.KR)(!1),s=()=>{r.value=!1,n.value={id:null,sortId:null,name:"",p_dpt_id:null,dpt_en_name:"",manager_id:null,area_id:null},o.value=!0},i=e=>{r.value=!0,n.value={...e},o.value=!0},c=async()=>{try{r.value?(await ja.updateDepartment(n.value),D.nk.success("éƒ¨é–€æ›´æ–°æˆåŠŸï¼")):(await ja.addDepartment(n.value),D.nk.success("éƒ¨é–€æ–°å¢žæˆåŠŸï¼")),o.value=!1;const e=await ja.getDepartmentData();a.value=e.data,v()}catch(e){console.error("å„²å­˜éƒ¨é–€éŒ¯èª¤ï¼š",e),D.nk.error("å„²å­˜éƒ¨é–€å¤±æ•—ã€‚")}},p=async e=>{try{await ja.deleteDepartment(e),D.nk.success("éƒ¨é–€åˆªé™¤æˆåŠŸï¼");const l=await ja.getDepartmentData();a.value=l.data,v()}catch(l){console.error("åˆªé™¤éƒ¨é–€éŒ¯èª¤ï¼š",l),D.nk.error("åˆªé™¤éƒ¨é–€å¤±æ•—ã€‚")}},m=(0,u.EW)((()=>{const e=l.value.toLowerCase(),o=a.value.filter((a=>a.id&&a.id.toLowerCase().includes(e)||a.name&&a.name.toLowerCase().includes(e))),n=(t.value.currentPage-1)*t.value.pageSize,r=n+t.value.pageSize;return o.slice(n,r)})),v=()=>{const e=l.value.toLowerCase(),o=a.value.filter((a=>a.id&&a.id.toLowerCase().includes(e)||a.name&&a.name.toLowerCase().includes(e)));t.value.total=o.length,t.value.currentPage=1},b=e=>{t.value.pageSize=e,t.value.currentPage=1,v()},g=e=>{t.value.currentPage=e};return(0,u.sV)((async()=>{try{const e=await ja.getDepartmentData();a.value=e.data,v()}catch(e){console.error("ç²å–éƒ¨é–€è³‡æ–™éŒ¯èª¤ï¼š",e)}})),(e,a)=>{const d=(0,u.g2)("el-input"),y=(0,u.g2)("el-button"),f=(0,u.g2)("el-pagination"),h=(0,u.g2)("el-table-column"),k=(0,u.g2)("el-table"),_=(0,u.g2)("el-form-item"),w=(0,u.g2)("el-form"),F=(0,u.g2)("el-dialog");return(0,u.uX)(),(0,u.CE)(u.FK,null,[(0,u.Lk)("div",null,[(0,u.bF)(d,{modelValue:l.value,"onUpdate:modelValue":a[0]||(a[0]=e=>l.value=e),placeholder:"ä¾ ID æˆ–åç¨±æœå°‹",style:{width:"200px","margin-right":"10px"}},null,8,["modelValue"]),(0,u.bF)(y,{type:"primary",onClick:v},{default:(0,u.k6)((()=>a[10]||(a[10]=[(0,u.eW)("æœå°‹")]))),_:1}),(0,u.bF)(y,{type:"success",onClick:s},{default:(0,u.k6)((()=>a[11]||(a[11]=[(0,u.eW)("æ–°å¢žéƒ¨é–€")]))),_:1}),(0,u.bF)(f,{onSizeChange:b,onCurrentChange:g,"current-page":t.value.currentPage,"page-sizes":[10,15,20,50],"page-size":t.value.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.value.total},null,8,["current-page","page-size","total"]),(0,u.bF)(k,{data:m.value,style:{width:"100%"}},{default:(0,u.k6)((()=>[(0,u.bF)(h,{prop:"id",label:"ID"}),(0,u.bF)(h,{prop:"sortId",label:"æŽ’åº ID"}),(0,u.bF)(h,{prop:"name",label:"åç¨±"}),(0,u.bF)(h,{label:"ä¸Šç´šéƒ¨é–€"},{default:(0,u.k6)((e=>[(0,u.bF)(_l,{mode:"Description","dept-id":e.row.p_dpt_id},null,8,["dept-id"])])),_:1}),(0,u.bF)(h,{prop:"dpt_en_name",label:"è‹±æ–‡åç¨±"}),(0,u.bF)(h,{prop:"manager_id",label:"ä¸»ç®¡ ID"}),(0,u.bF)(h,{label:"åœ°å€"},{default:(0,u.k6)((e=>[(0,u.bF)(rt,{areaId:e.row.area_id},null,8,["areaId"])])),_:1}),(0,u.bF)(h,{label:"æ“ä½œ"},{default:(0,u.k6)((e=>[(0,u.bF)(y,{size:"small",onClick:a=>i(e.row)},{default:(0,u.k6)((()=>a[12]||(a[12]=[(0,u.eW)("ç·¨è¼¯")]))),_:2},1032,["onClick"]),(0,u.bF)(y,{size:"small",type:"danger",onClick:a=>p(e.row.id)},{default:(0,u.k6)((()=>a[13]||(a[13]=[(0,u.eW)("åˆªé™¤")]))),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])]),(0,u.bF)(F,{modelValue:o.value,"onUpdate:modelValue":a[9]||(a[9]=e=>o.value=e),title:r.value?"ç·¨è¼¯éƒ¨é–€":"æ–°å¢žéƒ¨é–€",width:"500px"},{footer:(0,u.k6)((()=>[(0,u.Lk)("span",Gy,[(0,u.bF)(y,{onClick:a[8]||(a[8]=e=>o.value=!1)},{default:(0,u.k6)((()=>a[14]||(a[14]=[(0,u.eW)("å–æ¶ˆ")]))),_:1}),(0,u.bF)(y,{type:"primary",onClick:c},{default:(0,u.k6)((()=>a[15]||(a[15]=[(0,u.eW)("å„²å­˜")]))),_:1})])])),default:(0,u.k6)((()=>[(0,u.bF)(w,{model:n.value,"label-width":"150px"},{default:(0,u.k6)((()=>[r.value?((0,u.uX)(),(0,u.Wv)(_,{key:0,label:"ID"},{default:(0,u.k6)((()=>[(0,u.bF)(d,{modelValue:n.value.id,"onUpdate:modelValue":a[1]||(a[1]=e=>n.value.id=e),disabled:""},null,8,["modelValue"])])),_:1})):(0,u.Q3)("",!0),(0,u.bF)(_,{label:"æŽ’åº ID"},{default:(0,u.k6)((()=>[(0,u.bF)(d,{modelValue:n.value.sortId,"onUpdate:modelValue":a[2]||(a[2]=e=>n.value.sortId=e),type:"number"},null,8,["modelValue"])])),_:1}),(0,u.bF)(_,{label:"åç¨±"},{default:(0,u.k6)((()=>[(0,u.bF)(d,{modelValue:n.value.name,"onUpdate:modelValue":a[3]||(a[3]=e=>n.value.name=e)},null,8,["modelValue"])])),_:1}),(0,u.bF)(_,{label:"ä¸Šç´šéƒ¨é–€ ID"},{default:(0,u.k6)((()=>[(0,u.bF)(d,{modelValue:n.value.p_dpt_id,"onUpdate:modelValue":a[4]||(a[4]=e=>n.value.p_dpt_id=e)},null,8,["modelValue"])])),_:1}),(0,u.bF)(_,{label:"è‹±æ–‡åç¨±"},{default:(0,u.k6)((()=>[(0,u.bF)(d,{modelValue:n.value.dpt_en_name,"onUpdate:modelValue":a[5]||(a[5]=e=>n.value.dpt_en_name=e)},null,8,["modelValue"])])),_:1}),(0,u.bF)(_,{label:"ä¸»ç®¡ ID"},{default:(0,u.k6)((()=>[(0,u.bF)(d,{modelValue:n.value.manager_id,"onUpdate:modelValue":a[6]||(a[6]=e=>n.value.manager_id=e)},null,8,["modelValue"])])),_:1}),(0,u.bF)(_,{label:"åœ°å€ ID"},{default:(0,u.k6)((()=>[(0,u.bF)(d,{modelValue:n.value.area_id,"onUpdate:modelValue":a[7]||(a[7]=e=>n.value.area_id=e)},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue","title"])],64)}}};const ef=(0,ie.A)(Zy,[["__scopeId","data-v-6c04723c"]]);var af=ef;const lf={class:"dialog-footer"};var tf={__name:"DAE_AreaTable",setup(e){const a=(0,d.KR)([]),l=(0,d.KR)(""),t=(0,d.KR)({currentPage:1,pageSize:15,total:0}),o=(0,d.KR)(!1),n=(0,d.KR)({id:null,sortId:null,area:"",region:"",nation:""}),r=(0,d.KR)(!1),s=()=>{r.value=!1,n.value={id:null,sortId:null,area:"",region:"",nation:""},o.value=!0},i=e=>{r.value=!0,n.value={...e},o.value=!0},c=async()=>{try{r.value?(await ja.updateArea(n.value),D.nk.success("åœ°å€æ›´æ–°æˆåŠŸï¼")):(await ja.addArea(n.value),D.nk.success("åœ°å€æ–°å¢žæˆåŠŸï¼")),o.value=!1;const e=await ja.getAreaData();a.value=e.data,v()}catch(e){console.error("å„²å­˜åœ°å€éŒ¯èª¤ï¼š",e),D.nk.error("å„²å­˜åœ°å€å¤±æ•—ã€‚")}},p=async e=>{try{await ja.deleteArea(e),D.nk.success("åœ°å€åˆªé™¤æˆåŠŸï¼");const l=await ja.getAreaData();a.value=l.data,v()}catch(l){console.error("åˆªé™¤åœ°å€éŒ¯èª¤ï¼š",l),D.nk.error("åˆªé™¤åœ°å€å¤±æ•—ã€‚")}},m=(0,u.EW)((()=>{const e=l.value.toLowerCase(),o=a.value.filter((a=>a.id&&a.id.toLowerCase().includes(e)||a.area&&a.area.toLowerCase().includes(e))),n=(t.value.currentPage-1)*t.value.pageSize,r=n+t.value.pageSize;return o.slice(n,r)})),v=()=>{const e=l.value.toLowerCase(),o=a.value.filter((a=>a.id&&a.id.toLowerCase().includes(e)||a.area&&a.area.toLowerCase().includes(e)));t.value.total=o.length,t.value.currentPage=1},b=e=>{t.value.pageSize=e,t.value.currentPage=1,v()},g=e=>{t.value.currentPage=e};return(0,u.sV)((async()=>{try{const e=await ja.getAreaData();a.value=e.data,v()}catch(e){console.error("ç²å–åœ°å€è³‡æ–™éŒ¯èª¤ï¼š",e)}})),(e,a)=>{const d=(0,u.g2)("el-input"),y=(0,u.g2)("el-button"),f=(0,u.g2)("el-pagination"),h=(0,u.g2)("el-table-column"),k=(0,u.g2)("el-table"),_=(0,u.g2)("el-form-item"),w=(0,u.g2)("el-form"),F=(0,u.g2)("el-dialog");return(0,u.uX)(),(0,u.CE)(u.FK,null,[(0,u.Lk)("div",null,[(0,u.bF)(d,{modelValue:l.value,"onUpdate:modelValue":a[0]||(a[0]=e=>l.value=e),placeholder:"ä¾ ID æˆ–åœ°å€æœå°‹",style:{width:"200px","margin-right":"10px"}},null,8,["modelValue"]),(0,u.bF)(y,{type:"primary",onClick:v},{default:(0,u.k6)((()=>a[8]||(a[8]=[(0,u.eW)("æœå°‹")]))),_:1}),(0,u.bF)(y,{type:"success",onClick:s},{default:(0,u.k6)((()=>a[9]||(a[9]=[(0,u.eW)("æ–°å¢žåœ°å€")]))),_:1}),(0,u.bF)(f,{onSizeChange:b,onCurrentChange:g,"current-page":t.value.currentPage,"page-sizes":[10,15,20,50],"page-size":t.value.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.value.total},null,8,["current-page","page-size","total"]),(0,u.bF)(k,{data:m.value,style:{width:"100%"}},{default:(0,u.k6)((()=>[(0,u.bF)(h,{prop:"id",label:"ID"}),(0,u.bF)(h,{prop:"sortId",label:"æŽ’åº ID"}),(0,u.bF)(h,{prop:"area",label:"åœ°å€"}),(0,u.bF)(h,{prop:"region",label:"å€åŸŸ"}),(0,u.bF)(h,{prop:"nation",label:"åœ‹å®¶"}),(0,u.bF)(h,{prop:"district",label:"åœ‹å®¶"}),(0,u.bF)(h,{label:"æ“ä½œ"},{default:(0,u.k6)((e=>[(0,u.bF)(y,{size:"small",onClick:a=>i(e.row)},{default:(0,u.k6)((()=>a[10]||(a[10]=[(0,u.eW)("ç·¨è¼¯")]))),_:2},1032,["onClick"]),(0,u.bF)(y,{size:"small",type:"danger",onClick:a=>p(e.row.id)},{default:(0,u.k6)((()=>a[11]||(a[11]=[(0,u.eW)("åˆªé™¤")]))),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])]),(0,u.bF)(F,{modelValue:o.value,"onUpdate:modelValue":a[7]||(a[7]=e=>o.value=e),title:r.value?"ç·¨è¼¯åœ°å€":"æ–°å¢žåœ°å€",width:"500px"},{footer:(0,u.k6)((()=>[(0,u.Lk)("span",lf,[(0,u.bF)(y,{onClick:a[6]||(a[6]=e=>o.value=!1)},{default:(0,u.k6)((()=>a[12]||(a[12]=[(0,u.eW)("å–æ¶ˆ")]))),_:1}),(0,u.bF)(y,{type:"primary",onClick:c},{default:(0,u.k6)((()=>a[13]||(a[13]=[(0,u.eW)("å„²å­˜")]))),_:1})])])),default:(0,u.k6)((()=>[(0,u.bF)(w,{model:n.value,"label-width":"120px"},{default:(0,u.k6)((()=>[r.value?((0,u.uX)(),(0,u.Wv)(_,{key:0,label:"ID"},{default:(0,u.k6)((()=>[(0,u.bF)(d,{modelValue:n.value.id,"onUpdate:modelValue":a[1]||(a[1]=e=>n.value.id=e),disabled:""},null,8,["modelValue"])])),_:1})):(0,u.Q3)("",!0),(0,u.bF)(_,{label:"æŽ’åº ID"},{default:(0,u.k6)((()=>[(0,u.bF)(d,{modelValue:n.value.sortId,"onUpdate:modelValue":a[2]||(a[2]=e=>n.value.sortId=e),type:"number"},null,8,["modelValue"])])),_:1}),(0,u.bF)(_,{label:"åœ°å€"},{default:(0,u.k6)((()=>[(0,u.bF)(d,{modelValue:n.value.area,"onUpdate:modelValue":a[3]||(a[3]=e=>n.value.area=e)},null,8,["modelValue"])])),_:1}),(0,u.bF)(_,{label:"å€åŸŸ"},{default:(0,u.k6)((()=>[(0,u.bF)(d,{modelValue:n.value.region,"onUpdate:modelValue":a[4]||(a[4]=e=>n.value.region=e)},null,8,["modelValue"])])),_:1}),(0,u.bF)(_,{label:"åœ‹å®¶"},{default:(0,u.k6)((()=>[(0,u.bF)(d,{modelValue:n.value.nation,"onUpdate:modelValue":a[5]||(a[5]=e=>n.value.nation=e)},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue","title"])],64)}}};const of=(0,ie.A)(tf,[["__scopeId","data-v-34ca8dc4"]]);var nf=of,rf={__name:"WF_RoleTable",setup(e){const a=(0,d.KR)(""),l=(0,d.KR)([]),t=(0,d.KR)({}),o=(0,d.KR)(!1),n=(0,d.KR)(null),r=(0,d.KR)(!1),s=(0,d.KR)(""),i=(0,d.KR)(""),c=()=>{r.value=!1,t.value={id:"",name:"",description:"",sortId:0,isProxy:!1},o.value=!0},p={id:[{required:!0,message:"ID ä¸å¯ç‚ºç©º",trigger:"blur"}],name:[{required:!0,message:"åç¨±ä¸å¯ç‚ºç©º",trigger:"blur"}],sortId:[{required:!0,message:"æŽ’åº ID ä¸å¯ç‚ºç©º",trigger:"change"}]},m=e=>{r.value=!0,t.value={...e},o.value=!0},v=(0,u.EW)((()=>{const e=a.value.toLowerCase();let t=l.value.filter((a=>a.id&&a.id.toLowerCase().includes(e)||a.name&&a.name.toLowerCase().includes(e)));return s.value&&i.value&&t.sort(((e,a)=>{let l=e[s.value],t=a[s.value];return null!==l&&void 0!==l||(l=""),null!==t&&void 0!==t||(t=""),"string"===typeof l&&"string"===typeof t?"ascending"===i.value?l.localeCompare(t):t.localeCompare(l):"ascending"===i.value?l-t:t-l})),t})),b=async()=>{if(n.value)try{await n.value.validate((async e=>{if(!e)return D.nk.error("è«‹æª¢æŸ¥å¿…å¡«æ¬„ä½"),!1;{if(r.value)await ja.updateWF_RoleData(t.value),D.nk.success("æ›´æ–°æˆåŠŸ"),o.value=!1;else try{let e=await ja.addWF_RoleData(t.value);e&&(D.nk.success("æ–°å¢žæˆåŠŸ"),o.value=!1)}catch(a){if(!a.response||409!==a.response.status)throw a;D.nk.error("è©² ID å·²å»ºç«‹")}const e=await ja.getWF_RoleData();l.value=e.data}}))}catch(e){console.error("æ“ä½œå¤±æ•—:",e),D.nk.error("æ“ä½œå¤±æ•—: "+e.message)}},g=async e=>{try{await Sa.s.confirm("ç¢ºå®šè¦åˆªé™¤æ­¤ç­†è³‡æ–™å—Žï¼Ÿ","æç¤º",{confirmButtonText:"ç¢ºå®š",cancelButtonText:"å–æ¶ˆ",type:"warning"}),await ja.deleteWF_RoleData(e.id),D.nk.success("åˆªé™¤æˆåŠŸ");const a=await ja.getWF_RoleData();l.value=a.data}catch(a){"cancel"!==a&&(console.error("åˆªé™¤å¤±æ•—:",a),D.nk.error("åˆªé™¤å¤±æ•—: "+a.message))}};(0,u.sV)((async()=>{const e=await ja.getWF_RoleData();l.value=e.data}));const y=({prop:e,order:a})=>{s.value=e,i.value=a};return(e,l)=>{const s=(0,u.g2)("el-input"),i=(0,u.g2)("el-button"),d=(0,u.g2)("el-table-column"),f=(0,u.g2)("el-table"),h=(0,u.g2)("el-form-item"),k=(0,u.g2)("el-input-number"),_=(0,u.g2)("el-switch"),w=(0,u.g2)("el-form"),F=(0,u.g2)("el-dialog");return(0,u.uX)(),(0,u.CE)("div",null,[(0,u.bF)(s,{modelValue:a.value,"onUpdate:modelValue":l[0]||(l[0]=e=>a.value=e),placeholder:"ID or åç¨±",style:{width:"200px","margin-right":"10px"}},null,8,["modelValue"]),(0,u.bF)(i,{type:"success",onClick:c},{default:(0,u.k6)((()=>l[8]||(l[8]=[(0,u.eW)("æ–°å¢ž WF è§’è‰²è³‡æ–™")]))),_:1}),(0,u.bF)(f,{data:v.value,style:{width:"100%"},onSortChange:y},{default:(0,u.k6)((()=>[(0,u.bF)(d,{prop:"id",label:"ID",width:"500",sortable:"custom"}),(0,u.bF)(d,{prop:"name",label:"åç¨±",width:"200",sortable:"custom"}),(0,u.bF)(d,{prop:"description",label:"æè¿°",width:"300",sortable:"custom"}),(0,u.bF)(d,{prop:"sortId",label:"æŽ’åº ID",width:"100",sortable:"custom"}),(0,u.bF)(d,{prop:"isProxy",label:"æ˜¯å¦ä»£ç†",width:"150",sortable:"custom"},{default:(0,u.k6)((e=>[(0,u.Lk)("span",null,(0,L.v_)(e.row.isProxy?"æ˜¯":"å¦"),1)])),_:1}),(0,u.bF)(d,{label:"æ“ä½œ",width:"300"},{default:(0,u.k6)((e=>[(0,u.bF)(i,{type:"primary",onClick:a=>m(e.row)},{default:(0,u.k6)((()=>l[9]||(l[9]=[(0,u.eW)("ç·¨è¼¯")]))),_:2},1032,["onClick"]),(0,u.bF)(i,{type:"danger",onClick:a=>g(e.row)},{default:(0,u.k6)((()=>l[10]||(l[10]=[(0,u.eW)("åˆªé™¤")]))),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"]),(0,u.bF)(F,{modelValue:o.value,"onUpdate:modelValue":l[7]||(l[7]=e=>o.value=e),title:r.value?"ç·¨è¼¯ WF è§’è‰²è³‡æ–™":"æ–°å¢ž WF è§’è‰²è³‡æ–™",style:{width:"25rem"}},{footer:(0,u.k6)((()=>[(0,u.bF)(i,{onClick:l[6]||(l[6]=e=>o.value=!1)},{default:(0,u.k6)((()=>l[11]||(l[11]=[(0,u.eW)("å–æ¶ˆ")]))),_:1}),(0,u.bF)(i,{type:"primary",onClick:b},{default:(0,u.k6)((()=>l[12]||(l[12]=[(0,u.eW)("å®Œæˆ")]))),_:1})])),default:(0,u.k6)((()=>[(0,u.bF)(w,{model:t.value,ref_key:"editFormRef",ref:n,rules:p,"label-width":"100px"},{default:(0,u.k6)((()=>[(0,u.bF)(h,{label:"ID",prop:"id"},{default:(0,u.k6)((()=>[(0,u.bF)(s,{modelValue:t.value.id,"onUpdate:modelValue":l[1]||(l[1]=e=>t.value.id=e),disabled:r.value,style:{width:"100%"}},null,8,["modelValue","disabled"])])),_:1}),(0,u.bF)(h,{label:"åç¨±",prop:"name"},{default:(0,u.k6)((()=>[(0,u.bF)(s,{modelValue:t.value.name,"onUpdate:modelValue":l[2]||(l[2]=e=>t.value.name=e),style:{width:"100%"}},null,8,["modelValue"])])),_:1}),(0,u.bF)(h,{label:"æè¿°"},{default:(0,u.k6)((()=>[(0,u.bF)(s,{modelValue:t.value.description,"onUpdate:modelValue":l[3]||(l[3]=e=>t.value.description=e),style:{width:"100%"}},null,8,["modelValue"])])),_:1}),(0,u.bF)(h,{label:"æŽ’åº ID",prop:"sortId"},{default:(0,u.k6)((()=>[(0,u.bF)(k,{modelValue:t.value.sortId,"onUpdate:modelValue":l[4]||(l[4]=e=>t.value.sortId=e),min:0,style:{width:"100%"}},null,8,["modelValue"])])),_:1}),(0,u.bF)(h,{label:"æ˜¯å¦ä»£ç†",prop:"isProxy"},{default:(0,u.k6)((()=>[(0,u.bF)(_,{modelValue:t.value.isProxy,"onUpdate:modelValue":l[5]||(l[5]=e=>t.value.isProxy=e)},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue","title"])])}}};const sf=rf;var uf=sf;const df={class:"mt-5"};var cf={__name:"DAE_RelEIPUserRole_JOIN_WF_Role",setup(e){const a=(0,d.KR)(""),l=(0,d.KR)([]),t=(0,d.KR)({}),o=(0,d.KR)(!1),n=(0,d.KR)(null),r=(0,d.KR)(!1),s=()=>{r.value=!1,t.value={userId:"",roleId:"",roleName:""},o.value=!0},i={userId:[{required:!0,message:"ä½¿ç”¨è€…IDä¸å¯ç‚ºç©º",trigger:"blur"}],roleId:[{required:!0,message:"è§’è‰²IDä¸å¯ç‚ºç©º",trigger:"blur"}],roleName:[{required:!0,message:"è§’è‰²åç¨±ä¸å¯ç‚ºç©º",trigger:"blur"}]},c=e=>{r.value=!0,t.value={...e},o.value=!0},p=(0,u.EW)((()=>{const e=a.value.toLowerCase();return l.value.filter((a=>a.userId&&a.userId.toLowerCase().includes(e)||a.roleName&&a.roleName.toLowerCase().includes(e)))})),m=async()=>{if(n.value)try{await n.value.validate((async e=>{if(!e)return D.nk.error("è«‹æª¢æŸ¥å¿…å¡«æ¬„ä½"),!1;{r.value?(await ja.updateUserRoleData(t.value),D.nk.success("æ›´æ–°æˆåŠŸ")):(await ja.addUserWFRoleData(t.value.userId,t.value.roleId),D.nk.success("æ–°å¢žæˆåŠŸ")),o.value=!1;const e=await ja.getDAE_RelEIPUserRole_JOIN_WF_RolesData();l.value=e.data}}))}catch(e){console.error("æ“ä½œå¤±æ•—:",e),D.nk.error("æ“ä½œå¤±æ•—: "+e.message)}},v=(0,d.KR)([]),b=(0,d.KR)([]),g=async()=>{const e=await ja.getWF_RoleData();v.value=e.data},y=async()=>{const e=await ja.getUserData();b.value=e.data};return(0,u.sV)((async()=>{const e=await ja.getDAE_RelEIPUserRole_JOIN_WF_RolesData();await g(),await y(),l.value=e.data})),(0,u.wB)((()=>t.value.roleId),(e=>{const a=v.value.find((a=>a.id===e));t.value.roleName=a?a.name:""})),(0,u.wB)((()=>t.value.userId),(e=>{const a=b.value.find((a=>a.id===e));t.value.userName=a?a.name:""})),(e,l)=>{const d=(0,u.g2)("el-input"),g=(0,u.g2)("el-button"),y=(0,u.g2)("el-table-column"),f=(0,u.g2)("el-table"),h=(0,u.g2)("el-option"),k=(0,u.g2)("el-select"),_=(0,u.g2)("el-form-item"),w=(0,u.g2)("el-form"),F=(0,u.g2)("el-dialog");return(0,u.uX)(),(0,u.CE)(u.FK,null,[(0,u.Lk)("div",null,[(0,u.bF)(d,{modelValue:a.value,"onUpdate:modelValue":l[0]||(l[0]=e=>a.value=e),placeholder:"ä½¿ç”¨è€…ID or è§’è‰²åç¨±",style:{width:"200px","margin-right":"10px"}},null,8,["modelValue"]),(0,u.bF)(g,{type:"success",onClick:s},{default:(0,u.k6)((()=>l[7]||(l[7]=[(0,u.eW)("æ–°å¢žä½¿ç”¨è€…è§’è‰²")]))),_:1}),(0,u.bF)(f,{data:p.value,style:{width:"100%"}},{default:(0,u.k6)((()=>[(0,u.bF)(y,{prop:"userId",label:"ä½¿ç”¨è€…ID",width:"150"}),(0,u.bF)(y,{prop:"userName",label:"ä½¿ç”¨è€…åç¨±",width:"150"},{default:(0,u.k6)((e=>[(0,u.bF)(yl,{"employee-id":e.row.userId},null,8,["employee-id"])])),_:1}),(0,u.bF)(y,{prop:"roleId",label:"è§’è‰²ID",width:"250"}),(0,u.bF)(y,{prop:"roleName",label:"è§’è‰²åç¨±",width:"200"}),(0,u.bF)(y,{label:"æ“ä½œ"},{default:(0,u.k6)((e=>[(0,u.bF)(g,{type:"primary",onClick:a=>c(e.row)},{default:(0,u.k6)((()=>l[8]||(l[8]=[(0,u.eW)("ç·¨è¼¯")]))),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"]),(0,u.bF)(F,{modelValue:o.value,"onUpdate:modelValue":l[6]||(l[6]=e=>o.value=e),title:r.value?"ç·¨è¼¯ä½¿ç”¨è€…è§’è‰²":"æ–°å¢žä½¿ç”¨è€…è§’è‰²",style:{width:"20rem"}},{footer:(0,u.k6)((()=>[(0,u.bF)(g,{onClick:l[5]||(l[5]=e=>o.value=!1)},{default:(0,u.k6)((()=>l[9]||(l[9]=[(0,u.eW)("å–æ¶ˆ")]))),_:1}),(0,u.bF)(g,{type:"primary",onClick:m},{default:(0,u.k6)((()=>l[10]||(l[10]=[(0,u.eW)("å®Œæˆ")]))),_:1})])),default:(0,u.k6)((()=>[(0,u.bF)(w,{model:t.value,ref_key:"editFormRef",ref:n,rules:i,"label-width":"100px"},{default:(0,u.k6)((()=>[(0,u.bF)(_,{label:"ä½¿ç”¨è€…ID",prop:"userId"},{default:(0,u.k6)((()=>[(0,u.bF)(k,{modelValue:t.value.userId,"onUpdate:modelValue":l[1]||(l[1]=e=>t.value.userId=e),placeholder:"è«‹é¸æ“‡ä½¿ç”¨è€…",style:{width:"100%"}},{default:(0,u.k6)((()=>[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(b.value,(e=>((0,u.uX)(),(0,u.Wv)(h,{key:e.id,label:`${e.id} - ${e.name}`,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,u.bF)(_,{label:"ä½¿ç”¨è€…åç¨±",prop:"userName"},{default:(0,u.k6)((()=>[(0,u.bF)(d,{modelValue:t.value.userName,"onUpdate:modelValue":l[2]||(l[2]=e=>t.value.userName=e),disabled:"",style:{width:"100%"}},null,8,["modelValue"])])),_:1}),(0,u.bF)(_,{label:"è§’è‰²ID",prop:"roleId"},{default:(0,u.k6)((()=>[(0,u.bF)(k,{modelValue:t.value.roleId,"onUpdate:modelValue":l[3]||(l[3]=e=>t.value.roleId=e),placeholder:"è«‹é¸æ“‡è§’è‰²",style:{width:"100%"}},{default:(0,u.k6)((()=>[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(v.value,(e=>((0,u.uX)(),(0,u.Wv)(h,{key:e.id,label:`${e.id} - ${e.name}`,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,u.bF)(_,{label:"è§’è‰²åç¨±",prop:"roleName"},{default:(0,u.k6)((()=>[(0,u.bF)(d,{modelValue:t.value.roleName,"onUpdate:modelValue":l[4]||(l[4]=e=>t.value.roleName=e),disabled:"",style:{width:"100%"}},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue","title"])]),(0,u.Lk)("div",df,[(0,u.bF)(uf)])],64)}}};const pf=cf;var mf=pf,vf={__name:"DAE_Rel_UserRole",setup(e){const a=(0,d.KR)(""),l=(0,d.KR)([]),t=(0,d.KR)({userId:"",userName:"",roleId:"",roleName:""}),o=(0,d.KR)(!1),n=(0,d.KR)(null),r=(0,d.KR)(!1),s=(0,d.KR)([]),i=(0,d.KR)([]),c=(0,d.KR)(""),p=(0,d.KR)(""),m=()=>{r.value=!1,t.value={userId:"",userName:"",roleId:"",roleName:""},o.value=!0},v={userId:[{required:!0,message:"ä½¿ç”¨è€…IDä¸å¯ç‚ºç©º",trigger:"change"}],roleId:[{required:!0,message:"è§’è‰²IDä¸å¯ç‚ºç©º",trigger:"change"}]},b=e=>{r.value=!0,t.value={...e},o.value=!0},g=({prop:e,order:a})=>{c.value=e,p.value=a},y=(0,u.EW)((()=>{const e=a.value.toLowerCase();let t=l.value.filter((a=>a.userId&&a.userId.toLowerCase().includes(e)||a.userName&&a.userName.toLowerCase().includes(e)||a.roleName&&a.roleName.toLowerCase().includes(e)));return c.value&&p.value&&(t=t.sort(((e,a)=>{const l=e[c.value],t=a[c.value];return null===l||void 0===l?"ascending"===p.value?-1:1:null===t||void 0===t?"ascending"===p.value?1:-1:"string"===typeof l&&"string"===typeof t?"ascending"===p.value?l.localeCompare(t):t.localeCompare(l):"ascending"===p.value?l-t:t-l}))),t})),f=async()=>{if(n.value)try{await n.value.validate((async e=>{if(!e)return D.nk.error("è«‹æª¢æŸ¥å¿…å¡«æ¬„ä½"),!1;{r.value?(await ja.updateUserRoleData(t.value),D.nk.success("æ›´æ–°æˆåŠŸ")):(await ja.addUserWFRoleData(t.value.userId,t.value.roleId),D.nk.success("æ–°å¢žæˆåŠŸ")),o.value=!1;const e=await ja.getRelUserRole();l.value=e.data}}))}catch(e){console.error("æ“ä½œå¤±æ•—:",e),D.nk.error("æ“ä½œå¤±æ•—: "+e.message)}},h=async e=>{try{await Sa.s.confirm("ç¢ºå®šè¦åˆªé™¤æ­¤ç­†è³‡æ–™å—Žï¼Ÿ","æç¤º",{confirmButtonText:"ç¢ºå®š",cancelButtonText:"å–æ¶ˆ",type:"warning"}),await ja.deleteUserWFRoleData(e.userId,e.roleId),D.nk.success("åˆªé™¤æˆåŠŸ");const a=await ja.getRelUserRole();l.value=a.data}catch(a){"cancel"!==a&&(console.error("åˆªé™¤å¤±æ•—:",a),D.nk.error("åˆªé™¤å¤±æ•—: "+a.message))}},k=async()=>{const e=await ja.getRoleData();s.value=e.data},_=async()=>{const e=await ja.getUserData();i.value=e.data};return(0,u.sV)((async()=>{await k(),await _();const e=await ja.getRelUserRole();l.value=e.data})),(0,u.wB)((()=>t.value.userId),(e=>{const a=i.value.find((a=>a.id===e));t.value.userName=a?a.name:""})),(0,u.wB)((()=>t.value.roleId),(e=>{const a=s.value.find((a=>a.id===e));t.value.roleName=a?a.name:""})),(e,d)=>{const c=(0,u.g2)("el-input"),p=(0,u.g2)("el-button"),k=(0,u.g2)("el-table-column"),_=(0,u.g2)("el-table"),w=(0,u.g2)("el-option"),F=(0,u.g2)("el-select"),C=(0,u.g2)("el-form-item"),D=(0,u.g2)("el-form"),L=(0,u.g2)("el-dialog");return(0,u.uX)(),(0,u.CE)("div",null,[(0,u.bF)(c,{modelValue:a.value,"onUpdate:modelValue":d[0]||(d[0]=e=>a.value=e),placeholder:"ä½¿ç”¨è€…ID or è§’è‰²åç¨± or ä½¿ç”¨è€…åç¨±",style:{width:"200px","margin-right":"10px"}},null,8,["modelValue"]),(0,u.bF)(p,{type:"success",onClick:m},{default:(0,u.k6)((()=>d[7]||(d[7]=[(0,u.eW)("æ–°å¢žå¸³è™Ÿæ¬Šé™è³‡æ–™")]))),_:1}),l.value.length>0?((0,u.uX)(),(0,u.Wv)(_,{key:0,data:y.value,style:{width:"100%"},onSortChange:g},{default:(0,u.k6)((()=>[(0,u.bF)(k,{prop:"userId",label:"ä½¿ç”¨è€…ID",width:"150",sortable:"custom"}),(0,u.bF)(k,{prop:"userName",label:"ä½¿ç”¨è€…åç¨±",width:"150",sortable:"custom"}),(0,u.bF)(k,{prop:"roleId",label:"æ¬Šé™ID",width:"250",sortable:"custom"}),(0,u.bF)(k,{prop:"roleName",label:"æ¬Šé™åç¨±",width:"200",sortable:"custom"}),(0,u.bF)(k,{prop:"roleRemark",label:"æ¬Šé™æè¿°",width:"200",sortable:"custom"}),(0,u.bF)(k,{prop:"roleAreaId",label:"æ¬Šé™é©ç”¨åœ°å€(åƒè€ƒç”¨)",width:"200"},{default:(0,u.k6)((e=>[(0,u.bF)(rt,{areaId:e.row.roleAreaId},null,8,["areaId"])])),_:1}),(0,u.bF)(k,{prop:"roleDptId",label:"æ¬Šé™é©ç”¨éƒ¨é–€(åƒè€ƒç”¨)",width:"200"},{default:(0,u.k6)((e=>[(0,u.bF)(_l,{mode:"Description","dept-id":e.row.roleDptId},null,8,["dept-id"])])),_:1}),(0,u.bF)(k,{label:"æ“ä½œ"},{default:(0,u.k6)((e=>[(0,u.bF)(p,{type:"primary",onClick:a=>b(e.row)},{default:(0,u.k6)((()=>d[8]||(d[8]=[(0,u.eW)("ç·¨è¼¯")]))),_:2},1032,["onClick"]),(0,u.bF)(p,{type:"danger",onClick:a=>h(e.row)},{default:(0,u.k6)((()=>d[9]||(d[9]=[(0,u.eW)("åˆªé™¤")]))),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])):(0,u.Q3)("",!0),(0,u.bF)(L,{modelValue:o.value,"onUpdate:modelValue":d[6]||(d[6]=e=>o.value=e),title:r.value?"ç·¨è¼¯å¸³è™Ÿæ¬Šé™è³‡æ–™":"æ–°å¢žå¸³è™Ÿæ¬Šé™è³‡æ–™",style:{width:"20rem"}},{footer:(0,u.k6)((()=>[(0,u.bF)(p,{onClick:d[5]||(d[5]=e=>o.value=!1)},{default:(0,u.k6)((()=>d[10]||(d[10]=[(0,u.eW)("å–æ¶ˆ")]))),_:1}),(0,u.bF)(p,{type:"primary",onClick:f},{default:(0,u.k6)((()=>d[11]||(d[11]=[(0,u.eW)("å®Œæˆ")]))),_:1})])),default:(0,u.k6)((()=>[(0,u.bF)(D,{model:t.value,ref_key:"editFormRef",ref:n,rules:v,"label-width":"100px"},{default:(0,u.k6)((()=>[(0,u.bF)(C,{label:"ä½¿ç”¨è€…ID",prop:"userId"},{default:(0,u.k6)((()=>[(0,u.bF)(F,{modelValue:t.value.userId,"onUpdate:modelValue":d[1]||(d[1]=e=>t.value.userId=e),placeholder:"è«‹é¸æ“‡ä½¿ç”¨è€…",style:{width:"100%"}},{default:(0,u.k6)((()=>[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(i.value,(e=>((0,u.uX)(),(0,u.Wv)(w,{key:e.id,label:`${e.id} - ${e.name}`,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,u.bF)(C,{label:"ä½¿ç”¨è€…åç¨±",prop:"userName"},{default:(0,u.k6)((()=>[(0,u.bF)(c,{modelValue:t.value.userName,"onUpdate:modelValue":d[2]||(d[2]=e=>t.value.userName=e),disabled:"",style:{width:"100%"}},null,8,["modelValue"])])),_:1}),(0,u.bF)(C,{label:"æ¬Šé™ID",prop:"roleId"},{default:(0,u.k6)((()=>[(0,u.bF)(F,{modelValue:t.value.roleId,"onUpdate:modelValue":d[3]||(d[3]=e=>t.value.roleId=e),placeholder:"è«‹é¸æ“‡è§’è‰²",style:{width:"100%"}},{default:(0,u.k6)((()=>[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(s.value,(e=>((0,u.uX)(),(0,u.Wv)(w,{key:e.id,label:`${e.id} - ${e.name}`,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,u.bF)(C,{label:"æ¬Šé™åç¨±",prop:"roleName"},{default:(0,u.k6)((()=>[(0,u.bF)(c,{modelValue:t.value.roleName,"onUpdate:modelValue":d[4]||(d[4]=e=>t.value.roleName=e),disabled:"",style:{width:"100%"}},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue","title"])])}}};const bf=vf;var gf=bf;const yf={class:"audit-events-container"},ff={class:"search-section"},hf={class:"search-form"},kf={class:"form-item"},_f={class:"form-item"},wf={class:"form-item"},Ff={class:"form-item"},Cf={class:"table-section"},Df={class:"table-header"},Lf={class:"table-info"};var Rf={__name:"DAE_AuditEventsTable",setup(e){const a=(0,d.KR)(!1),l=(0,d.KR)([]),t=(0,d.KR)({from:null,to:null,top:500}),o=async()=>{a.value=!0;try{const e={};t.value.from&&(e.from=t.value.from),t.value.to&&(e.to=t.value.to),t.value.top&&(e.top=t.value.top),console.log("æŸ¥è©¢ç¨½æ ¸äº‹ä»¶åƒæ•¸:",e);const a=await W.A.getAuditEvents(e);a.data?l.value=a.data:(l.value=[],D.nk.warning("æœªæ‰¾åˆ°ç¨½æ ¸äº‹ä»¶è¨˜éŒ„"))}catch(e){console.error("å–å¾—ç¨½æ ¸äº‹ä»¶æ™‚ç™¼ç”ŸéŒ¯èª¤:",e),D.nk.error("å–å¾—ç¨½æ ¸äº‹ä»¶å¤±æ•—: "+(e.response?.data?.message||e.message)),l.value=[]}finally{a.value=!1}},n=e=>{if(!e)return"-";try{const a=new Date(e);return a.toLocaleString("zh-TW",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})}catch(a){return e}},r=e=>{if(!e)return"info";const a=e.trim();switch(a){case"LGIS":return"success";case"LGO":return"warning";case"LGIF":return"danger";default:return"info"}},s=()=>{const e=new Date,a=new Date(e.getTime()-864e5);t.value.to=e.toISOString().slice(0,19),t.value.from=a.toISOString().slice(0,19)};return(0,u.sV)((()=>{s(),o()})),(e,s)=>{const i=(0,u.g2)("el-date-picker"),c=(0,u.g2)("el-col"),p=(0,u.g2)("el-input-number"),m=(0,u.g2)("el-icon"),v=(0,u.g2)("el-button"),b=(0,u.g2)("el-row"),g=(0,u.g2)("el-card"),y=(0,u.g2)("el-table-column"),f=(0,u.g2)("el-tag"),h=(0,u.g2)("el-table"),k=(0,u.gN)("loading");return(0,u.uX)(),(0,u.CE)("div",yf,[(0,u.Lk)("div",ff,[(0,u.bF)(g,{class:"search-card"},{default:(0,u.k6)((()=>[(0,u.Lk)("div",hf,[(0,u.bF)(b,{gutter:20},{default:(0,u.k6)((()=>[(0,u.bF)(c,{span:8},{default:(0,u.k6)((()=>[(0,u.Lk)("div",kf,[s[3]||(s[3]=(0,u.Lk)("label",{class:"form-label"},"é–‹å§‹æ™‚é–“:",-1)),(0,u.bF)(i,{modelValue:t.value.from,"onUpdate:modelValue":s[0]||(s[0]=e=>t.value.from=e),type:"datetime",placeholder:"é¸æ“‡é–‹å§‹æ™‚é–“",format:"YYYY-MM-DD HH:mm:ss","value-format":"YYYY-MM-DDTHH:mm:ss",style:{width:"100%"}},null,8,["modelValue"])])])),_:1}),(0,u.bF)(c,{span:8},{default:(0,u.k6)((()=>[(0,u.Lk)("div",_f,[s[4]||(s[4]=(0,u.Lk)("label",{class:"form-label"},"çµæŸæ™‚é–“:",-1)),(0,u.bF)(i,{modelValue:t.value.to,"onUpdate:modelValue":s[1]||(s[1]=e=>t.value.to=e),type:"datetime",placeholder:"é¸æ“‡çµæŸæ™‚é–“",format:"YYYY-MM-DD HH:mm:ss","value-format":"YYYY-MM-DDTHH:mm:ss",style:{width:"100%"}},null,8,["modelValue"])])])),_:1}),(0,u.bF)(c,{span:4},{default:(0,u.k6)((()=>[(0,u.Lk)("div",wf,[s[5]||(s[5]=(0,u.Lk)("label",{class:"form-label"},"ç­†æ•¸é™åˆ¶:",-1)),(0,u.bF)(p,{modelValue:t.value.top,"onUpdate:modelValue":s[2]||(s[2]=e=>t.value.top=e),min:1,max:1e4,placeholder:"æœ€å¤§ç­†æ•¸",style:{width:"100%"}},null,8,["modelValue"])])])),_:1}),(0,u.bF)(c,{span:4},{default:(0,u.k6)((()=>[(0,u.Lk)("div",Ff,[(0,u.bF)(v,{type:"primary",onClick:o,loading:a.value,style:{width:"100%"}},{default:(0,u.k6)((()=>[(0,u.bF)(m,null,{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.Search))])),_:1}),s[6]||(s[6]=(0,u.eW)(" æŸ¥è©¢ "))])),_:1},8,["loading"])])])),_:1})])),_:1})])])),_:1})]),(0,u.Lk)("div",Cf,[(0,u.bF)(g,{class:"table-card"},{header:(0,u.k6)((()=>[(0,u.Lk)("div",Df,[(0,u.Lk)("h3",null,[(0,u.bF)(m,null,{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.Monitor))])),_:1}),s[7]||(s[7]=(0,u.eW)(" ç³»çµ±ç¨½æ ¸äº‹ä»¶è¨˜éŒ„ "))]),(0,u.Lk)("div",Lf,[(0,u.Lk)("span",null,"å…± "+(0,L.v_)(l.value.length)+" ç­†è¨˜éŒ„",1)])])])),default:(0,u.k6)((()=>[(0,u.bo)(((0,u.uX)(),(0,u.Wv)(h,{data:l.value,stripe:"",border:"",height:"600",style:{width:"100%"},"default-sort":{prop:"event_time_TW",order:"descending"}},{default:(0,u.k6)((()=>[(0,u.bF)(y,{prop:"event_time_TW",label:"äº‹ä»¶æ™‚é–“ (å°ç£)",width:"180",sortable:""},{default:(0,u.k6)((({row:e})=>[(0,u.Lk)("span",null,(0,L.v_)(n(e.event_time_TW)),1)])),_:1}),(0,u.bF)(y,{prop:"event_time_UTC",label:"äº‹ä»¶æ™‚é–“ (UTC)",width:"180",sortable:""},{default:(0,u.k6)((({row:e})=>[(0,u.Lk)("span",null,(0,L.v_)(n(e.event_time_UTC)),1)])),_:1}),(0,u.bF)(y,{prop:"action_id",label:"å‹•ä½œé¡žåž‹",width:"120",align:"center"},{default:(0,u.k6)((({row:e})=>[(0,u.bF)(f,{type:r(e.action_id),size:"small"},{default:(0,u.k6)((()=>[(0,u.eW)((0,L.v_)(e.action_id?.trim()),1)])),_:2},1032,["type"])])),_:1}),(0,u.bF)(y,{prop:"succeeded",label:"åŸ·è¡Œçµæžœ",width:"100",align:"center"},{default:(0,u.k6)((({row:e})=>[(0,u.bF)(f,{type:e.succeeded?"success":"danger",size:"small"},{default:(0,u.k6)((()=>[(0,u.eW)((0,L.v_)(e.succeeded?"æˆåŠŸ":"å¤±æ•—"),1)])),_:2},1032,["type"])])),_:1}),(0,u.bF)(y,{prop:"server_principal_name",label:"ä¼ºæœå™¨ä¸»é«”",width:"150"}),(0,u.bF)(y,{prop:"client_ip",label:"å®¢æˆ¶ç«¯ IP",width:"140"}),(0,u.bF)(y,{prop:"application_name",label:"æ‡‰ç”¨ç¨‹å¼åç¨±","min-width":"200","show-overflow-tooltip":""}),(0,u.bF)(y,{prop:"session_id",label:"æœƒè©± ID",width:"100",align:"center"})])),_:1},8,["data"])),[[k,a.value]])])),_:1})])])}}};const Vf=(0,ie.A)(Rf,[["__scopeId","data-v-73b07908"]]);var If=Vf,xf={__name:"WF_WorkflowFormTable",setup(e){const a=(0,d.KR)([]),l=(0,d.KR)(!0),t=async()=>{l.value=!0;try{const e=await Ma.getWorkflowForms();a.value=e.data}catch(e){console.error("Error fetching WorkflowForm data:",e),a.value=[]}finally{l.value=!1}};return(0,u.sV)((()=>{t()})),(e,t)=>{const o=(0,u.g2)("el-table-column"),n=(0,u.g2)("el-table"),r=(0,u.gN)("loading");return(0,u.uX)(),(0,u.CE)("div",null,[t[0]||(t[0]=(0,u.Lk)("h3",null,"å·¥ä½œæµç¨‹è¡¨å–®ç®¡ç†",-1)),(0,u.bo)(((0,u.uX)(),(0,u.Wv)(n,{data:a.value,style:{width:"100%"}},{default:(0,u.k6)((()=>[(0,u.bF)(o,{prop:"id",label:"ID",width:"180"}),(0,u.bF)(o,{prop:"name",label:"åç¨±",width:"180"}),(0,u.bF)(o,{prop:"description",label:"æè¿°"})])),_:1},8,["data"])),[[r,l.value]])])}}};const Ef=(0,ie.A)(xf,[["__scopeId","data-v-307c0de0"]]);var Af=Ef,Tf={__name:"WF_DocumentTypeTable",setup(e){const a=(0,d.KR)([]),l=(0,d.KR)(!0),t=async()=>{l.value=!0;try{const e=await Ma.getDocumentTypes();a.value=e.data}catch(e){console.error("Error fetching DocumentType data:",e),a.value=[]}finally{l.value=!1}};return(0,u.sV)((()=>{t()})),(e,t)=>{const o=(0,u.g2)("el-table-column"),n=(0,u.g2)("el-table"),r=(0,u.gN)("loading");return(0,u.uX)(),(0,u.CE)("div",null,[t[0]||(t[0]=(0,u.Lk)("h3",null,"æ–‡ä»¶é¡žåž‹ç®¡ç†",-1)),(0,u.bo)(((0,u.uX)(),(0,u.Wv)(n,{data:a.value,style:{width:"100%"}},{default:(0,u.k6)((()=>[(0,u.bF)(o,{prop:"documentTypeID",label:"æ–‡ä»¶é¡žåž‹ID",width:"180"}),(0,u.bF)(o,{prop:"documentTypeName",label:"æ–‡ä»¶é¡žåž‹åç¨±",width:"180"}),(0,u.bF)(o,{prop:"description",label:"æè¿°"})])),_:1},8,["data"])),[[r,l.value]])])}}};const Wf=(0,ie.A)(Tf,[["__scopeId","data-v-d4fe7dfe"]]);var Sf=Wf,Uf={__name:"WF_ApprovalWorkflowTable",setup(e){const a=(0,d.KR)([]),l=(0,d.KR)(!0),t=async()=>{l.value=!0;try{const e=await Ma.getApprovalWorkflows();a.value=e.data}catch(e){console.error("Error fetching ApprovalWorkflow data:",e),a.value=[]}finally{l.value=!1}};return(0,u.sV)((()=>{t()})),(e,t)=>{const o=(0,u.g2)("el-table-column"),n=(0,u.g2)("el-table"),r=(0,u.gN)("loading");return(0,u.uX)(),(0,u.CE)("div",null,[t[0]||(t[0]=(0,u.Lk)("h3",null,"ç°½æ ¸å·¥ä½œæµç¨‹ç®¡ç†",-1)),(0,u.bo)(((0,u.uX)(),(0,u.Wv)(n,{data:a.value,style:{width:"100%"}},{default:(0,u.k6)((()=>[(0,u.bF)(o,{prop:"workflowID",label:"å·¥ä½œæµç¨‹ID",width:"180"}),(0,u.bF)(o,{prop:"documentTypeID",label:"æ–‡ä»¶é¡žåž‹ID",width:"180"}),(0,u.bF)(o,{prop:"workflowName",label:"å·¥ä½œæµç¨‹åç¨±",width:"180"}),(0,u.bF)(o,{prop:"isActive",label:"æ˜¯å¦å•Ÿç”¨",width:"100"},{default:(0,u.k6)((({row:e})=>[(0,u.eW)((0,L.v_)(e.isActive?"æ˜¯":"å¦"),1)])),_:1}),(0,u.bF)(o,{prop:"remark",label:"å‚™è¨»"}),(0,u.bF)(o,{prop:"areaDistrict",label:"åœ°å€"})])),_:1},8,["data"])),[[r,l.value]])])}}};const $f=(0,ie.A)(Uf,[["__scopeId","data-v-8bda8e6e"]]);var Nf=$f,Xf={__name:"WF_ApprovalStepTable",setup(e){const a=(0,d.KR)([]),l=(0,d.KR)(!0),t={0:"ç”³è«‹",1:"ä¸€èˆ¬ç°½æ ¸",2:"ä¸²ç°½",3:"ä¸¦ç°½",4:"æœƒç°½",5:"åŠ ç°½",6:"çŸ¥æœƒ",7:"é™æ™‚",8:"é€€å›ž",9:"å†æ¬¡ç”³è«‹",99:"çµæŸ"},o=e=>t[e]||e,n=async()=>{l.value=!0;try{const e=await Ma.getApprovalSteps_ReferenceData();a.value=e.data}catch(e){console.error("Error fetching ApprovalStep data:",e),a.value=[]}finally{l.value=!1}};return(0,u.sV)((()=>{n()})),(e,t)=>{const n=(0,u.g2)("el-table-column"),r=(0,u.g2)("el-table"),s=(0,u.gN)("loading");return(0,u.uX)(),(0,u.CE)("div",null,[t[0]||(t[0]=(0,u.Lk)("h3",null,"ç°½æ ¸æ­¥é©Ÿç®¡ç†",-1)),(0,u.bo)(((0,u.uX)(),(0,u.Wv)(r,{data:a.value,style:{width:"100%"}},{default:(0,u.k6)((()=>[(0,u.bF)(n,{prop:"stepID",label:"æ­¥é©ŸID",width:"180"}),(0,u.bF)(n,{prop:"stepName",label:"æ­¥é©Ÿåç¨±",width:"180"}),(0,u.bF)(n,{prop:"workflowID",label:"å·¥ä½œæµç¨‹ID",width:"180"}),(0,u.bF)(n,{prop:"stepOrder",label:"æ­¥é©Ÿé †åº",width:"100"}),(0,u.bF)(n,{prop:"roleID",label:"è§’è‰²ID",width:"180"}),(0,u.bF)(n,{prop:"condition",label:"æ¢ä»¶"}),(0,u.bF)(n,{prop:"skipCondition",label:"è·³éŽæ¢ä»¶"}),(0,u.bF)(n,{prop:"stepType",label:"æ­¥é©Ÿé¡žåž‹",width:"120"},{default:(0,u.k6)((({row:e})=>[(0,u.eW)((0,L.v_)(o(e.stepType)),1)])),_:1}),(0,u.bF)(n,{prop:"timeout",label:"é€¾æ™‚æ™‚é–“",width:"180"}),(0,u.bF)(n,{prop:"autoApprove",label:"è‡ªå‹•æ ¸å‡†",width:"100"},{default:(0,u.k6)((({row:e})=>[(0,u.eW)((0,L.v_)(e.autoApprove?"æ˜¯":"å¦"),1)])),_:1}),(0,u.bF)(n,{prop:"autoReject",label:"è‡ªå‹•é§å›ž",width:"100"},{default:(0,u.k6)((({row:e})=>[(0,u.eW)((0,L.v_)(e.autoReject?"æ˜¯":"å¦"),1)])),_:1}),(0,u.bF)(n,{prop:"escalationRuleID",label:"å‡ç´šè¦å‰‡ID",width:"180"}),(0,u.bF)(n,{prop:"participantType",label:"åƒèˆ‡è€…é¡žåž‹",width:"120"}),(0,u.bF)(n,{prop:"participantKey",label:"åƒèˆ‡è€…Key",width:"180"})])),_:1},8,["data"])),[[s,l.value]])])}}};const Kf=(0,ie.A)(Xf,[["__scopeId","data-v-976a573c"]]);var Mf=Kf,Pf={__name:"WF_ParallelGroupTable",setup(e){const a=(0,d.KR)([]),l=(0,d.KR)(!0),t=async()=>{l.value=!0;try{const e=await Ma.getParallelGroups();a.value=e.data}catch(e){console.error("Error fetching ParallelGroup data:",e),a.value=[]}finally{l.value=!1}};return(0,u.sV)((()=>{t()})),(e,t)=>{const o=(0,u.g2)("el-table-column"),n=(0,u.g2)("el-table"),r=(0,u.gN)("loading");return(0,u.uX)(),(0,u.CE)("div",null,[t[0]||(t[0]=(0,u.Lk)("h3",null,"ä¸¦ç°½ç¾¤çµ„ç®¡ç†",-1)),(0,u.bo)(((0,u.uX)(),(0,u.Wv)(n,{data:a.value,style:{width:"100%"}},{default:(0,u.k6)((()=>[(0,u.bF)(o,{prop:"parallelGroupID",label:"ä¸¦ç°½ç¾¤çµ„ID",width:"180"}),(0,u.bF)(o,{prop:"parallelGroupName",label:"ä¸¦ç°½ç¾¤çµ„åç¨±",width:"180"}),(0,u.bF)(o,{prop:"workflowID",label:"å·¥ä½œæµç¨‹ID"})])),_:1},8,["data"])),[[r,l.value]])])}}};const Of=(0,ie.A)(Pf,[["__scopeId","data-v-4f330d14"]]);var zf=Of,Bf={__name:"WF_CountersignGroupTable",setup(e){const a=(0,d.KR)([]),l=(0,d.KR)(!0),t=async()=>{l.value=!0;try{const e=await Ma.getCountersignGroups();a.value=e.data}catch(e){console.error("Error fetching CountersignGroup data:",e),a.value=[]}finally{l.value=!1}};return(0,u.sV)((()=>{t()})),(e,t)=>{const o=(0,u.g2)("el-table-column"),n=(0,u.g2)("el-table"),r=(0,u.gN)("loading");return(0,u.uX)(),(0,u.CE)("div",null,[t[0]||(t[0]=(0,u.Lk)("h3",null,"æœƒç°½ç¾¤çµ„ç®¡ç†",-1)),(0,u.bo)(((0,u.uX)(),(0,u.Wv)(n,{data:a.value,style:{width:"100%"}},{default:(0,u.k6)((()=>[(0,u.bF)(o,{prop:"countersignGroupID",label:"æœƒç°½ç¾¤çµ„ID",width:"180"}),(0,u.bF)(o,{prop:"countersignGroupName",label:"æœƒç°½ç¾¤çµ„åç¨±",width:"180"}),(0,u.bF)(o,{prop:"workflowID",label:"å·¥ä½œæµç¨‹ID"})])),_:1},8,["data"])),[[r,l.value]])])}}};const jf=(0,ie.A)(Bf,[["__scopeId","data-v-2a7e8809"]]);var Yf=jf,Qf={__name:"WF_DocumentTable",setup(e){const a=(0,d.KR)([]),l=(0,d.KR)(!0),t=async()=>{l.value=!0;try{const e=await Ma.getDocuments();a.value=e.data}catch(e){console.error("Error fetching Document data:",e),a.value=[]}finally{l.value=!1}};return(0,u.sV)((()=>{t()})),(e,t)=>{(0,u.g2)("el-button");const o=(0,u.g2)("el-table-column"),n=(0,u.g2)("el-table"),r=(0,u.gN)("loading");return(0,u.uX)(),(0,u.CE)("div",null,[t[1]||(t[1]=(0,u.Lk)("h3",null,"æ–‡ä»¶ç®¡ç†",-1)),(0,u.Q3)("",!0),(0,u.bo)(((0,u.uX)(),(0,u.Wv)(n,{data:a.value,style:{width:"100%"}},{default:(0,u.k6)((()=>[(0,u.bF)(o,{prop:"documentID",label:"æ–‡ä»¶ID",width:"180"}),(0,u.bF)(o,{prop:"documentTypeID",label:"æ–‡ä»¶é¡žåž‹ID",width:"180"}),(0,u.bF)(o,{prop:"creatorID",label:"å»ºç«‹è€…ID",width:"180"}),(0,u.bF)(o,{prop:"applierSupervisorID",label:"ç”³è«‹ä¸»ç®¡ID",width:"180"}),(0,u.bF)(o,{prop:"createdDate",label:"å»ºç«‹æ—¥æœŸ",width:"180"}),(0,u.bF)(o,{prop:"currentStatus",label:"ç›®å‰ç‹€æ…‹",width:"120"}),(0,u.bF)(o,{prop:"workflowID",label:"å·¥ä½œæµç¨‹ID",width:"180"}),(0,u.bF)(o,{prop:"withdrawDeadline",label:"æ’¤å›žæœŸé™",width:"180"}),(0,u.bF)(o,{prop:"withdrawn",label:"æ˜¯å¦å·²æ’¤å›ž",width:"120"},{default:(0,u.k6)((({row:e})=>[(0,u.eW)((0,L.v_)(e.withdrawn?"æ˜¯":"å¦"),1)])),_:1}),(0,u.bF)(o,{prop:"currentStepID",label:"ç›®å‰æ­¥é©ŸID",width:"180"}),(0,u.bF)(o,{prop:"urgencyLevel",label:"ç·Šæ€¥ç¨‹åº¦",width:"120"}),(0,u.bF)(o,{prop:"deadline",label:"æˆªæ­¢æ—¥æœŸ",width:"180"}),(0,u.bF)(o,{prop:"revisionNo",label:"ä¿®è¨‚è™Ÿç¢¼",width:"100"})])),_:1},8,["data"])),[[r,l.value]])])}}};const Hf=(0,ie.A)(Qf,[["__scopeId","data-v-b9928534"]]);var qf=Hf,Jf={__name:"WF_ApprovalRecordTable",setup(e){const a=(0,d.KR)([]),l=(0,d.KR)(!0),t={0:"ç™¼èµ·ç°½æ ¸",1:"æ ¸å‡†",2:"é€€å›ž",3:"ä½œå»¢æµç¨‹",4:"å†æ¬¡ç”³è«‹",5:"è½‰ç°½",6:"åŠ ç°½",7:"å‡ç´š/æ“´å……",8:"å§”æ´¾",9:"åƒ…å›žè¦†æ„è¦‹"},o=e=>t[e]||e,n=async()=>{l.value=!0;try{const e=await Ma.getApprovalRecords();a.value=e.data}catch(e){console.error("Error fetching ApprovalRecord data:",e),a.value=[]}finally{l.value=!1}};return(0,u.sV)((()=>{n()})),(e,t)=>{const n=(0,u.g2)("el-table-column"),r=(0,u.g2)("el-table"),s=(0,u.gN)("loading");return(0,u.uX)(),(0,u.CE)("div",null,[t[0]||(t[0]=(0,u.Lk)("h3",null,"ç°½æ ¸è¨˜éŒ„ç®¡ç†",-1)),(0,u.bo)(((0,u.uX)(),(0,u.Wv)(r,{data:a.value,style:{width:"100%"}},{default:(0,u.k6)((()=>[(0,u.bF)(n,{prop:"recordID",label:"è¨˜éŒ„ID",width:"180"}),(0,u.bF)(n,{prop:"documentID",label:"æ–‡ä»¶ID",width:"180"}),(0,u.bF)(n,{prop:"version",label:"ç‰ˆæœ¬",width:"100"}),(0,u.bF)(n,{prop:"stepType",label:"æ­¥é©Ÿé¡žåž‹",width:"120"}),(0,u.bF)(n,{prop:"stepID",label:"æ­¥é©ŸID",width:"180"}),(0,u.bF)(n,{prop:"approverID",label:"ç°½æ ¸äººID",width:"180"}),(0,u.bF)(n,{prop:"action",label:"å‹•ä½œ",width:"120"},{default:(0,u.k6)((({row:e})=>[(0,u.eW)((0,L.v_)(o(e.action)),1)])),_:1}),(0,u.bF)(n,{prop:"comment",label:"è©•è«–"}),(0,u.bF)(n,{prop:"actionDate",label:"å‹•ä½œæ—¥æœŸ",width:"180"}),(0,u.bF)(n,{prop:"backToStepID",label:"é€€å›žæ­¥é©ŸID",width:"180"}),(0,u.bF)(n,{prop:"batchID",label:"æ‰¹æ¬¡ID",width:"180"})])),_:1},8,["data"])),[[s,l.value]])])}}};const Gf=(0,ie.A)(Jf,[["__scopeId","data-v-2e592406"]]);var Zf=Gf,eh={__name:"WF_StepInsertionTable",setup(e){const a=(0,d.KR)([]),l=(0,d.KR)(!0),t=async()=>{l.value=!0;try{const e=await Ma.getStepInsertions();a.value=e.data}catch(e){console.error("Error fetching StepInsertion data:",e),a.value=[]}finally{l.value=!1}};return(0,u.sV)((()=>{t()})),(e,t)=>{const o=(0,u.g2)("el-table-column"),n=(0,u.g2)("el-table"),r=(0,u.gN)("loading");return(0,u.uX)(),(0,u.CE)("div",null,[t[0]||(t[0]=(0,u.Lk)("h3",null,"æ­¥é©Ÿæ’å…¥ç®¡ç†",-1)),(0,u.bo)(((0,u.uX)(),(0,u.Wv)(n,{data:a.value,style:{width:"100%"}},{default:(0,u.k6)((()=>[(0,u.bF)(o,{prop:"insertionID",label:"æ’å…¥ID",width:"180"}),(0,u.bF)(o,{prop:"documentID",label:"æ–‡ä»¶ID",width:"180"}),(0,u.bF)(o,{prop:"referenceStepID",label:"åƒè€ƒæ­¥é©ŸID",width:"180"}),(0,u.bF)(o,{prop:"insertToStepOrder",label:"æ’å…¥æ­¥é©Ÿé †åº",width:"150"}),(0,u.bF)(o,{prop:"insertToStepID",label:"æ’å…¥ç›®æ¨™æ­¥é©ŸID",width:"180"}),(0,u.bF)(o,{prop:"position",label:"ä½ç½®",width:"100"}),(0,u.bF)(o,{prop:"eip_UserID",label:"EIPä½¿ç”¨è€…ID",width:"180"}),(0,u.bF)(o,{prop:"createdBy",label:"å»ºç«‹è€…",width:"180"}),(0,u.bF)(o,{prop:"createdDate",label:"å»ºç«‹æ—¥æœŸ",width:"180"})])),_:1},8,["data"])),[[r,l.value]])])}}};const ah=(0,ie.A)(eh,[["__scopeId","data-v-40a7da70"]]);var lh=ah,th={__name:"WF_NotificationLogTable",setup(e){const a=(0,d.KR)([]),l=(0,d.KR)(!0),t=async()=>{l.value=!0;try{const e=await Ma.getNotificationLogs();a.value=e.data}catch(e){console.error("Error fetching NotificationLog data:",e),a.value=[]}finally{l.value=!1}};return(0,u.sV)((()=>{t()})),(e,t)=>{const o=(0,u.g2)("el-table-column"),n=(0,u.g2)("el-table"),r=(0,u.gN)("loading");return(0,u.uX)(),(0,u.CE)("div",null,[t[0]||(t[0]=(0,u.Lk)("h3",null,"é€šçŸ¥æ—¥èªŒç®¡ç†",-1)),(0,u.bo)(((0,u.uX)(),(0,u.Wv)(n,{data:a.value,style:{width:"100%"}},{default:(0,u.k6)((()=>[(0,u.bF)(o,{prop:"logID",label:"æ—¥èªŒID",width:"180"}),(0,u.bF)(o,{prop:"documentID",label:"æ–‡ä»¶ID",width:"180"}),(0,u.bF)(o,{prop:"stepID",label:"æ­¥é©ŸID",width:"180"}),(0,u.bF)(o,{prop:"notifiedTo",label:"é€šçŸ¥å°è±¡",width:"180"}),(0,u.bF)(o,{prop:"channel",label:"é€šé“",width:"120"}),(0,u.bF)(o,{prop:"sentAt",label:"ç™¼é€æ™‚é–“",width:"180"}),(0,u.bF)(o,{prop:"status",label:"ç‹€æ…‹",width:"120"}),(0,u.bF)(o,{prop:"stepType",label:"æ­¥é©Ÿé¡žåž‹",width:"120"})])),_:1},8,["data"])),[[r,l.value]])])}}};const oh=(0,ie.A)(th,[["__scopeId","data-v-35cdcc65"]]);var nh=oh,rh={__name:"WF_DocumentNotificationRecipientTable",setup(e){const a=(0,d.KR)([]),l=(0,d.KR)(!0),t=async()=>{l.value=!0;try{const e=await Ma.getDocumentNotificationRecipients();a.value=e.data}catch(e){console.error("Error fetching DocumentNotificationRecipient data:",e),a.value=[]}finally{l.value=!1}};return(0,u.sV)((()=>{t()})),(e,t)=>{const o=(0,u.g2)("el-table-column"),n=(0,u.g2)("el-table"),r=(0,u.gN)("loading");return(0,u.uX)(),(0,u.CE)("div",null,[t[0]||(t[0]=(0,u.Lk)("h3",null,"æ–‡ä»¶é€šçŸ¥æŽ¥æ”¶è€…ç®¡ç†",-1)),(0,u.bo)(((0,u.uX)(),(0,u.Wv)(n,{data:a.value,style:{width:"100%"}},{default:(0,u.k6)((()=>[(0,u.bF)(o,{prop:"recipientID",label:"æŽ¥æ”¶è€…ID",width:"250"}),(0,u.bF)(o,{prop:"documentNotificationID",label:"æ–‡ä»¶é€šçŸ¥ID",width:"250"}),(0,u.bF)(o,{prop:"recipientType",label:"æŽ¥æ”¶è€…é¡žåž‹",width:"150"}),(0,u.bF)(o,{prop:"recipientReferenceID",label:"æŽ¥æ”¶è€…åƒè€ƒID"})])),_:1},8,["data"])),[[r,l.value]])])}}};const sh=(0,ie.A)(rh,[["__scopeId","data-v-17da6c19"]]);var uh=sh,ih={__name:"WF_DocumentNotificationTable",setup(e){const a=(0,d.KR)([]),l=(0,d.KR)(!0),t=async()=>{l.value=!0;try{const e=await Ma.getDocumentNotifications();a.value=e.data}catch(e){console.error("Error fetching DocumentNotification data:",e),a.value=[]}finally{l.value=!1}};return(0,u.sV)((()=>{t()})),(e,t)=>{const o=(0,u.g2)("el-table-column"),n=(0,u.g2)("el-table"),r=(0,u.gN)("loading");return(0,u.uX)(),(0,u.CE)("div",null,[t[0]||(t[0]=(0,u.Lk)("h3",null,"æ–‡ä»¶é€šçŸ¥ç®¡ç†",-1)),(0,u.bo)(((0,u.uX)(),(0,u.Wv)(n,{data:a.value,style:{width:"100%"}},{default:(0,u.k6)((()=>[(0,u.bF)(o,{prop:"documentNotificationID",label:"æ–‡ä»¶é€šçŸ¥ID",width:"250"}),(0,u.bF)(o,{prop:"documentID",label:"æ–‡ä»¶ID",width:"180"}),(0,u.bF)(o,{prop:"eventType",label:"äº‹ä»¶é¡žåž‹",width:"150"}),(0,u.bF)(o,{prop:"stepID",label:"æ­¥é©ŸID",width:"180"}),(0,u.bF)(o,{prop:"createdBy",label:"å»ºç«‹è€…",width:"180"}),(0,u.bF)(o,{prop:"createdAt",label:"å»ºç«‹æ™‚é–“",width:"180"})])),_:1},8,["data"])),[[r,l.value]])])}}};const dh=(0,ie.A)(ih,[["__scopeId","data-v-2a813e37"]]);var ch=dh,ph={__name:"WF_CountersignGroupMemberTable",setup(e){const a=(0,d.KR)([]),l=(0,d.KR)(!0),t=async()=>{l.value=!0;try{const e=await Ma.getCountersignGroupMembers();a.value=e.data}catch(e){console.error("Error fetching CountersignGroupMember data:",e),a.value=[]}finally{l.value=!1}};return(0,u.sV)((()=>{t()})),(e,t)=>{const o=(0,u.g2)("el-table-column"),n=(0,u.g2)("el-table"),r=(0,u.gN)("loading");return(0,u.uX)(),(0,u.CE)("div",null,[t[0]||(t[0]=(0,u.Lk)("h3",null,"æœƒç°½ç¾¤çµ„æˆå“¡ç®¡ç†",-1)),(0,u.bo)(((0,u.uX)(),(0,u.Wv)(n,{data:a.value,style:{width:"100%"}},{default:(0,u.k6)((()=>[(0,u.bF)(o,{prop:"countersignGroupID",label:"æœƒç°½ç¾¤çµ„ID",width:"180"}),(0,u.bF)(o,{prop:"memberType",label:"æˆå“¡é¡žåž‹",width:"120"}),(0,u.bF)(o,{prop:"memberID",label:"æˆå“¡ID",width:"180"}),(0,u.bF)(o,{prop:"sortOrder",label:"æŽ’åºé †åº",width:"100"})])),_:1},8,["data"])),[[r,l.value]])])}}};const mh=(0,ie.A)(ph,[["__scopeId","data-v-2474f2c0"]]);var vh=mh,bh={__name:"WF_ParallelGroupMemberTable",setup(e){const a=(0,d.KR)([]),l=(0,d.KR)(!0),t=async()=>{l.value=!0;try{const e=await Ma.getParallelGroupMembers();a.value=e.data}catch(e){console.error("Error fetching ParallelGroupMember data:",e),a.value=[]}finally{l.value=!1}};return(0,u.sV)((()=>{t()})),(e,t)=>{const o=(0,u.g2)("el-table-column"),n=(0,u.g2)("el-table"),r=(0,u.gN)("loading");return(0,u.uX)(),(0,u.CE)("div",null,[t[0]||(t[0]=(0,u.Lk)("h3",null,"ä¸¦ç°½ç¾¤çµ„æˆå“¡ç®¡ç†",-1)),(0,u.bo)(((0,u.uX)(),(0,u.Wv)(n,{data:a.value,style:{width:"100%"}},{default:(0,u.k6)((()=>[(0,u.bF)(o,{prop:"parallelGroupID",label:"ä¸¦ç°½ç¾¤çµ„ID",width:"180"}),(0,u.bF)(o,{prop:"memberType",label:"æˆå“¡é¡žåž‹",width:"120"}),(0,u.bF)(o,{prop:"memberID",label:"æˆå“¡ID",width:"180"}),(0,u.bF)(o,{prop:"sortOrder",label:"æŽ’åºé †åº",width:"100"})])),_:1},8,["data"])),[[r,l.value]])])}}};const gh=(0,ie.A)(bh,[["__scopeId","data-v-13bb3b3c"]]);var yh=gh;const fh={class:"attendance-container"};var hh={__name:"sys_AttendanceRecord",setup(e){const a=(0,d.KR)(null),l=async(e,l)=>{if(!l){const e=new Date;e.setMonth(e.getMonth());const a=e.getFullYear();let t=e.getMonth()+1;t=t<10?"0"+t:t,l=`${a}-${t}`}a.value=e};return(e,t)=>((0,u.uX)(),(0,u.CE)(u.FK,null,[(0,u.bF)(zv,{"sys-mode":"true",onRowSelected:l}),(0,u.Lk)("div",fh,[(0,u.bF)($n,{selectedUser:a.value,sysMode:!0,style:{"margin-top":"3rem"}},null,8,["selectedUser"])])],64))}};const kh=(0,ie.A)(hh,[["__scopeId","data-v-01237335"]]);var _h=kh;const wh={class:"data-management-container"},Fh={class:"page-header"},Ch={class:"page-title"},Dh={class:"content-wrapper"},Lh={class:"tab-label"},Rh={class:"table-container"},Vh={class:"tab-label"},Ih={class:"table-container"},xh={class:"tab-label"},Eh={class:"table-container"},Ah={class:"tab-label"},Th={class:"table-container"},Wh={class:"tab-label"},Sh={class:"table-container"},Uh={class:"tab-label"},$h={class:"table-container"},Nh={class:"tab-label"},Xh={class:"table-container"},Kh={class:"tab-label"},Mh={class:"table-container"},Ph={class:"tab-label"},Oh={class:"table-container"},zh={class:"tab-label"},Bh={class:"workflow-container"},jh={class:"sub-tab-label"},Yh={class:"sub-table-container"},Qh={class:"sub-tab-label"},Hh={class:"sub-table-container"},qh={class:"sub-tab-label"},Jh={class:"sub-table-container"},Gh={class:"sub-tab-label"},Zh={class:"sub-table-container"},ek={class:"sub-tab-label"},ak={class:"sub-table-container"},lk={class:"sub-tab-label"},tk={class:"sub-table-container"},ok={class:"sub-tab-label"},nk={class:"sub-table-container"},rk={class:"sub-tab-label"},sk={class:"sub-table-container"},uk={class:"sub-tab-label"},ik={class:"sub-table-container"},dk={class:"sub-tab-label"},ck={class:"sub-table-container"},pk={class:"sub-tab-label"},mk={class:"sub-table-container"},vk={class:"sub-tab-label"},bk={class:"sub-table-container"},gk={class:"sub-tab-label"},yk={class:"sub-table-container"},fk={class:"sub-tab-label"},hk={class:"sub-table-container"},kk={class:"sub-tab-label"},_k={class:"sub-table-container"},wk={class:"tab-label"},Fk={class:"table-container"};var Ck={__name:"sys_DAE_Data_Management",setup(e){const a=(0,d.KR)("users"),l=(0,d.KR)("document");return(e,t)=>{const o=(0,u.g2)("el-icon"),n=(0,u.g2)("el-tab-pane"),r=(0,u.g2)("el-tabs");return(0,u.uX)(),(0,u.CE)("div",wh,[(0,u.Lk)("div",Fh,[(0,u.Lk)("h2",Ch,[(0,u.bF)(o,{class:"title-icon"},{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.Setting))])),_:1}),t[2]||(t[2]=(0,u.eW)(" DAE è³‡æ–™ç®¡ç†ç³»çµ± "))]),t[3]||(t[3]=(0,u.Lk)("p",{class:"page-subtitle"},"ç³»çµ±è³‡æ–™ç¶­è­·èˆ‡ç®¡ç†ä¸­å¿ƒ",-1))]),(0,u.Lk)("div",Dh,[(0,u.bF)(r,{modelValue:a.value,"onUpdate:modelValue":t[1]||(t[1]=e=>a.value=e),type:"border-card",class:"main-tabs","tab-position":"top"},{default:(0,u.k6)((()=>[(0,u.bF)(n,{name:"users"},{label:(0,u.k6)((()=>[(0,u.Lk)("span",Lh,[(0,u.bF)(o,null,{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.User))])),_:1}),t[4]||(t[4]=(0,u.eW)(" ä½¿ç”¨è€…å¸³è™Ÿç®¡ç† "))])])),default:(0,u.k6)((()=>[(0,u.Lk)("div",Rh,[(0,u.bF)(Ay)])])),_:1}),(0,u.bF)(n,{name:"employees"},{label:(0,u.k6)((()=>[(0,u.Lk)("span",Vh,[(0,u.bF)(o,null,{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.Avatar))])),_:1}),t[5]||(t[5]=(0,u.eW)(" å“¡å·¥è³‡æ–™ç®¡ç† "))])])),default:(0,u.k6)((()=>[(0,u.Lk)("div",Ih,[(0,u.bF)(Xy)])])),_:1}),(0,u.bF)(n,{name:"permissions"},{label:(0,u.k6)((()=>[(0,u.Lk)("span",xh,[(0,u.bF)(o,null,{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.Key))])),_:1}),t[6]||(t[6]=(0,u.eW)(" æ¬Šé™åˆ—è¡¨ç®¡ç† "))])])),default:(0,u.k6)((()=>[(0,u.Lk)("div",Eh,[(0,u.bF)(zy)])])),_:1}),(0,u.bF)(n,{name:"user-roles"},{label:(0,u.k6)((()=>[(0,u.Lk)("span",Ah,[(0,u.bF)(o,null,{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.UserFilled))])),_:1}),t[7]||(t[7]=(0,u.eW)(" å¸³è™Ÿç³»çµ±è§’è‰²ç®¡ç† "))])])),default:(0,u.k6)((()=>[(0,u.Lk)("div",Th,[(0,u.bF)(gf)])])),_:1}),(0,u.bF)(n,{name:"roles"},{label:(0,u.k6)((()=>[(0,u.Lk)("span",Wh,[(0,u.bF)(o,null,{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.Management))])),_:1}),t[8]||(t[8]=(0,u.eW)(" EIPç³»çµ±è§’è‰²ç®¡ç† "))])])),default:(0,u.k6)((()=>[(0,u.Lk)("div",Sh,[(0,u.bF)(Jy)])])),_:1}),(0,u.bF)(n,{name:"titles"},{label:(0,u.k6)((()=>[(0,u.Lk)("span",Uh,[(0,u.bF)(o,null,{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.Medal))])),_:1}),t[9]||(t[9]=(0,u.eW)(" è·ç¨±/éšŽç´šç®¡ç† "))])])),default:(0,u.k6)((()=>[(0,u.Lk)("div",$h,[(0,u.bF)(Yy)])])),_:1}),(0,u.bF)(n,{name:"departments"},{label:(0,u.k6)((()=>[(0,u.Lk)("span",Nh,[(0,u.bF)(o,null,{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.OfficeBuilding))])),_:1}),t[10]||(t[10]=(0,u.eW)(" éƒ¨é–€è³‡è¨Šç®¡ç† "))])])),default:(0,u.k6)((()=>[(0,u.Lk)("div",Xh,[(0,u.bF)(af)])])),_:1}),(0,u.bF)(n,{name:"areas"},{label:(0,u.k6)((()=>[(0,u.Lk)("span",Kh,[(0,u.bF)(o,null,{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.Location))])),_:1}),t[11]||(t[11]=(0,u.eW)(" åœ°å€è³‡è¨Šç®¡ç† "))])])),default:(0,u.k6)((()=>[(0,u.Lk)("div",Mh,[(0,u.bF)(nf)])])),_:1}),(0,u.bF)(n,{name:"audit-events"},{label:(0,u.k6)((()=>[(0,u.Lk)("span",Ph,[(0,u.bF)(o,null,{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.Monitor))])),_:1}),t[12]||(t[12]=(0,u.eW)(" ç³»çµ±ç¨½æ ¸äº‹ä»¶ "))])])),default:(0,u.k6)((()=>[(0,u.Lk)("div",Oh,[(0,u.bF)(If)])])),_:1}),(0,u.bF)(n,{name:"workflow"},{label:(0,u.k6)((()=>[(0,u.Lk)("span",zh,[(0,u.bF)(o,null,{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.DocumentChecked))])),_:1}),t[13]||(t[13]=(0,u.eW)(" ç°½æ ¸æ¨¡çµ„ç®¡ç† "))])])),default:(0,u.k6)((()=>[(0,u.Lk)("div",Bh,[(0,u.bF)(r,{modelValue:l.value,"onUpdate:modelValue":t[0]||(t[0]=e=>l.value=e),"tab-position":"left",class:"workflow-tabs"},{default:(0,u.k6)((()=>[(0,u.bF)(n,{name:"document"},{label:(0,u.k6)((()=>[(0,u.Lk)("span",jh,[(0,u.bF)(o,null,{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.Document))])),_:1}),t[14]||(t[14]=(0,u.eW)(" ç°½æ ¸å–®æ“šç®¡ç† "))])])),default:(0,u.k6)((()=>[(0,u.Lk)("div",Yh,[(0,u.bF)(qf)])])),_:1}),(0,u.bF)(n,{name:"documentType"},{label:(0,u.k6)((()=>[(0,u.Lk)("span",Qh,[(0,u.bF)(o,null,{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.Files))])),_:1}),t[15]||(t[15]=(0,u.eW)(" ç°½æ ¸å–®æ“šé¡žåž‹ç®¡ç† "))])])),default:(0,u.k6)((()=>[(0,u.Lk)("div",Hh,[(0,u.bF)(Sf)])])),_:1}),(0,u.bF)(n,{name:"relEIPUserRoleJoinWFRole"},{label:(0,u.k6)((()=>[(0,u.Lk)("span",qh,[(0,u.bF)(o,null,{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.Lock))])),_:1}),t[16]||(t[16]=(0,u.eW)(" ç°½æ ¸ç³»çµ±è§’è‰²æ¬Šé™ç®¡ç† "))])])),default:(0,u.k6)((()=>[(0,u.Lk)("div",Jh,[(0,u.bF)(mf)])])),_:1}),(0,u.bF)(n,{name:"workflowForm"},{label:(0,u.k6)((()=>[(0,u.Lk)("span",Gh,[(0,u.bF)(o,null,{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.EditPen))])),_:1}),t[17]||(t[17]=(0,u.eW)(" å·¥ä½œæµç¨‹è¡¨å–®ç®¡ç† "))])])),default:(0,u.k6)((()=>[(0,u.Lk)("div",Zh,[(0,u.bF)(Af)])])),_:1}),(0,u.bF)(n,{name:"approvalWorkflow"},{label:(0,u.k6)((()=>[(0,u.Lk)("span",ek,[(0,u.bF)(o,null,{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.Connection))])),_:1}),t[18]||(t[18]=(0,u.eW)(" ç°½æ ¸æµç¨‹ç®¡ç† "))])])),default:(0,u.k6)((()=>[(0,u.Lk)("div",ak,[(0,u.bF)(Nf)])])),_:1}),(0,u.bF)(n,{name:"approvalStep"},{label:(0,u.k6)((()=>[(0,u.Lk)("span",lk,[(0,u.bF)(o,null,{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.Position))])),_:1}),t[19]||(t[19]=(0,u.eW)(" ç°½æ ¸æµç¨‹ç«™é»žç®¡ç† "))])])),default:(0,u.k6)((()=>[(0,u.Lk)("div",tk,[(0,u.bF)(Mf)])])),_:1}),(0,u.bF)(n,{name:"approvalRecord"},{label:(0,u.k6)((()=>[(0,u.Lk)("span",ok,[(0,u.bF)(o,null,{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.Notebook))])),_:1}),t[20]||(t[20]=(0,u.eW)(" ç°½æ ¸è¨˜éŒ„ç®¡ç† "))])])),default:(0,u.k6)((()=>[(0,u.Lk)("div",nk,[(0,u.bF)(Zf)])])),_:1}),(0,u.bF)(n,{name:"stepInsertion"},{label:(0,u.k6)((()=>[(0,u.Lk)("span",rk,[(0,u.bF)(o,null,{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.Plus))])),_:1}),t[21]||(t[21]=(0,u.eW)(" åŠ ç°½(æ’å…¥)ç®¡ç† "))])])),default:(0,u.k6)((()=>[(0,u.Lk)("div",sk,[(0,u.bF)(lh)])])),_:1}),(0,u.bF)(n,{name:"notificationLog"},{label:(0,u.k6)((()=>[(0,u.Lk)("span",uk,[(0,u.bF)(o,null,{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.Bell))])),_:1}),t[22]||(t[22]=(0,u.eW)(" çŸ¥æœƒç´€éŒ„ç®¡ç† "))])])),default:(0,u.k6)((()=>[(0,u.Lk)("div",ik,[(0,u.bF)(nh)])])),_:1}),(0,u.bF)(n,{name:"documentNotificationRecipient"},{label:(0,u.k6)((()=>[(0,u.Lk)("span",dk,[(0,u.bF)(o,null,{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.Message))])),_:1}),t[23]||(t[23]=(0,u.eW)(" çŸ¥æœƒäººç®¡ç† "))])])),default:(0,u.k6)((()=>[(0,u.Lk)("div",ck,[(0,u.bF)(uh)])])),_:1}),(0,u.bF)(n,{name:"documentNotification"},{label:(0,u.k6)((()=>[(0,u.Lk)("span",pk,[(0,u.bF)(o,null,{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.ChatDotRound))])),_:1}),t[24]||(t[24]=(0,u.eW)(" æ–‡ä»¶é€šçŸ¥ç®¡ç† "))])])),default:(0,u.k6)((()=>[(0,u.Lk)("div",mk,[(0,u.bF)(ch)])])),_:1}),(0,u.bF)(n,{name:"countersignGroup"},{label:(0,u.k6)((()=>[(0,u.Lk)("span",vk,[(0,u.bF)(o,null,{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.Grid))])),_:1}),t[25]||(t[25]=(0,u.eW)(" æœƒç°½ç¾¤çµ„ç®¡ç† "))])])),default:(0,u.k6)((()=>[(0,u.Lk)("div",bk,[(0,u.bF)(Yf)])])),_:1}),(0,u.bF)(n,{name:"countersignGroupMember"},{label:(0,u.k6)((()=>[(0,u.Lk)("span",gk,[(0,u.bF)(o,null,{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.Postcard))])),_:1}),t[26]||(t[26]=(0,u.eW)(" æœƒç°½ç¾¤çµ„æˆå“¡ç®¡ç† "))])])),default:(0,u.k6)((()=>[(0,u.Lk)("div",yk,[(0,u.bF)(vh)])])),_:1}),(0,u.bF)(n,{name:"parallelGroup"},{label:(0,u.k6)((()=>[(0,u.Lk)("span",fk,[(0,u.bF)(o,null,{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.Share))])),_:1}),t[27]||(t[27]=(0,u.eW)(" ä¸¦ç°½ç¾¤çµ„ç®¡ç† "))])])),default:(0,u.k6)((()=>[(0,u.Lk)("div",hk,[(0,u.bF)(zf)])])),_:1}),(0,u.bF)(n,{name:"parallelGroupMember"},{label:(0,u.k6)((()=>[(0,u.Lk)("span",kk,[(0,u.bF)(o,null,{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.Coordinate))])),_:1}),t[28]||(t[28]=(0,u.eW)(" ä¸¦ç°½ç¾¤çµ„æˆå“¡ç®¡ç† "))])])),default:(0,u.k6)((()=>[(0,u.Lk)("div",_k,[(0,u.bF)(yh)])])),_:1})])),_:1},8,["modelValue"])])])),_:1}),(0,u.bF)(n,{name:"attendance"},{label:(0,u.k6)((()=>[(0,u.Lk)("span",wk,[(0,u.bF)(o,null,{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.Clock))])),_:1}),t[29]||(t[29]=(0,u.eW)(" å‡ºå‹¤ç´€éŒ„ç®¡ç† "))])])),default:(0,u.k6)((()=>[(0,u.Lk)("div",Fk,[(0,u.bF)(_h)])])),_:1})])),_:1},8,["modelValue"])])])}}};const Dk=(0,ie.A)(Ck,[["__scopeId","data-v-3a14cffd"]]);var Lk=Dk;const Rk={class:"main-content-wrapper"},Vk={class:"tool-bar"},Ik={class:"region-filter"},xk={class:"month-filter"},Ek={class:"status-filter"},Ak={class:"doctype-filter"},Tk={class:"search-wrapper"},Wk={class:"pagination-size-control"},Sk={class:"pagination-controls"},Uk={class:"workflow"},$k={key:0,class:"mobile-row"},Nk={class:"mobile-item doc-type"},Xk={class:"mobile-item doc-id-line"},Kk={class:"doc-id"},Mk={class:"mobile-item dept-name"},Pk={class:"mobile-item creator-name"},Ok={class:"mobile-item created-date"},zk={class:"mobile-item status-name"},Bk={key:1,class:"desktop-row"},jk={class:"doc-type"},Yk={class:"doc-id"},Qk={class:"dept-name"},Hk={class:"creator-name"},qk={class:"created-date"},Jk={class:"status-name"};var Gk={__name:"List_Related_WF_Form",props:{sysMode:{type:Boolean,default:!1}},setup(e){const a=e,l=(0,S.k)(),o=vl(),n=Hl(),r=(0,i.n)(),s=(0,u.EW)((()=>r.user?.permissions||[])),{width:c}=(0,Ql.lWr)(),p=(0,u.EW)((()=>c.value<500?{height:"40rem",width:"10rem",alignItems:"center"}:{height:"40rem",width:"70rem",minWidth:"100%",maxWidth:"120%",alignItems:"center"})),m=(0,d.KR)([]),v=(0,d.KR)([]),b=(0,d.KR)(!0),g=(0,d.KR)(a.sysMode?4:1),y=(0,d.KR)("å…¨éƒ¨"),f=(0,d.KR)(E()),h=(0,d.KR)(""),k=(0,d.KR)(30),_=(0,d.KR)(1),w=(0,d.KR)([]),F=(0,d.KR)(""),C=(0,d.KR)("documentID"),R=(0,d.KR)(""),V=(0,d.KR)("asc"),I=(0,d.KR)(""),x=(0,d.KR)("asc");function E(){const e=new Date,a=e.getFullYear(),l=String(e.getMonth()+1).padStart(2,"0");return`${a}-${l}`}const A=(0,u.EW)((()=>s.value.includes("sys_North")?[{label:"åŒ—å€",value:"åŒ—å€"}]:[{label:"å…¨éƒ¨",value:"å…¨éƒ¨"},{label:"åŒ—å€",value:"åŒ—å€"},{label:"å—å€",value:"å—å€"}])),T=(0,u.EW)((()=>c.value<500?"auto":800)),W=[{value:0,label:"æ‰€æœ‰ç›¸é—œå–®æ“š",name:"Related"},{value:1,label:"å¾…ç°½æ ¸",name:"Pending"},{value:2,label:"å·²ç°½æ ¸",name:"Approved"},{value:3,label:"å·²ä½œå»¢",name:"Voided"}],U=[{value:4,label:"æ‰€æœ‰å–®æ“š",name:"All"},{value:5,label:"ç°½æ ¸ä¸­",name:"InProgress"},{value:6,label:"å·²å®Œæˆ",name:"Completed"}],$=(0,u.EW)((()=>a.sysMode?U:W)),N=(0,u.EW)((()=>{const e=(_.value-1)*k.value;return X.value.slice(e,e+k.value)})),X=(0,u.EW)((()=>{let e=m.value;return f.value&&(e=e.filter((e=>{if(!e.createdDate)return!1;const a=new Date(e.createdDate),l=a.getFullYear(),t=String(a.getMonth()+1).padStart(2,"0"),o=`${l}-${t}`;return o===f.value}))),h.value&&(e=e.filter((e=>e.documentTypeID===h.value))),F.value.trim()&&(e=e.filter((e=>{const a=F.value.trim().toLowerCase();switch(C.value){case"documentTypeID":const l=j.value[e.documentTypeID]||e.documentTypeID;return l.toLowerCase().includes(a);case"documentID":return e.documentID.toLowerCase().includes(a);case"creatorName":return e.creatorName?.toLowerCase().includes(a);case"departmentName":return e.departmentName?.toLowerCase().includes(a);case"createdDate":const t=K(null,null,e.createdDate).toLowerCase();return t.includes(a);case"currentStatusName":return e.currentStatusName?.toLowerCase().includes(a);default:return!1}}))),(R.value||I.value)&&(e=[...e].sort(((e,a)=>{if(R.value){const l=ae(e,a,R.value,V.value);if(0!==l)return l}return I.value&&R.value!==I.value?ae(e,a,I.value,x.value):0}))),e})),K=(e,a,l)=>{if(!l)return"";const t=new Date(l),o=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),r=String(t.getDate()).padStart(2,"0");let s=t.getHours();const u=s<12?"ä¸Šåˆ":"ä¸‹åˆ";let i=s%12;0===i&&(i=12);const d=String(i).padStart(2,"0"),c=String(t.getMinutes()).padStart(2,"0");return`${o}/${n}/${r} ${u} ${d}:${c}`},M=()=>({backgroundColor:"rgba(212, 255, 244, 0.7)",borderRadius:"12px",margin:"rem 0"}),P={},O={};async function z(e){if(P[e])return P[e];const a=await lt.getDepartmentName(e);return P[e]=a||"æœªçŸ¥éƒ¨é–€",P[e]}async function B(e){if(O[e])return O[e];const a=await lt.getEmployeeName(e);return O[e]=a||"æœªçŸ¥äººå“¡",O[e]}const j=(0,u.EW)((()=>{const e={};return v.value.forEach((a=>{e[a.documentTypeID]=a.documentTypeName})),e})),Y={Related:()=>Ma.getUserRelatedDocuments(l.userId),Pending:()=>Ma.getUserPendingDocuments(l.userId),Approved:()=>Ma.getUserApprovedDocuments(l.userId),Voided:()=>Ma.getUserVoidedDocuments(l.userId),All:()=>Ma.getAllDocuments(),InProgress:()=>Ma.getInProgressDocuments(),Completed:()=>Ma.getCompletedDocuments()};async function Q(){b.value=!0;try{const l=$.value,{name:t}=l.find((e=>e.value===g.value))||{name:a.sysMode?"All":"Related"};var e;a.sysMode?(e=await(Y[t]||Y.All)(),console.log(e.data),w.value=e.data||[],s.value.includes("sys_North")?(y.value="åŒ—å€",console.log("æª¢æ¸¬åˆ° sys_North æ¬Šé™ï¼Œé è¨­ç¯©é¸åŒ—å€")):(y.value="å…¨éƒ¨",console.log("ç„¡ç‰¹æ®Šå€åŸŸæ¬Šé™ï¼Œé¡¯ç¤ºå…¨éƒ¨å–®æ“š")),e.data=await te(w.value)):(e=await(Y[t]||Y.Related)(),console.log(e.data));const o=e.data||[];m.value=await Promise.all(o.map((async e=>{const a=await z(e.applicantDepartmentId),l=await B(e.creatorID);return{...e,departmentName:a,creatorName:l}})))}catch(l){console.error("è®€å–åˆ—è¡¨å¤±æ•—",l),m.value=[]}finally{b.value=!1}}async function H(){const e=await pl.getDocTypes();v.value=e.data||[]}const q=async e=>{try{await Sa.s.confirm(`ç¢ºå®šè¦åˆªé™¤å–®è™Ÿç‚º ${e} çš„å–®æ“šå—Žï¼Ÿ`,"è­¦å‘Š",{confirmButtonText:"ç¢ºå®š",cancelButtonText:"å–æ¶ˆ",type:"warning"});const l=e.match(/^([A-Za-z]+)/),t=l?l[1]:"";var a=await pl.deleteFormByDocID(t,e);a&&(0,D.nk)({type:"success",message:`å·²åˆªé™¤ ${t} å–®è™Ÿ: ${e}`}),Q()}catch(l){"cancel"===l?(0,D.nk)({type:"info",message:"å·²å–æ¶ˆåˆªé™¤"}):((0,D.nk)({type:"error",message:`åˆªé™¤å¤±æ•—: ${l.message||"æœªçŸ¥éŒ¯èª¤"}`}),console.error("åˆªé™¤å–®æ“šå¤±æ•—",l))}};function G(){Q()}function Z(){_.value=1}function ee(){_.value=1}function ae(e,a,l,t){let o=e[l],n=a[l];if("documentTypeID"===l?(o=j.value[e.documentTypeID]||e.documentTypeID,n=j.value[a.documentTypeID]||a.documentTypeID):"createdDate"===l&&(o=new Date(o),n=new Date(n)),null==o&&null==n)return 0;if(null==o)return"asc"===t?1:-1;if(null==n)return"asc"===t?-1:1;if("string"===typeof o&&"string"===typeof n){const e=o.localeCompare(n,"zh-TW");return"asc"===t?e:-e}return o<n?"asc"===t?-1:1:o>n?"asc"===t?1:-1:0}const le=async()=>{if(console.log("å€åŸŸè®Šæ›´ç‚º:",y.value),a.sysMode&&w.value.length>0){const e=await te(w.value);m.value=await Promise.all(e.map((async e=>{const a=await z(e.applicantDepartmentId),l=await B(e.creatorID);return{...e,departmentName:a,creatorName:l}})))}},te=async e=>{if("å…¨éƒ¨"===y.value)return e;const a=[];for(const t of e)try{const e=await o.getEmployeeArea(t.creatorID);if(e){const l=await n.getAreaDistrict(e);"åŒ—å€"!==y.value||"North"!==l&&"Middle"!==l?"å—å€"===y.value&&"South"===l&&a.push(t):a.push(t)}}catch(l){console.error(`ç„¡æ³•å–å¾— creatorID ${t.creatorID} çš„å€åŸŸè³‡è¨Š:`,l),"å…¨éƒ¨"===y.value&&a.push(t)}return console.log(`å€åŸŸç¯©é¸çµæžœ: ${y.value}, ç¯©é¸å¾Œæ–‡ä»¶æ•¸é‡: ${a.length}`),a};function oe({rowIndex:e}){return 0===e?"first-row-padding":""}function ne(e){_.value=e}function re(){_.value=1}function se(){_.value=1,console.log(`æœå°‹æ¬„ä½è®Šæ›´ç‚º: ${C.value}`)}function ue(){_.value=1,console.log(`æœå°‹é—œéµå­—: ${F.value}`)}function ie(){F.value="",_.value=1,console.log("å·²æ¸…é™¤æœå°‹é—œéµå­—")}const de=(0,d.KR)(null),ce=(0,d.KR)(!1),pe=async e=>{de.value=e,ce.value=!0};function me(){Q()}return(0,u.sV)((async()=>{await H(),Q()})),(0,u.wB)((()=>a.sysMode),(e=>{g.value=e?4:1,Q()}),{immediate:!0}),(l,o)=>{const n=(0,u.g2)("el-radio-button"),r=(0,u.g2)("el-radio-group"),s=(0,u.g2)("el-date-picker"),i=(0,u.g2)("el-option"),m=(0,u.g2)("el-select"),w=(0,u.g2)("el-icon"),D=(0,u.g2)("el-input"),R=(0,u.g2)("el-button"),V=(0,u.g2)("el-text"),I=(0,u.g2)("el-pagination"),x=(0,u.g2)("el-empty"),E=(0,u.g2)("el-table-column"),W=(0,u.g2)("el-table"),S=(0,u.g2)("el-config-provider");return(0,u.uX)(),(0,u.Wv)(S,{locale:(0,d.R1)(ht.A)},{default:(0,u.k6)((()=>[(0,u.Lk)("div",Rk,[o[19]||(o[19]=(0,u.Lk)("div",{class:"fancy-wrapper"},[(0,u.Lk)("span",{class:"fancy-title"},"å–®æ“šçœ‹æ¿")],-1)),(0,u.Lk)("div",Vk,[(0,u.Lk)("div",Ik,[e.sysMode?((0,u.uX)(),(0,u.Wv)(r,{key:0,modelValue:y.value,"onUpdate:modelValue":o[0]||(o[0]=e=>y.value=e),size:"default",onChange:le},{default:(0,u.k6)((()=>[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(A.value,(e=>((0,u.uX)(),(0,u.Wv)(n,{key:e.value,value:e.value},{default:(0,u.k6)((()=>[(0,u.eW)((0,L.v_)(e.label),1)])),_:2},1032,["value"])))),128))])),_:1},8,["modelValue"])):(0,u.Q3)("",!0)]),(0,u.Lk)("div",xk,[(0,u.bF)(s,{modelValue:f.value,"onUpdate:modelValue":o[1]||(o[1]=e=>f.value=e),type:"month",placeholder:"é¸æ“‡æœˆä»½",style:{width:"10rem"},format:"YYYY/MM","value-format":"YYYY-MM",onChange:Z},null,8,["modelValue"])]),(0,u.Lk)("div",Ek,[(0,u.bF)(m,{modelValue:g.value,"onUpdate:modelValue":o[2]||(o[2]=e=>g.value=e),placeholder:"é¸æ“‡ç‹€æ…‹",style:{width:"8rem"},onChange:G},{default:(0,u.k6)((()=>[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)($.value,(e=>((0,u.uX)(),(0,u.Wv)(i,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])]),(0,u.Lk)("div",Ak,[(0,u.bF)(m,{modelValue:h.value,"onUpdate:modelValue":o[3]||(o[3]=e=>h.value=e),placeholder:"é¸æ“‡é¡žåž‹",style:{width:"8rem"},onChange:ee},{default:(0,u.k6)((()=>[(0,u.bF)(i,{label:"å…¨éƒ¨",value:""}),((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(v.value,(e=>((0,u.uX)(),(0,u.Wv)(i,{key:e.documentTypeID,label:e.documentTypeName,value:e.documentTypeID},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])]),(0,u.Lk)("div",Tk,[(0,u.bF)(m,{modelValue:C.value,"onUpdate:modelValue":o[4]||(o[4]=e=>C.value=e),placeholder:"æœå°‹æ¬„ä½",style:{width:"8rem"},onChange:se},{default:(0,u.k6)((()=>[(0,u.bF)(i,{label:"æ–‡ä»¶é¡žåž‹",value:"documentTypeID"}),(0,u.bF)(i,{label:"å–®æ“šç·¨è™Ÿ",value:"documentID"}),(0,u.bF)(i,{label:"ç”³è«‹äºº",value:"creatorName"}),(0,u.bF)(i,{label:"éƒ¨é–€",value:"departmentName"}),(0,u.bF)(i,{label:"å»ºç«‹æ—¥æœŸ",value:"createdDate"}),(0,u.bF)(i,{label:"ç‹€æ…‹",value:"currentStatusName"})])),_:1},8,["modelValue"]),(0,u.bF)(D,{modelValue:F.value,"onUpdate:modelValue":o[5]||(o[5]=e=>F.value=e),placeholder:"è¼¸å…¥é—œéµå­—æœå°‹",style:{width:"12rem"},clearable:"",onInput:ue,onClear:ie},{suffix:(0,u.k6)((()=>[(0,u.bF)(w,null,{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.Search))])),_:1})])),_:1},8,["modelValue"])]),(0,u.Q3)("",!0),(0,u.Lk)("div",Wk,[(0,u.bF)(V,null,{default:(0,u.k6)((()=>o[13]||(o[13]=[(0,u.eW)("æ¯é é¡¯ç¤º")]))),_:1}),(0,u.bF)(m,{modelValue:k.value,"onUpdate:modelValue":o[8]||(o[8]=e=>k.value=e),placeholder:"",style:{width:"5rem"},size:"small",onChange:re},{default:(0,u.k6)((()=>[((0,u.uX)(),(0,u.CE)(u.FK,null,(0,u.pI)([5,10,20,30,50,100],(e=>(0,u.bF)(i,{key:e,label:e,value:e},null,8,["label","value"]))),64))])),_:1},8,["modelValue"]),(0,u.bF)(V,null,{default:(0,u.k6)((()=>o[14]||(o[14]=[(0,u.eW)("ç­†")]))),_:1})]),(0,u.Lk)("div",Sk,[(0,u.bF)(I,{background:"",layout:"prev, pager, next",total:X.value.length,"page-size":k.value,"current-page":_.value,"onUpdate:currentPage":o[9]||(o[9]=e=>_.value=e),onCurrentChange:ne,"page-count":Math.ceil(X.value.length/k.value)},null,8,["total","page-size","current-page","page-count"])])]),(0,u.Lk)("div",Uk,[(0,u.bF)(W,{class:"workflow-table",data:N.value,style:(0,L.Tr)(p.value),onRowClick:pe,"row-style":M,loading:b.value,"show-header":!1,"row-class-name":oe},{empty:(0,u.k6)((()=>[0!==N.value.length||b.value?(0,u.Q3)("",!0):((0,u.uX)(),(0,u.Wv)(x,{key:0},{description:(0,u.k6)((()=>o[15]||(o[15]=[(0,u.Lk)("span",{style:{"font-size":"2rem"}},"å°šç„¡å–®æ“š",-1)]))),_:1}))])),default:(0,u.k6)((()=>[a.sysMode?((0,u.uX)(),(0,u.Wv)(E,{key:0,label:"æ“ä½œ",width:"100"},{default:(0,u.k6)((({row:e})=>[(0,u.bF)(R,{type:"danger",size:"small",onClick:(0,t.D$)((a=>q(e.documentID)),["stop"])},{default:(0,u.k6)((()=>o[16]||(o[16]=[(0,u.eW)(" åˆªé™¤ ")]))),_:2},1032,["onClick"])])),_:1})):(0,u.Q3)("",!0),(0,u.bF)(E,{width:T.value},{default:(0,u.k6)((({row:e})=>[(0,d.R1)(c)<500?((0,u.uX)(),(0,u.CE)("div",$k,[(0,u.Lk)("div",Nk,(0,L.v_)(j.value[e.documentTypeID]||e.documentTypeID),1),(0,u.Lk)("div",Xk,[o[17]||(o[17]=(0,u.Lk)("span",{class:"doc-id-title"},"å–®è™Ÿ: ",-1)),(0,u.Lk)("span",Kk,(0,L.v_)(e.documentID),1)]),(0,u.Lk)("div",Mk,(0,L.v_)(e.departmentName),1),(0,u.Lk)("div",Pk,(0,L.v_)(e.creatorName),1),(0,u.Lk)("div",Ok,(0,L.v_)(K(null,null,e.createdDate)),1),(0,u.Lk)("div",zk,(0,L.v_)(e.currentStatusName),1)])):((0,u.uX)(),(0,u.CE)("div",Bk,[(0,u.Lk)("span",jk,(0,L.v_)(j.value[e.documentTypeID]||e.documentTypeID),1),o[18]||(o[18]=(0,u.Lk)("span",{class:"doc-id-title"},"å–®è™Ÿ: ",-1)),(0,u.Lk)("span",Yk,(0,L.v_)(e.documentID),1),(0,u.Lk)("span",Qk,(0,L.v_)(e.departmentName),1),(0,u.Lk)("span",Hk,(0,L.v_)(e.creatorName),1),(0,u.Lk)("span",qk,(0,L.v_)(K(null,null,e.createdDate)),1),(0,u.Lk)("span",Jk,(0,L.v_)(e.currentStatusName),1)]))])),_:1},8,["width"])])),_:1},8,["data","style","loading"])]),ce.value?((0,u.uX)(),(0,u.Wv)(en,{key:0,visible:ce.value,"onUpdate:visible":o[10]||(o[10]=e=>ce.value=e),doc:de.value,buttonGroupPosition:"dialog",onRefreshList:me},null,8,["visible","doc"])):(0,u.Q3)("",!0)])])),_:1},8,["locale"])}}};const Zk=(0,ie.A)(Gk,[["__scopeId","data-v-8dd11528"]]);var e_=Zk,a_={__name:"sys_WF_Management",setup(e){return(e,a)=>{(0,u.g2)("el-button");return(0,u.uX)(),(0,u.CE)(u.FK,null,[(0,u.bF)(e_,{sysMode:!0}),(0,u.Q3)("",!0)],64)}}};const l_=a_;var t_=l_;const o_={class:"field-preview"},n_={class:"field-label-wrapper"},r_={class:"field-label"},s_={key:0,class:"required-mark"},u_={key:0,class:"help-text"},i_={key:9,class:"unknown-field"},d_={key:0,class:"validation-info"};var c_={__name:"FieldPreview",props:{field:{type:Object,required:!0}},setup(e){const a=e,l=()=>{const e=a.field.options?.find((e=>e.selected));return e?.value||a.field.defaultValue},t=()=>{const e=a.field.options?.find((e=>e.selected));return e?.value||a.field.defaultValue},o=()=>{const e=a.field.options?.filter((e=>e.selected));return e?.length>0?e.map((e=>e.value)):Array.isArray(a.field.defaultValue)?a.field.defaultValue:[]},n=()=>{const e=a.field.validation;if(!e)return"";const l=[];return e.minLength&&l.push(`æœ€å°‘ ${e.minLength} å­—å…ƒ`),e.maxLength&&l.push(`æœ€å¤š ${e.maxLength} å­—å…ƒ`),void 0!==e.min&&l.push(`æœ€å°å€¼ ${e.min}`),void 0!==e.max&&l.push(`æœ€å¤§å€¼ ${e.max}`),e.pattern&&l.push("æ ¼å¼é©—è­‰"),l.join(", ")};return(a,r)=>{const s=(0,u.g2)("el-input"),i=(0,u.g2)("el-option"),d=(0,u.g2)("el-select"),c=(0,u.g2)("el-radio"),p=(0,u.g2)("el-radio-group"),m=(0,u.g2)("el-checkbox"),v=(0,u.g2)("el-checkbox-group"),b=(0,u.g2)("el-date-picker"),g=(0,u.g2)("el-input-number"),y=(0,u.g2)("el-upload"),f=(0,u.g2)("el-tag");return(0,u.uX)(),(0,u.CE)("div",o_,[(0,u.Lk)("div",n_,[(0,u.Lk)("label",r_,[(0,u.eW)((0,L.v_)(e.field.label||"æœªå‘½åæ¬„ä½")+" ",1),e.field.required?((0,u.uX)(),(0,u.CE)("span",s_,"*")):(0,u.Q3)("",!0)]),e.field.helpText?((0,u.uX)(),(0,u.CE)("span",u_,(0,L.v_)(e.field.helpText),1)):(0,u.Q3)("",!0)]),(0,u.Lk)("div",{class:"field-input-wrapper",style:(0,L.Tr)({width:e.field.width})},["text"===e.field.type?((0,u.uX)(),(0,u.Wv)(s,{key:0,placeholder:e.field.placeholder,"model-value":e.field.defaultValue,disabled:""},null,8,["placeholder","model-value"])):"textarea"===e.field.type?((0,u.uX)(),(0,u.Wv)(s,{key:1,type:"textarea",placeholder:e.field.placeholder,"model-value":e.field.defaultValue,rows:3,disabled:""},null,8,["placeholder","model-value"])):"select"===e.field.type?((0,u.uX)(),(0,u.Wv)(d,{key:2,placeholder:e.field.placeholder||"è«‹é¸æ“‡","model-value":l(),disabled:"",style:{width:"100%"}},{default:(0,u.k6)((()=>[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(e.field.options,(e=>((0,u.uX)(),(0,u.Wv)(i,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["placeholder","model-value"])):"radio"===e.field.type?((0,u.uX)(),(0,u.Wv)(p,{key:3,"model-value":t(),disabled:""},{default:(0,u.k6)((()=>[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(e.field.options,(e=>((0,u.uX)(),(0,u.Wv)(c,{key:e.value,label:e.value},{default:(0,u.k6)((()=>[(0,u.eW)((0,L.v_)(e.label),1)])),_:2},1032,["label"])))),128))])),_:1},8,["model-value"])):"checkbox"===e.field.type?((0,u.uX)(),(0,u.Wv)(v,{key:4,"model-value":o(),disabled:""},{default:(0,u.k6)((()=>[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(e.field.options,(e=>((0,u.uX)(),(0,u.Wv)(m,{key:e.value,label:e.value},{default:(0,u.k6)((()=>[(0,u.eW)((0,L.v_)(e.label),1)])),_:2},1032,["label"])))),128))])),_:1},8,["model-value"])):"date"===e.field.type?((0,u.uX)(),(0,u.Wv)(b,{key:5,placeholder:e.field.placeholder||"é¸æ“‡æ—¥æœŸ","model-value":e.field.defaultValue,disabled:"",style:{width:"100%"}},null,8,["placeholder","model-value"])):"number"===e.field.type?((0,u.uX)(),(0,u.Wv)(g,{key:6,placeholder:e.field.placeholder,"model-value":e.field.defaultValue,min:e.field.validation?.min,max:e.field.validation?.max,disabled:"",style:{width:"100%"}},null,8,["placeholder","model-value","min","max"])):"email"===e.field.type?((0,u.uX)(),(0,u.Wv)(s,{key:7,type:"email",placeholder:e.field.placeholder||"è«‹è¼¸å…¥é›»å­éƒµä»¶","model-value":e.field.defaultValue,disabled:""},null,8,["placeholder","model-value"])):"file"===e.field.type?((0,u.uX)(),(0,u.Wv)(y,{key:8,class:"upload-demo",drag:"",disabled:""},{default:(0,u.k6)((()=>r[0]||(r[0]=[(0,u.Lk)("i",{class:"pi pi-cloud-upload upload-icon"},null,-1),(0,u.Lk)("div",{class:"upload-text"}," é»žæ“Šæˆ–æ‹–æ‹½æª”æ¡ˆåˆ°æ­¤è™•ä¸Šå‚³ ",-1)]))),_:1})):((0,u.uX)(),(0,u.CE)("div",i_,[r[1]||(r[1]=(0,u.Lk)("i",{class:"pi pi-question-circle"},null,-1)),(0,u.eW)(" æœªçŸ¥æ¬„ä½é¡žåž‹: "+(0,L.v_)(e.field.type),1)]))],4),e.field.validation?((0,u.uX)(),(0,u.CE)("div",d_,[(0,u.bF)(f,{size:"small",type:"info"},{default:(0,u.k6)((()=>[r[2]||(r[2]=(0,u.Lk)("i",{class:"pi pi-info-circle"},null,-1)),(0,u.eW)(" "+(0,L.v_)(n()),1)])),_:1})])):(0,u.Q3)("",!0)])}}};const p_=(0,ie.A)(c_,[["__scopeId","data-v-134cd294"]]);var m_=p_;const v_={class:"card-header"},b_={class:"options-list"},g_={key:0,class:"empty-options"},y_={class:"card-header"},f_={key:0},h_={class:"dialog-footer"};var k_={__name:"FieldEditorDialog",props:{visible:{type:Boolean,default:!1},fieldData:{type:Object,default:null},availableFields:{type:Array,default:()=>[]}},emits:["update:visible","saved"],setup(e,{emit:a}){const l=e,t=a,o=(0,u.EW)({get:()=>l.visible,set:e=>t("update:visible",e)}),n=(0,u.EW)((()=>!!l.fieldData?.id)),r=(0,d.Kh)({id:"",type:"text",label:"",placeholder:"",required:!1,validation:{minLength:null,maxLength:null,min:null,max:null,pattern:"",customMessage:""},options:[],defaultValue:null,order:0,width:"100%",helpText:"",conditional:{dependsOn:"",condition:"equals",value:""}}),s=(0,d.KR)(!1),i={type:[{required:!0,message:"è«‹é¸æ“‡æ¬„ä½é¡žåž‹",trigger:"change"}],label:[{required:!0,message:"è«‹è¼¸å…¥æ¬„ä½æ¨™ç±¤",trigger:"blur"},{min:1,max:50,message:"æ¨™ç±¤é•·åº¦åœ¨ 1 åˆ° 50 å€‹å­—å…ƒ",trigger:"blur"}]},c=(0,d.KR)(),p=(0,u.EW)((()=>["select","radio","checkbox"].includes(r.type))),m=()=>{l.fieldData?(Object.assign(r,{id:l.fieldData.id||"",type:l.fieldData.type||"text",label:l.fieldData.label||"",placeholder:l.fieldData.placeholder||"",required:l.fieldData.required||!1,validation:{minLength:l.fieldData.validation?.minLength||null,maxLength:l.fieldData.validation?.maxLength||null,min:l.fieldData.validation?.min||null,max:l.fieldData.validation?.max||null,pattern:l.fieldData.validation?.pattern||"",customMessage:l.fieldData.validation?.customMessage||""},options:l.fieldData.options?[...l.fieldData.options]:[],defaultValue:l.fieldData.defaultValue,order:l.fieldData.order||0,width:l.fieldData.width||"100%",helpText:l.fieldData.helpText||"",conditional:{dependsOn:l.fieldData.conditional?.dependsOn||"",condition:l.fieldData.conditional?.condition||"equals",value:l.fieldData.conditional?.value||""}}),s.value=!!l.fieldData.conditional?.dependsOn):(Object.assign(r,{id:"",type:"text",label:"",placeholder:"",required:!1,validation:{minLength:null,maxLength:null,min:null,max:null,pattern:"",customMessage:""},options:[],defaultValue:null,order:0,width:"100%",helpText:"",conditional:{dependsOn:"",condition:"equals",value:""}}),s.value=!1)},v=()=>{r.defaultValue=null,p.value?0===r.options.length&&b():r.options=[]},b=()=>{r.options.push({label:`é¸é … ${r.options.length+1}`,value:`option_${r.options.length+1}`,selected:!1})},g=e=>{r.options.splice(e,1)},y=e=>{e||(r.conditional={dependsOn:"",condition:"equals",value:""})},f=()=>{switch(r.type){case"textarea":return"el-input";case"number":return"el-input-number";case"date":return"el-date-picker";case"select":return"OptionSelect";case"radio":return"OptionRadio";case"checkbox":return"OptionCheckbox";default:return"el-input"}},h=()=>{switch(r.type){case"text":case"email":return"é è¨­æ–‡å­—å€¼";case"textarea":return"é è¨­æ–‡å­—å…§å®¹";case"number":return"é è¨­æ•¸å­—";case"date":return"é¸æ“‡é è¨­æ—¥æœŸ";default:return"é è¨­å€¼"}},k=async()=>{try{if(await(c.value?.validate()),p.value&&0===r.options.length)return void D.nk.warning("è«‹è‡³å°‘æ–°å¢žä¸€å€‹é¸é …");const e={...r};p.value||(e.options=[]),s.value||(e.conditional=null);const a={...e.validation};Object.keys(a).forEach((e=>{null!==a[e]&&""!==a[e]||delete a[e]})),e.validation=Object.keys(a).length>0?a:null,t("saved",e)}catch(e){console.error("é©—è­‰å¤±æ•—:",e)}},_=()=>{o.value=!1};return(0,u.wB)((()=>l.visible),(e=>{e&&m()})),(a,l)=>{const t=(0,u.g2)("el-option"),m=(0,u.g2)("el-select"),w=(0,u.g2)("el-form-item"),F=(0,u.g2)("el-col"),C=(0,u.g2)("el-input"),D=(0,u.g2)("el-row"),L=(0,u.g2)("el-checkbox"),R=(0,u.g2)("el-card"),V=(0,u.g2)("el-button"),I=(0,u.g2)("el-input-number"),x=(0,u.g2)("el-switch"),E=(0,u.g2)("el-form"),A=(0,u.g2)("el-dialog");return(0,u.uX)(),(0,u.Wv)(A,{modelValue:o.value,"onUpdate:modelValue":l[17]||(l[17]=e=>o.value=e),title:n.value?"ç·¨è¼¯æ¬„ä½":"æ–°å¢žæ¬„ä½",width:"60%","close-on-click-modal":!1,onClose:_},{footer:(0,u.k6)((()=>[(0,u.Lk)("div",h_,[(0,u.bF)(V,{onClick:_},{default:(0,u.k6)((()=>l[27]||(l[27]=[(0,u.eW)("å–æ¶ˆ")]))),_:1}),(0,u.bF)(V,{type:"primary",onClick:k},{default:(0,u.k6)((()=>l[28]||(l[28]=[(0,u.eW)("ç¢ºå®š")]))),_:1})])])),default:(0,u.k6)((()=>[(0,u.bF)(E,{model:r,rules:i,ref_key:"formRef",ref:c,"label-width":"120px"},{default:(0,u.k6)((()=>[(0,u.bF)(R,{shadow:"never",class:"section-card"},{header:(0,u.k6)((()=>l[18]||(l[18]=[(0,u.Lk)("span",null,"åŸºæœ¬è¨­å®š",-1)]))),default:(0,u.k6)((()=>[(0,u.bF)(D,{gutter:20},{default:(0,u.k6)((()=>[(0,u.bF)(F,{span:12},{default:(0,u.k6)((()=>[(0,u.bF)(w,{label:"æ¬„ä½é¡žåž‹",prop:"type"},{default:(0,u.k6)((()=>[(0,u.bF)(m,{modelValue:r.type,"onUpdate:modelValue":l[0]||(l[0]=e=>r.type=e),onChange:v},{default:(0,u.k6)((()=>[(0,u.bF)(t,{label:"å–®è¡Œæ–‡å­—",value:"text"}),(0,u.bF)(t,{label:"å¤šè¡Œæ–‡å­—",value:"textarea"}),(0,u.bF)(t,{label:"ä¸‹æ‹‰é¸å–®",value:"select"}),(0,u.bF)(t,{label:"å–®é¸æŒ‰éˆ•",value:"radio"}),(0,u.bF)(t,{label:"è¤‡é¸æ¡†",value:"checkbox"}),(0,u.bF)(t,{label:"æ—¥æœŸ",value:"date"}),(0,u.bF)(t,{label:"æ•¸å­—",value:"number"}),(0,u.bF)(t,{label:"é›»å­éƒµä»¶",value:"email"}),(0,u.bF)(t,{label:"æª”æ¡ˆä¸Šå‚³",value:"file"})])),_:1},8,["modelValue"])])),_:1})])),_:1}),(0,u.bF)(F,{span:12},{default:(0,u.k6)((()=>[(0,u.bF)(w,{label:"æ¬„ä½æ¨™ç±¤",prop:"label"},{default:(0,u.k6)((()=>[(0,u.bF)(C,{modelValue:r.label,"onUpdate:modelValue":l[1]||(l[1]=e=>r.label=e),placeholder:"è«‹è¼¸å…¥æ¬„ä½æ¨™ç±¤"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),(0,u.bF)(D,{gutter:20},{default:(0,u.k6)((()=>[(0,u.bF)(F,{span:12},{default:(0,u.k6)((()=>[(0,u.bF)(w,{label:"ä½”ä½ç¬¦æ–‡å­—"},{default:(0,u.k6)((()=>[(0,u.bF)(C,{modelValue:r.placeholder,"onUpdate:modelValue":l[2]||(l[2]=e=>r.placeholder=e),placeholder:"è«‹è¼¸å…¥ä½”ä½ç¬¦æ–‡å­—"},null,8,["modelValue"])])),_:1})])),_:1}),(0,u.bF)(F,{span:12},{default:(0,u.k6)((()=>[(0,u.bF)(w,{label:"æ¬„ä½å¯¬åº¦"},{default:(0,u.k6)((()=>[(0,u.bF)(m,{modelValue:r.width,"onUpdate:modelValue":l[3]||(l[3]=e=>r.width=e)},{default:(0,u.k6)((()=>[(0,u.bF)(t,{label:"25%",value:"25%"}),(0,u.bF)(t,{label:"50%",value:"50%"}),(0,u.bF)(t,{label:"75%",value:"75%"}),(0,u.bF)(t,{label:"100%",value:"100%"})])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1}),(0,u.bF)(w,{label:"èªªæ˜Žæ–‡å­—"},{default:(0,u.k6)((()=>[(0,u.bF)(C,{modelValue:r.helpText,"onUpdate:modelValue":l[4]||(l[4]=e=>r.helpText=e),type:"textarea",rows:2,placeholder:"æ¬„ä½çš„èªªæ˜Žæ–‡å­—"},null,8,["modelValue"])])),_:1}),(0,u.bF)(w,{label:"é è¨­å€¼"},{default:(0,u.k6)((()=>[((0,u.uX)(),(0,u.Wv)((0,u.$y)(f()),{modelValue:r.defaultValue,"onUpdate:modelValue":l[5]||(l[5]=e=>r.defaultValue=e),placeholder:h(),options:r.options},null,8,["modelValue","placeholder","options"]))])),_:1}),(0,u.bF)(w,null,{default:(0,u.k6)((()=>[(0,u.bF)(L,{modelValue:r.required,"onUpdate:modelValue":l[6]||(l[6]=e=>r.required=e)},{default:(0,u.k6)((()=>l[19]||(l[19]=[(0,u.eW)("å¿…å¡«æ¬„ä½")]))),_:1},8,["modelValue"])])),_:1})])),_:1}),p.value?((0,u.uX)(),(0,u.Wv)(R,{key:0,shadow:"never",class:"section-card"},{header:(0,u.k6)((()=>[(0,u.Lk)("div",v_,[l[21]||(l[21]=(0,u.Lk)("span",null,"é¸é …è¨­å®š",-1)),(0,u.bF)(V,{size:"small",type:"primary",onClick:b},{default:(0,u.k6)((()=>l[20]||(l[20]=[(0,u.Lk)("i",{class:"pi pi-plus"},null,-1),(0,u.eW)(" æ–°å¢žé¸é … ")]))),_:1})])])),default:(0,u.k6)((()=>[(0,u.Lk)("div",b_,[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(r.options,((e,a)=>((0,u.uX)(),(0,u.CE)("div",{key:a,class:"option-item"},[(0,u.bF)(C,{modelValue:e.label,"onUpdate:modelValue":a=>e.label=a,placeholder:"é¸é …æ¨™ç±¤",class:"option-label"},null,8,["modelValue","onUpdate:modelValue"]),(0,u.bF)(C,{modelValue:e.value,"onUpdate:modelValue":a=>e.value=a,placeholder:"é¸é …å€¼",class:"option-value"},null,8,["modelValue","onUpdate:modelValue"]),(0,u.bF)(L,{modelValue:e.selected,"onUpdate:modelValue":a=>e.selected=a,class:"option-default"},{default:(0,u.k6)((()=>l[22]||(l[22]=[(0,u.eW)(" é è¨­ ")]))),_:2},1032,["modelValue","onUpdate:modelValue"]),(0,u.bF)(V,{size:"small",type:"danger",onClick:e=>g(a),icon:(0,d.R1)(J.Delete)},null,8,["onClick","icon"])])))),128)),0===r.options.length?((0,u.uX)(),(0,u.CE)("div",g_,[l[24]||(l[24]=(0,u.Lk)("p",null,"å°šæœªæ–°å¢žä»»ä½•é¸é …",-1)),(0,u.bF)(V,{type:"primary",onClick:b},{default:(0,u.k6)((()=>l[23]||(l[23]=[(0,u.eW)("æ–°å¢žç¬¬ä¸€å€‹é¸é …")]))),_:1})])):(0,u.Q3)("",!0)])])),_:1})):(0,u.Q3)("",!0),(0,u.bF)(R,{shadow:"never",class:"section-card"},{header:(0,u.k6)((()=>l[25]||(l[25]=[(0,u.Lk)("span",null,"é©—è­‰è¦å‰‡",-1)]))),default:(0,u.k6)((()=>["text"===r.type||"textarea"===r.type?((0,u.uX)(),(0,u.Wv)(D,{key:0,gutter:20},{default:(0,u.k6)((()=>[(0,u.bF)(F,{span:12},{default:(0,u.k6)((()=>[(0,u.bF)(w,{label:"æœ€å°é•·åº¦"},{default:(0,u.k6)((()=>[(0,u.bF)(I,{modelValue:r.validation.minLength,"onUpdate:modelValue":l[7]||(l[7]=e=>r.validation.minLength=e),min:0,placeholder:"ä¸é™åˆ¶"},null,8,["modelValue"])])),_:1})])),_:1}),(0,u.bF)(F,{span:12},{default:(0,u.k6)((()=>[(0,u.bF)(w,{label:"æœ€å¤§é•·åº¦"},{default:(0,u.k6)((()=>[(0,u.bF)(I,{modelValue:r.validation.maxLength,"onUpdate:modelValue":l[8]||(l[8]=e=>r.validation.maxLength=e),min:1,placeholder:"ä¸é™åˆ¶"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})):(0,u.Q3)("",!0),"number"===r.type?((0,u.uX)(),(0,u.Wv)(D,{key:1,gutter:20},{default:(0,u.k6)((()=>[(0,u.bF)(F,{span:12},{default:(0,u.k6)((()=>[(0,u.bF)(w,{label:"æœ€å°å€¼"},{default:(0,u.k6)((()=>[(0,u.bF)(I,{modelValue:r.validation.min,"onUpdate:modelValue":l[9]||(l[9]=e=>r.validation.min=e),placeholder:"ä¸é™åˆ¶"},null,8,["modelValue"])])),_:1})])),_:1}),(0,u.bF)(F,{span:12},{default:(0,u.k6)((()=>[(0,u.bF)(w,{label:"æœ€å¤§å€¼"},{default:(0,u.k6)((()=>[(0,u.bF)(I,{modelValue:r.validation.max,"onUpdate:modelValue":l[10]||(l[10]=e=>r.validation.max=e),placeholder:"ä¸é™åˆ¶"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})):(0,u.Q3)("",!0),"text"===r.type||"email"===r.type?((0,u.uX)(),(0,u.Wv)(w,{key:2,label:"æ­£å‰‡è¡¨é”å¼"},{default:(0,u.k6)((()=>[(0,u.bF)(C,{modelValue:r.validation.pattern,"onUpdate:modelValue":l[11]||(l[11]=e=>r.validation.pattern=e),placeholder:"ä¾‹å¦‚: ^[A-Za-z0-9]+$"},null,8,["modelValue"])])),_:1})):(0,u.Q3)("",!0),(0,u.bF)(w,{label:"è‡ªè¨‚éŒ¯èª¤è¨Šæ¯"},{default:(0,u.k6)((()=>[(0,u.bF)(C,{modelValue:r.validation.customMessage,"onUpdate:modelValue":l[12]||(l[12]=e=>r.validation.customMessage=e),placeholder:"é©—è­‰å¤±æ•—æ™‚é¡¯ç¤ºçš„è¨Šæ¯"},null,8,["modelValue"])])),_:1})])),_:1}),(0,u.bF)(R,{shadow:"never",class:"section-card"},{header:(0,u.k6)((()=>[(0,u.Lk)("div",y_,[l[26]||(l[26]=(0,u.Lk)("span",null,"æ¢ä»¶é¡¯ç¤º",-1)),(0,u.bF)(x,{modelValue:s.value,"onUpdate:modelValue":l[13]||(l[13]=e=>s.value=e),onChange:y},null,8,["modelValue"])])])),default:(0,u.k6)((()=>[s.value?((0,u.uX)(),(0,u.CE)("div",f_,[(0,u.bF)(w,{label:"ä¾è³´æ¬„ä½"},{default:(0,u.k6)((()=>[(0,u.bF)(m,{modelValue:r.conditional.dependsOn,"onUpdate:modelValue":l[14]||(l[14]=e=>r.conditional.dependsOn=e),placeholder:"é¸æ“‡ä¾è³´çš„æ¬„ä½"},{default:(0,u.k6)((()=>[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(e.availableFields,(e=>((0,u.uX)(),(0,u.Wv)(t,{key:e.id,label:e.label,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,u.bF)(D,{gutter:20},{default:(0,u.k6)((()=>[(0,u.bF)(F,{span:12},{default:(0,u.k6)((()=>[(0,u.bF)(w,{label:"æ¢ä»¶"},{default:(0,u.k6)((()=>[(0,u.bF)(m,{modelValue:r.conditional.condition,"onUpdate:modelValue":l[15]||(l[15]=e=>r.conditional.condition=e)},{default:(0,u.k6)((()=>[(0,u.bF)(t,{label:"ç­‰æ–¼",value:"equals"}),(0,u.bF)(t,{label:"ä¸ç­‰æ–¼",value:"not_equals"}),(0,u.bF)(t,{label:"åŒ…å«",value:"contains"}),(0,u.bF)(t,{label:"ä¸åŒ…å«",value:"not_contains"}),(0,u.bF)(t,{label:"ç‚ºç©º",value:"empty"}),(0,u.bF)(t,{label:"ä¸ç‚ºç©º",value:"not_empty"})])),_:1},8,["modelValue"])])),_:1})])),_:1}),(0,u.bF)(F,{span:12},{default:(0,u.k6)((()=>[(0,u.bF)(w,{label:"æ¯”è¼ƒå€¼"},{default:(0,u.k6)((()=>[(0,u.bF)(C,{modelValue:r.conditional.value,"onUpdate:modelValue":l[16]||(l[16]=e=>r.conditional.value=e),placeholder:"æ¢ä»¶æ¯”è¼ƒçš„å€¼"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})])):(0,u.Q3)("",!0)])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue","title"])}}};const __=(0,ie.A)(k_,[["__scopeId","data-v-293df904"]]);var w_=__,F_=l(54117);const C_={class:"form-template-dialog"},D_={class:"card-header"},L_={class:"fields-designer"},R_={class:"field-item"},V_={class:"field-header"},I_={class:"field-info"},x_={class:"field-type-badge"},E_={class:"field-label"},A_={class:"field-actions"},T_={class:"field-preview"},W_={key:0,class:"empty-fields"},S_={class:"dialog-footer"};var U_={__name:"FormTemplateDialog",props:{visible:{type:Boolean,default:!1},templateData:{type:Object,default:null}},emits:["update:visible","saved"],setup(e,{emit:a}){const l=e,o=a,n=(0,u.EW)({get:()=>l.visible,set:e=>o("update:visible",e)}),r=(0,u.EW)((()=>!!l.templateData?.id)),s=(0,d.KR)(!1),i=(0,d.KR)(!1),c=(0,d.Kh)({title:"",description:"",category:"",tags:[],fields:[],settings:{allowMultipleSubmissions:!0,requireLogin:!0,showProgressBar:!1,submitButtonText:"æäº¤",successMessage:"è¡¨å–®æäº¤æˆåŠŸï¼",redirectUrl:"",notificationEmails:[],startDate:null,endDate:null,maxSubmissions:null}}),p={title:[{required:!0,message:"è«‹è¼¸å…¥è¡¨å–®åç¨±",trigger:"blur"},{min:2,max:100,message:"è¡¨å–®åç¨±é•·åº¦åœ¨ 2 åˆ° 100 å€‹å­—å…ƒ",trigger:"blur"}],category:[{required:!0,message:"è«‹é¸æ“‡è¡¨å–®åˆ†é¡ž",trigger:"change"}],description:[{max:500,message:"æè¿°ä¸èƒ½è¶…éŽ 500 å€‹å­—å…ƒ",trigger:"blur"}]},m=(0,d.KR)(!1),v=(0,d.KR)(""),b=(0,d.KR)(),g=(0,d.KR)(!1),y=(0,d.KR)(null),f=(0,d.KR)(-1),h=(0,d.KR)(),k={text:"å–®è¡Œæ–‡å­—",textarea:"å¤šè¡Œæ–‡å­—",select:"ä¸‹æ‹‰é¸å–®",radio:"å–®é¸æŒ‰éˆ•",checkbox:"è¤‡é¸æ¡†",date:"æ—¥æœŸ",number:"æ•¸å­—",email:"é›»å­éƒµä»¶",file:"æª”æ¡ˆä¸Šå‚³"},_=e=>k[e]||e,w=()=>{l.templateData&&r.value?Object.assign(c,{title:l.templateData.title||"",description:l.templateData.description||"",category:l.templateData.category||"",tags:[...l.templateData.tags||[]],fields:l.templateData.fields?.map((e=>({...e})))||[],settings:{...c.settings,...l.templateData.settings||{}}}):Object.assign(c,{title:"",description:"",category:"",tags:[],fields:[],settings:{allowMultipleSubmissions:!0,requireLogin:!0,showProgressBar:!1,submitButtonText:"æäº¤",successMessage:"è¡¨å–®æäº¤æˆåŠŸï¼",redirectUrl:"",notificationEmails:[],startDate:null,endDate:null,maxSubmissions:null}})},F=()=>{const e={id:F_.A.generateId(),type:"text",label:"",placeholder:"",required:!1,validation:null,options:[],defaultValue:null,order:c.fields.length,width:"100%",helpText:"",conditional:null};y.value=e,f.value=-1,g.value=!0},C=e=>{y.value={...c.fields[e]},f.value=e,g.value=!0},R=e=>{c.fields.splice(e,1),c.fields.forEach(((e,a)=>{e.order=a}))},V=e=>{console.log("handleFieldSaved called with:",e),f.value>=0?c.fields[f.value]={...e}:(e.order=c.fields.length,c.fields.push(e)),console.log("formData.fields after push:",c.fields),g.value=!1,y.value=null,f.value=-1},I=e=>{c.tags.splice(c.tags.indexOf(e),1)},x=()=>{m.value=!0,(0,u.dY)((()=>{b.value?.input?.focus()}))},E=()=>{v.value&&!c.tags.includes(v.value)&&c.tags.push(v.value),m.value=!1,v.value=""},A=async()=>{try{if(await(h.value?.validate()),0===c.fields.length)return void D.nk.warning("è«‹è‡³å°‘æ–°å¢žä¸€å€‹è¡¨å–®æ¬„ä½");s.value=!0;const e={title:c.title,description:c.description,category:c.category,tags:c.tags,fields:c.fields,settings:c.settings};r.value?(await F_.A.updateFormTemplate(l.templateData.id,e),D.nk.success("è¡¨å–®ç¯„æœ¬æ›´æ–°æˆåŠŸ")):(await F_.A.createFormTemplate(e),D.nk.success("è¡¨å–®ç¯„æœ¬å»ºç«‹æˆåŠŸ")),o("saved")}catch(e){console.error("å„²å­˜å¤±æ•—:",e),D.nk.error("å„²å­˜å¤±æ•—")}finally{s.value=!1}},T=()=>{n.value=!1};return(0,u.wB)((()=>l.visible),(e=>{e&&w()})),(e,a)=>{const l=(0,u.g2)("el-input"),o=(0,u.g2)("el-form-item"),f=(0,u.g2)("el-col"),k=(0,u.g2)("el-option"),w=(0,u.g2)("el-select"),D=(0,u.g2)("el-row"),W=(0,u.g2)("el-tag"),S=(0,u.g2)("el-button"),U=(0,u.g2)("el-form"),$=(0,u.g2)("el-card"),N=(0,u.g2)("el-switch"),X=(0,u.g2)("el-input-number"),K=(0,u.g2)("el-date-picker"),M=(0,u.g2)("el-dialog");return(0,u.uX)(),(0,u.Wv)(M,{modelValue:n.value,"onUpdate:modelValue":a[17]||(a[17]=e=>n.value=e),title:r.value?"ç·¨è¼¯è¡¨å–®ç¯„æœ¬":"æ–°å¢žè¡¨å–®ç¯„æœ¬",width:"80%","close-on-click-modal":!1,onClose:T},{footer:(0,u.k6)((()=>[(0,u.Lk)("div",S_,[(0,u.bF)(S,{onClick:T},{default:(0,u.k6)((()=>a[31]||(a[31]=[(0,u.eW)("å–æ¶ˆ")]))),_:1}),(0,u.bF)(S,{type:"primary",onClick:A,loading:s.value},{default:(0,u.k6)((()=>[(0,u.eW)((0,L.v_)(r.value?"æ›´æ–°":"å»ºç«‹"),1)])),_:1},8,["loading"])])])),default:(0,u.k6)((()=>[(0,u.Lk)("div",C_,[(0,u.bF)($,{class:"section-card",shadow:"never"},{header:(0,u.k6)((()=>a[18]||(a[18]=[(0,u.Lk)("div",{class:"card-header"},[(0,u.Lk)("i",{class:"pi pi-info-circle"}),(0,u.Lk)("span",null,"åŸºæœ¬è³‡è¨Š")],-1)]))),default:(0,u.k6)((()=>[(0,u.bF)(U,{model:c,rules:p,ref_key:"formRef",ref:h,"label-width":"120px"},{default:(0,u.k6)((()=>[(0,u.bF)(D,{gutter:20},{default:(0,u.k6)((()=>[(0,u.bF)(f,{span:12},{default:(0,u.k6)((()=>[(0,u.bF)(o,{label:"è¡¨å–®åç¨±",prop:"title"},{default:(0,u.k6)((()=>[(0,u.bF)(l,{modelValue:c.title,"onUpdate:modelValue":a[0]||(a[0]=e=>c.title=e),placeholder:"è«‹è¼¸å…¥è¡¨å–®åç¨±"},null,8,["modelValue"])])),_:1})])),_:1}),(0,u.bF)(f,{span:12},{default:(0,u.k6)((()=>[(0,u.bF)(o,{label:"è¡¨å–®åˆ†é¡ž",prop:"category"},{default:(0,u.k6)((()=>[(0,u.bF)(w,{modelValue:c.category,"onUpdate:modelValue":a[1]||(a[1]=e=>c.category=e),placeholder:"è«‹é¸æ“‡åˆ†é¡ž"},{default:(0,u.k6)((()=>[(0,u.bF)(k,{label:"äººäº‹è¡¨å–®",value:"hr"}),(0,u.bF)(k,{label:"è²¡å‹™è¡¨å–®",value:"finance"}),(0,u.bF)(k,{label:"æŽ¡è³¼è¡¨å–®",value:"purchase"}),(0,u.bF)(k,{label:"å…¶ä»–",value:"other"})])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1}),(0,u.bF)(o,{label:"è¡¨å–®æè¿°",prop:"description"},{default:(0,u.k6)((()=>[(0,u.bF)(l,{modelValue:c.description,"onUpdate:modelValue":a[2]||(a[2]=e=>c.description=e),type:"textarea",rows:3,placeholder:"è«‹è¼¸å…¥è¡¨å–®æè¿°"},null,8,["modelValue"])])),_:1}),(0,u.bF)(o,{label:"æ¨™ç±¤"},{default:(0,u.k6)((()=>[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(c.tags,(e=>((0,u.uX)(),(0,u.Wv)(W,{key:e,closable:"",onClose:a=>I(e),class:"tag-item"},{default:(0,u.k6)((()=>[(0,u.eW)((0,L.v_)(e),1)])),_:2},1032,["onClose"])))),128)),m.value?((0,u.uX)(),(0,u.Wv)(l,{key:0,ref_key:"inputRef",ref:b,modelValue:v.value,"onUpdate:modelValue":a[3]||(a[3]=e=>v.value=e),class:"tag-input",size:"small",onKeyup:(0,t.jR)(E,["enter"]),onBlur:E},null,8,["modelValue"])):((0,u.uX)(),(0,u.Wv)(S,{key:1,class:"button-new-tag",size:"small",onClick:x},{default:(0,u.k6)((()=>a[19]||(a[19]=[(0,u.eW)(" + æ–°å¢žæ¨™ç±¤ ")]))),_:1}))])),_:1})])),_:1},8,["model"])])),_:1}),(0,u.bF)($,{class:"section-card",shadow:"never"},{header:(0,u.k6)((()=>[(0,u.Lk)("div",D_,[a[21]||(a[21]=(0,u.Lk)("i",{class:"pi pi-list"},null,-1)),a[22]||(a[22]=(0,u.Lk)("span",null,"è¡¨å–®æ¬„ä½è¨­è¨ˆ",-1)),(0,u.bF)(S,{type:"primary",size:"small",onClick:F,class:"add-field-btn"},{default:(0,u.k6)((()=>a[20]||(a[20]=[(0,u.Lk)("i",{class:"pi pi-plus"},null,-1),(0,u.eW)(" æ–°å¢žæ¬„ä½ ")]))),_:1})])])),default:(0,u.k6)((()=>[(0,u.Lk)("div",L_,[(0,u.bF)((0,d.R1)(Ld.MA),{modelValue:c.fields,"onUpdate:modelValue":a[4]||(a[4]=e=>c.fields=e),group:"fields",onStart:a[5]||(a[5]=e=>i.value=!0),onEnd:a[6]||(a[6]=e=>i.value=!1),"item-key":"id"},{item:(0,u.k6)((({element:e,index:l})=>[(0,u.Lk)("div",R_,[(0,u.Lk)("div",V_,[(0,u.Lk)("div",I_,[a[24]||(a[24]=(0,u.Lk)("i",{class:"pi pi-bars drag-handle"},null,-1)),(0,u.Lk)("span",x_,(0,L.v_)(_(e.type)),1),(0,u.Lk)("span",E_,(0,L.v_)(e.label||"æœªå‘½åæ¬„ä½"),1),e.required?((0,u.uX)(),(0,u.Wv)(W,{key:0,type:"danger",size:"small"},{default:(0,u.k6)((()=>a[23]||(a[23]=[(0,u.eW)("å¿…å¡«")]))),_:1})):(0,u.Q3)("",!0)]),(0,u.Lk)("div",A_,[(0,u.bF)(S,{size:"small",onClick:e=>C(l)},{default:(0,u.k6)((()=>a[25]||(a[25]=[(0,u.eW)("ç·¨è¼¯")]))),_:2},1032,["onClick"]),(0,u.bF)(S,{size:"small",type:"danger",onClick:e=>R(l)},{default:(0,u.k6)((()=>a[26]||(a[26]=[(0,u.eW)("åˆªé™¤")]))),_:2},1032,["onClick"])])]),(0,u.Lk)("div",T_,[(0,u.bF)(m_,{field:e},null,8,["field"])])])])),_:1},8,["modelValue"]),0===c.fields.length?((0,u.uX)(),(0,u.CE)("div",W_,[a[28]||(a[28]=(0,u.Lk)("i",{class:"pi pi-inbox"},null,-1)),a[29]||(a[29]=(0,u.Lk)("p",null,"å°šæœªæ–°å¢žä»»ä½•æ¬„ä½",-1)),(0,u.bF)(S,{type:"primary",onClick:F},{default:(0,u.k6)((()=>a[27]||(a[27]=[(0,u.eW)("æ–°å¢žç¬¬ä¸€å€‹æ¬„ä½")]))),_:1})])):(0,u.Q3)("",!0)])])),_:1}),(0,u.bF)($,{class:"section-card",shadow:"never"},{header:(0,u.k6)((()=>a[30]||(a[30]=[(0,u.Lk)("div",{class:"card-header"},[(0,u.Lk)("i",{class:"pi pi-cog"}),(0,u.Lk)("span",null,"è¡¨å–®è¨­å®š")],-1)]))),default:(0,u.k6)((()=>[(0,u.bF)(U,{model:c.settings,"label-width":"150px"},{default:(0,u.k6)((()=>[(0,u.bF)(D,{gutter:20},{default:(0,u.k6)((()=>[(0,u.bF)(f,{span:12},{default:(0,u.k6)((()=>[(0,u.bF)(o,{label:"å…è¨±å¤šæ¬¡æäº¤"},{default:(0,u.k6)((()=>[(0,u.bF)(N,{modelValue:c.settings.allowMultipleSubmissions,"onUpdate:modelValue":a[7]||(a[7]=e=>c.settings.allowMultipleSubmissions=e)},null,8,["modelValue"])])),_:1})])),_:1}),(0,u.bF)(f,{span:12},{default:(0,u.k6)((()=>[(0,u.bF)(o,{label:"éœ€è¦ç™»å…¥"},{default:(0,u.k6)((()=>[(0,u.bF)(N,{modelValue:c.settings.requireLogin,"onUpdate:modelValue":a[8]||(a[8]=e=>c.settings.requireLogin=e)},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),(0,u.bF)(D,{gutter:20},{default:(0,u.k6)((()=>[(0,u.bF)(f,{span:12},{default:(0,u.k6)((()=>[(0,u.bF)(o,{label:"é¡¯ç¤ºé€²åº¦æ¢"},{default:(0,u.k6)((()=>[(0,u.bF)(N,{modelValue:c.settings.showProgressBar,"onUpdate:modelValue":a[9]||(a[9]=e=>c.settings.showProgressBar=e)},null,8,["modelValue"])])),_:1})])),_:1}),(0,u.bF)(f,{span:12},{default:(0,u.k6)((()=>[(0,u.bF)(o,{label:"æœ€å¤§æäº¤æ•¸é‡"},{default:(0,u.k6)((()=>[(0,u.bF)(X,{modelValue:c.settings.maxSubmissions,"onUpdate:modelValue":a[10]||(a[10]=e=>c.settings.maxSubmissions=e),min:1,placeholder:"ä¸é™åˆ¶"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),(0,u.bF)(D,{gutter:20},{default:(0,u.k6)((()=>[(0,u.bF)(f,{span:12},{default:(0,u.k6)((()=>[(0,u.bF)(o,{label:"é–‹å§‹æ™‚é–“"},{default:(0,u.k6)((()=>[(0,u.bF)(K,{modelValue:c.settings.startDate,"onUpdate:modelValue":a[11]||(a[11]=e=>c.settings.startDate=e),type:"datetime",placeholder:"é¸æ“‡é–‹å§‹æ™‚é–“",format:"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue"])])),_:1})])),_:1}),(0,u.bF)(f,{span:12},{default:(0,u.k6)((()=>[(0,u.bF)(o,{label:"çµæŸæ™‚é–“"},{default:(0,u.k6)((()=>[(0,u.bF)(K,{modelValue:c.settings.endDate,"onUpdate:modelValue":a[12]||(a[12]=e=>c.settings.endDate=e),type:"datetime",placeholder:"é¸æ“‡çµæŸæ™‚é–“",format:"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),(0,u.bF)(o,{label:"æäº¤æŒ‰éˆ•æ–‡å­—"},{default:(0,u.k6)((()=>[(0,u.bF)(l,{modelValue:c.settings.submitButtonText,"onUpdate:modelValue":a[13]||(a[13]=e=>c.settings.submitButtonText=e),placeholder:"æäº¤"},null,8,["modelValue"])])),_:1}),(0,u.bF)(o,{label:"æˆåŠŸè¨Šæ¯"},{default:(0,u.k6)((()=>[(0,u.bF)(l,{modelValue:c.settings.successMessage,"onUpdate:modelValue":a[14]||(a[14]=e=>c.settings.successMessage=e),type:"textarea",placeholder:"è¡¨å–®æäº¤æˆåŠŸï¼"},null,8,["modelValue"])])),_:1}),(0,u.bF)(o,{label:"é€šçŸ¥ä¿¡ç®±"},{default:(0,u.k6)((()=>[(0,u.bF)(w,{modelValue:c.settings.notificationEmails,"onUpdate:modelValue":a[15]||(a[15]=e=>c.settings.notificationEmails=e),multiple:"",filterable:"","allow-create":"",placeholder:"è¼¸å…¥é›»å­éƒµä»¶åœ°å€"},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1})]),(0,u.bF)(w_,{visible:g.value,"onUpdate:visible":a[16]||(a[16]=e=>g.value=e),"field-data":y.value,onSaved:V},null,8,["visible","field-data"])])),_:1},8,["modelValue","title"])}}};const $_=(0,ie.A)(U_,[["__scopeId","data-v-4a950e75"]]);var N_=$_;const X_={class:"form-preview-dialog"},K_={key:0,class:"form-info-section"},M_={class:"form-header"},P_={class:"form-title"},O_={class:"form-meta"},z_={class:"created-date"},B_={key:0,class:"form-description"},j_={class:"form-stats"},Y_={class:"form-fields-section"},Q_={key:0,class:"no-fields"},H_={key:1,class:"fields-preview"},q_={class:"field-header"},J_={class:"field-info"},G_={class:"field-order"},Z_={class:"field-label"},ew={class:"field-details"},aw={key:0,class:"field-placeholder"},lw={key:1,class:"field-help"},tw={key:2,class:"field-default"},ow={key:3,class:"field-options"},nw={key:4,class:"field-validation"},rw={class:"validation-list"},sw={key:0},uw={key:1},iw={key:2},dw={key:3},cw={class:"field-demo"},pw={key:1,class:"form-settings-section"},mw={class:"dialog-footer"};var vw={__name:"FormPreviewDialog",props:{visible:{type:Boolean,default:!1},templateData:{type:Object,default:null}},emits:["update:visible"],setup(e,{emit:a}){const l=e,t=a,o=(0,C.rd)(),n=(0,d.KR)(!1),r=(0,u.EW)((()=>l.templateData?.fields?.length||0)),s=(0,u.EW)((()=>l.templateData?.fields?.filter((e=>e.required))?.length||0)),i=(0,u.EW)((()=>l.templateData?.fields?[...l.templateData.fields].sort(((e,a)=>(e.order||0)-(a.order||0))):[])),c=e=>{const a={hr:"äººäº‹è¡¨å–®",finance:"è²¡å‹™è¡¨å–®",purchase:"æŽ¡è³¼è¡¨å–®",other:"å…¶ä»–"};return a[e]||e||"æœªåˆ†é¡ž"},p=e=>{const a={draft:"è‰ç¨¿",published:"å·²ç™¼å¸ƒ",closed:"å·²é—œé–‰"};return a[e]||e||"æœªçŸ¥"},m=e=>{const a={draft:"info",published:"success",closed:"danger"};return a[e]||""},v=e=>{const a={text:"å–®è¡Œæ–‡å­—",textarea:"å¤šè¡Œæ–‡å­—",select:"ä¸‹æ‹‰é¸å–®",radio:"å–®é¸æŒ‰éˆ•",checkbox:"è¤‡é¸æ¡†",date:"æ—¥æœŸ",number:"æ•¸å­—",email:"é›»å­éƒµä»¶",file:"æª”æ¡ˆä¸Šå‚³"};return a[e]||e},b=e=>{const a={text:"",textarea:"info",select:"success",radio:"warning",checkbox:"warning",date:"info",number:"success",email:"info",file:"danger"};return a[e]||""},g=e=>["select","radio","checkbox"].includes(e.type)&&e.options?.length>0,y=e=>e.minLength||e.maxLength||void 0!==e.min||void 0!==e.max,f=e=>e?new Date(e).toLocaleString("zh-TW"):"",h=()=>{n.value=!1,t("update:visible",!1)},k=()=>{l.templateData?.id?o.push(`/home/SystemManagement/FormDesigner/${l.templateData.id}`):o.push("/home/SystemManagement/FormDesigner"),h()},_=()=>{l.templateData?.id&&o.push(`/form/fill/${l.templateData.id}`),h()};return(0,u.wB)((()=>l.visible),(e=>{n.value=e})),(0,u.wB)(n,(e=>{e||t("update:visible",!1)})),(a,l)=>{const t=(0,u.g2)("el-tag"),o=(0,u.g2)("el-statistic"),d=(0,u.g2)("el-col"),w=(0,u.g2)("el-row"),F=(0,u.g2)("el-button"),C=(0,u.g2)("el-empty"),D=(0,u.g2)("el-descriptions-item"),R=(0,u.g2)("el-descriptions"),V=(0,u.g2)("el-dialog");return(0,u.uX)(),(0,u.Wv)(V,{modelValue:n.value,"onUpdate:modelValue":l[0]||(l[0]=e=>n.value=e),title:"è¡¨å–®é è¦½",width:"80%","close-on-click-modal":!1,onClose:h},{footer:(0,u.k6)((()=>[(0,u.Lk)("div",mw,[(0,u.bF)(F,{onClick:h},{default:(0,u.k6)((()=>l[10]||(l[10]=[(0,u.eW)("é—œé–‰")]))),_:1}),"published"===e.templateData?.status?((0,u.uX)(),(0,u.Wv)(F,{key:0,type:"info",onClick:_},{default:(0,u.k6)((()=>l[11]||(l[11]=[(0,u.eW)(" å¡«å¯«è¡¨å–® ")]))),_:1})):(0,u.Q3)("",!0),(0,u.bF)(F,{type:"primary",onClick:k},{default:(0,u.k6)((()=>l[12]||(l[12]=[(0,u.eW)(" ç·¨è¼¯è¡¨å–® ")]))),_:1})])])),default:(0,u.k6)((()=>[(0,u.Lk)("div",X_,[e.templateData?((0,u.uX)(),(0,u.CE)("div",K_,[(0,u.Lk)("div",M_,[(0,u.Lk)("h2",P_,(0,L.v_)(e.templateData.title),1),(0,u.Lk)("div",O_,[e.templateData.category?((0,u.uX)(),(0,u.Wv)(t,{key:0,type:"info",size:"small"},{default:(0,u.k6)((()=>[(0,u.eW)((0,L.v_)(c(e.templateData.category)),1)])),_:1})):(0,u.Q3)("",!0),(0,u.bF)(t,{type:m(e.templateData.status),size:"small"},{default:(0,u.k6)((()=>[(0,u.eW)((0,L.v_)(p(e.templateData.status)),1)])),_:1},8,["type"]),(0,u.Lk)("span",z_," å»ºç«‹æ–¼: "+(0,L.v_)(f(e.templateData.createdAt)),1)]),e.templateData.description?((0,u.uX)(),(0,u.CE)("p",B_,(0,L.v_)(e.templateData.description),1)):(0,u.Q3)("",!0)]),(0,u.Lk)("div",j_,[(0,u.bF)(w,{gutter:20},{default:(0,u.k6)((()=>[(0,u.bF)(d,{span:6},{default:(0,u.k6)((()=>[(0,u.bF)(o,{title:"æ¬„ä½æ•¸é‡",value:r.value},null,8,["value"])])),_:1}),(0,u.bF)(d,{span:6},{default:(0,u.k6)((()=>[(0,u.bF)(o,{title:"å¿…å¡«æ¬„ä½",value:s.value},null,8,["value"])])),_:1}),(0,u.bF)(d,{span:6},{default:(0,u.k6)((()=>[(0,u.bF)(o,{title:"å›žæ‡‰æ•¸é‡",value:e.templateData.responseCount||0},null,8,["value"])])),_:1}),(0,u.bF)(d,{span:6},{default:(0,u.k6)((()=>[(0,u.bF)(o,{title:"æœ€å¾Œæ›´æ–°",value:f(e.templateData.updatedAt),format:"YYYY-MM-DD"},null,8,["value"])])),_:1})])),_:1})])])):(0,u.Q3)("",!0),(0,u.Lk)("div",Y_,[l[8]||(l[8]=(0,u.Lk)("h3",null,"è¡¨å–®æ¬„ä½é è¦½",-1)),e.templateData?.fields&&0!==e.templateData.fields.length?((0,u.uX)(),(0,u.CE)("div",H_,[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(i.value,((e,a)=>((0,u.uX)(),(0,u.CE)("div",{key:e.id,class:"field-preview-item"},[(0,u.Lk)("div",q_,[(0,u.Lk)("div",J_,[(0,u.Lk)("span",G_,(0,L.v_)(a+1)+".",1),(0,u.Lk)("span",Z_,[(0,u.eW)((0,L.v_)(e.label)+" ",1),e.required?((0,u.uX)(),(0,u.Wv)(t,{key:0,type:"danger",size:"small"},{default:(0,u.k6)((()=>l[2]||(l[2]=[(0,u.eW)("å¿…å¡«")]))),_:1})):(0,u.Q3)("",!0)]),(0,u.bF)(t,{type:b(e.type),size:"small"},{default:(0,u.k6)((()=>[(0,u.eW)((0,L.v_)(v(e.type)),1)])),_:2},1032,["type"])])]),(0,u.Lk)("div",ew,[e.placeholder?((0,u.uX)(),(0,u.CE)("p",aw,[l[3]||(l[3]=(0,u.Lk)("strong",null,"ä½”ä½ç¬¦:",-1)),(0,u.eW)(" "+(0,L.v_)(e.placeholder),1)])):(0,u.Q3)("",!0),e.helpText?((0,u.uX)(),(0,u.CE)("p",lw,[l[4]||(l[4]=(0,u.Lk)("strong",null,"èªªæ˜Ž:",-1)),(0,u.eW)(" "+(0,L.v_)(e.helpText),1)])):(0,u.Q3)("",!0),e.defaultValue?((0,u.uX)(),(0,u.CE)("p",tw,[l[5]||(l[5]=(0,u.Lk)("strong",null,"é è¨­å€¼:",-1)),(0,u.eW)(" "+(0,L.v_)(e.defaultValue),1)])):(0,u.Q3)("",!0),g(e)?((0,u.uX)(),(0,u.CE)("div",ow,[l[6]||(l[6]=(0,u.Lk)("strong",null,"é¸é …:",-1)),((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(e.options,(e=>((0,u.uX)(),(0,u.Wv)(t,{key:e.value,size:"small",class:"option-tag"},{default:(0,u.k6)((()=>[(0,u.eW)((0,L.v_)(e.label),1)])),_:2},1024)))),128))])):(0,u.Q3)("",!0),y(e)?((0,u.uX)(),(0,u.CE)("div",nw,[l[7]||(l[7]=(0,u.Lk)("strong",null,"é©—è­‰è¦å‰‡:",-1)),(0,u.Lk)("ul",rw,[e.minLength?((0,u.uX)(),(0,u.CE)("li",sw,"æœ€å°é•·åº¦: "+(0,L.v_)(e.minLength),1)):(0,u.Q3)("",!0),e.maxLength?((0,u.uX)(),(0,u.CE)("li",uw,"æœ€å¤§é•·åº¦: "+(0,L.v_)(e.maxLength),1)):(0,u.Q3)("",!0),void 0!==e.min?((0,u.uX)(),(0,u.CE)("li",iw,"æœ€å°å€¼: "+(0,L.v_)(e.min),1)):(0,u.Q3)("",!0),void 0!==e.max?((0,u.uX)(),(0,u.CE)("li",dw,"æœ€å¤§å€¼: "+(0,L.v_)(e.max),1)):(0,u.Q3)("",!0)])])):(0,u.Q3)("",!0)]),(0,u.Lk)("div",cw,[(0,u.bF)(m_,{field:e},null,8,["field"])])])))),128))])):((0,u.uX)(),(0,u.CE)("div",Q_,[(0,u.bF)(C,{description:"æ­¤è¡¨å–®å°šæœªè¨­è¨ˆä»»ä½•æ¬„ä½"},{default:(0,u.k6)((()=>[(0,u.bF)(F,{type:"primary",onClick:k},{default:(0,u.k6)((()=>l[1]||(l[1]=[(0,u.eW)(" å‰å¾€è¨­è¨ˆå™¨ ")]))),_:1})])),_:1})]))]),e.templateData?.settings?((0,u.uX)(),(0,u.CE)("div",pw,[l[9]||(l[9]=(0,u.Lk)("h3",null,"è¡¨å–®è¨­å®š",-1)),(0,u.bF)(R,{column:2,border:""},{default:(0,u.k6)((()=>[(0,u.bF)(D,{label:"å…è¨±å¤šæ¬¡æäº¤"},{default:(0,u.k6)((()=>[(0,u.bF)(t,{type:e.templateData.settings.allowMultipleSubmissions?"success":"info"},{default:(0,u.k6)((()=>[(0,u.eW)((0,L.v_)(e.templateData.settings.allowMultipleSubmissions?"æ˜¯":"å¦"),1)])),_:1},8,["type"])])),_:1}),(0,u.bF)(D,{label:"é¡¯ç¤ºé€²åº¦æ¢"},{default:(0,u.k6)((()=>[(0,u.bF)(t,{type:e.templateData.settings.showProgressBar?"success":"info"},{default:(0,u.k6)((()=>[(0,u.eW)((0,L.v_)(e.templateData.settings.showProgressBar?"æ˜¯":"å¦"),1)])),_:1},8,["type"])])),_:1}),(0,u.bF)(D,{label:"æˆªæ­¢æ™‚é–“"},{default:(0,u.k6)((()=>[(0,u.eW)((0,L.v_)(e.templateData.settings.endDate?f(e.templateData.settings.endDate):"ç„¡é™åˆ¶"),1)])),_:1}),(0,u.bF)(D,{label:"æäº¤æŒ‰éˆ•æ–‡å­—"},{default:(0,u.k6)((()=>[(0,u.eW)((0,L.v_)(e.templateData.settings.submitButtonText||"æäº¤è¡¨å–®"),1)])),_:1}),(0,u.bF)(D,{label:"æˆåŠŸè¨Šæ¯"},{default:(0,u.k6)((()=>[(0,u.eW)((0,L.v_)(e.templateData.settings.successMessage||"è¡¨å–®æäº¤æˆåŠŸï¼"),1)])),_:1})])),_:1})])):(0,u.Q3)("",!0)])])),_:1},8,["modelValue"])}}};const bw=(0,ie.A)(vw,[["__scopeId","data-v-c361ab14"]]);var gw=bw;const yw={key:0},fw={key:1};var hw={__name:"FormResponseDialog",props:{visible:Boolean,templateData:Object},emits:["update:visible"],setup(e){const a=e,l=(0,d.KR)(!1),t=(0,d.KR)([]),o=async()=>{if(a.templateData?.id){l.value=!0;try{const e=await F_.A.getFormResponses(a.templateData.id);t.value=e.data}catch(e){console.error("è¼‰å…¥è¡¨å–®å›žæ‡‰å¤±æ•—:",e),D.nk.error("è¼‰å…¥è¡¨å–®å›žæ‡‰å¤±æ•—")}finally{l.value=!1}}else t.value=[]},n=e=>new Date(e).toLocaleString("zh-TW"),r=async e=>{if(a.templateData?.id)try{const l=await F_.A.exportFormResponses(a.templateData.id,e),t=new Blob([l.data],{type:l.headers["content-type"]}),o=document.createElement("a");o.href=window.URL.createObjectURL(t),o.download=`${a.templateData.title}_responses.${"excel"===e?"xlsx":"csv"}`,o.click()}catch(l){console.error("åŒ¯å‡ºå›žæ‡‰å¤±æ•—:",l),D.nk.error("åŒ¯å‡ºå›žæ‡‰å¤±æ•—")}else D.nk.error("æ²’æœ‰å¯ç”¨çš„ç¯„æœ¬è³‡æ–™")};return(0,u.wB)((()=>a.visible),(e=>{e&&o()})),(0,u.sV)((()=>{a.visible&&o()})),(a,o)=>{const s=(0,u.g2)("el-table-column"),i=(0,u.g2)("el-table"),d=(0,u.g2)("el-button"),c=(0,u.g2)("el-dialog"),p=(0,u.gN)("loading");return(0,u.uX)(),(0,u.Wv)(c,{"model-value":e.visible,title:"è¡¨å–®å›žæ‡‰",width:"70%","onUpdate:modelValue":o[2]||(o[2]=e=>a.$emit("update:visible",e))},{footer:(0,u.k6)((()=>[(0,u.bF)(d,{onClick:o[0]||(o[0]=e=>r("excel"))},{default:(0,u.k6)((()=>o[4]||(o[4]=[(0,u.eW)("åŒ¯å‡º Excel")]))),_:1}),(0,u.bF)(d,{onClick:o[1]||(o[1]=e=>a.$emit("update:visible",!1))},{default:(0,u.k6)((()=>o[5]||(o[5]=[(0,u.eW)("é—œé–‰")]))),_:1})])),default:(0,u.k6)((()=>[e.templateData?((0,u.uX)(),(0,u.CE)("div",fw,[(0,u.Lk)("h3",null,(0,L.v_)(e.templateData.title),1),(0,u.Lk)("p",null,(0,L.v_)(e.templateData.description),1),(0,u.bo)(((0,u.uX)(),(0,u.Wv)(i,{data:t.value},{default:(0,u.k6)((()=>[(0,u.bF)(s,{prop:"submittedAt",label:"æäº¤æ™‚é–“",width:"180"},{default:(0,u.k6)((({row:e})=>[(0,u.eW)((0,L.v_)(n(e.submittedAt)),1)])),_:1}),(0,u.bF)(s,{label:"å›žæ‡‰å…§å®¹"},{default:(0,u.k6)((({row:e})=>[(0,u.Lk)("pre",null,(0,L.v_)(JSON.stringify(e.data,null,2)),1)])),_:1})])),_:1},8,["data"])),[[p,l.value]])])):((0,u.uX)(),(0,u.CE)("div",yw,o[3]||(o[3]=[(0,u.Lk)("p",null,"æ²’æœ‰å¯ç”¨çš„ç¯„æœ¬è³‡æ–™ã€‚",-1)])))])),_:1},8,["model-value"])}}};const kw=(0,ie.A)(hw,[["__scopeId","data-v-06e768f5"]]);var _w=kw;const ww={class:"form-analytics-dialog"},Fw={key:0,class:"loading-container"},Cw={key:1,class:"analytics-content"},Dw={class:"stats-overview"},Lw={class:"development-notice"},Rw={class:"form-info"},Vw={class:"dialog-footer"};var Iw={__name:"FormAnalyticsDialog",props:{visible:{type:Boolean,default:!1},templateData:{type:Object,default:null}},emits:["update:visible","view-responses"],setup(e,{emit:a}){const l=e,t=a,o=(0,d.KR)(!1),n=(0,d.KR)(!1),r=(0,d.KR)({totalResponses:0,completedResponses:0,averageCompletionTime:0,lastSubmission:null}),s=(0,u.EW)((()=>0===r.value.totalResponses?0:Math.round(r.value.completedResponses/r.value.totalResponses*100))),i=(0,u.EW)((()=>Math.round(r.value.averageCompletionTime/60))),c=(0,u.EW)((()=>r.value.lastSubmission?b(r.value.lastSubmission):"ç„¡")),p=(0,u.EW)((()=>l.templateData?.fields?.filter((e=>e.required))?.length||0)),m=e=>{const a={draft:"info",published:"success",closed:"danger"};return a[e]||""},v=e=>{const a={draft:"è‰ç¨¿",published:"å·²ç™¼å¸ƒ",closed:"å·²é—œé–‰"};return a[e]||e||"æœªçŸ¥"},b=e=>e?new Date(e).toLocaleString("zh-TW"):"ç„¡",g=()=>{o.value=!1,t("update:visible",!1)},y=()=>{t("view-responses",l.templateData),g()},f=async()=>{if(l.templateData?.id){n.value=!0;try{await new Promise((e=>setTimeout(e,1e3))),r.value={totalResponses:Math.floor(100*Math.random()),completedResponses:Math.floor(80*Math.random()),averageCompletionTime:Math.floor(600*Math.random())+120,lastSubmission:new Date(Date.now()-7*Math.random()*24*60*60*1e3)}}catch(e){console.error("è¼‰å…¥çµ±è¨ˆè³‡æ–™å¤±æ•—:",e),D.nk.error("è¼‰å…¥çµ±è¨ˆè³‡æ–™å¤±æ•—")}finally{n.value=!1}}};return(0,u.wB)((()=>l.visible),(e=>{o.value=e,e&&f()})),(0,u.wB)(o,(e=>{e||t("update:visible",!1)})),(a,l)=>{const t=(0,u.g2)("el-skeleton"),d=(0,u.g2)("el-statistic"),f=(0,u.g2)("el-card"),h=(0,u.g2)("el-col"),k=(0,u.g2)("el-row"),_=(0,u.g2)("el-alert"),w=(0,u.g2)("el-descriptions-item"),F=(0,u.g2)("el-tag"),C=(0,u.g2)("el-descriptions"),D=(0,u.g2)("el-button"),R=(0,u.g2)("el-dialog");return(0,u.uX)(),(0,u.Wv)(R,{modelValue:o.value,"onUpdate:modelValue":l[0]||(l[0]=e=>o.value=e),title:"è¡¨å–®çµ±è¨ˆåˆ†æž",width:"90%","close-on-click-modal":!1,onClose:g},{footer:(0,u.k6)((()=>[(0,u.Lk)("div",Vw,[(0,u.bF)(D,{onClick:g},{default:(0,u.k6)((()=>l[6]||(l[6]=[(0,u.eW)("é—œé–‰")]))),_:1}),(0,u.bF)(D,{type:"primary",onClick:y},{default:(0,u.k6)((()=>l[7]||(l[7]=[(0,u.eW)("æŸ¥çœ‹å›žæ‡‰")]))),_:1})])])),default:(0,u.k6)((()=>[(0,u.Lk)("div",ww,[n.value?((0,u.uX)(),(0,u.CE)("div",Fw,[(0,u.bF)(t,{rows:8,animated:""})])):((0,u.uX)(),(0,u.CE)("div",Cw,[(0,u.Lk)("div",Dw,[(0,u.bF)(k,{gutter:20},{default:(0,u.k6)((()=>[(0,u.bF)(h,{span:6},{default:(0,u.k6)((()=>[(0,u.bF)(f,{class:"stat-card"},{default:(0,u.k6)((()=>[(0,u.bF)(d,{title:"ç¸½å›žæ‡‰æ•¸",value:r.value.totalResponses||0,class:"stat-item"},{suffix:(0,u.k6)((()=>l[1]||(l[1]=[(0,u.Lk)("i",{class:"pi pi-file",style:{color:"#409eff"}},null,-1)]))),_:1},8,["value"])])),_:1})])),_:1}),(0,u.bF)(h,{span:6},{default:(0,u.k6)((()=>[(0,u.bF)(f,{class:"stat-card"},{default:(0,u.k6)((()=>[(0,u.bF)(d,{title:"å®ŒæˆçŽ‡",value:s.value,suffix:"%",class:"stat-item"},{suffix:(0,u.k6)((()=>l[2]||(l[2]=[(0,u.Lk)("span",null,"%",-1),(0,u.Lk)("i",{class:"pi pi-check-circle",style:{color:"#67c23a"}},null,-1)]))),_:1},8,["value"])])),_:1})])),_:1}),(0,u.bF)(h,{span:6},{default:(0,u.k6)((()=>[(0,u.bF)(f,{class:"stat-card"},{default:(0,u.k6)((()=>[(0,u.bF)(d,{title:"å¹³å‡å¡«å¯«æ™‚é–“",value:i.value,suffix:"åˆ†é˜",class:"stat-item"},{suffix:(0,u.k6)((()=>l[3]||(l[3]=[(0,u.Lk)("span",null,"åˆ†é˜",-1),(0,u.Lk)("i",{class:"pi pi-clock",style:{color:"#e6a23c"}},null,-1)]))),_:1},8,["value"])])),_:1})])),_:1}),(0,u.bF)(h,{span:6},{default:(0,u.k6)((()=>[(0,u.bF)(f,{class:"stat-card"},{default:(0,u.k6)((()=>[(0,u.bF)(d,{title:"æœ€å¾Œæäº¤",value:c.value,class:"stat-item"},{suffix:(0,u.k6)((()=>l[4]||(l[4]=[(0,u.Lk)("i",{class:"pi pi-calendar",style:{color:"#909399"}},null,-1)]))),_:1},8,["value"])])),_:1})])),_:1})])),_:1})]),(0,u.Lk)("div",Lw,[(0,u.bF)(_,{title:"çµ±è¨ˆåŠŸèƒ½é–‹ç™¼ä¸­",type:"info",description:"è©³ç´°çš„çµ±è¨ˆåˆ†æžåŠŸèƒ½æ­£åœ¨é–‹ç™¼ä¸­ï¼Œç›®å‰é¡¯ç¤ºçš„æ˜¯æ¨¡æ“¬è³‡æ–™ã€‚","show-icon":"",closable:!1})]),(0,u.Lk)("div",Rw,[(0,u.bF)(f,null,{header:(0,u.k6)((()=>l[5]||(l[5]=[(0,u.Lk)("span",null,"è¡¨å–®åŸºæœ¬è³‡è¨Š",-1)]))),default:(0,u.k6)((()=>[(0,u.bF)(C,{column:2,border:""},{default:(0,u.k6)((()=>[(0,u.bF)(w,{label:"è¡¨å–®åç¨±"},{default:(0,u.k6)((()=>[(0,u.eW)((0,L.v_)(e.templateData?.title||"æœªçŸ¥"),1)])),_:1}),(0,u.bF)(w,{label:"è¡¨å–®ç‹€æ…‹"},{default:(0,u.k6)((()=>[(0,u.bF)(F,{type:m(e.templateData?.status)},{default:(0,u.k6)((()=>[(0,u.eW)((0,L.v_)(v(e.templateData?.status)),1)])),_:1},8,["type"])])),_:1}),(0,u.bF)(w,{label:"å»ºç«‹æ™‚é–“"},{default:(0,u.k6)((()=>[(0,u.eW)((0,L.v_)(b(e.templateData?.createdAt)),1)])),_:1}),(0,u.bF)(w,{label:"æœ€å¾Œæ›´æ–°"},{default:(0,u.k6)((()=>[(0,u.eW)((0,L.v_)(b(e.templateData?.updatedAt)),1)])),_:1}),(0,u.bF)(w,{label:"æ¬„ä½æ•¸é‡"},{default:(0,u.k6)((()=>[(0,u.eW)((0,L.v_)(e.templateData?.fields?.length||0),1)])),_:1}),(0,u.bF)(w,{label:"å¿…å¡«æ¬„ä½"},{default:(0,u.k6)((()=>[(0,u.eW)((0,L.v_)(p.value),1)])),_:1})])),_:1})])),_:1})])]))])])),_:1},8,["modelValue"])}}};const xw=(0,ie.A)(Iw,[["__scopeId","data-v-3b8adaaa"]]);var Ew=xw;const Aw={class:"form-template-management"},Tw={class:"action-bar"},Ww={class:"filter-bar"},Sw={class:"template-list"},Uw={class:"template-title"},$w={class:"template-description"},Nw={class:"pagination-wrapper"};var Xw={__name:"FormTemplateManagement",setup(e){const a=(0,C.rd)(),l=(0,d.KR)(!1),t=(0,d.KR)([]),o=(0,d.KR)(""),n=(0,d.KR)(""),r=(0,d.KR)(""),s=(0,d.KR)(1),i=(0,d.KR)(20),c=(0,d.KR)(0),p=(0,d.KR)("createdAt"),m=(0,d.KR)("desc"),v=(0,d.KR)(!1),b=(0,d.KR)(!1),g=(0,d.KR)(!1),y=(0,d.KR)(!1),f=(0,d.KR)(null),h={hr:"äººäº‹è¡¨å–®",finance:"è²¡å‹™è¡¨å–®",purchase:"æŽ¡è³¼è¡¨å–®",other:"å…¶ä»–"},k=e=>h[e]||e||"æœªåˆ†é¡ž",_=e=>{switch(e){case"draft":return"è‰ç¨¿";case"published":return"å·²ç™¼å¸ƒ";case"closed":return"å·²é—œé–‰";default:return"æœªçŸ¥"}},w=e=>{switch(e){case"draft":return"info";case"published":return"success";case"closed":return"danger";default:return""}},F=()=>{a.push({name:"FormDesigner"})},R=async()=>{l.value=!0;try{const e={page:s.value,pageSize:i.value,category:n.value||void 0,status:r.value||void 0},a=await F_.A.getFormTemplates(e);console.log("API å›žæ‡‰:",a.data),Array.isArray(a.data)?(t.value=a.data,c.value=a.data.length):a.data.items?(t.value=a.data.items,c.value=a.data.totalCount||a.data.items.length):(console.warn("æœªé æœŸçš„ API å›žæ‡‰æ ¼å¼:",a.data),t.value=[],c.value=0)}catch(e){console.error("è¼‰å…¥è¡¨å–®ç¯„æœ¬å¤±æ•—:",e),D.nk.error("è¼‰å…¥è¡¨å–®ç¯„æœ¬å¤±æ•—")}finally{l.value=!1}},V=async()=>{if(o.value.trim()){l.value=!0;try{const e=await F_.A.searchFormTemplates(o.value);t.value=e.data,c.value=e.data.length}catch(e){console.error("æœå°‹å¤±æ•—:",e),D.nk.error("æœå°‹å¤±æ•—")}finally{l.value=!1}}else R()},I=()=>{s.value=1,R()},x=({prop:e,order:a})=>{p.value=e,m.value="ascending"===a?"asc":"desc",R()},E=e=>{i.value=e,s.value=1,R()},A=e=>{s.value=e,R()},T=()=>{R()},W=e=>{f.value=e,b.value=!0},S=e=>{a.push(`/home/SystemManagement/FormDesigner/${e.id}`)},U=e=>{f.value=e,g.value=!0},$=e=>{f.value=e,y.value=!0},N=e=>{f.value=e,y.value=!1,g.value=!0},X=async e=>{try{await Sa.s.confirm(`ç¢ºå®šè¦åˆªé™¤è¡¨å–®ç¯„æœ¬ã€Œ${e.title}ã€å—Žï¼Ÿæ­¤æ“ä½œç„¡æ³•å¾©åŽŸã€‚`,"ç¢ºèªåˆªé™¤",{confirmButtonText:"ç¢ºå®š",cancelButtonText:"å–æ¶ˆ",type:"warning"}),await F_.A.deleteFormTemplate(e.id),D.nk.success("åˆªé™¤æˆåŠŸ"),R()}catch(a){"cancel"!==a&&(console.error("åˆªé™¤å¤±æ•—:",a),D.nk.error("åˆªé™¤å¤±æ•—"))}},K=async e=>{try{await F_.A.publishFormTemplate(e.id),D.nk.success("è¡¨å–®å·²ç™¼å¸ƒ"),R()}catch(a){console.error("ç™¼å¸ƒå¤±æ•—:",a),D.nk.error("ç™¼å¸ƒå¤±æ•—")}},M=async e=>{try{await F_.A.closeFormTemplate(e.id),D.nk.success("è¡¨å–®å·²é—œé–‰"),R()}catch(a){console.error("é—œé–‰å¤±æ•—:",a),D.nk.error("é—œé–‰å¤±æ•—")}},P=async e=>{try{await F_.A.copyFormTemplate(e.id),D.nk.success("è¡¨å–®å·²è¤‡è£½"),R()}catch(a){console.error("è¤‡è£½å¤±æ•—:",a),D.nk.error("è¤‡è£½å¤±æ•—")}},O=()=>{v.value=!1,f.value=null,R()},z=e=>new Date(e).toLocaleString("zh-TW");return(0,u.sV)((()=>{R()})),(e,a)=>{const p=(0,u.g2)("el-button"),m=(0,u.g2)("el-input"),h=(0,u.g2)("el-col"),C=(0,u.g2)("el-option"),D=(0,u.g2)("el-select"),R=(0,u.g2)("el-row"),B=(0,u.g2)("el-tag"),j=(0,u.g2)("el-table-column"),Y=(0,u.g2)("el-badge"),Q=(0,u.g2)("el-button-group"),H=(0,u.g2)("el-table"),q=(0,u.g2)("el-pagination"),G=(0,u.gN)("loading");return(0,u.uX)(),(0,u.CE)("div",Aw,[a[22]||(a[22]=(0,u.Lk)("div",{class:"page-header"},[(0,u.Lk)("h2",null,[(0,u.Lk)("i",{class:"pi pi-file-edit"}),(0,u.eW)(" å‹•æ…‹è¡¨å–®ç®¡ç† ")]),(0,u.Lk)("p",{class:"page-description"},"ç®¡ç†å‹•æ…‹è¡¨å–®ç¯„æœ¬ï¼Œå‰µå»ºã€ç·¨è¼¯å’ŒæŸ¥çœ‹è¡¨å–®å›žæ‡‰")],-1)),(0,u.Lk)("div",Tw,[(0,u.bF)(p,{type:"primary",onClick:F,icon:(0,d.R1)(J.Plus)},{default:(0,u.k6)((()=>a[10]||(a[10]=[(0,u.eW)(" è¡¨å–®è¨­è¨ˆå™¨ ")]))),_:1},8,["icon"]),(0,u.bF)(p,{type:"success",onClick:a[0]||(a[0]=e=>v.value=!0),icon:(0,d.R1)(J.Edit)},{default:(0,u.k6)((()=>a[11]||(a[11]=[(0,u.eW)(" å¿«é€Ÿæ–°å¢ž ")]))),_:1},8,["icon"]),(0,u.bF)(p,{onClick:T,icon:(0,d.R1)(J.Refresh)},{default:(0,u.k6)((()=>a[12]||(a[12]=[(0,u.eW)(" é‡æ–°æ•´ç† ")]))),_:1},8,["icon"])]),(0,u.Lk)("div",Ww,[(0,u.bF)(R,{gutter:20},{default:(0,u.k6)((()=>[(0,u.bF)(h,{span:8},{default:(0,u.k6)((()=>[(0,u.bF)(m,{modelValue:o.value,"onUpdate:modelValue":a[1]||(a[1]=e=>o.value=e),placeholder:"æœå°‹è¡¨å–®åç¨±æˆ–æè¿°...","prefix-icon":(0,d.R1)(J.Search),onInput:V,clearable:""},null,8,["modelValue","prefix-icon"])])),_:1}),(0,u.bF)(h,{span:6},{default:(0,u.k6)((()=>[(0,u.bF)(D,{modelValue:n.value,"onUpdate:modelValue":a[2]||(a[2]=e=>n.value=e),placeholder:"é¸æ“‡åˆ†é¡ž",clearable:"",onChange:I},{default:(0,u.k6)((()=>[(0,u.bF)(C,{label:"å…¨éƒ¨åˆ†é¡ž",value:""}),(0,u.bF)(C,{label:"äººäº‹è¡¨å–®",value:"hr"}),(0,u.bF)(C,{label:"è²¡å‹™è¡¨å–®",value:"finance"}),(0,u.bF)(C,{label:"æŽ¡è³¼è¡¨å–®",value:"purchase"}),(0,u.bF)(C,{label:"å…¶ä»–",value:"other"})])),_:1},8,["modelValue"])])),_:1}),(0,u.bF)(h,{span:6},{default:(0,u.k6)((()=>[(0,u.bF)(D,{modelValue:r.value,"onUpdate:modelValue":a[3]||(a[3]=e=>r.value=e),placeholder:"é¸æ“‡ç‹€æ…‹",clearable:"",onChange:I},{default:(0,u.k6)((()=>[(0,u.bF)(C,{label:"å…¨éƒ¨ç‹€æ…‹",value:""}),(0,u.bF)(C,{label:"è‰ç¨¿",value:"draft"}),(0,u.bF)(C,{label:"å·²ç™¼å¸ƒ",value:"published"}),(0,u.bF)(C,{label:"å·²é—œé–‰",value:"closed"})])),_:1},8,["modelValue"])])),_:1})])),_:1})]),(0,u.Lk)("div",Sw,[(0,u.bo)(((0,u.uX)(),(0,u.Wv)(H,{data:t.value,stripe:"",onSortChange:x},{default:(0,u.k6)((()=>[(0,u.bF)(j,{prop:"title",label:"è¡¨å–®åç¨±",sortable:"","min-width":"200"},{default:(0,u.k6)((({row:e})=>[(0,u.Lk)("div",Uw,[(0,u.Lk)("strong",null,(0,L.v_)(e.title),1),(0,u.bF)(B,{type:w(e.status),size:"small",class:"status-tag"},{default:(0,u.k6)((()=>[(0,u.eW)((0,L.v_)(_(e.status)),1)])),_:2},1032,["type"])]),(0,u.Lk)("div",$w,(0,L.v_)(e.description),1)])),_:1}),(0,u.bF)(j,{prop:"category",label:"åˆ†é¡ž",width:"120"},{default:(0,u.k6)((({row:e})=>[(0,u.bF)(B,{size:"small"},{default:(0,u.k6)((()=>[(0,u.eW)((0,L.v_)(k(e.category)),1)])),_:2},1024)])),_:1}),(0,u.bF)(j,{prop:"responseCount",label:"å›žæ‡‰æ•¸é‡",width:"100",align:"center"},{default:(0,u.k6)((({row:e})=>[(0,u.bF)(Y,{value:e.responseCount,class:"response-badge"},{default:(0,u.k6)((()=>a[13]||(a[13]=[(0,u.Lk)("i",{class:"pi pi-file"},null,-1)]))),_:2},1032,["value"])])),_:1}),(0,u.bF)(j,{prop:"createdAt",label:"å»ºç«‹æ™‚é–“",width:"180",sortable:""},{default:(0,u.k6)((({row:e})=>[(0,u.eW)((0,L.v_)(z(e.createdAt)),1)])),_:1}),(0,u.bF)(j,{prop:"updatedAt",label:"æ›´æ–°æ™‚é–“",width:"180",sortable:""},{default:(0,u.k6)((({row:e})=>[(0,u.eW)((0,L.v_)(z(e.updatedAt)),1)])),_:1}),(0,u.bF)(j,{label:"æ“ä½œ",width:"320",fixed:"right"},{default:(0,u.k6)((({row:e})=>[(0,u.bF)(Q,null,{default:(0,u.k6)((()=>[(0,u.bF)(p,{size:"small",onClick:a=>W(e),icon:(0,d.R1)(J.View)},{default:(0,u.k6)((()=>a[14]||(a[14]=[(0,u.eW)(" æª¢è¦– ")]))),_:2},1032,["onClick","icon"]),(0,u.bF)(p,{size:"small",type:"primary",onClick:a=>S(e),icon:(0,d.R1)(J.Edit)},{default:(0,u.k6)((()=>a[15]||(a[15]=[(0,u.eW)(" ç·¨è¼¯ ")]))),_:2},1032,["onClick","icon"]),(0,u.bF)(p,{size:"small",type:"info",onClick:a=>U(e),icon:(0,d.R1)(J.Document)},{default:(0,u.k6)((()=>a[16]||(a[16]=[(0,u.eW)(" å›žæ‡‰ ")]))),_:2},1032,["onClick","icon"]),(0,u.bF)(p,{size:"small",type:"primary",onClick:a=>$(e)},{default:(0,u.k6)((()=>a[17]||(a[17]=[(0,u.eW)(" çµ±è¨ˆ ")]))),_:2},1032,["onClick"]),"draft"===e.status?((0,u.uX)(),(0,u.Wv)(p,{key:0,size:"small",type:"success",onClick:a=>K(e)},{default:(0,u.k6)((()=>a[18]||(a[18]=[(0,u.eW)(" ç™¼å¸ƒ ")]))),_:2},1032,["onClick"])):(0,u.Q3)("",!0),"published"===e.status?((0,u.uX)(),(0,u.Wv)(p,{key:1,size:"small",type:"warning",onClick:a=>M(e)},{default:(0,u.k6)((()=>a[19]||(a[19]=[(0,u.eW)(" é—œé–‰ ")]))),_:2},1032,["onClick"])):(0,u.Q3)("",!0),(0,u.bF)(p,{size:"small",onClick:a=>P(e)},{default:(0,u.k6)((()=>a[20]||(a[20]=[(0,u.eW)(" è¤‡è£½ ")]))),_:2},1032,["onClick"]),(0,u.bF)(p,{size:"small",type:"danger",onClick:a=>X(e),icon:(0,d.R1)(J.Delete)},{default:(0,u.k6)((()=>a[21]||(a[21]=[(0,u.eW)(" åˆªé™¤ ")]))),_:2},1032,["onClick","icon"])])),_:2},1024)])),_:1})])),_:1},8,["data"])),[[G,l.value]]),(0,u.Lk)("div",Nw,[(0,u.bF)(q,{"current-page":s.value,"onUpdate:currentPage":a[4]||(a[4]=e=>s.value=e),"page-size":i.value,"onUpdate:pageSize":a[5]||(a[5]=e=>i.value=e),"page-sizes":[10,20,50,100],total:c.value,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:E,onCurrentChange:A},null,8,["current-page","page-size","total"])])]),(0,u.bF)(N_,{visible:v.value,"onUpdate:visible":a[6]||(a[6]=e=>v.value=e),"template-data":f.value,onSaved:O},null,8,["visible","template-data"]),(0,u.bF)(gw,{visible:b.value,"onUpdate:visible":a[7]||(a[7]=e=>b.value=e),"template-data":f.value},null,8,["visible","template-data"]),(0,u.bF)(_w,{visible:g.value,"onUpdate:visible":a[8]||(a[8]=e=>g.value=e),"template-data":f.value},null,8,["visible","template-data"]),(0,u.bF)(Ew,{visible:y.value,"onUpdate:visible":a[9]||(a[9]=e=>y.value=e),"template-data":f.value,onViewResponses:N},null,8,["visible","template-data"])])}}};const Kw=(0,ie.A)(Xw,[["__scopeId","data-v-fd7db358"]]);var Mw=Kw;const Pw={class:"form-builder"},Ow={class:"toolbar"},zw={class:"toolbar-left"},Bw={key:0,class:"template-info"},jw={class:"template-title"},Yw={class:"toolbar-right"},Qw={class:"builder-container"},Hw={class:"components-panel"},qw={class:"component-groups"},Jw={class:"component-group"},Gw={class:"component-list"},Zw=["onDragstart"],eF={class:"component-group"},aF={class:"component-list"},lF=["onDragstart"],tF={class:"design-area"},oF={key:0,class:"empty-state"},nF=["onClick"],rF={class:"field-actions"},sF={class:"properties-panel"},uF={key:0,class:"no-selection"},iF={key:1,class:"field-properties"},dF={class:"options-editor"},cF={class:"template-management"},pF={class:"template-list"},mF={class:"list-header"},vF={key:0,class:"save-template-form"},bF={class:"form-actions"},gF={class:"dialog-footer"};var yF={__name:"FormBuilder",props:{modelValue:{type:Array,default:()=>[]}},emits:["update:modelValue","save"],setup(e,{emit:a}){const l=e,o=a,n=(0,d.KR)([...l.modelValue]),r=(0,d.KR)(null),s=(0,d.KR)(!1),i=(0,d.KR)(!1),c=(0,d.KR)(!1),p=(0,d.KR)(null),m=(0,d.KR)(!1),v=(0,d.KR)(!1),b=(0,d.KR)([]),g=(0,d.KR)(null),y=(0,d.KR)(!1),f=(0,d.KR)(!1),h=(0,d.KR)({title:"",description:"",category:"general",tags:""}),k=[{type:"text",label:"å–®è¡Œæ–‡å­—",icon:"pi pi-minus"},{type:"textarea",label:"å¤šè¡Œæ–‡å­—",icon:"pi pi-align-left"},{type:"number",label:"æ•¸å­—",icon:"pi pi-hashtag"},{type:"email",label:"é›»å­éƒµä»¶",icon:"pi pi-envelope"},{type:"date",label:"æ—¥æœŸ",icon:"pi pi-calendar"},{type:"file",label:"æª”æ¡ˆä¸Šå‚³",icon:"pi pi-upload"}],_=[{type:"select",label:"ä¸‹æ‹‰é¸å–®",icon:"pi pi-chevron-down"},{type:"radio",label:"å–®é¸æŒ‰éˆ•",icon:"pi pi-circle"},{type:"checkbox",label:"è¤‡é¸æ¡†",icon:"pi pi-check-square"}],w=(0,u.EW)((()=>n.value.find((e=>e.id===r.value)))),F=(0,u.EW)((()=>JSON.stringify(n.value,null,2))),C=()=>"field_"+Date.now()+"_"+Math.random().toString(36).substr(2,9),R=e=>{const a={id:C(),type:e.type,label:e.label,placeholder:"",helpText:"",defaultValue:"",required:!1,width:"100%",order:n.value.length};switch(e.type){case"select":case"radio":case"checkbox":a.options=[{label:"é¸é …1",value:"option1"},{label:"é¸é …2",value:"option2"}];break;case"number":a.min=null,a.max=null,a.step=1;break;case"text":case"textarea":a.minLength=null,a.maxLength=null;break}return a},V=(e,a)=>{e.dataTransfer.effectAllowed="copy",e.dataTransfer.setData("application/json",JSON.stringify(a)),e.dataTransfer.setData("text/plain",JSON.stringify(a)),e.dataTransfer.setData("text/component-type",a.type)},I=async e=>{e.preventDefault();try{let a=null;const l=e.dataTransfer.getData("application/json");if(l)a=JSON.parse(l);else{const l=e.dataTransfer.getData("text/plain");l&&(a=JSON.parse(l))}if(!a)return void D.nk.error("ç„¡æ³•ç²å–çµ„ä»¶æ•¸æ“š");const t=R(a);n.value=[...n.value,t],(0,d.mu)(n),await(0,u.dY)(),W(t.id),j(),D.nk.success(`å·²æ·»åŠ  ${t.label} æ¬„ä½`)}catch(a){console.error("æ‹–æ‹‰æ·»åŠ æ¬„ä½å¤±æ•—:",a),D.nk.error("æ·»åŠ æ¬„ä½å¤±æ•—: "+a.message)}},x=e=>{e.preventDefault(),e.dataTransfer.dropEffect="copy"},E=e=>{e.preventDefault(),e.currentTarget.classList.add("drag-over")},A=e=>{e.currentTarget.classList.remove("drag-over")},T=()=>{n.value.forEach(((e,a)=>{e.order=a})),j(),D.nk.success("æ¬„ä½é †åºå·²æ›´æ–°")},W=e=>{r.value=e},S=(e,a)=>{const l=n.value.findIndex((a=>a.id===e));-1!==l&&(n.value[l]={...n.value[l],...a},j())},U=()=>{j()},$=e=>{p.value={...e},c.value=!0},N=e=>{S(e.id,e),c.value=!1},X=e=>{const a={...e,id:C(),label:e.label+" (è¤‡è£½)",order:n.value.length};n.value.push(a),j()},K=async e=>{try{await Sa.s.confirm("ç¢ºå®šè¦åˆªé™¤æ­¤æ¬„ä½å—Žï¼Ÿ","ç¢ºèªåˆªé™¤",{type:"warning"});const a=n.value[e];n.value.splice(e,1),r.value===a.id&&(r.value=null),j(),D.nk.success("æ¬„ä½å·²åˆªé™¤")}catch{}},M=()=>{w.value&&w.value.options&&(w.value.options.push({label:`é¸é …${w.value.options.length+1}`,value:`option${w.value.options.length+1}`}),U())},P=e=>{w.value&&w.value.options&&(w.value.options.splice(e,1),U())},O=async()=>{try{await Sa.s.confirm("ç¢ºå®šè¦æ¸…ç©ºæ‰€æœ‰æ¬„ä½å—Žï¼Ÿ","ç¢ºèªæ¸…ç©º",{type:"warning"}),n.value=[],r.value=null,j(),D.nk.success("å·²æ¸…ç©ºæ‰€æœ‰æ¬„ä½")}catch{}},z=async()=>{0!==n.value.length?g.value?await q():(m.value=!0,v.value=!0):D.nk.warning("è«‹è‡³å°‘æ·»åŠ ä¸€å€‹æ¬„ä½")},B=async()=>{try{await navigator.clipboard.writeText(F.value),D.nk.success("JSON å·²è¤‡è£½åˆ°å‰ªè²¼æ¿")}catch{D.nk.error("è¤‡è£½å¤±æ•—")}},j=()=>{o("update:modelValue",n.value)},Y=async()=>{y.value=!0;try{console.log("æ­£åœ¨è¼‰å…¥ç¯„æœ¬åˆ—è¡¨...");const e=await F_.A.getFormTemplates();console.log("ç¯„æœ¬åˆ—è¡¨éŸ¿æ‡‰:",e),b.value=e.data.items||e.data}catch(e){console.error("è¼‰å…¥ç¯„æœ¬å¤±æ•—:",e),console.error("éŒ¯èª¤è©³æƒ…:",e.response),D.nk.error(`è¼‰å…¥ç¯„æœ¬å¤±æ•—: ${e.response?.status} ${e.response?.statusText}`)}finally{y.value=!1}},Q=async e=>{try{const a=await F_.A.getFormTemplate(e.id),l=a.data,t=l.fields.map((e=>({id:e.id,type:e.type,label:e.label,placeholder:e.placeholder||"",helpText:e.helpText||"",defaultValue:e.defaultValue||"",required:e.required||!1,width:e.width||"100%",order:e.order||0,...e.options&&{options:e.options},...e.validation&&{minLength:e.validation.minLength,maxLength:e.validation.maxLength,min:e.validation.min,max:e.validation.max,step:e.validation.step||1}})));n.value=t,g.value=l,m.value=!1,(0,d.mu)(n),await(0,u.dY)(),D.nk.success(`å·²è¼‰å…¥ç¯„æœ¬ï¼š${l.title}`)}catch(a){console.error("è¼‰å…¥ç¯„æœ¬å¤±æ•—:",a),D.nk.error("è¼‰å…¥ç¯„æœ¬å¤±æ•—")}},H=async()=>{if(h.value.title.trim()){f.value=!0;try{const e={title:h.value.title,description:h.value.description,category:h.value.category,tags:h.value.tags.split(",").map((e=>e.trim())).filter((e=>e)),fields:n.value.map((e=>({id:e.id,type:e.type,label:e.label,placeholder:e.placeholder,helpText:e.helpText,defaultValue:e.defaultValue,required:e.required,width:e.width,order:e.order,...e.options&&{options:e.options},...void 0!==e.minLength&&{validation:{minLength:e.minLength,maxLength:e.maxLength,min:e.min,max:e.max,step:e.step}}}))),settings:{allowMultipleSubmissions:!1,requireLogin:!0,showProgressBar:!0,submitButtonText:"æäº¤",successMessage:"æäº¤æˆåŠŸï¼"}},a=await F_.A.createFormTemplate(e);g.value=a.data,h.value={title:"",description:"",category:"general",tags:""},v.value=!1,m.value=!1,await Y(),D.nk.success("ç¯„æœ¬ä¿å­˜æˆåŠŸ"),o("save",n.value)}catch(e){console.error("ä¿å­˜ç¯„æœ¬å¤±æ•—:",e),D.nk.error("ä¿å­˜ç¯„æœ¬å¤±æ•—")}finally{f.value=!1}}else D.nk.warning("è«‹è¼¸å…¥ç¯„æœ¬åç¨±")},q=async()=>{if(g.value){f.value=!0;try{const e={title:g.value.title,description:g.value.description,category:g.value.category,tags:g.value.tags,status:g.value.status,fields:n.value.map((e=>({id:e.id,type:e.type,label:e.label,placeholder:e.placeholder,helpText:e.helpText,defaultValue:e.defaultValue,required:e.required,width:e.width,order:e.order,...e.options&&{options:e.options},...void 0!==e.minLength&&{validation:{minLength:e.minLength,maxLength:e.maxLength,min:e.min,max:e.max,step:e.step}}}))),settings:g.value.settings},a=await F_.A.updateFormTemplate(g.value.id,e);g.value=a.data,D.nk.success("ç¯„æœ¬æ›´æ–°æˆåŠŸ"),o("save",n.value)}catch(e){console.error("æ›´æ–°ç¯„æœ¬å¤±æ•—:",e),D.nk.error("æ›´æ–°ç¯„æœ¬å¤±æ•—")}finally{f.value=!1}}},G=async e=>{try{const a=await F_.A.copyFormTemplate(e.id);console.log(a.data),await Y(),D.nk.success(`ç¯„æœ¬ "${e.title}" è¤‡è£½æˆåŠŸ`)}catch(a){console.error("è¤‡è£½ç¯„æœ¬å¤±æ•—:",a),D.nk.error("è¤‡è£½ç¯„æœ¬å¤±æ•—")}},Z=async e=>{try{await Sa.s.confirm(`ç¢ºå®šè¦åˆªé™¤ç¯„æœ¬ "${e.title}" å—Žï¼Ÿæ­¤æ“ä½œç„¡æ³•æ’¤éŠ·ã€‚`,"ç¢ºèªåˆªé™¤",{type:"warning",confirmButtonText:"åˆªé™¤",cancelButtonText:"å–æ¶ˆ"}),await F_.A.deleteFormTemplate(e.id),await Y(),g.value&&g.value.id===e.id&&(g.value=null),D.nk.success("ç¯„æœ¬åˆªé™¤æˆåŠŸ")}catch(a){"cancel"!==a&&(console.error("åˆªé™¤ç¯„æœ¬å¤±æ•—:",a),D.nk.error("åˆªé™¤ç¯„æœ¬å¤±æ•—"))}},ee=()=>{if(0===n.value.length)return void D.nk.warning("æ²’æœ‰å¯åŒ¯å‡ºçš„å…§å®¹");const e={title:g.value?.title||"æœªå‘½åè¡¨å–®",description:g.value?.description||"",fields:n.value,exportTime:(new Date).toISOString()},a=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),l=URL.createObjectURL(a),t=document.createElement("a");t.href=l,t.download=`${e.title}.json`,document.body.appendChild(t),t.click(),document.body.removeChild(t),URL.revokeObjectURL(l),D.nk.success("ç¯„æœ¬åŒ¯å‡ºæˆåŠŸ")},ae=()=>{v.value=!1,h.value={title:"",description:"",category:"general",tags:""}},le=e=>{switch(e){case"published":return"success";case"draft":return"info";case"closed":return"danger";default:return"info"}},te=e=>{switch(e){case"published":return"å·²ç™¼å¸ƒ";case"draft":return"è‰ç¨¿";case"closed":return"å·²é—œé–‰";default:return"æœªçŸ¥"}},oe=e=>new Date(e).toLocaleString("zh-TW");return(0,u.sV)((()=>{Y()})),(0,u.wB)((()=>l.modelValue),(e=>{n.value=[...e]}),{deep:!0}),(e,a)=>{const l=(0,u.g2)("el-tag"),o=(0,u.g2)("el-button"),C=(0,u.g2)("el-button-group"),D=(0,u.g2)("el-input"),R=(0,u.g2)("el-form-item"),j=(0,u.g2)("el-divider"),q=(0,u.g2)("el-option"),ne=(0,u.g2)("el-select"),re=(0,u.g2)("el-checkbox"),se=(0,u.g2)("el-input-number"),ue=(0,u.g2)("el-form"),ie=(0,u.g2)("el-dialog"),de=(0,u.g2)("el-table-column"),ce=(0,u.g2)("el-table"),pe=(0,u.gN)("loading");return(0,u.uX)(),(0,u.CE)("div",Pw,[(0,u.Lk)("div",Ow,[(0,u.Lk)("div",zw,[a[29]||(a[29]=(0,u.Lk)("h3",null,"è¡¨å–®è¨­è¨ˆå™¨",-1)),g.value?((0,u.uX)(),(0,u.CE)("div",Bw,[(0,u.Lk)("span",jw,(0,L.v_)(g.value.title),1),(0,u.bF)(l,{type:le(g.value.status),size:"small"},{default:(0,u.k6)((()=>[(0,u.eW)((0,L.v_)(te(g.value.status)),1)])),_:1},8,["type"])])):(0,u.Q3)("",!0),(0,u.bF)(C,null,{default:(0,u.k6)((()=>[(0,u.bF)(o,{onClick:a[0]||(a[0]=e=>s.value=!s.value),type:s.value?"primary":"default"},{default:(0,u.k6)((()=>[a[27]||(a[27]=(0,u.Lk)("i",{class:"pi pi-eye"},null,-1)),(0,u.eW)(" "+(0,L.v_)(s.value?"ç·¨è¼¯æ¨¡å¼":"é è¦½æ¨¡å¼"),1)])),_:1},8,["type"]),(0,u.bF)(o,{onClick:O,icon:(0,d.R1)(J.Delete)},{default:(0,u.k6)((()=>a[28]||(a[28]=[(0,u.eW)("æ¸…ç©º")]))),_:1},8,["icon"]),(0,u.bF)(o,{onClick:z,type:"primary",icon:(0,d.R1)(J.Check),loading:f.value},{default:(0,u.k6)((()=>[(0,u.eW)((0,L.v_)(g.value?"æ›´æ–°ç¯„æœ¬":"ä¿å­˜ç¯„æœ¬"),1)])),_:1},8,["icon","loading"])])),_:1})]),(0,u.Lk)("div",Yw,[(0,u.bF)(C,null,{default:(0,u.k6)((()=>[(0,u.bF)(o,{onClick:a[1]||(a[1]=e=>m.value=!0),icon:(0,d.R1)(J.Upload)},{default:(0,u.k6)((()=>a[30]||(a[30]=[(0,u.eW)("è¼‰å…¥ç¯„æœ¬")]))),_:1},8,["icon"]),(0,u.bF)(o,{onClick:a[2]||(a[2]=e=>i.value=!0),icon:(0,d.R1)(J.Document)},{default:(0,u.k6)((()=>a[31]||(a[31]=[(0,u.eW)("æŸ¥çœ‹JSON")]))),_:1},8,["icon"]),n.value.length>0?((0,u.uX)(),(0,u.Wv)(o,{key:0,onClick:ee,icon:(0,d.R1)(J.Download)},{default:(0,u.k6)((()=>a[32]||(a[32]=[(0,u.eW)("åŒ¯å‡º")]))),_:1},8,["icon"])):(0,u.Q3)("",!0)])),_:1})])]),(0,u.Lk)("div",Qw,[(0,u.Lk)("div",Hw,[a[35]||(a[35]=(0,u.Lk)("h4",null,"æ‹–æ‹‰çµ„ä»¶",-1)),(0,u.Lk)("div",qw,[(0,u.Lk)("div",Jw,[a[33]||(a[33]=(0,u.Lk)("h5",null,"åŸºæœ¬çµ„ä»¶",-1)),(0,u.Lk)("div",Gw,[((0,u.uX)(),(0,u.CE)(u.FK,null,(0,u.pI)(k,(e=>(0,u.Lk)("div",{key:e.type,class:"component-item",draggable:"true",onDragstart:a=>V(a,e)},[(0,u.Lk)("i",{class:(0,L.C4)(e.icon)},null,2),(0,u.Lk)("span",null,(0,L.v_)(e.label),1)],40,Zw))),64))])]),(0,u.Lk)("div",eF,[a[34]||(a[34]=(0,u.Lk)("h5",null,"é¸æ“‡çµ„ä»¶",-1)),(0,u.Lk)("div",aF,[((0,u.uX)(),(0,u.CE)(u.FK,null,(0,u.pI)(_,(e=>(0,u.Lk)("div",{key:e.type,class:"component-item",draggable:"true",onDragstart:a=>V(a,e)},[(0,u.Lk)("i",{class:(0,L.C4)(e.icon)},null,2),(0,u.Lk)("span",null,(0,L.v_)(e.label),1)],40,lF))),64))])])])]),(0,u.Lk)("div",tF,[(0,u.Lk)("div",{class:"form-canvas",onDrop:I,onDragover:x,onDragenter:E,onDragleave:A},[0===n.value.length?((0,u.uX)(),(0,u.CE)("div",oF,a[36]||(a[36]=[(0,u.Lk)("i",{class:"pi pi-plus-circle"},null,-1),(0,u.Lk)("p",null,"æ‹–æ‹‰å·¦å´çµ„ä»¶åˆ°æ­¤è™•é–‹å§‹è¨­è¨ˆè¡¨å–®",-1)]))):(0,u.Q3)("",!0),n.value.length>0?((0,u.uX)(),(0,u.Wv)((0,d.R1)(Ld.MA),{key:1,modelValue:n.value,"onUpdate:modelValue":a[3]||(a[3]=e=>n.value=e),group:"formFields","item-key":"id",class:"field-list",animation:200,"ghost-class":"ghost","chosen-class":"chosen",onEnd:T},{default:(0,u.k6)((()=>[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(n.value,((e,a)=>((0,u.uX)(),(0,u.CE)("div",{key:e.id,class:(0,L.C4)(["field-wrapper",{selected:r.value===e.id}]),onClick:a=>W(e.id)},[(0,u.Lk)("div",rF,[(0,u.bF)(C,null,{default:(0,u.k6)((()=>[(0,u.bF)(o,{onClick:(0,t.D$)((a=>$(e)),["stop"]),icon:(0,d.R1)(J.Edit),size:"default"},null,8,["onClick","icon"]),(0,u.bF)(o,{onClick:(0,t.D$)((a=>X(e)),["stop"]),icon:(0,d.R1)(J.CopyDocument),size:"default"},null,8,["onClick","icon"]),(0,u.bF)(o,{onClick:(0,t.D$)((e=>K(a)),["stop"]),icon:(0,d.R1)(J.Delete),size:"default",type:"danger",class:"delete-button"},null,8,["onClick","icon"])])),_:2},1024)]),(0,u.bF)(m_,{field:e,"preview-mode":s.value,"onUpdate:field":S},null,8,["field","preview-mode"])],10,nF)))),128))])),_:1},8,["modelValue"])):(0,u.Q3)("",!0)],32)]),(0,u.Lk)("div",sF,[a[45]||(a[45]=(0,u.Lk)("h4",null,"å±¬æ€§è¨­å®š",-1)),w.value?((0,u.uX)(),(0,u.CE)("div",iF,[(0,u.bF)(ue,{model:w.value,"label-width":"80px",size:"small"},{default:(0,u.k6)((()=>[(0,u.bF)(R,{label:"æ¨™ç±¤"},{default:(0,u.k6)((()=>[(0,u.bF)(D,{modelValue:w.value.label,"onUpdate:modelValue":a[4]||(a[4]=e=>w.value.label=e),onInput:U},null,8,["modelValue"])])),_:1}),(0,u.bF)(R,{label:"ä½”ä½ç¬¦"},{default:(0,u.k6)((()=>[(0,u.bF)(D,{modelValue:w.value.placeholder,"onUpdate:modelValue":a[5]||(a[5]=e=>w.value.placeholder=e),onInput:U},null,8,["modelValue"])])),_:1}),(0,u.bF)(R,{label:"å¹«åŠ©æ–‡å­—"},{default:(0,u.k6)((()=>[(0,u.bF)(D,{modelValue:w.value.helpText,"onUpdate:modelValue":a[6]||(a[6]=e=>w.value.helpText=e),onInput:U},null,8,["modelValue"])])),_:1}),(0,u.bF)(R,{label:"é è¨­å€¼"},{default:(0,u.k6)((()=>[(0,u.bF)(D,{modelValue:w.value.defaultValue,"onUpdate:modelValue":a[7]||(a[7]=e=>w.value.defaultValue=e),onInput:U},null,8,["modelValue"])])),_:1}),(0,u.bF)(j,null,{default:(0,u.k6)((()=>a[38]||(a[38]=[(0,u.eW)("å¸ƒå±€è¨­å®š")]))),_:1}),(0,u.bF)(R,{label:"å¯¬åº¦"},{default:(0,u.k6)((()=>[(0,u.bF)(ne,{modelValue:w.value.width,"onUpdate:modelValue":a[8]||(a[8]=e=>w.value.width=e),onChange:U},{default:(0,u.k6)((()=>[(0,u.bF)(q,{label:"25%",value:"25%"}),(0,u.bF)(q,{label:"50%",value:"50%"}),(0,u.bF)(q,{label:"75%",value:"75%"}),(0,u.bF)(q,{label:"100%",value:"100%"})])),_:1},8,["modelValue"])])),_:1}),(0,u.bF)(j,null,{default:(0,u.k6)((()=>a[39]||(a[39]=[(0,u.eW)("é©—è­‰è¨­å®š")]))),_:1}),(0,u.bF)(R,null,{default:(0,u.k6)((()=>[(0,u.bF)(re,{modelValue:w.value.required,"onUpdate:modelValue":a[9]||(a[9]=e=>w.value.required=e),onChange:U},{default:(0,u.k6)((()=>a[40]||(a[40]=[(0,u.eW)(" å¿…å¡«æ¬„ä½ ")]))),_:1},8,["modelValue"])])),_:1}),"select"===w.value.type||"radio"===w.value.type||"checkbox"===w.value.type?((0,u.uX)(),(0,u.CE)(u.FK,{key:0},[(0,u.bF)(j,null,{default:(0,u.k6)((()=>a[41]||(a[41]=[(0,u.eW)("é¸é …è¨­å®š")]))),_:1}),(0,u.Lk)("div",dF,[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(w.value.options,((e,a)=>((0,u.uX)(),(0,u.CE)("div",{key:a,class:"option-item"},[(0,u.bF)(D,{modelValue:e.label,"onUpdate:modelValue":a=>e.label=a,placeholder:"é¸é …æ¨™ç±¤",onInput:U},null,8,["modelValue","onUpdate:modelValue"]),(0,u.bF)(D,{modelValue:e.value,"onUpdate:modelValue":a=>e.value=a,placeholder:"é¸é …å€¼",onInput:U},null,8,["modelValue","onUpdate:modelValue"]),(0,u.bF)(o,{onClick:e=>P(a),icon:(0,d.R1)(J.Delete),size:"small",type:"danger"},null,8,["onClick","icon"])])))),128)),(0,u.bF)(o,{onClick:M,icon:(0,d.R1)(J.Plus),size:"small",type:"primary"},{default:(0,u.k6)((()=>a[42]||(a[42]=[(0,u.eW)(" æ–°å¢žé¸é … ")]))),_:1},8,["icon"])])],64)):(0,u.Q3)("",!0),"number"===w.value.type?((0,u.uX)(),(0,u.CE)(u.FK,{key:1},[(0,u.bF)(j,null,{default:(0,u.k6)((()=>a[43]||(a[43]=[(0,u.eW)("æ•¸å€¼è¨­å®š")]))),_:1}),(0,u.bF)(R,{label:"æœ€å°å€¼"},{default:(0,u.k6)((()=>[(0,u.bF)(se,{modelValue:w.value.min,"onUpdate:modelValue":a[10]||(a[10]=e=>w.value.min=e),onChange:U},null,8,["modelValue"])])),_:1}),(0,u.bF)(R,{label:"æœ€å¤§å€¼"},{default:(0,u.k6)((()=>[(0,u.bF)(se,{modelValue:w.value.max,"onUpdate:modelValue":a[11]||(a[11]=e=>w.value.max=e),onChange:U},null,8,["modelValue"])])),_:1}),(0,u.bF)(R,{label:"æ­¥é•·"},{default:(0,u.k6)((()=>[(0,u.bF)(se,{modelValue:w.value.step,"onUpdate:modelValue":a[12]||(a[12]=e=>w.value.step=e),onChange:U},null,8,["modelValue"])])),_:1})],64)):(0,u.Q3)("",!0),"text"===w.value.type||"textarea"===w.value.type?((0,u.uX)(),(0,u.CE)(u.FK,{key:2},[(0,u.bF)(j,null,{default:(0,u.k6)((()=>a[44]||(a[44]=[(0,u.eW)("æ–‡å­—è¨­å®š")]))),_:1}),(0,u.bF)(R,{label:"æœ€å°é•·åº¦"},{default:(0,u.k6)((()=>[(0,u.bF)(se,{modelValue:w.value.minLength,"onUpdate:modelValue":a[13]||(a[13]=e=>w.value.minLength=e),onChange:U},null,8,["modelValue"])])),_:1}),(0,u.bF)(R,{label:"æœ€å¤§é•·åº¦"},{default:(0,u.k6)((()=>[(0,u.bF)(se,{modelValue:w.value.maxLength,"onUpdate:modelValue":a[14]||(a[14]=e=>w.value.maxLength=e),onChange:U},null,8,["modelValue"])])),_:1})],64)):(0,u.Q3)("",!0)])),_:1},8,["model"])])):((0,u.uX)(),(0,u.CE)("div",uF,a[37]||(a[37]=[(0,u.Lk)("i",{class:"pi pi-info-circle"},null,-1),(0,u.Lk)("p",null,"è«‹é¸æ“‡ä¸€å€‹æ¬„ä½ä¾†ç·¨è¼¯å±¬æ€§",-1)])))])]),(0,u.bF)(ie,{modelValue:i.value,"onUpdate:modelValue":a[17]||(a[17]=e=>i.value=e),title:"è¡¨å–® JSON çµæ§‹",width:"60%"},{footer:(0,u.k6)((()=>[(0,u.bF)(o,{onClick:B},{default:(0,u.k6)((()=>a[46]||(a[46]=[(0,u.eW)("è¤‡è£½")]))),_:1}),(0,u.bF)(o,{onClick:a[16]||(a[16]=e=>i.value=!1)},{default:(0,u.k6)((()=>a[47]||(a[47]=[(0,u.eW)("é—œé–‰")]))),_:1})])),default:(0,u.k6)((()=>[(0,u.bF)(D,{modelValue:F.value,"onUpdate:modelValue":a[15]||(a[15]=e=>F.value=e),type:"textarea",rows:20,readonly:"",class:"json-viewer"},null,8,["modelValue"])])),_:1},8,["modelValue"]),(0,u.bF)(w_,{modelValue:c.value,"onUpdate:modelValue":a[18]||(a[18]=e=>c.value=e),"field-data":p.value,onSave:N},null,8,["modelValue","field-data"]),(0,u.bF)(ie,{modelValue:m.value,"onUpdate:modelValue":a[26]||(a[26]=e=>m.value=e),title:"ç¯„æœ¬ç®¡ç†",width:"80%","before-close":ae},{footer:(0,u.k6)((()=>[(0,u.Lk)("div",gF,[!v.value&&n.value.length>0?((0,u.uX)(),(0,u.Wv)(o,{key:0,onClick:a[24]||(a[24]=e=>v.value=!0),type:"primary"},{default:(0,u.k6)((()=>a[56]||(a[56]=[(0,u.eW)(" ä¿å­˜ç‚ºæ–°ç¯„æœ¬ ")]))),_:1})):(0,u.Q3)("",!0),(0,u.bF)(o,{onClick:a[25]||(a[25]=e=>m.value=!1)},{default:(0,u.k6)((()=>a[57]||(a[57]=[(0,u.eW)("é—œé–‰")]))),_:1})])])),default:(0,u.k6)((()=>[(0,u.Lk)("div",cF,[(0,u.Lk)("div",pF,[(0,u.Lk)("div",mF,[a[49]||(a[49]=(0,u.Lk)("h4",null,"æˆ‘çš„ç¯„æœ¬",-1)),(0,u.bF)(o,{onClick:Y,loading:y.value,size:"small"},{default:(0,u.k6)((()=>a[48]||(a[48]=[(0,u.Lk)("i",{class:"pi pi-refresh"},null,-1),(0,u.eW)(" é‡æ–°æ•´ç† ")]))),_:1},8,["loading"])]),(0,u.bo)(((0,u.uX)(),(0,u.Wv)(ce,{data:b.value,height:"400"},{default:(0,u.k6)((()=>[(0,u.bF)(de,{prop:"title",label:"ç¯„æœ¬åç¨±","min-width":"150"}),(0,u.bF)(de,{prop:"description",label:"æè¿°","min-width":"200","show-overflow-tooltip":""}),(0,u.bF)(de,{prop:"category",label:"åˆ†é¡ž",width:"100"}),(0,u.bF)(de,{prop:"status",label:"ç‹€æ…‹",width:"80"},{default:(0,u.k6)((({row:e})=>[(0,u.bF)(l,{type:le(e.status),size:"small"},{default:(0,u.k6)((()=>[(0,u.eW)((0,L.v_)(te(e.status)),1)])),_:2},1032,["type"])])),_:1}),(0,u.bF)(de,{prop:"responseCount",label:"å›žæ‡‰æ•¸",width:"80"}),(0,u.bF)(de,{prop:"updatedAt",label:"æ›´æ–°æ™‚é–“",width:"150"},{default:(0,u.k6)((({row:e})=>[(0,u.eW)((0,L.v_)(oe(e.updatedAt)),1)])),_:1}),(0,u.bF)(de,{label:"æ“ä½œ",width:"200",fixed:"right"},{default:(0,u.k6)((({row:e})=>[(0,u.bF)(C,{size:"small"},{default:(0,u.k6)((()=>[(0,u.bF)(o,{onClick:a=>Q(e),type:"primary",size:"small"},{default:(0,u.k6)((()=>a[50]||(a[50]=[(0,u.eW)("è¼‰å…¥")]))),_:2},1032,["onClick"]),(0,u.bF)(o,{onClick:a=>G(e),size:"small"},{default:(0,u.k6)((()=>a[51]||(a[51]=[(0,u.eW)("è¤‡è£½")]))),_:2},1032,["onClick"]),(0,u.bF)(o,{onClick:a=>Z(e),type:"danger",size:"small"},{default:(0,u.k6)((()=>a[52]||(a[52]=[(0,u.eW)("åˆªé™¤")]))),_:2},1032,["onClick"])])),_:2},1024)])),_:1})])),_:1},8,["data"])),[[pe,y.value]])]),v.value?((0,u.uX)(),(0,u.CE)("div",vF,[a[55]||(a[55]=(0,u.Lk)("h4",null,"ä¿å­˜ç‚ºæ–°ç¯„æœ¬",-1)),(0,u.bF)(ue,{model:h.value,"label-width":"80px",size:"small"},{default:(0,u.k6)((()=>[(0,u.bF)(R,{label:"ç¯„æœ¬åç¨±",required:""},{default:(0,u.k6)((()=>[(0,u.bF)(D,{modelValue:h.value.title,"onUpdate:modelValue":a[19]||(a[19]=e=>h.value.title=e),placeholder:"è«‹è¼¸å…¥ç¯„æœ¬åç¨±"},null,8,["modelValue"])])),_:1}),(0,u.bF)(R,{label:"æè¿°"},{default:(0,u.k6)((()=>[(0,u.bF)(D,{modelValue:h.value.description,"onUpdate:modelValue":a[20]||(a[20]=e=>h.value.description=e),type:"textarea",rows:3,placeholder:"è«‹è¼¸å…¥ç¯„æœ¬æè¿°"},null,8,["modelValue"])])),_:1}),(0,u.bF)(R,{label:"åˆ†é¡ž"},{default:(0,u.k6)((()=>[(0,u.bF)(ne,{modelValue:h.value.category,"onUpdate:modelValue":a[21]||(a[21]=e=>h.value.category=e),placeholder:"è«‹é¸æ“‡åˆ†é¡ž"},{default:(0,u.k6)((()=>[(0,u.bF)(q,{label:"ä¸€èˆ¬è¡¨å–®",value:"general"}),(0,u.bF)(q,{label:"èª¿æŸ¥å•å·",value:"survey"}),(0,u.bF)(q,{label:"ç”³è«‹è¡¨å–®",value:"application"}),(0,u.bF)(q,{label:"å›žé¥‹è¡¨å–®",value:"feedback"}),(0,u.bF)(q,{label:"å…¶ä»–",value:"other"})])),_:1},8,["modelValue"])])),_:1}),(0,u.bF)(R,{label:"æ¨™ç±¤"},{default:(0,u.k6)((()=>[(0,u.bF)(D,{modelValue:h.value.tags,"onUpdate:modelValue":a[22]||(a[22]=e=>h.value.tags=e),placeholder:"è«‹è¼¸å…¥æ¨™ç±¤ï¼Œç”¨é€—è™Ÿåˆ†éš”"},null,8,["modelValue"])])),_:1})])),_:1},8,["model"]),(0,u.Lk)("div",bF,[(0,u.bF)(o,{onClick:a[23]||(a[23]=e=>v.value=!1)},{default:(0,u.k6)((()=>a[53]||(a[53]=[(0,u.eW)("å–æ¶ˆ")]))),_:1}),(0,u.bF)(o,{onClick:H,type:"primary",loading:f.value},{default:(0,u.k6)((()=>a[54]||(a[54]=[(0,u.eW)("ä¿å­˜ç¯„æœ¬")]))),_:1},8,["loading"])])])):(0,u.Q3)("",!0)])])),_:1},8,["modelValue"])])}}};const fF=(0,ie.A)(yF,[["__scopeId","data-v-54275e5d"]]);var hF=fF,kF=l(29043);const _F={class:"form-designer"},wF={class:"card-header"},FF={class:"header-actions"},CF={class:"preview-container"},DF={class:"preview-header"},LF={key:0};var RF={__name:"FormDesigner",setup(e){const a=(0,C.lq)(),l=(0,C.rd)(),t=(0,d.KR)(null),o=(0,d.KR)(!1),n=(0,d.KR)(!1),r=(0,d.KR)({title:"",description:"",category:"",status:"draft",fields:[],settings:{allowMultipleSubmissions:!1,showProgressBar:!1,endDate:null}}),s={title:[{required:!0,message:"è«‹è¼¸å…¥è¡¨å–®åç¨±",trigger:"blur"},{min:2,max:100,message:"è¡¨å–®åç¨±é•·åº¦åœ¨ 2 åˆ° 100 å€‹å­—ç¬¦",trigger:"blur"}],category:[{required:!0,message:"è«‹é¸æ“‡è¡¨å–®åˆ†é¡ž",trigger:"change"}]},i=(0,u.EW)((()=>!!a.params.id)),c=(0,u.EW)((()=>n.value?{...r.value,id:"preview",createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()}:null)),p=async()=>{if(i.value)try{const e=await F_.A.getFormTemplate(a.params.id);r.value=e.data}catch(e){console.error("è¼‰å…¥è¡¨å–®ç¯„æœ¬å¤±æ•—:",e),D.nk.error("è¼‰å…¥è¡¨å–®ç¯„æœ¬å¤±æ•—"),l.push("/dynamic-form/management")}},m=e=>{r.value.fields=e},v=async()=>{const e=await(t.value?.validate().catch((()=>!1)));if(!e)return D.nk.error("è«‹å®Œå–„è¡¨å–®åŸºæœ¬è³‡è¨Š"),!1;if(!r.value.fields||0===r.value.fields.length)return D.nk.error("è«‹è‡³å°‘æ·»åŠ ä¸€å€‹è¡¨å–®æ¬„ä½"),!1;const a=r.value.fields.filter((e=>!e.label?.trim()));return!(a.length>0)||(D.nk.error("æ‰€æœ‰æ¬„ä½éƒ½å¿…é ˆè¨­ç½®æ¨™ç±¤"),!1)},b=async()=>{if(await v())try{o.value=!0;const e={title:r.value.title,description:r.value.description,category:r.value.category,status:r.value.status,tags:r.value.tags||[],fields:r.value.fields.map(((e,a)=>({id:e.id,type:e.type,label:e.label,placeholder:e.placeholder||"",required:e.required||!1,validation:e.validation||{minLength:e.minLength||null,maxLength:e.maxLength||null,min:e.min||null,max:e.max||null,pattern:e.pattern||"",customMessage:e.customMessage||""},options:e.options||[],defaultValue:e.defaultValue||"",order:a,width:e.width||"100%",helpText:e.helpText||"",conditional:e.conditional||null}))),settings:{allowMultipleSubmissions:r.value.settings?.allowMultipleSubmissions||!1,requireLogin:r.value.settings?.requireLogin||!0,showProgressBar:r.value.settings?.showProgressBar||!1,submitButtonText:r.value.settings?.submitButtonText||"æäº¤",successMessage:r.value.settings?.successMessage||"è¡¨å–®æäº¤æˆåŠŸï¼",redirectUrl:r.value.settings?.redirectUrl||"",notificationEmails:r.value.settings?.notificationEmails||[],startDate:r.value.settings?.startDate||null,endDate:r.value.settings?.endDate||null,maxSubmissions:r.value.settings?.maxSubmissions||null}};let t;console.log("è¦é€å‡ºçš„form data:",e),i.value?(t=await F_.A.updateFormTemplate(a.params.id,e),D.nk.success("è¡¨å–®ç¯„æœ¬å·²æ›´æ–°")):(t=await F_.A.createFormTemplate(e),alert("DD"),D.nk.success("è¡¨å–®ç¯„æœ¬å·²å‰µå»º"),l.push(`/dynamic-form/designer/${t.data.id}`))}catch(e){console.error("ä¿å­˜è¡¨å–®ç¯„æœ¬å¤±æ•—:",e),D.nk.error("ä¿å­˜å¤±æ•—ï¼š"+(e.response?.data?.message||e.message))}finally{o.value=!1}},g=()=>{r.value.fields&&0!==r.value.fields.length?n.value=!0:D.nk.warning("è«‹å…ˆæ·»åŠ è¡¨å–®æ¬„ä½")},y=async()=>{const e=r.value.title||r.value.description||r.value.fields.length>0;if(e)try{await Sa.s.confirm("æ‚¨æœ‰æœªä¿å­˜çš„æ›´æ”¹ï¼Œç¢ºå®šè¦é›¢é–‹å—Žï¼Ÿ","ç¢ºèªé›¢é–‹",{type:"warning"})}catch{return!1}return!0};return(0,u.sV)((()=>{p()})),(0,C.JZ)((async(e,a,l)=>{const t=await y();l(t)})),(e,a)=>{const l=(0,u.g2)("el-input"),p=(0,u.g2)("el-form-item"),v=(0,u.g2)("el-col"),y=(0,u.g2)("el-option"),f=(0,u.g2)("el-select"),h=(0,u.g2)("el-row"),k=(0,u.g2)("el-form"),_=(0,u.g2)("el-card"),w=(0,u.g2)("el-button"),F=(0,u.g2)("el-dialog");return(0,u.uX)(),(0,u.CE)("div",_F,[a[12]||(a[12]=(0,u.Lk)("div",{class:"page-header"},[(0,u.Lk)("h2",null,[(0,u.Lk)("i",{class:"pi pi-cog"}),(0,u.eW)(" è¡¨å–®è¨­è¨ˆå™¨ ")]),(0,u.Lk)("p",{class:"page-description"},"è¨­è¨ˆå’Œå‰µå»ºå‹•æ…‹è¡¨å–®ç¯„æœ¬")],-1)),(0,u.bF)(_,{class:"form-info-card",shadow:"never"},{header:(0,u.k6)((()=>a[7]||(a[7]=[(0,u.Lk)("div",{class:"card-header"},[(0,u.Lk)("i",{class:"pi pi-info-circle"}),(0,u.Lk)("span",null,"è¡¨å–®åŸºæœ¬è³‡è¨Š")],-1)]))),default:(0,u.k6)((()=>[(0,u.bF)(k,{model:r.value,rules:s,ref_key:"templateFormRef",ref:t,"label-width":"120px"},{default:(0,u.k6)((()=>[(0,u.bF)(h,{gutter:20},{default:(0,u.k6)((()=>[(0,u.bF)(v,{span:8},{default:(0,u.k6)((()=>[(0,u.bF)(p,{label:"è¡¨å–®åç¨±",prop:"title"},{default:(0,u.k6)((()=>[(0,u.bF)(l,{modelValue:r.value.title,"onUpdate:modelValue":a[0]||(a[0]=e=>r.value.title=e),placeholder:"è«‹è¼¸å…¥è¡¨å–®åç¨±"},null,8,["modelValue"])])),_:1})])),_:1}),(0,u.bF)(v,{span:8},{default:(0,u.k6)((()=>[(0,u.bF)(p,{label:"è¡¨å–®åˆ†é¡ž",prop:"category"},{default:(0,u.k6)((()=>[(0,u.bF)(f,{modelValue:r.value.category,"onUpdate:modelValue":a[1]||(a[1]=e=>r.value.category=e),placeholder:"è«‹é¸æ“‡åˆ†é¡ž"},{default:(0,u.k6)((()=>[(0,u.bF)(y,{label:"äººäº‹è¡¨å–®",value:"hr"}),(0,u.bF)(y,{label:"è²¡å‹™è¡¨å–®",value:"finance"}),(0,u.bF)(y,{label:"æŽ¡è³¼è¡¨å–®",value:"purchase"}),(0,u.bF)(y,{label:"å…¶ä»–",value:"other"})])),_:1},8,["modelValue"])])),_:1})])),_:1}),(0,u.bF)(v,{span:8},{default:(0,u.k6)((()=>[(0,u.bF)(p,{label:"ç‹€æ…‹",prop:"status"},{default:(0,u.k6)((()=>[(0,u.bF)(f,{modelValue:r.value.status,"onUpdate:modelValue":a[2]||(a[2]=e=>r.value.status=e)},{default:(0,u.k6)((()=>[(0,u.bF)(y,{label:"è‰ç¨¿",value:"draft"}),(0,u.bF)(y,{label:"å·²ç™¼å¸ƒ",value:"published"}),(0,u.bF)(y,{label:"å·²åœç”¨",value:"disabled"})])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1}),(0,u.bF)(p,{label:"è¡¨å–®æè¿°",prop:"description"},{default:(0,u.k6)((()=>[(0,u.bF)(l,{modelValue:r.value.description,"onUpdate:modelValue":a[3]||(a[3]=e=>r.value.description=e),type:"textarea",rows:3,placeholder:"è«‹è¼¸å…¥è¡¨å–®æè¿°"},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1}),(0,u.bF)(_,{class:"form-builder-card",shadow:"never"},{header:(0,u.k6)((()=>[(0,u.Lk)("div",wF,[a[9]||(a[9]=(0,u.Lk)("i",{class:"pi pi-palette"},null,-1)),a[10]||(a[10]=(0,u.Lk)("span",null,"è¡¨å–®è¨­è¨ˆ",-1)),(0,u.Lk)("div",FF,[(0,u.bF)(w,{onClick:g,icon:(0,d.R1)(J.View)},{default:(0,u.k6)((()=>a[8]||(a[8]=[(0,u.eW)("é è¦½è¡¨å–®")]))),_:1},8,["icon"]),(0,u.bF)(w,{onClick:b,type:"primary",icon:(0,d.R1)(J.Check),loading:o.value},{default:(0,u.k6)((()=>[(0,u.eW)((0,L.v_)(i.value?"æ›´æ–°ç¯„æœ¬":"ä¿å­˜ç¯„æœ¬"),1)])),_:1},8,["icon","loading"])])])])),default:(0,u.k6)((()=>[(0,u.bF)(hF,{modelValue:r.value.fields,"onUpdate:modelValue":a[4]||(a[4]=e=>r.value.fields=e),onSave:m},null,8,["modelValue"])])),_:1}),(0,u.bF)(F,{modelValue:n.value,"onUpdate:modelValue":a[6]||(a[6]=e=>n.value=e),title:"è¡¨å–®é è¦½",width:"80%","close-on-click-modal":!1},{footer:(0,u.k6)((()=>[(0,u.bF)(w,{onClick:a[5]||(a[5]=e=>n.value=!1)},{default:(0,u.k6)((()=>a[11]||(a[11]=[(0,u.eW)("é—œé–‰é è¦½")]))),_:1})])),default:(0,u.k6)((()=>[(0,u.Lk)("div",CF,[(0,u.Lk)("div",DF,[(0,u.Lk)("h3",null,(0,L.v_)(r.value.title||"æœªå‘½åè¡¨å–®"),1),r.value.description?((0,u.uX)(),(0,u.CE)("p",LF,(0,L.v_)(r.value.description),1)):(0,u.Q3)("",!0)]),n.value&&c.value?((0,u.uX)(),(0,u.Wv)(kF["default"],{key:0,"template-data":c.value,"preview-mode":!0},null,8,["template-data"])):(0,u.Q3)("",!0)])])),_:1},8,["modelValue"])])}}};const VF=(0,ie.A)(RF,[["__scopeId","data-v-6be82f1a"]]);var IF=VF;const xF={class:"manual-upload"},EF={class:"dialog-footer"};var AF={__name:"DeviceDialog",props:{visible:{type:Boolean,default:!1},deviceData:{type:Object,default:()=>({})},isEdit:{type:Boolean,default:!1}},emits:["update:visible","confirm","cancel"],setup(e,{emit:a}){const l=e,t=a,o=(0,d.KR)(null),n=(0,d.KR)(null),r=(0,d.KR)(!1),s=(0,d.KR)(!1),i=(0,d.KR)([]),c=(0,d.KR)({category:"",url:"",dns:"",port:"",domain:"",account:"",password:"",appName:"",manual:null,areaId:""}),p={category:[{required:!0,message:"è«‹é¸æ“‡è¨­å‚™é¡žåˆ¥",trigger:"change"}],appName:[{required:!0,message:"è«‹è¼¸å…¥APPåç¨±",trigger:"blur"},{min:2,max:50,message:"é•·åº¦åœ¨ 2 åˆ° 50 å€‹å­—ç¬¦",trigger:"blur"}],dns:[{required:!0,message:"è«‹è¼¸å…¥DNSæˆ–IPä½å€",trigger:"blur"}],account:[{required:!0,message:"è«‹è¼¸å…¥ç™»å…¥å¸³è™Ÿ",trigger:"blur"}],password:[{required:!0,message:"è«‹è¼¸å…¥ç™»å…¥å¯†ç¢¼",trigger:"blur"},{min:6,message:"å¯†ç¢¼é•·åº¦è‡³å°‘6å€‹å­—ç¬¦",trigger:"blur"}],url:[{pattern:/^https?:\/\/.+/,message:"è«‹è¼¸å…¥æœ‰æ•ˆçš„ç¶²å€æ ¼å¼",trigger:"blur"}],port:[{pattern:/^\d+$/,message:"è«‹è¼¸å…¥æœ‰æ•ˆçš„é€£æŽ¥åŸ è™Ÿ",trigger:"blur"}]},m=(0,u.EW)((()=>"undefined"!==typeof window&&window.innerWidth<=768)),v=(0,u.EW)((()=>{if("undefined"!==typeof window){const e=window.innerWidth;return e<=480?"95%":e<=768?"90%":e<=1024?"80%":"800px"}return"800px"}));(0,u.wB)((()=>l.visible),(e=>{e&&(b(),l.isEdit&&l.deviceData&&(0,u.dY)((()=>{Object.assign(c.value,l.deviceData),l.deviceData.manual&&(i.value=[{name:l.deviceData.manual,url:l.deviceData.manual}])})))}));const b=()=>{c.value={category:"",url:"",dns:"",port:"",domain:"",account:"",password:"",appName:"",manual:null,areaId:""},i.value=[],o.value&&o.value.resetFields()},g=e=>{if(e.raw&&e.raw.size>10485760)return D.nk.error("æª”æ¡ˆå¤§å°ä¸èƒ½è¶…éŽ 10MB"),!1;const a=["application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/pdf"];if(e.raw&&!a.includes(e.raw.type))return D.nk.error("åªèƒ½ä¸Šå‚³ docã€docx æˆ– pdf æ ¼å¼çš„æª”æ¡ˆ"),!1;c.value.manual=e.name},y=()=>{c.value.manual=null},f=async()=>{if(o.value)try{await o.value.validate(),r.value=!0,await new Promise((e=>setTimeout(e,1e3))),t("confirm",{...c.value}),r.value=!1}catch(e){console.error("è¡¨å–®é©—è­‰å¤±æ•—:",e),r.value=!1}},h=()=>{t("update:visible",!1),t("cancel")};return(a,l)=>{const t=(0,u.g2)("el-option"),b=(0,u.g2)("el-select"),k=(0,u.g2)("el-form-item"),_=(0,u.g2)("el-col"),w=(0,u.g2)("el-input"),F=(0,u.g2)("el-row"),C=(0,u.g2)("el-button"),D=(0,u.g2)("el-upload"),R=(0,u.g2)("el-form"),V=(0,u.g2)("el-dialog");return(0,u.uX)(),(0,u.Wv)(V,{"model-value":e.visible,title:e.isEdit?"ç·¨è¼¯è¨­å‚™":"æ–°å¢žè¨­å‚™",width:v.value,"close-on-click-modal":!1,"close-on-press-escape":!1,onClose:h,class:"device-dialog"},{footer:(0,u.k6)((()=>[(0,u.Lk)("div",EF,[(0,u.bF)(C,{onClick:h},{default:(0,u.k6)((()=>l[11]||(l[11]=[(0,u.eW)("å–æ¶ˆ")]))),_:1}),(0,u.bF)(C,{type:"primary",onClick:f,loading:r.value},{default:(0,u.k6)((()=>[(0,u.eW)((0,L.v_)(e.isEdit?"æ›´æ–°":"æ–°å¢ž"),1)])),_:1},8,["loading"])])])),default:(0,u.k6)((()=>[(0,u.bF)(R,{ref_key:"formRef",ref:o,model:c.value,rules:p,"label-width":"100px",class:"device-form"},{default:(0,u.k6)((()=>[(0,u.bF)(F,{gutter:20},{default:(0,u.k6)((()=>[(0,u.bF)(_,{span:m.value?24:12},{default:(0,u.k6)((()=>[(0,u.bF)(k,{label:"é¡žåˆ¥",prop:"category"},{default:(0,u.k6)((()=>[(0,u.bF)(b,{modelValue:c.value.category,"onUpdate:modelValue":l[0]||(l[0]=e=>c.value.category=e),placeholder:"è«‹é¸æ“‡è¨­å‚™é¡žåˆ¥",style:{width:"100%"}},{default:(0,u.k6)((()=>[(0,u.bF)(t,{label:"ä¼ºæœå™¨",value:"ä¼ºæœå™¨"}),(0,u.bF)(t,{label:"è³‡æ–™åº«",value:"è³‡æ–™åº«"}),(0,u.bF)(t,{label:"ç¶²è·¯è¨­å‚™",value:"ç¶²è·¯è¨­å‚™"}),(0,u.bF)(t,{label:"æ‡‰ç”¨ç¨‹å¼",value:"æ‡‰ç”¨ç¨‹å¼"}),(0,u.bF)(t,{label:"å…¶ä»–",value:"å…¶ä»–"})])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["span"]),(0,u.bF)(_,{span:m.value?24:12},{default:(0,u.k6)((()=>[(0,u.bF)(k,{label:"APPåç¨±",prop:"appName"},{default:(0,u.k6)((()=>[(0,u.bF)(w,{modelValue:c.value.appName,"onUpdate:modelValue":l[1]||(l[1]=e=>c.value.appName=e),placeholder:"è«‹è¼¸å…¥æ‡‰ç”¨ç¨‹å¼åç¨±"},null,8,["modelValue"])])),_:1})])),_:1},8,["span"])])),_:1}),(0,u.bF)(F,{gutter:20},{default:(0,u.k6)((()=>[(0,u.bF)(_,{span:m.value?24:12},{default:(0,u.k6)((()=>[(0,u.bF)(k,{label:"å€åŸŸ",prop:"areaId"},{default:(0,u.k6)((()=>[(0,u.bF)(ar,{modelValue:c.value.areaId,"onUpdate:modelValue":l[2]||(l[2]=e=>c.value.areaId=e)},null,8,["modelValue"])])),_:1})])),_:1},8,["span"]),(0,u.bF)(_,{span:m.value?24:12},null,8,["span"])])),_:1}),(0,u.bF)(F,{gutter:20},{default:(0,u.k6)((()=>[(0,u.bF)(_,{span:m.value?24:12},{default:(0,u.k6)((()=>[(0,u.bF)(k,{label:"ç¶²å€",prop:"url"},{default:(0,u.k6)((()=>[(0,u.bF)(w,{modelValue:c.value.url,"onUpdate:modelValue":l[3]||(l[3]=e=>c.value.url=e),placeholder:"è«‹è¼¸å…¥ç¶²å€ (å¦‚: https://example.com)"},null,8,["modelValue"])])),_:1})])),_:1},8,["span"]),(0,u.bF)(_,{span:m.value?24:12},{default:(0,u.k6)((()=>[(0,u.bF)(k,{label:"DNS",prop:"dns"},{default:(0,u.k6)((()=>[(0,u.bF)(w,{modelValue:c.value.dns,"onUpdate:modelValue":l[4]||(l[4]=e=>c.value.dns=e),placeholder:"è«‹è¼¸å…¥DNSæˆ–IPä½å€"},null,8,["modelValue"])])),_:1})])),_:1},8,["span"])])),_:1}),(0,u.bF)(F,{gutter:20},{default:(0,u.k6)((()=>[(0,u.bF)(_,{span:m.value?24:12},{default:(0,u.k6)((()=>[(0,u.bF)(k,{label:"PORT",prop:"port"},{default:(0,u.k6)((()=>[(0,u.bF)(w,{modelValue:c.value.port,"onUpdate:modelValue":l[5]||(l[5]=e=>c.value.port=e),placeholder:"è«‹è¼¸å…¥é€£æŽ¥åŸ è™Ÿ",type:"number"},null,8,["modelValue"])])),_:1})])),_:1},8,["span"]),(0,u.bF)(_,{span:m.value?24:12},{default:(0,u.k6)((()=>[(0,u.bF)(k,{label:"ç¶²åŸŸ",prop:"domain"},{default:(0,u.k6)((()=>[(0,u.bF)(w,{modelValue:c.value.domain,"onUpdate:modelValue":l[6]||(l[6]=e=>c.value.domain=e),placeholder:"è«‹è¼¸å…¥ç¶²åŸŸåç¨±"},null,8,["modelValue"])])),_:1})])),_:1},8,["span"])])),_:1}),(0,u.bF)(F,{gutter:20},{default:(0,u.k6)((()=>[(0,u.bF)(_,{span:m.value?24:12},{default:(0,u.k6)((()=>[(0,u.bF)(k,{label:"å¸³è™Ÿ",prop:"account"},{default:(0,u.k6)((()=>[(0,u.bF)(w,{modelValue:c.value.account,"onUpdate:modelValue":l[7]||(l[7]=e=>c.value.account=e),placeholder:"è«‹è¼¸å…¥ç™»å…¥å¸³è™Ÿ"},null,8,["modelValue"])])),_:1})])),_:1},8,["span"]),(0,u.bF)(_,{span:m.value?24:12},{default:(0,u.k6)((()=>[(0,u.bF)(k,{label:"å¯†ç¢¼",prop:"password"},{default:(0,u.k6)((()=>[(0,u.bF)(w,{modelValue:c.value.password,"onUpdate:modelValue":l[8]||(l[8]=e=>c.value.password=e),placeholder:"è«‹è¼¸å…¥ç™»å…¥å¯†ç¢¼",type:s.value?"text":"password","show-password":""},null,8,["modelValue","type"])])),_:1})])),_:1},8,["span"])])),_:1}),(0,u.bF)(F,null,{default:(0,u.k6)((()=>[(0,u.bF)(_,{span:24},{default:(0,u.k6)((()=>[(0,u.bF)(k,{label:"æ“ä½œæ‰‹å†Š",prop:"manual"},{default:(0,u.k6)((()=>[(0,u.Lk)("div",xF,[(0,u.bF)(D,{ref_key:"uploadRef",ref:n,"file-list":i.value,"auto-upload":!1,"show-file-list":!0,limit:1,accept:".doc,.docx,.pdf",onChange:g,onRemove:y,class:"upload-component"},{tip:(0,u.k6)((()=>l[10]||(l[10]=[(0,u.Lk)("div",{class:"el-upload__tip"}," åªèƒ½ä¸Šå‚³ doc/docx/pdf æª”æ¡ˆï¼Œä¸”ä¸è¶…éŽ 10MB ",-1)]))),default:(0,u.k6)((()=>[(0,u.bF)(C,{type:"primary",icon:(0,d.R1)(J.Upload)},{default:(0,u.k6)((()=>l[9]||(l[9]=[(0,u.eW)(" é¸æ“‡æª”æ¡ˆ ")]))),_:1},8,["icon"])])),_:1},8,["file-list"])])])),_:1})])),_:1})])),_:1})])),_:1},8,["model"])])),_:1},8,["model-value","title","width"])}}};const TF=(0,ie.A)(AF,[["__scopeId","data-v-c199fe62"]]);var WF=TF,SF=l(82860);const UF={devices:{getAll:()=>SF.A.get("/api/SystemManagement/devices"),getById:e=>SF.A.get(`/api/SystemManagement/devices/${e}`),create:e=>SF.A.post("/api/SystemManagement/devices",e),update:(e,a)=>SF.A.put(`/api/SystemManagement/devices/${e}`,a),delete:e=>SF.A.delete(`/api/SystemManagement/devices/${e}`)},hosts:{getAll:()=>SF.A.get("/api/SystemManagement/hosts"),getById:e=>SF.A.get(`/api/SystemManagement/hosts/${e}`),create:e=>SF.A.post("/api/SystemManagement/hosts",e),update:(e,a)=>SF.A.put(`/api/SystemManagement/hosts/${e}`,a),delete:e=>SF.A.delete(`/api/SystemManagement/hosts/${e}`),backup:e=>SF.A.post(`/api/SystemManagement/hosts/${e}/backup`)}};var $F=UF;const NF={class:"device-management"},XF={class:"toolbar"},KF={class:"toolbar-left"},MF={class:"toolbar-right"},PF={class:"table-container"},OF={key:1,class:"text-muted"},zF={key:1,class:"text-muted"},BF={class:"password-cell"},jF={key:0,class:"password-hidden"},YF={key:1,class:"password-visible"},QF={key:1,class:"text-muted"},HF={key:1,class:"text-muted"},qF={class:"pagination-container"};var JF={__name:"DeviceManagement",setup(e){const a=(0,d.KR)(!1),l=(0,d.KR)(""),t=(0,d.KR)(1),o=(0,d.KR)(20),n=(0,d.KR)(!1),r=(0,d.KR)(!1),s=(0,d.KR)({}),i=(0,d.KR)([]),c=(0,d.KR)([]),p=(0,u.EW)((()=>{let e=c.value;if(l.value){const a=l.value.toLowerCase();e=e.filter((e=>e.category.toLowerCase().includes(a)||e.url.toLowerCase().includes(a)||e.dns.toLowerCase().includes(a)||e.domain.toLowerCase().includes(a)||e.account.toLowerCase().includes(a)||e.appName.toLowerCase().includes(a)))}const a=(t.value-1)*o.value,n=a+o.value;return e.slice(a,n)})),m=(0,u.EW)((()=>{if(l.value){const e=l.value.toLowerCase();return c.value.filter((a=>a.category.toLowerCase().includes(e)||a.url.toLowerCase().includes(e)||a.dns.toLowerCase().includes(e)||a.domain.toLowerCase().includes(e)||a.account.toLowerCase().includes(e)||a.appName.toLowerCase().includes(e))).length}return c.value.length})),v=e=>{const a={"ä¼ºæœå™¨":"primary","è³‡æ–™åº«":"success","ç¶²è·¯è¨­å‚™":"warning","æ‡‰ç”¨ç¨‹å¼":"info"};return a[e]||"default"},b=e=>{e.showPassword=!e.showPassword},g=({rowIndex:e})=>e%2===0?"even-row":"odd-row",y=()=>{r.value=!1,s.value={category:"",url:"",dns:"",port:"",domain:"",account:"",password:"",appName:"",manual:null,areaId:""},n.value=!0},f=e=>{r.value=!0,s.value={...e},n.value=!0},h=async()=>{a.value=!0;try{const e=await $F.devices.getAll();e.data.success?c.value=e.data.data.map((e=>({...e,showPassword:!1}))):D.nk.error("å–å¾—è¨­å‚™æ¸…å–®å¤±æ•—")}catch(e){console.error("å–å¾—è¨­å‚™æ¸…å–®éŒ¯èª¤:",e),D.nk.error("å–å¾—è¨­å‚™æ¸…å–®å¤±æ•—")}finally{a.value=!1}},k=async e=>{try{await Sa.s.confirm(`ç¢ºå®šè¦åˆªé™¤è¨­å‚™ã€Œ${e.appName}ã€å—Žï¼Ÿ`,"åˆªé™¤ç¢ºèª",{confirmButtonText:"ç¢ºå®š",cancelButtonText:"å–æ¶ˆ",type:"warning"});const a=await $F.devices.delete(e.id);a.data.success?(D.nk.success("è¨­å‚™åˆªé™¤æˆåŠŸ"),await h()):D.nk.error(a.data.message||"è¨­å‚™åˆªé™¤å¤±æ•—")}catch(a){"cancel"===a?D.nk.info("å·²å–æ¶ˆåˆªé™¤"):(console.error("åˆªé™¤è¨­å‚™éŒ¯èª¤:",a),D.nk.error("è¨­å‚™åˆªé™¤å¤±æ•—"))}},_=async()=>{await h(),D.nk.success("è³‡æ–™é‡æ–°æ•´ç†å®Œæˆ")},w=()=>{t.value=1},F=e=>{i.value=e},C=e=>{o.value=e,t.value=1},R=e=>{t.value=e},V=e=>{D.nk.info(`ä¸‹è¼‰æ“ä½œæ‰‹å†Šï¼š${e.manual}`)},I=async e=>{try{if(r.value){const a=await $F.devices.update(e.id,e);if(!a.data.success)return void D.nk.error(a.data.message||"è¨­å‚™æ›´æ–°å¤±æ•—");D.nk.success("è¨­å‚™æ›´æ–°æˆåŠŸ"),await h()}else{const a=await $F.devices.create(e);if(!a.data.success)return void D.nk.error(a.data.message||"è¨­å‚™æ–°å¢žå¤±æ•—");D.nk.success("è¨­å‚™æ–°å¢žæˆåŠŸ"),await h()}n.value=!1}catch(a){console.error("è¨­å‚™æ“ä½œéŒ¯èª¤:",a),D.nk.error(r.value?"è¨­å‚™æ›´æ–°å¤±æ•—":"è¨­å‚™æ–°å¢žå¤±æ•—")}},x=()=>{n.value=!1};return(0,u.sV)((async()=>{console.log("è¨­å‚™ç®¡ç†çµ„ä»¶å·²è¼‰å…¥"),await h()})),(e,i)=>{const c=(0,u.g2)("el-button"),h=(0,u.g2)("el-input"),D=(0,u.g2)("el-table-column"),E=(0,u.g2)("el-tag"),A=(0,u.g2)("el-link"),T=(0,u.g2)("el-table"),W=(0,u.g2)("el-pagination"),S=(0,u.gN)("loading");return(0,u.uX)(),(0,u.CE)("div",NF,[(0,u.Lk)("div",XF,[(0,u.Lk)("div",KF,[(0,u.bF)(c,{type:"primary",onClick:y,icon:(0,d.R1)(J.Plus)},{default:(0,u.k6)((()=>i[4]||(i[4]=[(0,u.eW)(" æ–°å¢žè¨­å‚™ ")]))),_:1},8,["icon"]),(0,u.bF)(c,{type:"success",onClick:_,icon:(0,d.R1)(J.Refresh)},{default:(0,u.k6)((()=>i[5]||(i[5]=[(0,u.eW)(" é‡æ–°æ•´ç† ")]))),_:1},8,["icon"])]),(0,u.Lk)("div",MF,[(0,u.bF)(h,{modelValue:l.value,"onUpdate:modelValue":i[0]||(i[0]=e=>l.value=e),placeholder:"æœå°‹è¨­å‚™...","prefix-icon":(0,d.R1)(J.Search),clearable:"",onInput:w,class:"search-input"},null,8,["modelValue","prefix-icon"])])]),(0,u.Lk)("div",PF,[(0,u.bo)(((0,u.uX)(),(0,u.Wv)(T,{data:p.value,stripe:"",border:"",class:"device-table","row-class-name":g,onSelectionChange:F},{default:(0,u.k6)((()=>[(0,u.bF)(D,{type:"selection",width:"55"}),(0,u.bF)(D,{prop:"category",label:"é¡žåˆ¥",width:"120"},{default:(0,u.k6)((({row:e})=>[(0,u.bF)(E,{type:v(e.category)},{default:(0,u.k6)((()=>[(0,u.eW)((0,L.v_)(e.category),1)])),_:2},1032,["type"])])),_:1}),(0,u.bF)(D,{prop:"url",label:"ç¶²å€","min-width":"200"},{default:(0,u.k6)((({row:e})=>[e.url?((0,u.uX)(),(0,u.Wv)(A,{key:0,href:e.url,target:"_blank",type:"primary"},{default:(0,u.k6)((()=>[(0,u.eW)((0,L.v_)(e.url),1)])),_:2},1032,["href"])):((0,u.uX)(),(0,u.CE)("span",OF,"-"))])),_:1}),(0,u.bF)(D,{prop:"dns",label:"DNS",width:"150"}),(0,u.bF)(D,{prop:"port",label:"PORT",width:"100"},{default:(0,u.k6)((({row:e})=>[e.port?((0,u.uX)(),(0,u.Wv)(E,{key:0,size:"small",type:"info"},{default:(0,u.k6)((()=>[(0,u.eW)((0,L.v_)(e.port),1)])),_:2},1024)):((0,u.uX)(),(0,u.CE)("span",zF,"-"))])),_:1}),(0,u.bF)(D,{prop:"domain",label:"ç¶²åŸŸ",width:"150"}),(0,u.bF)(D,{prop:"account",label:"å¸³è™Ÿ",width:"120"}),(0,u.bF)(D,{prop:"password",label:"å¯†ç¢¼",width:"120"},{default:(0,u.k6)((({row:e})=>[(0,u.Lk)("div",BF,[e.showPassword?((0,u.uX)(),(0,u.CE)("span",YF,(0,L.v_)(e.password),1)):((0,u.uX)(),(0,u.CE)("span",jF,(0,L.v_)("â€¢".repeat(8)),1)),(0,u.bF)(c,{icon:e.showPassword?(0,d.R1)(J.Hide):(0,d.R1)(J.View),size:"small",text:"",onClick:a=>b(e),class:"password-toggle"},null,8,["icon","onClick"])])])),_:1}),(0,u.bF)(D,{prop:"appName",label:"APPåç¨±",width:"150"}),(0,u.bF)(D,{prop:"areaId",label:"å€åŸŸ",width:"120"},{default:(0,u.k6)((({row:e})=>[e.areaId?((0,u.uX)(),(0,u.Wv)(rt,{key:0,areaId:e.areaId},null,8,["areaId"])):((0,u.uX)(),(0,u.CE)("span",QF,"-"))])),_:1}),(0,u.bF)(D,{prop:"manual",label:"æ“ä½œæ‰‹å†Š",width:"120"},{default:(0,u.k6)((({row:e})=>[e.manual?((0,u.uX)(),(0,u.Wv)(c,{key:0,type:"primary",size:"small",icon:(0,d.R1)(J.Document),onClick:a=>V(e)},{default:(0,u.k6)((()=>i[6]||(i[6]=[(0,u.eW)(" ä¸‹è¼‰ ")]))),_:2},1032,["icon","onClick"])):((0,u.uX)(),(0,u.CE)("span",HF,"ç„¡"))])),_:1}),(0,u.bF)(D,{label:"æ“ä½œ",width:"150",fixed:"right"},{default:(0,u.k6)((({row:e})=>[(0,u.bF)(c,{type:"primary",size:"small",icon:(0,d.R1)(J.Edit),onClick:a=>f(e)},{default:(0,u.k6)((()=>i[7]||(i[7]=[(0,u.eW)(" ç·¨è¼¯ ")]))),_:2},1032,["icon","onClick"]),(0,u.bF)(c,{type:"danger",size:"small",icon:(0,d.R1)(J.Delete),onClick:a=>k(e)},{default:(0,u.k6)((()=>i[8]||(i[8]=[(0,u.eW)(" åˆªé™¤ ")]))),_:2},1032,["icon","onClick"])])),_:1})])),_:1},8,["data"])),[[S,a.value]])]),(0,u.Lk)("div",qF,[(0,u.bF)(W,{"current-page":t.value,"onUpdate:currentPage":i[1]||(i[1]=e=>t.value=e),"page-size":o.value,"onUpdate:pageSize":i[2]||(i[2]=e=>o.value=e),"page-sizes":[10,20,50,100],total:m.value,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:C,onCurrentChange:R},null,8,["current-page","page-size","total"])]),(0,u.bF)(WF,{visible:n.value,"onUpdate:visible":i[3]||(i[3]=e=>n.value=e),"device-data":s.value,"is-edit":r.value,onConfirm:I,onCancel:x},null,8,["visible","device-data","is-edit"])])}}};const GF=(0,ie.A)(JF,[["__scopeId","data-v-164458ec"]]);var ZF=GF;const eC={class:"status-option"},aC={class:"status-option"},lC={class:"status-option"},tC={class:"folder-input-group"},oC={class:"folder-hint"},nC={class:"folder-input-group"},rC={class:"folder-hint"},sC={class:"dialog-footer"};var uC={__name:"HostDialog",props:{visible:{type:Boolean,default:!1},hostData:{type:Object,default:()=>({})},isEdit:{type:Boolean,default:!1}},emits:["update:visible","confirm","cancel"],setup(e,{emit:a}){const l=e,t=a,o=(0,d.KR)(null),n=(0,d.KR)(!1),r=(0,d.KR)(!1),s=(0,d.KR)({hostName:"",backupHost:"",backupLocation:"",originalFolder:"",backupFolder:"",status:"é‹è¡Œä¸­",autoBackup:!1,backupFrequency:"daily",backupTime:"02:00",areaId:""}),i={hostName:[{required:!0,message:"è«‹è¼¸å…¥ä¸»æ©Ÿåç¨±",trigger:"blur"},{min:2,max:50,message:"é•·åº¦åœ¨ 2 åˆ° 50 å€‹å­—ç¬¦",trigger:"blur"},{pattern:/^[A-Za-z0-9\-_]+$/,message:"ä¸»æ©Ÿåç¨±åªèƒ½åŒ…å«å­—æ¯ã€æ•¸å­—ã€é€£å­—è™Ÿå’Œåº•ç·š",trigger:"blur"}],originalFolder:[{required:!0,message:"è«‹è¼¸å…¥åŽŸä¸»æ©Ÿè³‡æ–™å¤¾è·¯å¾‘",trigger:"blur"},{pattern:/^[A-Za-z]:\\.*$/,message:"è«‹è¼¸å…¥æœ‰æ•ˆçš„Windowsè·¯å¾‘æ ¼å¼ (ä¾‹: C:\\Data)",trigger:"blur"}],status:[{required:!0,message:"è«‹é¸æ“‡ä¸»æ©Ÿç‹€æ…‹",trigger:"change"}],backupFolder:[{pattern:/^[A-Za-z]:\\.*$/,message:"è«‹è¼¸å…¥æœ‰æ•ˆçš„Windowsè·¯å¾‘æ ¼å¼ (ä¾‹: D:\\Backup)",trigger:"blur"}]},c=(0,u.EW)((()=>"undefined"!==typeof window&&window.innerWidth<=768)),p=(0,u.EW)((()=>{if("undefined"!==typeof window){const e=window.innerWidth;return e<=480?"95%":e<=768?"90%":e<=1024?"85%":"900px"}return"900px"}));(0,u.wB)((()=>l.visible),(e=>{e&&(m(),l.isEdit&&l.hostData&&(0,u.dY)((()=>{Object.assign(s.value,{...l.hostData,autoBackup:l.hostData.autoBackup||!1,backupFrequency:l.hostData.backupFrequency||"daily",backupTime:l.hostData.backupTime||"02:00"})})))}));const m=()=>{s.value={hostName:"",backupHost:"",backupLocation:"",originalFolder:"",backupFolder:"",status:"é‹è¡Œä¸­",autoBackup:!1,backupFrequency:"daily",backupTime:"02:00",areaId:""},o.value&&o.value.resetFields()},v=e=>{D.nk.info(`é–‹å•Ÿ${"original"===e?"åŽŸä¸»æ©Ÿ":"å‚™ä»½ä¸»æ©Ÿ"}è³‡æ–™å¤¾é¸æ“‡å™¨`);const a={original:["C:\\Program Files\\Application\\Data","C:\\inetpub\\wwwroot\\webapp","D:\\Applications\\ERP\\Files"],backup:["D:\\Backup\\Application\\Data","E:\\Backup\\webapp","F:\\Backup\\ERP\\Files"]},l=a[e],t=l[Math.floor(Math.random()*l.length)];"original"===e?s.value.originalFolder=t:s.value.backupFolder=t},b=async()=>{r.value=!0;try{await new Promise((e=>setTimeout(e,2e3))),D.nk.success("ä¸»æ©Ÿé€£ç·šæ¸¬è©¦æˆåŠŸ")}catch(e){D.nk.error("ä¸»æ©Ÿé€£ç·šæ¸¬è©¦å¤±æ•—")}finally{r.value=!1}},g=async()=>{if(o.value)try{await o.value.validate(),n.value=!0,await new Promise((e=>setTimeout(e,1e3))),t("confirm",{...s.value}),n.value=!1}catch(e){console.error("è¡¨å–®é©—è­‰å¤±æ•—:",e),n.value=!1}},y=()=>{t("update:visible",!1),t("cancel")};return(a,l)=>{const t=(0,u.g2)("el-input"),m=(0,u.g2)("el-form-item"),f=(0,u.g2)("el-col"),h=(0,u.g2)("el-icon"),k=(0,u.g2)("el-option"),_=(0,u.g2)("el-select"),w=(0,u.g2)("el-row"),F=(0,u.g2)("el-button"),C=(0,u.g2)("el-divider"),D=(0,u.g2)("el-switch"),R=(0,u.g2)("el-time-picker"),V=(0,u.g2)("el-form"),I=(0,u.g2)("el-dialog");return(0,u.uX)(),(0,u.Wv)(I,{"model-value":e.visible,title:e.isEdit?"ç·¨è¼¯ä¸»æ©Ÿ":"æ–°å¢žä¸»æ©Ÿ",width:p.value,"close-on-click-modal":!1,"close-on-press-escape":!1,onClose:y,class:"host-dialog"},{footer:(0,u.k6)((()=>[(0,u.Lk)("div",sC,[(0,u.bF)(F,{onClick:y},{default:(0,u.k6)((()=>l[21]||(l[21]=[(0,u.eW)("å–æ¶ˆ")]))),_:1}),(0,u.bF)(F,{type:"primary",onClick:g,loading:n.value},{default:(0,u.k6)((()=>[(0,u.eW)((0,L.v_)(e.isEdit?"æ›´æ–°":"æ–°å¢ž"),1)])),_:1},8,["loading"]),e.isEdit?((0,u.uX)(),(0,u.Wv)(F,{key:0,type:"warning",onClick:b,loading:r.value},{default:(0,u.k6)((()=>l[22]||(l[22]=[(0,u.eW)(" æ¸¬è©¦é€£ç·š ")]))),_:1},8,["loading"])):(0,u.Q3)("",!0)])])),default:(0,u.k6)((()=>[(0,u.bF)(V,{ref_key:"formRef",ref:o,model:s.value,rules:i,"label-width":"120px",class:"host-form"},{default:(0,u.k6)((()=>[(0,u.bF)(w,{gutter:20},{default:(0,u.k6)((()=>[(0,u.bF)(f,{span:c.value?24:12},{default:(0,u.k6)((()=>[(0,u.bF)(m,{label:"ä¸»æ©Ÿåç¨±",prop:"hostName"},{default:(0,u.k6)((()=>[(0,u.bF)(t,{modelValue:s.value.hostName,"onUpdate:modelValue":l[0]||(l[0]=e=>s.value.hostName=e),placeholder:"è«‹è¼¸å…¥ä¸»æ©Ÿåç¨±","prefix-icon":(0,d.R1)(J.Monitor)},null,8,["modelValue","prefix-icon"])])),_:1})])),_:1},8,["span"]),(0,u.bF)(f,{span:c.value?24:12},{default:(0,u.k6)((()=>[(0,u.bF)(m,{label:"ä¸»æ©Ÿç‹€æ…‹",prop:"status"},{default:(0,u.k6)((()=>[(0,u.bF)(_,{modelValue:s.value.status,"onUpdate:modelValue":l[1]||(l[1]=e=>s.value.status=e),placeholder:"è«‹é¸æ“‡ä¸»æ©Ÿç‹€æ…‹",style:{width:"100%"}},{default:(0,u.k6)((()=>[(0,u.bF)(k,{label:"é‹è¡Œä¸­",value:"é‹è¡Œä¸­"},{default:(0,u.k6)((()=>[(0,u.Lk)("div",eC,[(0,u.bF)(h,{color:"#67c23a"},{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.CircleCheck))])),_:1}),l[12]||(l[12]=(0,u.Lk)("span",null,"é‹è¡Œä¸­",-1))])])),_:1}),(0,u.bF)(k,{label:"é›¢ç·š",value:"é›¢ç·š"},{default:(0,u.k6)((()=>[(0,u.Lk)("div",aC,[(0,u.bF)(h,{color:"#f56c6c"},{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.CircleClose))])),_:1}),l[13]||(l[13]=(0,u.Lk)("span",null,"é›¢ç·š",-1))])])),_:1}),(0,u.bF)(k,{label:"ç¶­è­·ä¸­",value:"ç¶­è­·ä¸­"},{default:(0,u.k6)((()=>[(0,u.Lk)("div",lC,[(0,u.bF)(h,{color:"#e6a23c"},{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.Warning))])),_:1}),l[14]||(l[14]=(0,u.Lk)("span",null,"ç¶­è­·ä¸­",-1))])])),_:1})])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["span"])])),_:1}),(0,u.bF)(w,{gutter:20},{default:(0,u.k6)((()=>[(0,u.bF)(f,{span:c.value?24:12},{default:(0,u.k6)((()=>[(0,u.bF)(m,{label:"å€åŸŸ",prop:"areaId"},{default:(0,u.k6)((()=>[(0,u.bF)(ar,{modelValue:s.value.areaId,"onUpdate:modelValue":l[2]||(l[2]=e=>s.value.areaId=e)},null,8,["modelValue"])])),_:1})])),_:1},8,["span"]),(0,u.bF)(f,{span:c.value?24:12},null,8,["span"])])),_:1}),(0,u.bF)(w,{gutter:20},{default:(0,u.k6)((()=>[(0,u.bF)(f,{span:c.value?24:12},{default:(0,u.k6)((()=>[(0,u.bF)(m,{label:"å‚™ä»½ä¸»æ©Ÿ",prop:"backupHost"},{default:(0,u.k6)((()=>[(0,u.bF)(t,{modelValue:s.value.backupHost,"onUpdate:modelValue":l[3]||(l[3]=e=>s.value.backupHost=e),placeholder:"è«‹è¼¸å…¥å‚™ä»½ä¸»æ©Ÿåç¨±","prefix-icon":(0,d.R1)(J.Box)},null,8,["modelValue","prefix-icon"])])),_:1})])),_:1},8,["span"]),(0,u.bF)(f,{span:c.value?24:12},{default:(0,u.k6)((()=>[(0,u.bF)(m,{label:"å‚™ä»½ä¸»æ©Ÿä½ç½®",prop:"backupLocation"},{default:(0,u.k6)((()=>[(0,u.bF)(t,{modelValue:s.value.backupLocation,"onUpdate:modelValue":l[4]||(l[4]=e=>s.value.backupLocation=e),placeholder:"è«‹è¼¸å…¥å‚™ä»½ä¸»æ©Ÿå¯¦é«”ä½ç½®","prefix-icon":(0,d.R1)(J.Location)},null,8,["modelValue","prefix-icon"])])),_:1})])),_:1},8,["span"])])),_:1}),(0,u.bF)(w,null,{default:(0,u.k6)((()=>[(0,u.bF)(f,{span:24},{default:(0,u.k6)((()=>[(0,u.bF)(m,{label:"åŽŸä¸»æ©Ÿè³‡æ–™å¤¾",prop:"originalFolder"},{default:(0,u.k6)((()=>[(0,u.Lk)("div",tC,[(0,u.bF)(t,{modelValue:s.value.originalFolder,"onUpdate:modelValue":l[5]||(l[5]=e=>s.value.originalFolder=e),placeholder:"è«‹è¼¸å…¥åŽŸä¸»æ©Ÿè³‡æ–™å¤¾è·¯å¾‘ (ä¾‹: C:\\Data\\Application)","prefix-icon":(0,d.R1)(J.Folder)},null,8,["modelValue","prefix-icon"]),(0,u.bF)(F,{type:"primary",icon:(0,d.R1)(J.FolderOpened),onClick:l[6]||(l[6]=e=>v("original")),class:"folder-btn"},{default:(0,u.k6)((()=>l[15]||(l[15]=[(0,u.eW)(" ç€è¦½ ")]))),_:1},8,["icon"])]),(0,u.Lk)("div",oC,[(0,u.bF)(h,null,{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.InfoFilled))])),_:1}),l[16]||(l[16]=(0,u.Lk)("span",null,"å»ºè­°ä½¿ç”¨çµ•å°è·¯å¾‘ï¼Œä¾‹å¦‚ï¼šC:\\Program Files\\Application\\Data",-1))])])),_:1})])),_:1})])),_:1}),(0,u.bF)(w,null,{default:(0,u.k6)((()=>[(0,u.bF)(f,{span:24},{default:(0,u.k6)((()=>[(0,u.bF)(m,{label:"å‚™ä»½ä¸»æ©Ÿè³‡æ–™å¤¾",prop:"backupFolder"},{default:(0,u.k6)((()=>[(0,u.Lk)("div",nC,[(0,u.bF)(t,{modelValue:s.value.backupFolder,"onUpdate:modelValue":l[7]||(l[7]=e=>s.value.backupFolder=e),placeholder:"è«‹è¼¸å…¥å‚™ä»½ä¸»æ©Ÿè³‡æ–™å¤¾è·¯å¾‘ (ä¾‹: D:\\Backup\\Application)","prefix-icon":(0,d.R1)(J.FolderOpened)},null,8,["modelValue","prefix-icon"]),(0,u.bF)(F,{type:"success",icon:(0,d.R1)(J.FolderAdd),onClick:l[8]||(l[8]=e=>v("backup")),class:"folder-btn"},{default:(0,u.k6)((()=>l[17]||(l[17]=[(0,u.eW)(" ç€è¦½ ")]))),_:1},8,["icon"])]),(0,u.Lk)("div",rC,[(0,u.bF)(h,null,{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.InfoFilled))])),_:1}),l[18]||(l[18]=(0,u.Lk)("span",null,"å‚™ä»½è³‡æ–™å¤¾è·¯å¾‘ï¼Œå»ºè­°èˆ‡åŽŸè³‡æ–™å¤¾çµæ§‹ç›¸åŒ",-1))])])),_:1})])),_:1})])),_:1}),(0,u.bF)(C,{"content-position":"left"},{default:(0,u.k6)((()=>[(0,u.bF)(h,null,{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.Setting))])),_:1}),l[19]||(l[19]=(0,u.Lk)("span",null,"å‚™ä»½è¨­å®š",-1))])),_:1}),(0,u.bF)(w,{gutter:20},{default:(0,u.k6)((()=>[(0,u.bF)(f,{span:c.value?24:12},{default:(0,u.k6)((()=>[(0,u.bF)(m,{label:"è‡ªå‹•å‚™ä»½"},{default:(0,u.k6)((()=>[(0,u.bF)(D,{modelValue:s.value.autoBackup,"onUpdate:modelValue":l[9]||(l[9]=e=>s.value.autoBackup=e),"active-text":"å•Ÿç”¨","inactive-text":"åœç”¨"},null,8,["modelValue"])])),_:1})])),_:1},8,["span"]),s.value.autoBackup?((0,u.uX)(),(0,u.Wv)(f,{key:0,span:c.value?24:12},{default:(0,u.k6)((()=>[(0,u.bF)(m,{label:"å‚™ä»½é »çŽ‡"},{default:(0,u.k6)((()=>[(0,u.bF)(_,{modelValue:s.value.backupFrequency,"onUpdate:modelValue":l[10]||(l[10]=e=>s.value.backupFrequency=e),placeholder:"è«‹é¸æ“‡å‚™ä»½é »çŽ‡",style:{width:"100%"}},{default:(0,u.k6)((()=>[(0,u.bF)(k,{label:"æ¯æ—¥",value:"daily"}),(0,u.bF)(k,{label:"æ¯é€±",value:"weekly"}),(0,u.bF)(k,{label:"æ¯æœˆ",value:"monthly"})])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["span"])):(0,u.Q3)("",!0)])),_:1}),s.value.autoBackup?((0,u.uX)(),(0,u.Wv)(w,{key:0},{default:(0,u.k6)((()=>[(0,u.bF)(f,{span:24},{default:(0,u.k6)((()=>[(0,u.bF)(m,{label:"å‚™ä»½æ™‚é–“"},{default:(0,u.k6)((()=>[(0,u.bF)(R,{modelValue:s.value.backupTime,"onUpdate:modelValue":l[11]||(l[11]=e=>s.value.backupTime=e),placeholder:"é¸æ“‡å‚™ä»½æ™‚é–“",format:"HH:mm","value-format":"HH:mm",style:{width:"200px"}},null,8,["modelValue"]),l[20]||(l[20]=(0,u.Lk)("span",{class:"time-hint"},"å»ºè­°é¸æ“‡ç³»çµ±è² è¼‰è¼ƒä½Žçš„æ™‚é–“é€²è¡Œå‚™ä»½",-1))])),_:1})])),_:1})])),_:1})):(0,u.Q3)("",!0)])),_:1},8,["model"])])),_:1},8,["model-value","title","width"])}}};const iC=(0,ie.A)(uC,[["__scopeId","data-v-76a5325b"]]);var dC=iC;const cC={class:"host-management"},pC={class:"toolbar"},mC={class:"toolbar-left"},vC={class:"toolbar-right"},bC={class:"table-container"},gC={class:"host-name-cell"},yC={class:"host-name"},fC={key:0,class:"backup-host-cell"},hC={key:1,class:"text-muted"},kC={key:0,class:"location-cell"},_C={key:1,class:"text-muted"},wC={class:"folder-cell"},FC={class:"folder-path"},CC={key:0,class:"folder-cell"},DC={class:"folder-path"},LC={key:1,class:"text-muted"},RC={key:1,class:"text-muted"},VC={key:0,class:"backup-time-cell"},IC={key:1,class:"text-muted"},xC={class:"action-buttons"},EC={class:"pagination-container"};var AC={__name:"HostManagement",setup(e){const a=(0,d.KR)(!1),l=(0,d.KR)(""),t=(0,d.KR)(1),o=(0,d.KR)(20),n=(0,d.KR)(!1),r=(0,d.KR)(!1),s=(0,d.KR)({}),i=(0,d.KR)([]),c=(0,d.KR)([]),p=(0,u.EW)((()=>{let e=c.value;if(l.value){const a=l.value.toLowerCase();e=e.filter((e=>e.hostName.toLowerCase().includes(a)||e.backupHost&&e.backupHost.toLowerCase().includes(a)||e.backupLocation&&e.backupLocation.toLowerCase().includes(a)||e.originalFolder.toLowerCase().includes(a)||e.backupFolder&&e.backupFolder.toLowerCase().includes(a)))}const a=(t.value-1)*o.value,n=a+o.value;return e.slice(a,n)})),m=(0,u.EW)((()=>{if(l.value){const e=l.value.toLowerCase();return c.value.filter((a=>a.hostName.toLowerCase().includes(e)||a.backupHost&&a.backupHost.toLowerCase().includes(e)||a.backupLocation&&a.backupLocation.toLowerCase().includes(e)||a.originalFolder.toLowerCase().includes(e)||a.backupFolder&&a.backupFolder.toLowerCase().includes(e))).length}return c.value.length})),v=e=>{const a={"é‹è¡Œä¸­":"success","é›¢ç·š":"danger","ç¶­è­·ä¸­":"warning","å‚™ä»½ä¸­":"info"};return a[e]||"default"},b=e=>{if(!e)return"-";const a=new Date(e);return a.toLocaleString("zh-TW",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})},g=async e=>{try{await navigator.clipboard.writeText(e),D.nk.success("è·¯å¾‘å·²è¤‡è£½åˆ°å‰ªè²¼ç°¿")}catch(a){D.nk.error("è¤‡è£½å¤±æ•—")}},y=({rowIndex:e})=>e%2===0?"even-row":"odd-row",f=()=>{r.value=!1,s.value={hostName:"",backupHost:"",backupLocation:"",originalFolder:"",backupFolder:"",status:"é‹è¡Œä¸­",areaId:""},n.value=!0},h=e=>{r.value=!0,s.value={...e},n.value=!0},k=async()=>{a.value=!0;try{const e=await $F.hosts.getAll();e.data.success?c.value=e.data.data.map((e=>({...e,backingUp:!1}))):D.nk.error("å–å¾—ä¸»æ©Ÿæ¸…å–®å¤±æ•—")}catch(e){console.error("å–å¾—ä¸»æ©Ÿæ¸…å–®éŒ¯èª¤:",e),D.nk.error("å–å¾—ä¸»æ©Ÿæ¸…å–®å¤±æ•—")}finally{a.value=!1}},_=async e=>{try{await Sa.s.confirm(`ç¢ºå®šè¦åˆªé™¤ä¸»æ©Ÿã€Œ${e.hostName}ã€å—Žï¼Ÿ`,"åˆªé™¤ç¢ºèª",{confirmButtonText:"ç¢ºå®š",cancelButtonText:"å–æ¶ˆ",type:"warning"});const a=await $F.hosts.delete(e.id);a.data.success?(D.nk.success("ä¸»æ©Ÿåˆªé™¤æˆåŠŸ"),await k()):D.nk.error(a.data.message||"ä¸»æ©Ÿåˆªé™¤å¤±æ•—")}catch(a){"cancel"===a?D.nk.info("å·²å–æ¶ˆåˆªé™¤"):(console.error("åˆªé™¤ä¸»æ©ŸéŒ¯èª¤:",a),D.nk.error("ä¸»æ©Ÿåˆªé™¤å¤±æ•—"))}},w=async e=>{if(e.backupHost){e.backingUp=!0;try{const a=await $F.hosts.backup(e.id);a.data.success?(D.nk.success(`ä¸»æ©Ÿ ${e.hostName} å‚™ä»½å®Œæˆ`),await k()):D.nk.error(a.data.message||"å‚™ä»½å¤±æ•—")}catch(a){console.error("å‚™ä»½éŒ¯èª¤:",a),D.nk.error("å‚™ä»½å¤±æ•—")}finally{e.backingUp=!1}}else D.nk.warning("æ­¤ä¸»æ©Ÿæœªè¨­å®šå‚™ä»½ä¸»æ©Ÿ")},F=async()=>{await k(),D.nk.success("è³‡æ–™é‡æ–°æ•´ç†å®Œæˆ")},C=()=>{t.value=1},R=e=>{i.value=e},V=e=>{o.value=e,t.value=1},I=e=>{t.value=e},x=async e=>{try{if(r.value){const a=await $F.hosts.update(e.id,e);if(!a.data.success)return void D.nk.error(a.data.message||"ä¸»æ©Ÿæ›´æ–°å¤±æ•—");D.nk.success("ä¸»æ©Ÿæ›´æ–°æˆåŠŸ"),await k()}else{const a=await $F.hosts.create(e);if(!a.data.success)return void D.nk.error(a.data.message||"ä¸»æ©Ÿæ–°å¢žå¤±æ•—");D.nk.success("ä¸»æ©Ÿæ–°å¢žæˆåŠŸ"),await k()}n.value=!1}catch(a){console.error("ä¸»æ©Ÿæ“ä½œéŒ¯èª¤:",a),D.nk.error(r.value?"ä¸»æ©Ÿæ›´æ–°å¤±æ•—":"ä¸»æ©Ÿæ–°å¢žå¤±æ•—")}},E=()=>{n.value=!1};return(0,u.sV)((async()=>{console.log("ä¸»æ©Ÿç®¡ç†çµ„ä»¶å·²è¼‰å…¥"),await k()})),(e,i)=>{const c=(0,u.g2)("el-button"),k=(0,u.g2)("el-input"),D=(0,u.g2)("el-table-column"),A=(0,u.g2)("el-icon"),T=(0,u.g2)("el-tag"),W=(0,u.g2)("el-tooltip"),S=(0,u.g2)("el-table"),U=(0,u.g2)("el-pagination"),$=(0,u.gN)("loading");return(0,u.uX)(),(0,u.CE)("div",cC,[(0,u.Lk)("div",pC,[(0,u.Lk)("div",mC,[(0,u.bF)(c,{type:"primary",onClick:f,icon:(0,d.R1)(J.Plus)},{default:(0,u.k6)((()=>i[4]||(i[4]=[(0,u.eW)(" æ–°å¢žä¸»æ©Ÿ ")]))),_:1},8,["icon"]),(0,u.bF)(c,{type:"success",onClick:F,icon:(0,d.R1)(J.Refresh)},{default:(0,u.k6)((()=>i[5]||(i[5]=[(0,u.eW)(" é‡æ–°æ•´ç† ")]))),_:1},8,["icon"])]),(0,u.Lk)("div",vC,[(0,u.bF)(k,{modelValue:l.value,"onUpdate:modelValue":i[0]||(i[0]=e=>l.value=e),placeholder:"æœå°‹ä¸»æ©Ÿ...","prefix-icon":(0,d.R1)(J.Search),clearable:"",onInput:C,class:"search-input"},null,8,["modelValue","prefix-icon"])])]),(0,u.Lk)("div",bC,[(0,u.bo)(((0,u.uX)(),(0,u.Wv)(S,{data:p.value,stripe:"",border:"",class:"host-table","row-class-name":y,onSelectionChange:R},{default:(0,u.k6)((()=>[(0,u.bF)(D,{type:"selection",width:"55"}),(0,u.bF)(D,{prop:"hostName",label:"ä¸»æ©Ÿåç¨±","min-width":"150"},{default:(0,u.k6)((({row:e})=>[(0,u.Lk)("div",gC,[(0,u.bF)(A,{class:"host-icon"},{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.Monitor))])),_:1}),(0,u.Lk)("span",yC,(0,L.v_)(e.hostName),1),(0,u.bF)(T,{type:v(e.status),size:"small",class:"status-tag"},{default:(0,u.k6)((()=>[(0,u.eW)((0,L.v_)(e.status),1)])),_:2},1032,["type"])])])),_:1}),(0,u.bF)(D,{prop:"backupHost",label:"å‚™ä»½ä¸»æ©Ÿ","min-width":"150"},{default:(0,u.k6)((({row:e})=>[e.backupHost?((0,u.uX)(),(0,u.CE)("div",fC,[(0,u.bF)(A,{class:"backup-icon"},{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.Box))])),_:1}),(0,u.Lk)("span",null,(0,L.v_)(e.backupHost),1)])):((0,u.uX)(),(0,u.CE)("span",hC,"ç„¡å‚™ä»½ä¸»æ©Ÿ"))])),_:1}),(0,u.bF)(D,{prop:"backupLocation",label:"å‚™ä»½ä¸»æ©Ÿä½ç½®","min-width":"180"},{default:(0,u.k6)((({row:e})=>[e.backupLocation?((0,u.uX)(),(0,u.CE)("div",kC,[(0,u.bF)(A,{class:"location-icon"},{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.Location))])),_:1}),(0,u.Lk)("span",null,(0,L.v_)(e.backupLocation),1)])):((0,u.uX)(),(0,u.CE)("span",_C,"-"))])),_:1}),(0,u.bF)(D,{prop:"originalFolder",label:"åŽŸä¸»æ©Ÿè³‡æ–™å¤¾","min-width":"200"},{default:(0,u.k6)((({row:e})=>[(0,u.Lk)("div",wC,[(0,u.bF)(A,{class:"folder-icon"},{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.Folder))])),_:1}),(0,u.bF)(W,{content:e.originalFolder,placement:"top"},{default:(0,u.k6)((()=>[(0,u.Lk)("span",FC,(0,L.v_)(e.originalFolder),1)])),_:2},1032,["content"]),(0,u.bF)(c,{type:"primary",size:"small",text:"",icon:(0,d.R1)(J.CopyDocument),onClick:a=>g(e.originalFolder),class:"copy-btn"},{default:(0,u.k6)((()=>i[6]||(i[6]=[(0,u.eW)(" è¤‡è£½ ")]))),_:2},1032,["icon","onClick"])])])),_:1}),(0,u.bF)(D,{prop:"backupFolder",label:"å‚™ä»½ä¸»æ©Ÿè³‡æ–™å¤¾","min-width":"200"},{default:(0,u.k6)((({row:e})=>[e.backupFolder?((0,u.uX)(),(0,u.CE)("div",CC,[(0,u.bF)(A,{class:"folder-icon"},{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.FolderOpened))])),_:1}),(0,u.bF)(W,{content:e.backupFolder,placement:"top"},{default:(0,u.k6)((()=>[(0,u.Lk)("span",DC,(0,L.v_)(e.backupFolder),1)])),_:2},1032,["content"]),(0,u.bF)(c,{type:"success",size:"small",text:"",icon:(0,d.R1)(J.CopyDocument),onClick:a=>g(e.backupFolder),class:"copy-btn"},{default:(0,u.k6)((()=>i[7]||(i[7]=[(0,u.eW)(" è¤‡è£½ ")]))),_:2},1032,["icon","onClick"])])):((0,u.uX)(),(0,u.CE)("span",LC,"-"))])),_:1}),(0,u.bF)(D,{prop:"areaId",label:"å€åŸŸ",width:"120"},{default:(0,u.k6)((({row:e})=>[e.areaId?((0,u.uX)(),(0,u.Wv)(rt,{key:0,areaId:e.areaId},null,8,["areaId"])):((0,u.uX)(),(0,u.CE)("span",RC,"-"))])),_:1}),(0,u.bF)(D,{label:"æœ€å¾Œå‚™ä»½æ™‚é–“",width:"160"},{default:(0,u.k6)((({row:e})=>[e.lastBackupTime?((0,u.uX)(),(0,u.CE)("div",VC,[(0,u.bF)(A,{class:"time-icon"},{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.Clock))])),_:1}),(0,u.Lk)("span",null,(0,L.v_)(b(e.lastBackupTime)),1)])):((0,u.uX)(),(0,u.CE)("span",IC,"å¾žæœªå‚™ä»½"))])),_:1}),(0,u.bF)(D,{label:"æ“ä½œ",width:"180",fixed:"right"},{default:(0,u.k6)((({row:e})=>[(0,u.Lk)("div",xC,[(0,u.bF)(c,{type:"primary",size:"small",icon:(0,d.R1)(J.Edit),onClick:a=>h(e)},{default:(0,u.k6)((()=>i[8]||(i[8]=[(0,u.eW)(" ç·¨è¼¯ ")]))),_:2},1032,["icon","onClick"]),(0,u.bF)(c,{type:"warning",size:"small",icon:(0,d.R1)(J.Refresh),onClick:a=>w(e),loading:e.backingUp},{default:(0,u.k6)((()=>i[9]||(i[9]=[(0,u.eW)(" å‚™ä»½ ")]))),_:2},1032,["icon","onClick","loading"]),(0,u.bF)(c,{type:"danger",size:"small",icon:(0,d.R1)(J.Delete),onClick:a=>_(e)},{default:(0,u.k6)((()=>i[10]||(i[10]=[(0,u.eW)(" åˆªé™¤ ")]))),_:2},1032,["icon","onClick"])])])),_:1})])),_:1},8,["data"])),[[$,a.value]])]),(0,u.Lk)("div",EC,[(0,u.bF)(U,{"current-page":t.value,"onUpdate:currentPage":i[1]||(i[1]=e=>t.value=e),"page-size":o.value,"onUpdate:pageSize":i[2]||(i[2]=e=>o.value=e),"page-sizes":[10,20,50,100],total:m.value,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:V,onCurrentChange:I},null,8,["current-page","page-size","total"])]),(0,u.bF)(dC,{visible:n.value,"onUpdate:visible":i[3]||(i[3]=e=>n.value=e),"host-data":s.value,"is-edit":r.value,onConfirm:x,onCancel:E},null,8,["visible","host-data","is-edit"])])}}};const TC=(0,ie.A)(AC,[["__scopeId","data-v-395ceb1e"]]);var WC=TC;const SC={class:"device-host-management"};var UC={__name:"DeviceHostManagement",setup(e){const a=(0,d.KR)("devices"),l=(0,d.KR)(null),t=(0,d.KR)(null),o=e=>{console.log("åˆ‡æ›åˆ°æ¨™ç±¤é :",e)};return(0,u.sV)((()=>{console.log("è¨­å‚™/ä¸»æ©Ÿç®¡ç†é é¢å·²è¼‰å…¥")})),(e,n)=>{const r=(0,u.g2)("el-tab-pane"),s=(0,u.g2)("el-tabs");return(0,u.uX)(),(0,u.CE)("div",SC,[n[1]||(n[1]=(0,u.Lk)("div",{class:"page-header"},[(0,u.Lk)("h1",{class:"page-title"},"è¨­å‚™/ä¸»æ©Ÿç®¡ç†"),(0,u.Lk)("p",{class:"page-description"},"ç®¡ç†ç³»çµ±è¨­å‚™æ¸…å–®èˆ‡ä¸»æ©Ÿé…ç½®è³‡è¨Š")],-1)),(0,u.bF)(s,{modelValue:a.value,"onUpdate:modelValue":n[0]||(n[0]=e=>a.value=e),class:"management-tabs",onTabChange:o},{default:(0,u.k6)((()=>[(0,u.bF)(r,{label:"è¨­å‚™æ¸…å–®",name:"devices"},{default:(0,u.k6)((()=>[(0,u.bF)(ZF,{ref_key:"deviceManagementRef",ref:l},null,512)])),_:1}),(0,u.bF)(r,{label:"ä¸»æ©Ÿæ¸…å–®",name:"hosts"},{default:(0,u.k6)((()=>[(0,u.bF)(WC,{ref_key:"hostManagementRef",ref:t},null,512)])),_:1})])),_:1},8,["modelValue"])])}}};const $C=(0,ie.A)(UC,[["__scopeId","data-v-11392ad1"]]);var NC=$C;let XC;function KC(e){XC=e}const MC=()=>XC,PC="CRM";var OC={createCustomerTracking(e){return MC().post(`${PC}/CustomerTracking`,e,{headers:{"Content-Type":"application/json"}})},getCustomerTracking(){return MC().get(`${PC}/CustomerTracking`)},getColdCallingReport(e,a){return MC().get(`${PC}/ColdCallingReport/${e}/${a}`)},getCustomerReport(){return MC().get(`${PC}/CustomerReport`)},addCustomerReport(e){return MC().post(`${PC}/CustomerReport`,e)},updateCustomerTracking(e,a){return MC().put(`${PC}/CustomerTracking/${e}`,a)},deleteCustomerTracking(e){return MC().delete(`${PC}/CustomerTracking/${e}`)},getSalespersonBusinessArea(){return MC().get(`${PC}/SalespersonBusinessArea`)},getComCustomer(){return MC().get(`${PC}/comCustomer`)},getCustomerClass(e,a,l){return MC().get(`${PC}/customerClass`,{params:{customerId:e,start:a,end:l}})},getCustomerClassByAmount(e,a,l){return MC().get(`${PC}/customerClassByAmount`,{params:{amount:e,start:a,end:l}})},getOrderSummaries(e,a,l){return console.log(`${e}  ${a}  ${l}`),MC().get(`${PC}/OrderSummaries`,{params:{CustomerID:e,start:a,end:l}})},updateOrderProductCategory(e,a){return MC().post(`${PC}/OrderProductCategory`,{OrderNumber:e,ProductCategory:a})},getAllCustomerTracking(){return MC().get(`${PC}/CustomerTracking`)},getCustomerTrackingById(e){return MC().get(`${PC}/CustomerTracking/${e}`)},createCustomerForm(e){return MC().post(`${PC}/CustomerForm`,e,{headers:{"Content-Type":"application/json"}})},getCustomerForms(){return MC().get(`${PC}/CustomerForm`)},getCustomerReport_CustomerReadModels(){return MC().get(`${PC}/CustomerReport/CustomerReadModels`)},getCustomerFormsByUserID(e){return MC().get(`${PC}/CustomerFormByUserID/${e}`)},getAllCustomerForms(){return MC().get(`${PC}/CustomerForm`)},updateCustomer(e,a){return MC().put(`${PC}/CustomerForm/${e}`,a)},deleteCustomer(e){return MC().delete(`${PC}/CustomerForm/${e}`)},getSalesEmployeeData(){return MC().get(`${PC}/getSalesEmployeeData`)},getCaseTrackings(){return MC().get(`${PC}/CaseTracking`)},getCaseTracking(e){return MC().get(`${PC}/CaseTracking/${e}`)},getCaseTrackingByUserID(e){return MC().get(`${PC}/CaseTrackingByUserID/${e}`)},getAllCaseTracking(){return MC().get(`${PC}/CaseTracking`)},createCaseTracking(e){return console.log(e),MC().post(`${PC}/CaseTracking`,e)},updateCaseTracking(e,a){return console.log("id:",e),console.log("updateCaseTracking:",a),MC().put(`${PC}/CaseTracking/${e}`,a)},deleteCaseTracking(e){return MC().delete(`${PC}/CaseTracking/${e}`)},updateFXRateAndOriginalAmount(e,a){return console.log("id:",e),console.log("updateFXRateAndOriginalAmount:",a),MC().put(`${PC}/CaseTrackingAmount/${e}`,a)},getDeviceUsageCategories(){return MC().get(`${PC}/DeviceUsageCategories`)},getPerformanceReport(){return MC().get(`${PC}/PerformanceReport`)},getPerformanceReportByYear(e){return MC().get(`${PC}/performanceReport/${e}`)},getComBillAccounts(e,a){return MC().get(`${PC}/comBillAccounts/${e}/${a}`)},createPerformanceReport(e){return MC().post(`${PC}/PerformanceReport`,e)},updatePerformanceReport(e,a,l){return MC().put(`${PC}/PerformanceReport/${e}/${a}`,l)},updatePerformanceReportAnnual(e,a,l){return MC().put(`${PC}/PerformanceReportByAnnual/${e}/${a}/${l}`)},deletePerformanceReport(e){return MC().delete(`${PC}/PerformanceReport/${e}`)},getPerformanceDashboard(e){return MC().get(`${PC}/PerformanceDashboard/${e}`)}};const zC={style:{"margin-top":"3rem","text-align":"center"}},BC={style:{display:"flex",gap:"2rem","margin-bottom":"20px","margin-top":"20px","align-items":"center","justify-content":"center"}},jC={key:0,style:{"margin-bottom":"20px"}},YC={key:0},QC={key:1},HC={key:0},qC={key:0},JC={key:1},GC={key:1},ZC={key:0,style:{margin:"0 auto"}},eD={key:0},aD={key:1},lD={key:1,style:{margin:"0 auto"}},tD={key:0},oD={key:1},nD={key:0},rD={key:0},sD={key:1},uD={key:1};var iD={__name:"PerformanceReport",setup(e){const a=(0,S.k)(),l=(0,d.KR)("monthly"),t=(0,d.KR)("sales"),o=(0,d.KR)(null),n=(0,d.KR)([]),r=(0,d.KR)([]),s=(0,d.KR)([]),i=(0,d.KR)(new Date),c=(0,d.KR)(!0),p=(0,d.KR)("å…¨ç‡Ÿæ¥­å€"),m=(0,d.KR)([]),v=(0,d.KR)([]),b=(0,d.KR)([]),g=(0,d.KR)([]),y=(0,d.KR)([]),f=(0,d.KR)([]),h=(0,d.KR)([]),k=(0,d.KR)([]),_=e=>null===e||void 0===e||""===e?"":e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),w=(e,a)=>{const l=parseFloat(e[`month${a}Target`]),t=parseFloat(e[`month${a}Actual`]);if(isNaN(l)||isNaN(t))e[`month${a}AchievementRate`]="0.00%";else{const o=0!==l?t/l*100:0;e[`month${a}AchievementRate`]=Math.floor(100*o)/100+"%"}},F=e=>{if(e&&"string"===typeof e){const a=parseFloat(e.replace("%",""));if(!isNaN(a)&&a<100)return{backgroundColor:"#FFD2D2"}}return{}},C=e=>{if(e&&"string"===typeof e){const a=parseFloat(e.replace("%",""));if(!isNaN(a)){if(a>0)return{color:"#67C23A",fontWeight:"bold"};if(a<0)return{color:"#F56C6C",fontWeight:"bold"}}}return{}},R=(e,a)=>{const l=parseFloat(e)||0,t=parseFloat(a)||0;if(0===t)return l>0?"+âˆž%":"0.00%";const o=(l-t)/t*100,n=o>=0?"+":"";return n+o.toFixed(2)+"%"},V=e=>{const a=parseFloat(e.yearTarget),l=parseFloat(e.yearActual);if(isNaN(a)||isNaN(l))e.yearAchievementRate="0.00%";else{const t=0!==a?l/a*100:0;e.yearAchievementRate=Math.floor(100*t)/100+"%"}},I=async e=>{if(null!=e)try{const a=await OC.getPerformanceReportByYear(e);console.log("ç•¶å¹´æ•¸æ“š:",a.data);const l=a.data.personalGoal||[],t=a.data.personalPerformances||{},o=e-1,n=await OC.getPerformanceReportByYear(o);console.log("åŽ»å¹´æ•¸æ“š:",n.data);const r=n.data.personalPerformances||{};y.value=a.data.salesRepPersonList||[],y.value.sort(((e,a)=>(e.sortId||0)-(a.sortId||0)));const s=[...new Set(y.value.map((e=>e.salesRepBusinessAreaName)))];m.value=s,p.value&&"å…¨ç‡Ÿæ¥­å€"!==p.value||(p.value="å…¨ç‡Ÿæ¥­å€");const u=l.map((e=>{const a={id:e.id,salesRepID:e.salesRepID,salesRepName:e.salesRepName},l=e.salesRepName.length>2?e.salesRepName.slice(-2):e.salesRepName,o=t[l]||{},n=o.monthlyAmount||{},s=r[l]||{},u=s.monthlyAmount||{},i=["january","february","march","april","may","june","july","august","september","october","november","december"];return i.forEach(((l,t)=>{const o=t+1;a[`month${o}Target`]=e[l]??0,a[`month${o}Actual`]=n[l]??0,a[`month${o}LastYearActual`]=u[l]??0,a[`month${o}Comparison`]=R(a[`month${o}Actual`],a[`month${o}LastYearActual`]),w(a,o)})),a})),i=u.sort(((e,a)=>{const l=y.value.find((a=>a.salesRepID===e.salesRepID)),t=y.value.find((e=>e.salesRepID===a.salesRepID));return(l?.sortId||0)-(t?.sortId||0)}));v.value=i;const d=e=>e.map((e=>{const a={salesRepID:e.salesRepID,salesRepName:e.salesRepName,id:e.id};for(let r=1;r<=4;r++){let l=0,t=0,o=0;for(let a=3*(r-1)+1;a<=3*r;a++)l+=parseFloat(e[`month${a}Target`]||0),t+=parseFloat(e[`month${a}Actual`]||0),o+=parseFloat(e[`month${a}LastYearActual`]||0);a[`quarter${r}Target`]=l,a[`quarter${r}Actual`]=t,a[`quarter${r}LastYearActual`]=o,a[`quarter${r}Comparison`]=R(t,o);const n=0!==l?t/l*100:0;a[`quarter${r}AchievementRate`]=Math.floor(100*n)/100+"%"}let l=0,t=0,o=0;for(let r=1;r<=12;r++)l+=parseFloat(e[`month${r}Target`]||0),t+=parseFloat(e[`month${r}Actual`]||0),o+=parseFloat(e[`month${r}LastYearActual`]||0);a.yearTarget=l,a.yearActual=t,a.yearLastYearActual=o,a.yearComparison=R(t,o);const n=0!==l?t/l*100:0;return a.yearAchievementRate=Math.floor(100*n)/100+"%",a}));b.value=d(i),g.value=d(i),x(i),$()}catch(a){console.error("å–å¾—ç¸¾æ•ˆå ±å‘Šå¤±æ•—ï¼š",a),D.nk.error("å–å¾—ç¸¾æ•ˆå ±å‘Šå¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦ã€‚")}},x=e=>{const a={};e.forEach((e=>{const l=y.value.find((a=>a.salesRepID===e.salesRepID)),t=l?.salesRepBusinessAreaName||"æœªçŸ¥åœ°å€";a[t]||(a[t]=[]),a[t].push(e)}));const l=Object.keys(a).map((e=>{const l={regionName:e,salesRepName:e};for(let t=1;t<=12;t++){let o=0,n=0;a[e].forEach((e=>{o+=parseFloat(e[`month${t}Actual`]||0),n+=parseFloat(e[`month${t}LastYearActual`]||0)})),l[`month${t}Actual`]=o,l[`month${t}LastYearActual`]=n,l[`month${t}Comparison`]=R(o,n)}return l})),t=e=>e.map((e=>{const a={regionName:e.regionName,salesRepName:e.salesRepName};for(let o=1;o<=4;o++){let l=0,t=0;for(let a=3*(o-1)+1;a<=3*o;a++)l+=parseFloat(e[`month${a}Actual`]||0),t+=parseFloat(e[`month${a}LastYearActual`]||0);a[`quarter${o}Actual`]=l,a[`quarter${o}LastYearActual`]=t,a[`quarter${o}Comparison`]=R(l,t)}let l=0,t=0;for(let o=1;o<=12;o++)l+=parseFloat(e[`month${o}Actual`]||0),t+=parseFloat(e[`month${o}LastYearActual`]||0);return a.yearActual=l,a.yearLastYearActual=t,a.yearComparison=R(l,t),a}));f.value=l,h.value=t(l),k.value=t(l)},E=e=>{o.value=e.id},A=async e=>{try{if(console.log("doneEdit: ",e),"monthly"===l.value){const a=["January","February","March","April","May","June","July","August","September","October","November","December"],l={Id:e.id,SalesRepID:e.salesRepID,SalesRepName:e.salesRepName,year:i.value.getFullYear().toString(),...a.reduce(((a,l,t)=>(a[l]=e[`month${t+1}Target`],a)),{})};console.log("é€åˆ°å¾Œç«¯çš„ payload (monthly):",l),await OC.updatePerformanceReport(i.value.getFullYear(),e.salesRepID,l)}else"yearly"===l.value&&(console.log("é€åˆ°å¾Œç«¯çš„ row (yearly):",parseInt(e.yearTarget)),await OC.updatePerformanceReportAnnual(i.value.getFullYear(),e.salesRepID,parseInt(e.yearTarget)));D.nk.success("è³‡æ–™å·²æ›´æ–°"),o.value=null,await I(i.value.getFullYear())}catch(a){console.error("æ›´æ–°è³‡æ–™å¤±æ•—ï¼š",a),D.nk.error("æ›´æ–°è³‡æ–™å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦ã€‚")}},T=()=>{o.value=null},W=e=>{console.log("ç¯©é¸è®Šæ›´:",e),p.value=e,console.log("æ›´æ–°å¾Œçš„é¸æ“‡:",p.value),$()},U=()=>{$()},$=()=>{if("region"===t.value)return n.value=f.value,r.value=h.value,s.value=k.value,void console.log("é¡¯ç¤ºåœ°å€éŠ·å”®é¡æ•¸æ“šï¼Œæ•¸æ“šç­†æ•¸:",n.value.length);if(console.log("é–‹å§‹ç¯©é¸ï¼Œé¸ä¸­çš„ç‡Ÿæ¥­å€:",p.value),console.log("æ‰€æœ‰ç‡Ÿæ¥­å€é¸é …:",m.value),"å…¨ç‡Ÿæ¥­å€"===p.value)return n.value=v.value,r.value=b.value,s.value=g.value,void console.log("é¡¯ç¤ºå…¨ç‡Ÿæ¥­å€æ•¸æ“šï¼Œæ•¸æ“šç­†æ•¸:",n.value.length);const e=y.value.filter((e=>e.salesRepBusinessAreaName===p.value)).map((e=>e.salesRepID));console.log("ç¯©é¸å¾Œçš„æ¥­å‹™äººå“¡ID:",e);const a=v.value.filter((a=>e.includes(a.salesRepID))),l=b.value.filter((a=>e.includes(a.salesRepID))),o=g.value.filter((a=>e.includes(a.salesRepID)));console.log("ç¯©é¸å¾Œçš„æ•¸æ“šç­†æ•¸:",a.length),n.value=a,r.value=l,s.value=o,console.log("ç¯©é¸å®Œæˆï¼Œç•¶å‰é¡¯ç¤ºæ•¸æ“šç­†æ•¸:",n.value.length)},N=()=>{const e=a.userId,l={TW0301:"åŒ—ç‡Ÿæ¥­å€",TW0261:"åŒ—ç‡Ÿæ¥­å€",TW0282:"ä¸­ç‡Ÿæ¥­å€",TW0316:"å—ç‡Ÿæ¥­ä¸€å€",TW0300:"åœ‹å¤–æ¥­å‹™",OP0001:"å—ç‡Ÿæ¥­äºŒå€",TW0073:"å—ç‡Ÿæ¥­äºŒå€",TW0035:"å—ç‡Ÿæ¥­ä¸€å€"},t=l[e];if(t){c.value=!1;const e=m.value.includes(t);e?(m.value=[t],p.value=t):(m.value=[],p.value=""),$()}else c.value=!0};return(0,u.wB)(i,(async e=>{e&&(await I(e.getFullYear()),N())})),(0,u.sV)((async()=>{await I(i.value.getFullYear()),N()})),(e,a)=>{const d=(0,u.g2)("el-date-picker"),v=(0,u.g2)("el-radio-button"),b=(0,u.g2)("el-radio-group"),g=(0,u.g2)("el-button"),y=(0,u.g2)("el-table-column"),f=(0,u.g2)("el-input"),h=(0,u.g2)("el-table");return(0,u.uX)(),(0,u.CE)(u.FK,null,[(0,u.Lk)("div",zC,[(0,u.bF)(d,{modelValue:i.value,"onUpdate:modelValue":a[0]||(a[0]=e=>i.value=e),type:"year",size:"large",placeholder:"è«‹é¸æ“‡å¹´åº¦",style:{width:"11.5rem","margin-right":"2rem","margin-top":"0.5rem","font-size":"2rem"},onChange:a[1]||(a[1]=e=>I(i.value.getFullYear()))},null,8,["modelValue"]),(0,u.Lk)("div",BC,[(0,u.bF)(b,{modelValue:l.value,"onUpdate:modelValue":a[2]||(a[2]=e=>l.value=e),size:"large",fill:"#6cf"},{default:(0,u.k6)((()=>[(0,u.bF)(v,{label:"monthly"},{default:(0,u.k6)((()=>a[7]||(a[7]=[(0,u.eW)("æœˆåº¦")]))),_:1}),(0,u.bF)(v,{label:"quarterly"},{default:(0,u.k6)((()=>a[8]||(a[8]=[(0,u.eW)("å­£åº¦")]))),_:1}),(0,u.bF)(v,{label:"yearly"},{default:(0,u.k6)((()=>a[9]||(a[9]=[(0,u.eW)("å¹´åº¦")]))),_:1})])),_:1},8,["modelValue"]),(0,u.bF)(b,{modelValue:t.value,"onUpdate:modelValue":a[3]||(a[3]=e=>t.value=e),size:"large",fill:"#52c41a",onChange:U},{default:(0,u.k6)((()=>[(0,u.bF)(v,{label:"sales"},{default:(0,u.k6)((()=>a[10]||(a[10]=[(0,u.eW)("æ¥­å‹™éŠ·å”®é¡")]))),_:1}),(0,u.bF)(v,{label:"region"},{default:(0,u.k6)((()=>a[11]||(a[11]=[(0,u.eW)("åœ°å€éŠ·å”®é¡")]))),_:1})])),_:1},8,["modelValue"])]),"sales"===t.value?((0,u.uX)(),(0,u.CE)("div",jC,[(0,u.bF)(b,{modelValue:p.value,"onUpdate:modelValue":a[4]||(a[4]=e=>p.value=e),size:"large",onChange:W},{default:(0,u.k6)((()=>[c.value?((0,u.uX)(),(0,u.Wv)(v,{key:0,value:"å…¨ç‡Ÿæ¥­å€"},{default:(0,u.k6)((()=>a[12]||(a[12]=[(0,u.eW)("å…¨ç‡Ÿæ¥­å€")]))),_:1})):(0,u.Q3)("",!0),((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(m.value,(e=>((0,u.uX)(),(0,u.Wv)(v,{key:e,value:e},{default:(0,u.k6)((()=>[(0,u.eW)((0,L.v_)(e),1)])),_:2},1032,["value"])))),128))])),_:1},8,["modelValue"])])):(0,u.Q3)("",!0),(0,u.Lk)("div",null,["monthly"===l.value?((0,u.uX)(),(0,u.Wv)(h,{key:0,class:"form",data:n.value,style:{width:"100%","max-width":"140rem"}},{default:(0,u.k6)((()=>["sales"===t.value?((0,u.uX)(),(0,u.Wv)(y,{key:0,label:"æ“ä½œ",width:"85",fixed:"left","header-align":"center"},{default:(0,u.k6)((({row:e})=>[o.value!==e.id?((0,u.uX)(),(0,u.CE)("div",YC,[(0,u.bF)(g,{type:"primary",size:"default",onClick:a=>E(e)},{default:(0,u.k6)((()=>a[13]||(a[13]=[(0,u.eW)("ç·¨è¼¯")]))),_:2},1032,["onClick"])])):((0,u.uX)(),(0,u.CE)("div",QC,[(0,u.bF)(g,{type:"success",style:{"margin-left":"-0.1rem"},size:"default",onClick:a=>A(e)},{default:(0,u.k6)((()=>a[14]||(a[14]=[(0,u.eW)("å®Œæˆ")]))),_:2},1032,["onClick"]),(0,u.bF)(g,{type:"info",style:{"margin-left":"-0.1rem"},size:"default",onClick:a[5]||(a[5]=e=>T())},{default:(0,u.k6)((()=>a[15]||(a[15]=[(0,u.eW)("å–æ¶ˆ")]))),_:1})]))])),_:1})):(0,u.Q3)("",!0),(0,u.bF)(y,{prop:"salesRepName",label:"sales"===t.value?"å§“å":"åœ°å€",width:"120",fixed:"left","header-align":"center"},{default:(0,u.k6)((({row:e})=>[(0,u.Lk)("span",null,(0,L.v_)(e.salesRepName),1)])),_:1},8,["label"]),((0,u.uX)(),(0,u.CE)(u.FK,null,(0,u.pI)(12,(e=>(0,u.bF)(y,{key:e,label:`${e}æœˆ`,width:"200","header-align":"center"},{default:(0,u.k6)((({row:a})=>["sales"===t.value?((0,u.uX)(),(0,u.CE)("div",HC,[o.value!==a.id?((0,u.uX)(),(0,u.CE)("div",qC,[(0,u.Lk)("div",null,"ç›®æ¨™: "+(0,L.v_)(_(a[`month${e}Target`])),1),(0,u.Lk)("div",null,"å¯¦éš›: "+(0,L.v_)(_(a[`month${e}Actual`])),1),(0,u.Lk)("div",null,"å¯¦éš›(åŽ»å¹´): "+(0,L.v_)(_(a[`month${e}LastYearActual`])),1),(0,u.Lk)("div",{style:(0,L.Tr)(F(a[`month${e}AchievementRate`]))},"ç›®æ¨™é”æˆçŽ‡: "+(0,L.v_)(a[`month${e}AchievementRate`]),5),(0,u.Lk)("div",{style:(0,L.Tr)(C(a[`month${e}Comparison`]))},"åŽ»å¹´æ¯”è¼ƒ: "+(0,L.v_)(a[`month${e}Comparison`]),5)])):((0,u.uX)(),(0,u.CE)("div",JC,[(0,u.bF)(f,{modelValue:a[`month${e}Target`],"onUpdate:modelValue":l=>a[`month${e}Target`]=l,size:"large",placeholder:"ç›®æ¨™",onChange:l=>w(a,e)},null,8,["modelValue","onUpdate:modelValue","onChange"])]))])):((0,u.uX)(),(0,u.CE)("div",GC,[(0,u.Lk)("div",null,"éŠ·å”®é¡: "+(0,L.v_)(_(a[`month${e}Actual`])),1),(0,u.Lk)("div",null,"éŠ·å”®é¡(åŽ»å¹´): "+(0,L.v_)(_(a[`month${e}LastYearActual`])),1),(0,u.Lk)("div",{style:(0,L.Tr)(C(a[`month${e}Comparison`]))},"åŽ»å¹´æ¯”è¼ƒ: "+(0,L.v_)(a[`month${e}Comparison`]),5)]))])),_:2},1032,["label"]))),64))])),_:1},8,["data"])):(0,u.Q3)("",!0)])]),"quarterly"===l.value?((0,u.uX)(),(0,u.CE)("div",ZC,[(0,u.bF)(h,{class:"form",data:r.value,style:{width:"100%","max-width":"75rem"}},{default:(0,u.k6)((()=>[(0,u.bF)(y,{prop:"salesRepName",label:"sales"===t.value?"å§“å":"åœ°å€",width:"120",fixed:"left","header-align":"center"},{default:(0,u.k6)((({row:e})=>[(0,u.Lk)("span",null,(0,L.v_)(e.salesRepName),1)])),_:1},8,["label"]),((0,u.uX)(),(0,u.CE)(u.FK,null,(0,u.pI)(4,(e=>(0,u.bF)(y,{key:e,label:`Q${e}`,width:"250","header-align":"center"},{default:(0,u.k6)((({row:a})=>["sales"===t.value?((0,u.uX)(),(0,u.CE)("div",eD,[(0,u.Lk)("div",null,"ç›®æ¨™: "+(0,L.v_)(_(a[`quarter${e}Target`])),1),(0,u.Lk)("div",null,"å¯¦éš›: "+(0,L.v_)(_(a[`quarter${e}Actual`])),1),(0,u.Lk)("div",null,"å¯¦éš›(åŽ»å¹´): "+(0,L.v_)(_(a[`quarter${e}LastYearActual`])),1),(0,u.Lk)("div",{style:(0,L.Tr)(F(a[`quarter${e}AchievementRate`]))},"ç›®æ¨™é”æˆçŽ‡:"+(0,L.v_)(a[`quarter${e}AchievementRate`]),5),(0,u.Lk)("div",{style:(0,L.Tr)(C(a[`quarter${e}Comparison`]))},"åŽ»å¹´æ¯”è¼ƒ: "+(0,L.v_)(a[`quarter${e}Comparison`]),5)])):((0,u.uX)(),(0,u.CE)("div",aD,[(0,u.Lk)("div",null,"éŠ·å”®é¡: "+(0,L.v_)(_(a[`quarter${e}Actual`])),1),(0,u.Lk)("div",null,"éŠ·å”®é¡(åŽ»å¹´): "+(0,L.v_)(_(a[`quarter${e}LastYearActual`])),1),(0,u.Lk)("div",{style:(0,L.Tr)(C(a[`quarter${e}Comparison`]))},"åŽ»å¹´æ¯”è¼ƒ: "+(0,L.v_)(a[`quarter${e}Comparison`]),5)]))])),_:2},1032,["label"]))),64))])),_:1},8,["data"])])):(0,u.Q3)("",!0),"yearly"===l.value?((0,u.uX)(),(0,u.CE)("div",lD,[(0,u.bF)(h,{class:"form",data:s.value,style:(0,L.Tr)("region"===t.value?"width: 100%; max-width: 25rem;":"width: 100%; max-width: 30rem;")},{default:(0,u.k6)((()=>["sales"===t.value?((0,u.uX)(),(0,u.Wv)(y,{key:0,label:"æ“ä½œ",width:"85",fixed:"left","header-align":"center"},{default:(0,u.k6)((({row:e})=>[o.value!==e.id?((0,u.uX)(),(0,u.CE)("div",tD,[(0,u.bF)(g,{type:"primary",size:"default",onClick:a=>E(e)},{default:(0,u.k6)((()=>a[16]||(a[16]=[(0,u.eW)("ç·¨è¼¯")]))),_:2},1032,["onClick"])])):((0,u.uX)(),(0,u.CE)("div",oD,[(0,u.bF)(g,{type:"success",size:"default",onClick:a=>A(e)},{default:(0,u.k6)((()=>a[17]||(a[17]=[(0,u.eW)("å®Œæˆ")]))),_:2},1032,["onClick"]),(0,u.bF)(g,{type:"info",size:"default",onClick:a[6]||(a[6]=e=>T())},{default:(0,u.k6)((()=>a[18]||(a[18]=[(0,u.eW)("å–æ¶ˆ")]))),_:1})]))])),_:1})):(0,u.Q3)("",!0),(0,u.bF)(y,{prop:"salesRepName",label:"sales"===t.value?"å§“å":"åœ°å€",width:"120",fixed:"left","header-align":"center"},{default:(0,u.k6)((({row:e})=>[(0,u.Lk)("span",null,(0,L.v_)(e.salesRepName),1)])),_:1},8,["label"]),(0,u.bF)(y,{label:"å¹´åº¦ç¸½è¨ˆ",width:"250","header-align":"center"},{default:(0,u.k6)((({row:e})=>["sales"===t.value?((0,u.uX)(),(0,u.CE)("div",nD,[o.value!==e.id?((0,u.uX)(),(0,u.CE)("div",rD,[(0,u.Lk)("div",null,"ç›®æ¨™: "+(0,L.v_)(_(e.yearTarget)),1),(0,u.Lk)("div",null,"å¯¦éš›: "+(0,L.v_)(_(e.yearActual)),1),(0,u.Lk)("div",null,"å¯¦éš›(åŽ»å¹´): "+(0,L.v_)(_(e.yearLastYearActual)),1),(0,u.Lk)("div",{style:(0,L.Tr)(F(e.yearAchievementRate))},"ç›®æ¨™é”æˆçŽ‡:"+(0,L.v_)(e.yearAchievementRate),5),(0,u.Lk)("div",{style:(0,L.Tr)(C(e.yearComparison))},"åŽ»å¹´æ¯”è¼ƒ: "+(0,L.v_)(e.yearComparison),5)])):((0,u.uX)(),(0,u.CE)("div",sD,[(0,u.bF)(f,{modelValue:e.yearTarget,"onUpdate:modelValue":a=>e.yearTarget=a,size:"large",placeholder:"ç›®æ¨™",onChange:a=>V(e)},null,8,["modelValue","onUpdate:modelValue","onChange"])]))])):((0,u.uX)(),(0,u.CE)("div",uD,[(0,u.Lk)("div",null,"éŠ·å”®é¡: "+(0,L.v_)(_(e.yearActual)),1),(0,u.Lk)("div",null,"éŠ·å”®é¡(åŽ»å¹´): "+(0,L.v_)(_(e.yearLastYearActual)),1),(0,u.Lk)("div",{style:(0,L.Tr)(C(e.yearComparison))},"åŽ»å¹´æ¯”è¼ƒ: "+(0,L.v_)(e.yearComparison),5)]))])),_:1})])),_:1},8,["data","style"])])):(0,u.Q3)("",!0)],64)}}};const dD=(0,ie.A)(iD,[["__scopeId","data-v-93eea2bc"]]);var cD=dD,pD=l(76230);const mD={style:{"margin-top":"5rem","text-align":"center"}},vD={class:"content-container"},bD={key:0},gD={key:0},yD={key:0},fD={key:0},hD={key:0},kD={key:0},_D={key:0},wD={key:0},FD={key:0},CD={class:"chart-section"},DD={class:"chart-header"},LD={class:"chart-legend"},RD={class:"legend-item"},VD={class:"legend-item"},ID={class:"chart-container"};var xD={__name:"PersonalGoals",setup(e){const a=(0,d.KR)(null),l=(0,S.k)(),t=(0,d.KR)("monthly"),o=(0,d.KR)(new Date),n=(0,d.KR)(!1),r=(0,d.KR)(null),s=e=>{r.value&&clearTimeout(r.value),n.value=!0,r.value=setTimeout((()=>{n.value=!1,r.value=null}),1500),console.log("[PG] selectedView ->",e),A()},i=(0,u.EW)((()=>o.value.getFullYear())),c=(0,u.EW)((()=>i.value-1)),p=(0,d.KR)(null),m=(0,d.KR)(null),v=e=>e.reduce(((e,a)=>e+(Number(a)||0)),0),b=(e,a)=>e.filter((e=>e&&void 0!==e[a]&&null!==e[a])).length,g=(0,d.KR)(0),y=e=>null===e||void 0===e?"":e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),f=(e,a)=>{if(!e||!a||0===e)return"-";const l=(a-e)/e*100,t=l>=0?"+":"";return`${t}${l.toFixed(1)}%`},h=e=>e&&"-"!==e?e.startsWith("+")?"positive-growth":e.startsWith("-")?"negative-growth":"":"",k=(0,d.KR)([]),_=(0,d.KR)([]),w=(0,d.KR)([]),F=()=>{const e=[];for(let a=1;a<=12;a++)e.push({id:a,month:`${a}æœˆ`,target:null,actual:null,lastYearActual:null,achievementRate:null,yearOverYearComparison:"-"});k.value=e},C=()=>{const e=[{id:1,quarter:"Q1",target:null,actual:null,lastYearActual:null,achievementRate:null,yearOverYearComparison:"-"},{id:2,quarter:"Q2",target:null,actual:null,lastYearActual:null,achievementRate:null,yearOverYearComparison:"-"},{id:3,quarter:"Q3",target:null,actual:null,lastYearActual:null,achievementRate:null,yearOverYearComparison:"-"},{id:4,quarter:"Q4",target:null,actual:null,lastYearActual:null,achievementRate:null,yearOverYearComparison:"-"}];_.value=e},R=()=>{const e=(new Date).getFullYear(),a=[{id:1,year:`${e}å¹´`,target:null,actual:null,lastYearActual:null,achievementRate:null,yearOverYearComparison:"-"}];w.value=a},V=(0,d.KR)(""),I=async()=>{V.value=l.userName.slice(-2);try{console.log("[PG] fetch start",{year:o.value.getFullYear(),empName:V.value});const e=await OC.getComBillAccounts(o.value.getFullYear(),V.value),a=await OC.getComBillAccounts(c.value,V.value),l=e.data.personalGoal,t=e.data.personalPerformance?.monthlyAmount||{},n=e.data.personalPerformance?.quarterAmount||{},r=e.data.personalPerformance?.yearlyAmount||0,s=a.data.personalPerformance?.monthlyAmount||{},u=a.data.personalPerformance?.quarterAmount||{},i=a.data.personalPerformance?.yearlyAmount||0;if(console.log("[PG] data existence",{hasPersonalGoal:!!l,hasMonthly:!!t,hasQuarter:!!n,hasYearly:!!r,hasLYMonthly:!!s,hasLYQuarter:!!u,hasLYYearly:!!i}),l&&t){const e=["january","february","march","april","may","june","july","august","september","october","november","december"];k.value.forEach((a=>{const o=e[a.id-1];a.target=l[o]??0,a.actual=t[o]??0,a.lastYearActual=s[o]??0,a.achievementRate=a.target?(a.actual/a.target*100).toFixed(1)+"%":"0.0%",a.yearOverYearComparison=f(a.lastYearActual,a.actual)}))}if(l&&n&&_.value.forEach((e=>{let a=0;for(let o=3*(e.id-1)+1;o<=3*e.id;o++){const e=new Date(2e3,o-1,1).toLocaleString("en-US",{month:"long"}).toLowerCase();a+=l[e]??0}const t=`q${e.id}`;e.target=a,e.actual=n[t]??0,e.lastYearActual=u[t]??0,e.achievementRate=e.target?(e.actual/e.target*100).toFixed(1)+"%":"0.0%",e.yearOverYearComparison=f(e.lastYearActual,e.actual)})),l&&w.value.length>0){const e=["january","february","march","april","may","june","july","august","september","october","november","december"];let a=0;e.forEach((e=>a+=l[e]??0)),w.value[0].target=a,w.value[0].actual=r??0,w.value[0].lastYearActual=i??0,w.value[0].achievementRate=a?(w.value[0].actual/a*100).toFixed(1)+"%":"0.0%",w.value[0].yearOverYearComparison=f(w.value[0].lastYearActual,w.value[0].actual)}console.log("[PG] table fill check",{monthly_len:k.value.length,monthly_target_defined:b(k.value,"target"),monthly_actual_defined:b(k.value,"actual"),monthly_lastYearActual_defined:b(k.value,"lastYearActual"),quarterly_len:_.value.length,yearly_len:w.value.length})}catch(e){console.error("ç²å–æ•¸æ“šå¤±æ•—ï¼š",e),D.nk.error("ç²å–æ•¸æ“šå¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦ã€‚")}finally{(0,u.dY)((()=>{console.log("[PG] fetch done -> renderChart()"),A()}))}},x=()=>{const e={monthly:"æœˆåº¦å¯¦éš›æ¥­ç¸¾æ¯”è¼ƒ",quarterly:"å­£åº¦å¯¦éš›æ¥­ç¸¾æ¯”è¼ƒ",yearly:"å¹´åº¦å¯¦éš›æ¥­ç¸¾æ¯”è¼ƒ"};return e[t.value]||"å¯¦éš›æ¥­ç¸¾æ¯”è¼ƒ"},E=()=>{p.value&&(p.value.destroy(),p.value=null)},A=()=>{const e=++g.value;(0,u.dY)((()=>{E(),T(e)}))},T=e=>{if(console.log(`[PG] createChart#${e} ref`,{hasRef:!!m.value}),!m.value)return void console.error("Chart canvas ref not found");let a=[];"monthly"===t.value?a=k.value:"quarterly"===t.value?a=_.value:"yearly"===t.value&&(a=w.value),a.length?(0,u.dY)((()=>{try{const l=m.value.getContext("2d");let o=[],n=[],r=[];"monthly"===t.value?(o=a.map((e=>e.month)),n=a.map((e=>Number(e.lastYearActual??0))),r=a.map((e=>Number(e.actual??0)))):"quarterly"===t.value?(o=a.map((e=>e.quarter)),n=a.map((e=>Number(e.lastYearActual??0))),r=a.map((e=>Number(e.actual??0)))):(o=a.map((e=>e.year)),n=a.map((e=>Number(e.lastYearActual??0))),r=a.map((e=>Number(e.actual??0)))),console.log(`[PG] createChart#${e} data summary`,{labels:o.length,lastYearSum:v(n),currentYearSum:v(r),sample_lastYear:n.slice(0,6),sample_current:r.slice(0,6)});const s={labels:o,datasets:[{label:`${c.value}å¯¦éš›æ¥­ç¸¾`,data:n,backgroundColor:"#36A2EB",borderColor:"#36A2EB",borderWidth:1},{label:`${i.value}å¯¦éš›æ¥­ç¸¾`,data:r,backgroundColor:"#FF6384",borderColor:"#FF6384",borderWidth:1}]};p.value=new pD["default"](l,{type:"bar",data:s,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!0,position:"top"}},scales:{y:{beginAtZero:!0,ticks:{callback:e=>y(e)}}}}}),console.log(`[PG] chart created#${e}`)}catch(l){console.error("Error creating PersonalGoals chart:",l)}})):console.error("No data available for chart")};return(0,u.wB)([k,_,w],(e=>{console.log("[PG] data changed (some array mutated)"),e&&e.some((e=>e&&e.length>0))}),{deep:!0,immediate:!0}),(0,u.sV)((async()=>{console.log("[PG] mounted, Chart.js version:",pD["default"].version),F(),C(),R(),await I(),(0,u.dY)((()=>{console.log("[PG] initial timed render"),k.value&&k.value.length>0?A():console.log("[PG] No data available for initial render")}))})),(0,u.xo)((()=>{E(),r.value&&(clearTimeout(r.value),r.value=null)})),(e,l)=>{const r=(0,u.g2)("el-date-picker"),d=(0,u.g2)("el-radio-button"),p=(0,u.g2)("el-radio-group"),v=(0,u.g2)("el-table-column"),b=(0,u.g2)("el-input"),g=((0,u.g2)("el-button"),(0,u.g2)("el-table")),f=(0,u.g2)("el-text");return(0,u.uX)(),(0,u.CE)("div",mD,[(0,u.Lk)("div",null,[(0,u.bF)(r,{modelValue:o.value,"onUpdate:modelValue":l[0]||(l[0]=e=>o.value=e),type:"year",size:"large",placeholder:"è«‹é¸æ“‡å¹´åº¦",style:{width:"11.5rem","margin-right":"2rem","margin-top":"0.5rem","font-size":"2rem"},onChange:I},null,8,["modelValue"]),(0,u.bF)(p,{modelValue:t.value,"onUpdate:modelValue":l[1]||(l[1]=e=>t.value=e),size:"large",fill:"#6cf",style:{"margin-bottom":"20px"},onChange:s,disabled:n.value},{default:(0,u.k6)((()=>[(0,u.bF)(d,{label:"monthly"},{default:(0,u.k6)((()=>l[5]||(l[5]=[(0,u.eW)("æœˆåº¦")]))),_:1}),(0,u.bF)(d,{label:"quarterly"},{default:(0,u.k6)((()=>l[6]||(l[6]=[(0,u.eW)("å­£åº¦")]))),_:1}),(0,u.bF)(d,{label:"yearly"},{default:(0,u.k6)((()=>l[7]||(l[7]=[(0,u.eW)("å¹´åº¦")]))),_:1})])),_:1},8,["modelValue","disabled"])]),(0,u.Lk)("div",vD,["monthly"===t.value?((0,u.uX)(),(0,u.Wv)(g,{key:0,class:"form monthly",data:k.value,style:{width:"782px"}},{default:(0,u.k6)((()=>[(0,u.bF)(v,{prop:"month",label:"æœˆä»½",width:"100",align:"center"}),(0,u.bF)(v,{label:`${i.value} ç›®æ¨™`,width:"140",align:"center"},{default:(0,u.k6)((({row:e})=>[a.value!==e.id?((0,u.uX)(),(0,u.CE)("span",bD,(0,L.v_)(y(e.target)),1)):((0,u.uX)(),(0,u.Wv)(b,{key:1,modelValue:e.target,"onUpdate:modelValue":a=>e.target=a,size:"small"},null,8,["modelValue","onUpdate:modelValue"]))])),_:1},8,["label"]),(0,u.bF)(v,{label:`${i.value}å¯¦éš›æ¥­ç¸¾`,width:"140",align:"center"},{default:(0,u.k6)((({row:e})=>[a.value!==e.id?((0,u.uX)(),(0,u.CE)("span",gD,(0,L.v_)(y(e.actual)),1)):((0,u.uX)(),(0,u.Wv)(b,{key:1,modelValue:e.actual,"onUpdate:modelValue":a=>e.actual=a,size:"small"},null,8,["modelValue","onUpdate:modelValue"]))])),_:1},8,["label"]),(0,u.bF)(v,{label:`${c.value}å¯¦éš›æ¥­ç¸¾`,width:"140",align:"center"},{default:(0,u.k6)((({row:e})=>[(0,u.Lk)("span",null,(0,L.v_)(y(e.lastYearActual)),1)])),_:1},8,["label"]),(0,u.bF)(v,{label:"é”æˆçŽ‡",width:"120",align:"center"},{default:(0,u.k6)((({row:e})=>[a.value!==e.id?((0,u.uX)(),(0,u.CE)("span",yD,(0,L.v_)(e.achievementRate),1)):((0,u.uX)(),(0,u.Wv)(b,{key:1,modelValue:e.achievementRate,"onUpdate:modelValue":a=>e.achievementRate=a,size:"small"},null,8,["modelValue","onUpdate:modelValue"]))])),_:1}),(0,u.bF)(v,{label:"åŽ»å¹´åŒæœŸæ¯”è¼ƒ",width:"140",align:"center"},{default:(0,u.k6)((({row:e})=>[(0,u.Lk)("span",{class:(0,L.C4)(h(e.yearOverYearComparison))},(0,L.v_)(e.yearOverYearComparison),3)])),_:1}),(0,u.Q3)("",!0)])),_:1},8,["data"])):(0,u.Q3)("",!0),"quarterly"===t.value?((0,u.uX)(),(0,u.Wv)(g,{key:1,class:"form quarterly",data:_.value,style:{width:"782px"}},{default:(0,u.k6)((()=>[(0,u.bF)(v,{prop:"quarter",label:"å­£åº¦",width:"100",align:"center"}),(0,u.bF)(v,{label:`${i.value} ç›®æ¨™`,width:"140",align:"center"},{default:(0,u.k6)((({row:e})=>[a.value!==e.id?((0,u.uX)(),(0,u.CE)("span",fD,(0,L.v_)(y(e.target)),1)):((0,u.uX)(),(0,u.Wv)(b,{key:1,modelValue:e.target,"onUpdate:modelValue":a=>e.target=a,size:"small"},null,8,["modelValue","onUpdate:modelValue"]))])),_:1},8,["label"]),(0,u.bF)(v,{label:`${i.value}å¯¦éš›æ¥­ç¸¾`,width:"140",align:"center"},{default:(0,u.k6)((({row:e})=>[a.value!==e.id?((0,u.uX)(),(0,u.CE)("span",hD,(0,L.v_)(y(e.actual)),1)):((0,u.uX)(),(0,u.Wv)(b,{key:1,modelValue:e.actual,"onUpdate:modelValue":a=>e.actual=a,size:"small"},null,8,["modelValue","onUpdate:modelValue"]))])),_:1},8,["label"]),(0,u.bF)(v,{label:`${c.value}å¯¦éš›æ¥­ç¸¾`,width:"140",align:"center"},{default:(0,u.k6)((({row:e})=>[(0,u.Lk)("span",null,(0,L.v_)(y(e.lastYearActual)),1)])),_:1},8,["label"]),(0,u.bF)(v,{label:"é”æˆçŽ‡",width:"120",align:"center"},{default:(0,u.k6)((({row:e})=>[a.value!==e.id?((0,u.uX)(),(0,u.CE)("span",kD,(0,L.v_)(e.achievementRate),1)):((0,u.uX)(),(0,u.Wv)(b,{key:1,modelValue:e.achievementRate,"onUpdate:modelValue":a=>e.achievementRate=a,size:"small"},null,8,["modelValue","onUpdate:modelValue"]))])),_:1}),(0,u.bF)(v,{label:"åŽ»å¹´åŒæœŸæ¯”è¼ƒ",width:"140",align:"center"},{default:(0,u.k6)((({row:e})=>[(0,u.Lk)("span",{class:(0,L.C4)(h(e.yearOverYearComparison))},(0,L.v_)(e.yearOverYearComparison),3)])),_:1}),(0,u.Q3)("",!0)])),_:1},8,["data"])):(0,u.Q3)("",!0),"yearly"===t.value?((0,u.uX)(),(0,u.Wv)(g,{key:2,class:"form yearly",data:w.value,style:{width:"782px"}},{default:(0,u.k6)((()=>[(0,u.bF)(v,{prop:"year",label:"å¹´åº¦",width:"100",align:"center"}),(0,u.bF)(v,{label:`${i.value} ç›®æ¨™`,width:"140",align:"center"},{default:(0,u.k6)((({row:e})=>[a.value!==e.id?((0,u.uX)(),(0,u.CE)("span",_D,(0,L.v_)(y(e.target)),1)):((0,u.uX)(),(0,u.Wv)(b,{key:1,modelValue:e.target,"onUpdate:modelValue":a=>e.target=a,size:"small"},null,8,["modelValue","onUpdate:modelValue"]))])),_:1},8,["label"]),(0,u.bF)(v,{label:`${i.value}å¯¦éš›æ¥­ç¸¾`,width:"140",align:"center"},{default:(0,u.k6)((({row:e})=>[a.value!==e.id?((0,u.uX)(),(0,u.CE)("span",wD,(0,L.v_)(y(e.actual)),1)):((0,u.uX)(),(0,u.Wv)(b,{key:1,modelValue:e.actual,"onUpdate:modelValue":a=>e.actual=a,size:"small"},null,8,["modelValue","onUpdate:modelValue"]))])),_:1},8,["label"]),(0,u.bF)(v,{label:`${c.value}å¯¦éš›æ¥­ç¸¾`,width:"140",align:"center"},{default:(0,u.k6)((({row:e})=>[(0,u.Lk)("span",null,(0,L.v_)(y(e.lastYearActual)),1)])),_:1},8,["label"]),(0,u.bF)(v,{label:"é”æˆçŽ‡",width:"120",align:"center"},{default:(0,u.k6)((({row:e})=>[a.value!==e.id?((0,u.uX)(),(0,u.CE)("span",FD,(0,L.v_)(e.achievementRate),1)):((0,u.uX)(),(0,u.Wv)(b,{key:1,modelValue:e.achievementRate,"onUpdate:modelValue":a=>e.achievementRate=a,size:"small"},null,8,["modelValue","onUpdate:modelValue"]))])),_:1}),(0,u.bF)(v,{label:"åŽ»å¹´åŒæœŸæ¯”è¼ƒ",width:"140",align:"center"},{default:(0,u.k6)((({row:e})=>[(0,u.Lk)("span",{class:(0,L.C4)(h(e.yearOverYearComparison))},(0,L.v_)(e.yearOverYearComparison),3)])),_:1}),(0,u.Q3)("",!0)])),_:1},8,["data"])):(0,u.Q3)("",!0),(0,u.Lk)("div",CD,[(0,u.Lk)("div",DD,[(0,u.bF)(f,{style:{color:"white","font-size":"1.5rem"},tag:"b",class:"mx-1"},{default:(0,u.k6)((()=>[(0,u.eW)((0,L.v_)(x()),1)])),_:1}),(0,u.Lk)("div",LD,[(0,u.Lk)("div",RD,[l[17]||(l[17]=(0,u.Lk)("span",{class:"legend-color prev-year"},null,-1)),(0,u.Lk)("span",null,(0,L.v_)(c.value)+"å¯¦éš›æ¥­ç¸¾",1)]),(0,u.Lk)("div",VD,[l[18]||(l[18]=(0,u.Lk)("span",{class:"legend-color curr-year"},null,-1)),(0,u.Lk)("span",null,(0,L.v_)(i.value)+"å¯¦éš›æ¥­ç¸¾",1)])])]),(0,u.Lk)("div",ID,[(0,u.Lk)("canvas",{ref_key:"comparisonChartRef",ref:m,id:"comparisonChart"},null,512)])])])])}}};const ED=(0,ie.A)(xD,[["__scopeId","data-v-18525628"]]);var AD=ED;const TD={class:"dashboard-section"},WD={class:"table-section"},SD={class:"header-content"},UD={class:"year-selector-compact"},$D={class:"total-summary"},ND={class:"total-item"},XD={class:"total-label"},KD={class:"total-value",style:{"font-size":"1.5rem"}},MD={class:"total-item"},PD={class:"total-label"},OD={class:"total-value",style:{"font-size":"1.5rem"}},zD={class:"total-item"},BD={class:"chart-section"},jD={class:"header-content"},YD={class:"legend-item"},QD={style:{"font-size":"1.5rem"}},HD={class:"legend-item"},qD={style:{"font-size":"1.5rem"}};var JD={__name:"AnnualPerformanceSection",props:{selectedYear:{type:Number,required:!0},availableYears:{type:Array,required:!0},performanceData:{type:Array,required:!0},loading:{type:Boolean,default:!1}},emits:["yearChange"],setup(e,{expose:a,emit:l}){const o=e,n=l,r=(0,d.KR)(null),s=(0,d.KR)(null),{width:i}=(0,Ql.lWr)(),c=(0,u.EW)((()=>i.value<=768)),p=(0,d.KR)(!1),m=(0,d.KR)(!1),v=e=>{"table"===e?p.value=!p.value:"chart"===e&&(m.value=!m.value,m.value&&(0,u.dY)((()=>{g()})))},b=()=>{r.value&&(r.value.destroy(),r.value=null)},g=()=>{console.log("AnnualPerformanceSection renderChart called"),console.log("performanceData:",o.performanceData),(0,u.dY)((()=>{b(),y()}))},y=()=>{console.log("é–‹å§‹å‰µå»º Annual Performance Chart"),console.log("performanceChartRef:",s.value),s.value?o.performanceData.length?(0,u.dY)((()=>{try{const e=s.value.getContext("2d"),a={labels:o.performanceData.map((e=>e.monthName)),datasets:[{label:o.selectedYear-1+"å¹´æ¥­ç¸¾",data:o.performanceData.map((e=>parseFloat(e.prevYear)||0)),backgroundColor:"#36A2EB",borderColor:"#36A2EB",borderWidth:1},{label:`${o.selectedYear}å¹´æ¥­ç¸¾`,data:o.performanceData.map((e=>parseFloat(e.currYear)||0)),backgroundColor:"#FF6384",borderColor:"#FF6384",borderWidth:1}]};console.log("Annual Chart data:",a),r.value=new pD["default"](e,{type:"bar",data:a,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!0,position:"top"}},scales:{y:{beginAtZero:!0}}}}),console.log("Annual Performance chart created successfully:",r.value)}catch(e){console.error("Error creating annual performance chart:",e)}})):console.error("No performance data available"):console.error("Performance chart canvas ref not found")},f=e=>null===e||void 0===e||0===e?"0":new Intl.NumberFormat("zh-TW",{style:"currency",currency:"TWD",minimumFractionDigits:0,maximumFractionDigits:0}).format(e),h=e=>{const a=parseFloat(e.prevYear)||0,l=parseFloat(e.currYear)||0;return 0===a?l>0?100:0:(l-a)/a*100},k=e=>{const a=h(e);return 0===a&&0===parseFloat(e.prevYear)&&0===parseFloat(e.currYear)?"-":`${a>0?"+":""}${a.toFixed(1)}%`},_=e=>{const a=h(e);return a>0?"growth-positive":a<0?"growth-negative":"growth-neutral"},w=()=>o.performanceData.length?o.performanceData.reduce(((e,a)=>e+(parseFloat(a.prevYear)||0)),0):0,F=()=>o.performanceData.length?o.performanceData.reduce(((e,a)=>e+(parseFloat(a.currYear)||0)),0):0,C=()=>{const e=w(),a=F();if(0===e)return a>0?"+100.0%":"0.0%";const l=(a-e)/e*100;return`${l>0?"+":""}${l.toFixed(1)}%`},D=()=>{const e=parseFloat(C().replace(/[+%]/g,""));return e>0?"positive":e<0?"negative":"neutral"};return(0,u.wB)((()=>o.performanceData),(e=>{console.log("AnnualPerformanceSection performanceData changed:",e),e&&e.length>0&&g()}),{deep:!0,immediate:!0}),(0,u.wB)((()=>o.selectedYear),(()=>{console.log("AnnualPerformanceSection selectedYear changed")})),(0,u.sV)((()=>{console.log("AnnualPerformanceSection mounted"),console.log("Initial props.performanceData:",o.performanceData),(0,u.dY)((()=>{console.log("=== AnnualPerformanceSection åˆå§‹åŒ–æ¸²æŸ“ ==="),console.log("performanceData at render time:",o.performanceData),o.performanceData&&o.performanceData.length>0?g():console.log("No data available for initial render")}))})),(0,u.xo)((()=>{b()})),a({renderChart:g}),(a,l)=>{const o=(0,u.g2)("el-text"),r=(0,u.g2)("el-option"),i=(0,u.g2)("el-select"),b=(0,u.g2)("el-icon"),g=(0,u.g2)("el-table-column"),y=(0,u.g2)("el-table"),h=(0,u.gN)("loading");return(0,u.uX)(),(0,u.CE)("div",TD,[(0,u.Lk)("div",WD,[(0,u.Lk)("div",{class:(0,L.C4)(["table-header",{"mobile-collapsible":c.value}]),onClick:l[2]||(l[2]=e=>c.value&&v("table"))},[(0,u.Lk)("div",SD,[(0,u.bF)(o,{style:{color:"white","font-size":"1.5rem"},tag:"b",class:(0,L.C4)(["mx-1 year",{"mobile-large-title":c.value}])},{default:(0,u.k6)((()=>l[4]||(l[4]=[(0,u.eW)("å…¨å¹´åº¦æ¥­ç¸¾æ•¸æ“š")]))),_:1},8,["class"]),(0,u.Lk)("div",UD,[(0,u.bF)(o,{style:{color:"white","font-size":"1.5rem"},tag:"b",class:(0,L.C4)(["mx-1",{"mobile-large-title":c.value}])},{default:(0,u.k6)((()=>l[5]||(l[5]=[(0,u.eW)(" é¸æ“‡å¹´ä»½ ")]))),_:1},8,["class"]),(0,u.bF)(i,{id:"yearSelect","model-value":e.selectedYear,"onUpdate:modelValue":l[0]||(l[0]=e=>n("yearChange",e)),placeholder:"è«‹é¸æ“‡å¹´ä»½",size:c.value?"small":"large",style:{width:"8rem"},onClick:l[1]||(l[1]=(0,t.D$)((()=>{}),["stop"]))},{default:(0,u.k6)((()=>[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(e.availableYears,(e=>((0,u.uX)(),(0,u.Wv)(r,{key:e,label:e,value:e},null,8,["label","value"])))),128))])),_:1},8,["model-value","size"])]),c.value?((0,u.uX)(),(0,u.Wv)(b,{key:0,class:(0,L.C4)(["collapse-icon",{rotated:p.value}])},{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.ArrowDown))])),_:1},8,["class"])):(0,u.Q3)("",!0)])],2),(0,u.Lk)("div",{class:(0,L.C4)(["table-wrapper",{"mobile-hidden":c.value&&!p.value,"desktop-centered":!c.value}])},[(0,u.bo)(((0,u.uX)(),(0,u.Wv)(y,{data:e.performanceData,border:"",stripe:"",class:"performance-table",style:{"font-size":"1.3rem"}},{default:(0,u.k6)((()=>[(0,u.bF)(g,{prop:"monthName",label:"æœˆ",width:c.value?40:80,align:"center"},null,8,["width"]),(0,u.bF)(g,{prop:"prevYear",label:e.selectedYear-1+"å¹´",align:"center",width:c.value?90:200},{default:(0,u.k6)((e=>[(0,u.eW)((0,L.v_)(f(e.row.prevYear)),1)])),_:1},8,["label","width"]),(0,u.bF)(g,{prop:"currYear",label:`${e.selectedYear}å¹´`,align:"center",width:c.value?90:200},{default:(0,u.k6)((e=>[(0,u.eW)((0,L.v_)(f(e.row.currYear)),1)])),_:1},8,["label","width"]),(0,u.bF)(g,{label:"æˆé•·çŽ‡",align:"center",width:c.value?85:200},{default:(0,u.k6)((e=>[(0,u.Lk)("span",{class:(0,L.C4)(_(e.row))},(0,L.v_)(k(e.row)),3)])),_:1},8,["width"])])),_:1},8,["data"])),[[h,e.loading]])],2),(0,u.Lk)("div",$D,[(0,u.Lk)("div",ND,[(0,u.Lk)("span",XD,(0,L.v_)(e.selectedYear-1)+"å¹´ç¸½æ¥­ç¸¾",1),(0,u.Lk)("span",KD,(0,L.v_)(f(w())),1)]),(0,u.Lk)("div",MD,[(0,u.Lk)("span",PD,(0,L.v_)(e.selectedYear)+"å¹´ç¸½æ¥­ç¸¾",1),(0,u.Lk)("span",OD,(0,L.v_)(f(F())),1)]),(0,u.Lk)("div",zD,[l[6]||(l[6]=(0,u.Lk)("span",{class:"total-label"},"å¹´åº¦æˆé•·çŽ‡",-1)),(0,u.Lk)("span",{class:(0,L.C4)(["total-value",D()]),style:{"font-size":"1.5rem"}},(0,L.v_)(C()),3)])])]),(0,u.Lk)("div",BD,[(0,u.Lk)("div",{class:(0,L.C4)(["chart-header",{"mobile-collapsible":c.value}]),onClick:l[3]||(l[3]=e=>c.value&&v("chart"))},[(0,u.Lk)("div",jD,[(0,u.bF)(o,{style:{color:"white","font-size":"1.5rem"},tag:"b",class:"mx-1 chart"},{default:(0,u.k6)((()=>l[7]||(l[7]=[(0,u.eW)("å…¨å¹´åº¦æ¥­ç¸¾æ¯”è¼ƒ")]))),_:1}),c.value?((0,u.uX)(),(0,u.Wv)(b,{key:0,class:(0,L.C4)(["collapse-icon",{rotated:m.value}])},{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.ArrowDown))])),_:1},8,["class"])):(0,u.Q3)("",!0)]),(0,u.Lk)("div",{class:(0,L.C4)(["chart-legend",{"mobile-hidden":c.value&&!m.value}])},[(0,u.Lk)("div",YD,[l[8]||(l[8]=(0,u.Lk)("span",{class:"legend-color prev-year",style:{width:"1.5rem",height:"1.5rem"}},null,-1)),(0,u.Lk)("span",QD,(0,L.v_)(e.selectedYear-1)+"å¹´",1)]),(0,u.Lk)("div",HD,[l[9]||(l[9]=(0,u.Lk)("span",{class:"legend-color curr-year",style:{width:"1.5rem",height:"1.5rem"}},null,-1)),(0,u.Lk)("span",qD,(0,L.v_)(e.selectedYear)+"å¹´",1)])],2)],2),(0,u.Lk)("div",{class:(0,L.C4)(["chart-container",{"mobile-hidden":c.value&&!m.value}])},[(0,u.Lk)("canvas",{ref_key:"performanceChartRef",ref:s,id:"performanceChart"},null,512)],2)])])}}};const GD=(0,ie.A)(JD,[["__scopeId","data-v-5a8359ce"]]);var ZD=GD;const eL={class:"dashboard-section"},aL={class:"table-section"},lL={class:"header-content"},tL={class:"month-selector-compact"},oL={class:"total-summary"},nL={class:"total-item"},rL={class:"total-label"},sL={class:"total-value",style:{"font-size":"1.5rem"}},uL={class:"total-item"},iL={class:"total-label"},dL={class:"total-value",style:{"font-size":"1.5rem"}},cL={class:"total-item"},pL={class:"chart-section"},mL={class:"header-content"},vL={class:"legend-item"},bL={style:{color:"white","font-size":"1.5rem"}},gL={class:"legend-item"},yL={style:{color:"white","font-size":"1.5rem"}};var fL={__name:"CumulativePerformanceSection",props:{selectedYear:{type:Number,required:!0},selectedMonth:{type:Number,required:!0},cumulativeData:{type:Array,required:!0},loading:{type:Boolean,default:!1}},emits:["monthChange"],setup(e,{expose:a,emit:l}){const{width:o}=(0,Ql.lWr)(),n=(0,u.EW)((()=>o.value<=768)),r=(0,d.KR)(!1),s=(0,d.KR)(!1),i=e=>{"table"===e?r.value=!r.value:"chart"===e&&(s.value=!s.value,s.value&&(0,u.dY)((()=>{y()})))},c=e,p=l,m=(0,d.KR)(null),v=(0,d.KR)(null),b=["ä¸€æœˆ","äºŒæœˆ","ä¸‰æœˆ","å››æœˆ","äº”æœˆ","å…­æœˆ","ä¸ƒæœˆ","å…«æœˆ","ä¹æœˆ","åæœˆ","åä¸€æœˆ","åäºŒæœˆ"],g=()=>{m.value&&(m.value.destroy(),m.value=null)},y=()=>{console.log("CumulativePerformanceSection renderChart called"),console.log("cumulativeData:",c.cumulativeData),(0,u.dY)((()=>{g(),f()}))},f=()=>{console.log("é–‹å§‹å‰µå»º Cumulative Performance Chart"),console.log("cumulativeChartRef:",v.value),v.value?c.cumulativeData.length?(0,u.dY)((()=>{try{const e=v.value.getContext("2d");console.log("Canvas context:",e);const a={labels:c.cumulativeData.map((e=>e.monthName)),datasets:[{label:c.selectedYear-1+"å¹´æ¥­ç¸¾",data:c.cumulativeData.map((e=>parseFloat(e.prevYear)||0)),backgroundColor:"#36A2EB",borderColor:"#36A2EB",borderWidth:1},{label:`${c.selectedYear}å¹´æ¥­ç¸¾`,data:c.cumulativeData.map((e=>parseFloat(e.currYear)||0)),backgroundColor:"#FF6384",borderColor:"#FF6384",borderWidth:1}]};console.log("Cumulative Chart data:",a),m.value=new pD["default"](e,{type:"bar",data:a,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!0,position:"top"}},scales:{y:{beginAtZero:!0}}}}),console.log("Cumulative Performance chart created successfully:",m.value)}catch(e){console.error("Error creating cumulative performance chart:",e)}})):console.error("No cumulative data available"):console.error("Cumulative chart canvas ref not found")},h=e=>null===e||void 0===e||0===e?"0":new Intl.NumberFormat("zh-TW",{style:"currency",currency:"TWD",minimumFractionDigits:0,maximumFractionDigits:0}).format(e),k=e=>{const a=parseFloat(e.prevYear)||0,l=parseFloat(e.currYear)||0;return 0===a?l>0?100:0:(l-a)/a*100},_=e=>{const a=k(e);return 0===a&&0===parseFloat(e.prevYear)&&0===parseFloat(e.currYear)?"-":`${a>0?"+":""}${a.toFixed(1)}%`},w=e=>{const a=k(e);return a>0?"growth-positive":a<0?"growth-negative":"growth-neutral"},F=()=>c.cumulativeData.length?c.cumulativeData.reduce(((e,a)=>e+(parseFloat(a.prevYear)||0)),0):0,C=()=>c.cumulativeData.length?c.cumulativeData.reduce(((e,a)=>e+(parseFloat(a.currYear)||0)),0):0,D=()=>{const e=F(),a=C();if(0===e)return a>0?"+100.0%":"0.0%";const l=(a-e)/e*100;return`${l>0?"+":""}${l.toFixed(1)}%`},R=()=>{const e=parseFloat(D().replace(/[+%]/g,""));return e>0?"positive":e<0?"negative":"neutral"};return(0,u.wB)((()=>c.cumulativeData),(e=>{console.log("CumulativePerformanceSection cumulativeData changed:",e),e&&e.length>0&&y()}),{deep:!0,immediate:!0}),(0,u.wB)((()=>c.selectedMonth),(()=>{console.log("CumulativePerformanceSection selectedMonth changed"),y()})),(0,u.wB)((()=>c.selectedYear),(()=>{console.log("CumulativePerformanceSection selectedYear changed")})),(0,u.sV)((()=>{console.log("CumulativePerformanceSection mounted"),console.log("Initial props.cumulativeData:",c.cumulativeData),(0,u.dY)((()=>{console.log("=== CumulativePerformanceSection åˆå§‹åŒ–æ¸²æŸ“ ==="),console.log("cumulativeData at render time:",c.cumulativeData),c.cumulativeData&&c.cumulativeData.length>0?y():console.log("No cumulative data available for initial render")}))})),(0,u.xo)((()=>{g()})),a({renderChart:y}),(a,l)=>{const o=(0,u.g2)("el-text"),c=(0,u.g2)("el-option"),m=(0,u.g2)("el-select"),g=(0,u.g2)("el-icon"),y=(0,u.g2)("el-table-column"),f=(0,u.g2)("el-table"),k=(0,u.gN)("loading");return(0,u.uX)(),(0,u.CE)("div",eL,[(0,u.Lk)("div",aL,[(0,u.Lk)("div",{class:(0,L.C4)(["table-header",{"mobile-collapsible":n.value}]),onClick:l[2]||(l[2]=e=>n.value&&i("table"))},[(0,u.Lk)("div",lL,[(0,u.bF)(o,{style:{color:"white","font-size":"1.5rem"},tag:"b",class:(0,L.C4)(["mx-1 month",{"mobile-large-title":n.value}])},{default:(0,u.k6)((()=>l[4]||(l[4]=[(0,u.eW)("æˆªè‡³æœˆä»½æ¥­ç¸¾æ•¸æ“š")]))),_:1},8,["class"]),(0,u.Lk)("div",tL,[(0,u.bF)(o,{style:{color:"white","font-size":"1.5rem"},tag:"b",class:(0,L.C4)(["mx-1",{"mobile-large-title":n.value}])},{default:(0,u.k6)((()=>l[5]||(l[5]=[(0,u.eW)("æˆªè‡³æœˆä»½")]))),_:1},8,["class"]),(0,u.bF)(m,{id:"monthSelect","model-value":e.selectedMonth,"onUpdate:modelValue":l[0]||(l[0]=e=>p("monthChange",e)),placeholder:"è«‹é¸æ“‡æœˆä»½",size:n.value?"small":"large",style:{width:"8rem"},onClick:l[1]||(l[1]=(0,t.D$)((()=>{}),["stop"]))},{default:(0,u.k6)((()=>[((0,u.uX)(),(0,u.CE)(u.FK,null,(0,u.pI)(b,((e,a)=>(0,u.bF)(c,{key:a+1,label:e,value:a+1},null,8,["label","value"]))),64))])),_:1},8,["model-value","size"])]),n.value?((0,u.uX)(),(0,u.Wv)(g,{key:0,class:(0,L.C4)(["collapse-icon",{rotated:r.value}])},{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.ArrowDown))])),_:1},8,["class"])):(0,u.Q3)("",!0)])],2),(0,u.Lk)("div",{class:(0,L.C4)(["table-wrapper",{"mobile-hidden":n.value&&!r.value}])},[(0,u.bo)(((0,u.uX)(),(0,u.Wv)(f,{data:e.cumulativeData,border:"",stripe:"",class:"performance-table",style:{"font-size":"1.3rem"}},{default:(0,u.k6)((()=>[(0,u.bF)(y,{prop:"monthName",label:"æœˆ",width:n.value?40:80,align:"center"},null,8,["width"]),(0,u.bF)(y,{prop:"prevYear",label:e.selectedYear-1+"å¹´",align:"center",width:n.value?90:200},{default:(0,u.k6)((e=>[(0,u.eW)((0,L.v_)(h(e.row.prevYear)),1)])),_:1},8,["label","width"]),(0,u.bF)(y,{prop:"currYear",label:`${e.selectedYear}å¹´`,align:"center",width:n.value?90:200},{default:(0,u.k6)((e=>[(0,u.eW)((0,L.v_)(h(e.row.currYear)),1)])),_:1},8,["label","width"]),(0,u.bF)(y,{label:"æˆé•·çŽ‡",align:"center",width:n.value?85:200},{default:(0,u.k6)((e=>[(0,u.Lk)("span",{class:(0,L.C4)(w(e.row))},(0,L.v_)(_(e.row)),3)])),_:1},8,["width"])])),_:1},8,["data"])),[[k,e.loading]])],2),(0,u.Lk)("div",oL,[(0,u.Lk)("div",nL,[(0,u.Lk)("span",rL,(0,L.v_)(e.selectedYear-1)+"å¹´ç¸½æ¥­ç¸¾",1),(0,u.Lk)("span",sL,(0,L.v_)(h(F())),1)]),(0,u.Lk)("div",uL,[(0,u.Lk)("span",iL,(0,L.v_)(e.selectedYear)+"å¹´ç¸½æ¥­ç¸¾",1),(0,u.Lk)("span",dL,(0,L.v_)(h(C())),1)]),(0,u.Lk)("div",cL,[l[6]||(l[6]=(0,u.Lk)("span",{class:"total-label"},"å¹´åº¦æˆé•·çŽ‡",-1)),(0,u.Lk)("span",{class:(0,L.C4)(["total-value",R()]),style:{"font-size":"1.5rem"}},(0,L.v_)(D()),3)])])]),(0,u.Lk)("div",pL,[(0,u.Lk)("div",{class:(0,L.C4)(["chart-header",{"mobile-collapsible":n.value}]),onClick:l[3]||(l[3]=e=>n.value&&i("chart"))},[(0,u.Lk)("div",mL,[(0,u.bF)(o,{style:{color:"white","font-size":"1.5rem"},tag:"b",class:"mx-1 chart"},{default:(0,u.k6)((()=>[(0,u.eW)("æˆªè‡³"+(0,L.v_)(e.selectedMonth?b[e.selectedMonth-1]:"ä¸€æœˆ")+"æ¥­ç¸¾æ¯”è¼ƒ",1)])),_:1}),n.value?((0,u.uX)(),(0,u.Wv)(g,{key:0,class:(0,L.C4)(["collapse-icon",{rotated:s.value}])},{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.ArrowDown))])),_:1},8,["class"])):(0,u.Q3)("",!0)]),(0,u.Lk)("div",{class:(0,L.C4)(["chart-legend",{"mobile-hidden":n.value&&!s.value}])},[(0,u.Lk)("div",vL,[l[7]||(l[7]=(0,u.Lk)("span",{class:"legend-color prev-year",style:{width:"1.5rem",height:"1.5rem"}},null,-1)),(0,u.Lk)("span",bL,(0,L.v_)(e.selectedYear-1)+"å¹´",1)]),(0,u.Lk)("div",gL,[l[8]||(l[8]=(0,u.Lk)("span",{class:"legend-color curr-year",style:{width:"1.5rem",height:"1.5rem"}},null,-1)),(0,u.Lk)("span",yL,(0,L.v_)(e.selectedYear)+"å¹´",1)])],2)],2),(0,u.Lk)("div",{class:(0,L.C4)(["chart-container",{"mobile-hidden":n.value&&!s.value}])},[(0,u.Lk)("canvas",{ref_key:"cumulativeChartRef",ref:v,id:"cumulativeChart"},null,512)],2)])])}}};const hL=(0,ie.A)(fL,[["__scopeId","data-v-4b0ce6f2"]]);var kL=hL;const _L={class:"performance-dashboard"},wL={class:"dashboard-content"};var FL={__name:"PerformanceDashboard",setup(e){const a=(0,d.KR)((new Date).getFullYear()),l=(0,d.KR)((new Date).getMonth()+1),t=(0,d.KR)([]),o=(0,d.KR)([]),n=(0,d.KR)(!1),r=(0,d.KR)([]),s=(0,d.KR)(null),i=(0,d.KR)(null),c=()=>{const e=(new Date).getFullYear();r.value=[];for(let a=e;a>=e-10;a--)r.value.push(a)},p=async()=>{console.log("Fetching data for year:",a.value),n.value=!0;try{const e=await OC.getPerformanceDashboard(a.value);t.value=e.data,console.log("Performance data loaded:",t.value)}catch(e){console.error("ç²å–æ¥­ç¸¾æ•¸æ“šå¤±æ•—:",e),D.nk.error("ç²å–æ¥­ç¸¾æ•¸æ“šå¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦"),t.value=[{monthName:"ä¸€æœˆ",prevYear:15257759,currYear:12317448},{monthName:"äºŒæœˆ",prevYear:9232128,currYear:11567853},{monthName:"ä¸‰æœˆ",prevYear:18915076,currYear:20300348},{monthName:"å››æœˆ",prevYear:15105928,currYear:16985452},{monthName:"äº”æœˆ",prevYear:17566289,currYear:16295034},{monthName:"å…­æœˆ",prevYear:23408017,currYear:19855287}],console.log("Using test data:",t.value)}finally{n.value=!1,m()}},m=()=>{console.log("Updating cumulative data for month:",l.value),t.value.length&&(o.value=t.value.slice(0,l.value),console.log("Cumulative data updated:",o.value))},v=e=>{console.log("Year changed to:",e),a.value=e,p()},b=e=>{console.log("Month changed to:",e),l.value=e,m()},g=()=>{console.log("Forcing render of all charts"),(0,u.dY)((()=>{setTimeout((()=>{s.value&&(console.log("Triggering annual section chart render"),s.value.renderChart()),i.value&&(console.log("Triggering cumulative section chart render"),i.value.renderChart()),alert("forceRenderAllChartsè¦æ¸²æŸ“å›‰!")}),2e3)}))};return(0,u.sV)((()=>{console.log("PerformanceDashboard mounted"),c(),p(),window.forceRenderCharts=()=>{console.log("Force rendering charts from main component"),g()}})),(e,d)=>((0,u.uX)(),(0,u.CE)("div",_L,[d[0]||(d[0]=(0,u.Lk)("div",{class:"dashboard-header"},[(0,u.Lk)("h2",{style:{"font-size":"3rem"}},"æ¥­ç¸¾å„€è¡¨æ¿")],-1)),(0,u.Lk)("div",wL,[(0,u.bF)(ZD,{ref_key:"annualSection",ref:s,"selected-year":a.value,"available-years":r.value,"performance-data":t.value,loading:n.value,onYearChange:v},null,8,["selected-year","available-years","performance-data","loading"]),(0,u.bF)(kL,{ref_key:"cumulativeSection",ref:i,"selected-year":a.value,"selected-month":l.value,"cumulative-data":o.value,loading:n.value,onMonthChange:b},null,8,["selected-year","selected-month","cumulative-data","loading"])])]))}};const CL=(0,ie.A)(FL,[["__scopeId","data-v-e05b989a"]]);var DL=CL,LL={__name:"FillCustomerForm",setup(e){const a=(0,i.n)(),l=(0,S.k)(),t=(0,d.KR)(null),o=(0,d.KR)([]),n=["ç³»çµ±æ•´åˆå•†","è¨­å‚™å» å•†","æ°´é›»å» å•†","å¼±é›»å» å•†","å»ºç¯‰å¸«äº‹å‹™æ‰€","å®¤å…§è¨­è¨ˆå…¬å¸","å»ºè¨­ç‡Ÿé€ å…¬å¸","æ©Ÿé›»å·¥ç¨‹å…¬å¸","ç‰©æ¥­ç®¡ç†å…¬å¸","ç®¡ç†é¡§å•å…¬å¸","ä¼æ¥­","å­¸æ ¡","é†«é™¢","å…¬å®¶æ©Ÿé—œ","å·¥ç¨‹é¡§å•","é›»æ©ŸæŠ€å¸«"],s=(0,d.Kh)({customerId:"",customerName:"",shortName:"",fullCompanyName:"",companyAddress:"",companyRegion:"",otherCompanyRegion:"",contactName:"",customerType:"",email:"",phoneExtension:"",faxNum:"",mobilePhone:"",taxId:"",createdDate:new Date,createdBy:a.userId||"",customerSource:"",otherCustomerSource:"",responsibleArea:""}),c=(0,u.EW)((()=>{if(k.value&&l.userId){const e=k.value.find((e=>e.salespersonID===l.userId));return e?e.businessArea:""}return""}));const p={customerName:[{required:!0,message:"è«‹è¼¸å…¥å®¢æˆ¶å§“å",trigger:"change"}],contactName:[{required:!0,message:"è«‹è¼¸å…¥è¯çµ¡äººå§“å",trigger:"change"}],otherCompanyRegion:[{required:()=>"å…¶ä»–"===s.companyRegion,message:"è«‹è¼¸å…¥è‡ªè¨‚å…¬å¸å€åŸŸ",trigger:"blur"}],fullCompanyName:[{required:!0,message:"è«‹è¼¸å…¥å…¬å¸å…¨å",trigger:"change"}],customerType:[{required:!0,message:"è«‹é¸æ“‡å®¢æˆ¶é¡žåž‹",trigger:"change"}],companyAddress:[{required:!0,message:"è«‹è¼¸å…¥å…¬å¸åœ°å€",trigger:"change"}],customerSource:[{required:!0,message:"è«‹é¸æ“‡å®¢æˆ¶ä¾†æº",trigger:"change"}],otherCustomerSource:[{required:()=>"å…¶ä»–ç®¡é“"===s.customerSource,message:"è«‹è¼¸å…¥è‡ªè¨‚å®¢æˆ¶ä¾†æº",trigger:"blur"}],email:[{required:!0,message:"è«‹å¡«å¯«é›»å­éƒµä»¶",trigger:"change"},{type:"email",message:"è«‹è¼¸å…¥æœ‰æ•ˆçš„é›»å­éƒµä»¶åœ°å€ï¼Œä¾‹å¦‚: dae.david@gmail.com",trigger:["blur","change"]}],phoneExtension:[{validator:(e,a,l)=>{if(!s.phoneExtension&&!s.mobilePhone)return void l(new Error("é›»è©±(åˆ†æ©Ÿ)å’Œæ‰‹æ©Ÿè™Ÿç¢¼å¿…é ˆæ“‡ä¸€å¡«å¯«"));const t=/^(?:\d{2,4}-\d{6,8}|\d{2,4}-\d{4}-\d{4})(?:#\d+)?$/;s.phoneExtension&&!t.test(s.phoneExtension)?l(new Error("è«‹è¼¸å…¥æœ‰æ•ˆçš„é›»è©±(åˆ†æ©Ÿ)è™Ÿç¢¼ï¼Œä¾‹å¦‚: 02-1234-5678#123")):l()},trigger:"change"}],mobilePhone:[{validator:(e,a,l)=>{s.phoneExtension||s.mobilePhone?s.mobilePhone&&!/^09\d{2}\d{3}\d{3}$/.test(s.mobilePhone)?l(new Error("è«‹è¼¸å…¥æœ‰æ•ˆçš„æ‰‹æ©Ÿè™Ÿç¢¼ï¼Œä¾‹å¦‚: 0912345678")):l():l(new Error("é›»è©±(åˆ†æ©Ÿ)å’Œæ‰‹æ©Ÿè™Ÿç¢¼å¿…é ˆæ“‡ä¸€å¡«å¯«"))},trigger:"change"}]};function m(){t.value.resetFields(),s.responsibleArea=c.value}async function v(){t.value.validate((async e=>{if(!e)return;"å…¶ä»–"===s.companyRegion&&(s.companyRegion=s.otherCompanyRegion.trim()),"å…¶ä»–ç®¡é“"===s.customerSource&&(s.customerSource=s.otherCustomerSource.trim()),s.responsibleArea=c.value;const a=(0,d.ux)(s),t={CreatorID:l.userId,FormData:a};try{const e=await OC.createCustomerForm(t);e&&(D.nk.success("å®¢æˆ¶è³‡æ–™æ–°å¢žæˆåŠŸ!!"),m(),or.emit("customer-created")),console.log("å¾Œç«¯å›žå‚³ï¼š",e.data)}catch(o){D.nk.error("ä¸æ˜ŽåŽŸå› éŒ¯èª¤ï¼Œè«‹è¯ç¹«ç³»çµ±èª²å·¥ç¨‹å¸« !!"),console.error("é€å‡ºå¤±æ•—ï¼š",o)}}))}const b=(0,d.KR)([]),g=async()=>{try{const e=await OC.getComCustomer();b.value=e.data}catch(e){D.nk.error("è¼‰å…¥å®¢æˆ¶è³‡æ–™å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦"),console.error(e)}},y=async()=>{const e=await r.A.get("https://api.nlsc.gov.tw/other/ListCounty",{responseType:"text"}),a=new DOMParser,l=a.parseFromString(e.data,"application/xml"),t=l.getElementsByTagName("countyItem");o.value=Array.from(t).map((e=>{const a=e.getElementsByTagName("countyname")[0];return a?a.textContent.trim():""})).filter((e=>e))},f=(e,a)=>{const l=b.value||[],t=e?l.filter((a=>a.fullName.toLowerCase().includes(e.toLowerCase()))):[];a(t.map((e=>({value:e.fullName,...e}))))},h=e=>{s.customerId=e.customerId,s.shortName=e.shortName,s.contactName=e.linkMan,s.email=e.email,s.mobilePhone=e.mobileTel,s.faxNum=e.faxNum,s.phoneExtension=e.phoneExtension,s.taxId=e.taxId,s.companyAddress=e.companyAddress,s.customerName=e.customerName},k=(0,d.KR)(),_=async()=>{const e=await OC.getSalespersonBusinessArea();console.log(e.data),k.value=e.data};return(0,u.sV)((async()=>{try{await y(),await g(),await _()}catch(e){console.error("è³‡æ–™æŽ›è¼‰å¤±æ•—ï¼š",e)}})),(e,a)=>{(0,u.g2)("el-date-picker");const l=(0,u.g2)("el-form-item"),r=(0,u.g2)("el-autocomplete"),i=(0,u.g2)("el-input"),d=(0,u.g2)("el-option"),c=(0,u.g2)("el-select"),b=(0,u.g2)("el-button"),g=(0,u.g2)("el-form");return(0,u.uX)(),(0,u.Wv)(g,{ref_key:"formRef",ref:t,class:"fill-form-tracking",style:{"max-width":"100%","margin-bottom":"1rem"},model:s,rules:p,"label-width":"8rem","status-icon":"",inline:""},{default:(0,u.k6)((()=>[(0,u.Q3)("",!0),(0,u.bF)(l,{label:"å…¬å¸å…¨å",prop:"fullCompanyName"},{default:(0,u.k6)((()=>[(0,u.bF)(r,{modelValue:s.fullCompanyName,"onUpdate:modelValue":a[1]||(a[1]=e=>s.fullCompanyName=e),"fetch-suggestions":f,placeholder:"è¼¸å…¥å…¬å¸å…¨åå¾Œé¸æ“‡",onSelect:h,style:{width:"22rem"},clearable:"","trigger-on-focus":!1},null,8,["modelValue"])])),_:1}),(0,u.Q3)("",!0),(0,u.bF)(l,{label:"å®¢æˆ¶å§“å",prop:"customerName"},{default:(0,u.k6)((()=>[(0,u.bF)(i,{style:{width:"22rem"},modelValue:s.customerName,"onUpdate:modelValue":a[3]||(a[3]=e=>s.customerName=e),placeholder:"è«‹è¼¸å…¥å®¢æˆ¶å§“å"},null,8,["modelValue"])])),_:1}),(0,u.bF)(l,{label:"å…¬å¸ç°¡ç¨±",prop:"shortName"},{default:(0,u.k6)((()=>[(0,u.bF)(i,{style:{width:"22rem"},modelValue:s.shortName,"onUpdate:modelValue":a[4]||(a[4]=e=>s.shortName=e),placeholder:"è«‹è¼¸å…¥å…¬å¸ç°¡ç¨±"},null,8,["modelValue"])])),_:1}),(0,u.bF)(l,{label:"å…¬å¸åœ°å€",prop:"companyAddress"},{default:(0,u.k6)((()=>[(0,u.bF)(i,{style:{width:"22rem"},modelValue:s.companyAddress,"onUpdate:modelValue":a[5]||(a[5]=e=>s.companyAddress=e),placeholder:"è«‹è¼¸å…¥å…¬å¸åœ°å€"},null,8,["modelValue"])])),_:1}),(0,u.bF)(l,{label:"çµ±ä¸€ç·¨è™Ÿ",prop:"taxId"},{default:(0,u.k6)((()=>[(0,u.bF)(i,{style:{width:"22rem"},modelValue:s.taxId,"onUpdate:modelValue":a[6]||(a[6]=e=>s.taxId=e),placeholder:"è«‹è¼¸å…¥çµ±ä¸€ç·¨è™Ÿ"},null,8,["modelValue"])])),_:1}),(0,u.bF)(l,{label:"å…¬å¸å€åŸŸ",prop:"companyRegion"},{default:(0,u.k6)((()=>[(0,u.bF)(c,{modelValue:s.companyRegion,"onUpdate:modelValue":a[7]||(a[7]=e=>s.companyRegion=e),filterable:"","allow-create":"","default-first-option":"",placeholder:"è«‹é¸æ“‡æˆ–è¼¸å…¥å…¬å¸å€åŸŸ",style:{width:"22rem"},clearable:"",onChange:a[8]||(a[8]=()=>s.otherCompanyRegion="")},{default:(0,u.k6)((()=>[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(o.value,(e=>((0,u.uX)(),(0,u.Wv)(d,{key:e,label:e,value:e},null,8,["label","value"])))),128)),(0,u.bF)(d,{label:"å…¶ä»–",value:"å…¶ä»–"})])),_:1},8,["modelValue"])])),_:1}),"å…¶ä»–"===s.companyRegion?((0,u.uX)(),(0,u.Wv)(l,{key:2,label:"å…¶ä»–å…¬å¸å€åŸŸ",prop:"otherCompanyRegion"},{default:(0,u.k6)((()=>[(0,u.bF)(i,{modelValue:s.otherCompanyRegion,"onUpdate:modelValue":a[9]||(a[9]=e=>s.otherCompanyRegion=e),placeholder:"è«‹è¼¸å…¥å…¬å¸å€åŸŸ",style:{width:"22rem"}},null,8,["modelValue"])])),_:1})):(0,u.Q3)("",!0),(0,u.bF)(l,{label:"è¯çµ¡äººå§“å",prop:"contactName"},{default:(0,u.k6)((()=>[(0,u.bF)(i,{style:{width:"22rem"},modelValue:s.contactName,"onUpdate:modelValue":a[10]||(a[10]=e=>s.contactName=e),placeholder:"è«‹è¼¸å…¥è¯çµ¡äººå§“å"},null,8,["modelValue"])])),_:1}),(0,u.bF)(l,{label:"é›»å­éƒµä»¶",prop:"email"},{default:(0,u.k6)((()=>[(0,u.bF)(i,{style:{width:"22rem"},modelValue:s.email,"onUpdate:modelValue":a[11]||(a[11]=e=>s.email=e),placeholder:"è«‹è¼¸å…¥é›»å­éƒµä»¶"},null,8,["modelValue"])])),_:1}),(0,u.bF)(l,{class:"blue-error",prop:"mobilePhone"},{label:(0,u.k6)((()=>a[20]||(a[20]=[(0,u.Lk)("span",{style:{color:"blue","margin-right":"4px"}},"*",-1),(0,u.Lk)("span",null,"æ‰‹æ©Ÿè™Ÿç¢¼",-1)]))),default:(0,u.k6)((()=>[(0,u.bF)(i,{style:{width:"22rem"},modelValue:s.mobilePhone,"onUpdate:modelValue":a[12]||(a[12]=e=>s.mobilePhone=e),placeholder:"è«‹è¼¸å…¥æ‰‹æ©Ÿè™Ÿç¢¼"},null,8,["modelValue"])])),_:1}),(0,u.bF)(l,{class:"blue-error",prop:"phoneExtension"},{label:(0,u.k6)((()=>a[21]||(a[21]=[(0,u.Lk)("span",{style:{color:"blue","margin-right":"4px"}},"*",-1),(0,u.Lk)("span",null,"é›»è©±(åˆ†æ©Ÿ)",-1)]))),default:(0,u.k6)((()=>[(0,u.bF)(i,{style:{width:"22rem"},modelValue:s.phoneExtension,"onUpdate:modelValue":a[13]||(a[13]=e=>s.phoneExtension=e),placeholder:"ex: 02-1234-5678 ext.123"},null,8,["modelValue"])])),_:1}),(0,u.bF)(l,{label:"å‚³çœŸ",prop:"faxNum"},{default:(0,u.k6)((()=>[(0,u.bF)(i,{style:{width:"22rem"},modelValue:s.faxNum,"onUpdate:modelValue":a[14]||(a[14]=e=>s.faxNum=e),placeholder:"è«‹è¼¸å…¥å‚³çœŸè™Ÿç¢¼"},null,8,["modelValue"])])),_:1}),(0,u.bF)(l,{label:"å®¢æˆ¶ä¾†æº",prop:"customerSource"},{default:(0,u.k6)((()=>[(0,u.bF)(c,{modelValue:s.customerSource,"onUpdate:modelValue":a[15]||(a[15]=e=>s.customerSource=e),placeholder:"è«‹é¸æ“‡å®¢æˆ¶ä¾†æº",style:{width:"22rem"},clearable:"",onChange:a[16]||(a[16]=()=>s.otherCustomerSource="")},{default:(0,u.k6)((()=>[(0,u.bF)(d,{label:"é™Œç”Ÿé–‹ç™¼",value:"é™Œç”Ÿé–‹ç™¼"}),(0,u.bF)(d,{label:"å…¬å¸å®˜ç¶²",value:"å…¬å¸å®˜ç¶²"}),(0,u.bF)(d,{label:"ç¤¾ç¾¤åª’é«”",value:"ç¤¾ç¾¤åª’é«”"}),(0,u.bF)(d,{label:"å±•è¦½æ´»å‹•",value:"å±•è¦½æ´»å‹•"}),(0,u.bF)(d,{label:"æŽ¨è–¦è½‰ä»‹",value:"æŽ¨è–¦è½‰ä»‹"}),(0,u.bF)(d,{label:"å…¶ä»–ç®¡é“",value:"å…¶ä»–ç®¡é“"})])),_:1},8,["modelValue"])])),_:1}),(0,u.bF)(l,{label:"å®¢æˆ¶é¡žåž‹",prop:"customerType"},{default:(0,u.k6)((()=>[(0,u.bF)(c,{modelValue:s.customerType,"onUpdate:modelValue":a[17]||(a[17]=e=>s.customerType=e),filterable:"","allow-create":"","default-first-option":"",placeholder:"è«‹é¸æ“‡æˆ–è¼¸å…¥å®¢æˆ¶é¡žåž‹",style:{width:"22rem"},clearable:""},{default:(0,u.k6)((()=>[((0,u.uX)(),(0,u.CE)(u.FK,null,(0,u.pI)(n,(e=>(0,u.bF)(d,{key:e,label:e,value:e},null,8,["label","value"]))),64))])),_:1},8,["modelValue"])])),_:1}),(0,u.Q3)("",!0),(0,u.Q3)("",!0),"å…¶ä»–ç®¡é“"===s.customerSource?((0,u.uX)(),(0,u.Wv)(l,{key:5,label:"å…¶ä»–å®¢æˆ¶ä¾†æº",prop:"otherCustomerSource"},{default:(0,u.k6)((()=>[(0,u.bF)(i,{modelValue:s.otherCustomerSource,"onUpdate:modelValue":a[19]||(a[19]=e=>s.otherCustomerSource=e),placeholder:"è«‹è¼¸å…¥å®¢æˆ¶ä¾†æº",style:{width:"22rem"}},null,8,["modelValue"])])),_:1})):(0,u.Q3)("",!0),(0,u.bF)(l,{class:"Fill_Btn_Submit"},{default:(0,u.k6)((()=>[(0,u.bF)(b,{type:"primary",onClick:v},{default:(0,u.k6)((()=>a[22]||(a[22]=[(0,u.eW)("æäº¤")]))),_:1}),(0,u.bF)(b,{onClick:m},{default:(0,u.k6)((()=>a[23]||(a[23]=[(0,u.eW)("æ¸…é™¤")]))),_:1}),(0,u.Q3)("",!0)])),_:1})])),_:1},8,["model"])}}};const RL=(0,ie.A)(LL,[["__scopeId","data-v-2613605e"]]);var VL=RL;const IL={class:"flex justify-center items-center w-full"},xL=["onDblclick"],EL=["onDblclick"],AL={style:{padding:"10px"}},TL={key:0},WL={key:1},SL={style:{"margin-top":"10px"}};var UL={__name:"OrderSummaryDialog",props:{visible:{type:Boolean,default:!1},customerId:{type:String,required:!0},fullCompanyName:{type:String,default:""},getFormattedDateRange:{type:String,default:""}},emits:["update:visible"],setup(e,{emit:a}){const l=(0,d.KR)(),o=e=>"number"!==typeof e?e:e.toLocaleString("en-US"),n=["","è¨ˆè²»ç®¡ç†","èƒ½æºç®¡ç†","æ™ºæ…§ç…§æ˜Ž"],r=e,s=a,i=(0,u.EW)({get:()=>r.visible,set:e=>s("update:visible",e)}),c=(0,d.KR)([]),p=(0,d.KR)(!1),m=(0,d.KR)(!1),v=(0,d.KR)(""),b=(0,d.KR)(10),g=(0,d.KR)(1),y=(0,u.EW)((()=>`è¨‚å–®è³‡è¨Š - ${r.fullCompanyName}`));async function f(e,a,l){p.value=!0;try{const t=await OC.getOrderSummaries(e,a,l);c.value=(Array.isArray(t.data)?t.data:[t.data]).map((e=>({...e,isEditingProductCategory:!1}))),g.value=1}catch(t){D.nk.error("è¼‰å…¥è¨‚å–®è³‡è¨Šå¤±æ•—ï¼š"+t.message),console.error(t),c.value=[]}finally{p.value=!1}}const h=(0,u.EW)((()=>{const e=v.value.trim().toLowerCase();return e?c.value.filter((a=>{const l=a["å¸‚å ´äº¤æ˜“åˆ†é¡ž"]?a["å¸‚å ´äº¤æ˜“åˆ†é¡ž"].toString().toLowerCase():"",t=a["å°ˆæ¡ˆåç¨±"]?a["å°ˆæ¡ˆåç¨±"].toString().toLowerCase():"";return l.includes(e)||t.includes(e)})):c.value})),k=(0,u.EW)((()=>{if(m.value)return h.value.slice(0,V.value);{const e=(g.value-1)*b.value;return h.value.slice(e,e+b.value)}})),_=()=>{m.value?V.value=30:g.value=1},w=e=>{g.value=e},F=e=>{b.value=e,g.value=1};async function C(e,a){try{await OC.updateOrderProductCategory(e.è¨‚å–®è™Ÿç¢¼,a),D.nk.success("ç”¢å“åˆ†é¡žæ›´æ–°æˆåŠŸ")}catch(l){D.nk.error("æ›´æ–°ç”¢å“åˆ†é¡žå¤±æ•—ï¼š"+l.message),console.error(l)}}(0,u.wB)((()=>r.visible),(e=>{if(e&&r.customerId){const[e,a]=r.getFormattedDateRange.split("_");f(r.customerId,e,a)}}));const R=()=>{s("update:visible",!1)},V=(0,d.KR)(30),I=(0,d.KR)(null),x=()=>{if(m.value&&I.value){const{scrollTop:e,scrollHeight:a,clientHeight:t}=I.value;e+t>=a-50&&!l.value&&E()}},E=()=>{V.value<h.value.length&&(l.value=!0,setTimeout((()=>{V.value+=30,l.value=!1}),500))};(0,u.wB)((()=>r.visible),(e=>{if(e&&r.customerId){const[e,a]=r.getFormattedDateRange.split("_");f(r.customerId,e,a)}})),(0,u.wB)(m,(e=>{e&&I.value?I.value.addEventListener("scroll",x):I.value&&I.value.removeEventListener("scroll",x)}));const A={"è¨‚è³¼æ—¥æœŸ":"è¨‚è³¼æ—¥æœŸ","å®¢æˆ¶ä»£è™Ÿ":"å®¢æˆ¶ä»£è™Ÿ","å®¢æˆ¶ç°¡ç¨±":"å®¢æˆ¶ç°¡ç¨±","å°ˆæ¡ˆåç¨±":"å°ˆæ¡ˆåç¨±","å°ˆæ¡ˆç·¨è™Ÿ":"å°ˆæ¡ˆç·¨è™Ÿ","è¨‚å–®ç‹€æ…‹":"è¨‚å–®ç‹€æ…‹","è¨‚å–®è™Ÿç¢¼":"è¨‚å–®è™Ÿç¢¼","åŽŸå¹£é‡‘é¡":"åŽŸå¹£é‡‘é¡","ç™¼ç¥¨è™Ÿç¢¼":"ç™¼ç¥¨è™Ÿç¢¼","æ¥­å‹™äººå“¡":"è² è²¬æ¥­å‹™","å¸‚å ´äº¤æ˜“åˆ†é¡ž":"å¸‚å ´äº¤æ˜“åˆ†é¡ž","ç”¢å“åˆ†é¡ž":"ç”¢å“åˆ†é¡ž"},T=(0,u.EW)((()=>e=>{const a=["isEditingProductCategory"];return Object.entries(e).filter((([e])=>!a.includes(e)))})),W=window.matchMedia("(max-width: 768px)"),S=e=>{m.value=e.matches};return(0,u.sV)((()=>{W.addEventListener("change",S),S(W)})),(0,u.hi)((()=>{W.removeEventListener("change",S)})),(e,a)=>{const l=(0,u.g2)("el-tag"),r=(0,u.g2)("el-input"),s=(0,u.g2)("el-button"),d=(0,u.g2)("el-text"),c=(0,u.g2)("el-option"),f=(0,u.g2)("el-select"),D=(0,u.g2)("el-pagination"),V=(0,u.g2)("el-table-column"),x=(0,u.g2)("el-table"),E=(0,u.g2)("el-dialog"),W=(0,u.gN)("loading");return(0,u.uX)(),(0,u.Wv)(E,{modelValue:i.value,"onUpdate:modelValue":a[4]||(a[4]=e=>i.value=e),width:m.value?"95%":"90%",top:"3vh",onClose:R,style:(0,L.Tr)({border:"4mm ridge rgba(255, 140, 100, 0.6)",borderRadius:"10px",boxShadow:"0 4px 16px rgba(255, 215, 0, 0.3)",backdropFilter:"blur(6px)",transform:i.value?"scale(1)":"scale(0.98)",transition:"transform 0.25s ease-in-out, box-shadow 0.25s ease-in-out"})},{header:(0,u.k6)((()=>[(0,u.Lk)("div",IL,[(0,u.bF)(l,{type:"warning",effect:"light",style:(0,L.Tr)({fontSize:m.value?"1.5rem":"3rem",padding:m.value?"1.5rem 2.5rem":"3rem 5rem"}),round:""},{default:(0,u.k6)((()=>[(0,u.eW)((0,L.v_)(y.value),1)])),_:1},8,["style"])])])),footer:(0,u.k6)((()=>[(0,u.bF)(s,{onClick:a[3]||(a[3]=e=>i.value=!1)},{default:(0,u.k6)((()=>a[8]||(a[8]=[(0,u.eW)("é—œé–‰")]))),_:1})])),default:(0,u.k6)((()=>[(0,u.Lk)("div",{class:"controls-bar mb-4 w-full",style:(0,L.Tr)({display:"flex",flexDirection:m.value?"column":"row",alignItems:(m.value,"center"),gap:m.value?"10px":"8px",borderColor:"gray",borderWidth:"1px",padding:"1rem"})},[(0,u.bF)(r,{modelValue:v.value,"onUpdate:modelValue":a[0]||(a[0]=e=>v.value=e),placeholder:"æœå°‹å¸‚å ´äº¤æ˜“åˆ†é¡žæˆ–å°ˆæ¡ˆåç¨±",clearable:"",onClear:_,onKeyup:(0,t.jR)(_,["enter"]),style:(0,L.Tr)({width:m.value?"100%":"300px"})},null,8,["modelValue","style"]),(0,u.bF)(s,{type:"info",onClick:_,style:(0,L.Tr)({marginLeft:(m.value,"0")})},{default:(0,u.k6)((()=>a[5]||(a[5]=[(0,u.eW)("æœå°‹")]))),_:1},8,["style"]),(0,u.Lk)("div",{style:(0,L.Tr)({display:"flex",flexDirection:m.value?"column":"row",alignItems:(m.value,"center"),marginLeft:m.value?"0":"5rem",gap:m.value?"10px":"8px"})},[(0,u.bF)(d,{class:"mx-1",type:"info"},{default:(0,u.k6)((()=>a[6]||(a[6]=[(0,u.eW)("æ¯é é¡¯ç¤º")]))),_:1}),(0,u.bF)(f,{modelValue:b.value,"onUpdate:modelValue":a[1]||(a[1]=e=>b.value=e),placeholder:"",style:(0,L.Tr)({width:m.value?"100%":"4rem"}),size:"default",onChange:F},{default:(0,u.k6)((()=>[((0,u.uX)(),(0,u.CE)(u.FK,null,(0,u.pI)([5,10,15,20,25,30],(e=>(0,u.bF)(c,{key:e,label:e,value:e},null,8,["label","value"]))),64))])),_:1},8,["modelValue","style"]),(0,u.bF)(d,{class:"mx-1",type:"info"},{default:(0,u.k6)((()=>a[7]||(a[7]=[(0,u.eW)("ç­†")]))),_:1}),(0,u.bF)(D,{background:"",layout:"prev, pager, next",total:h.value.length,"page-size":b.value,"current-page":g.value,"onUpdate:currentPage":a[2]||(a[2]=e=>g.value=e),onCurrentChange:w,style:(0,L.Tr)({marginLeft:m.value?"0":"3rem"})},null,8,["total","page-size","current-page","style"])],4)],4),m.value?(0,u.Q3)("",!0):(0,u.bo)(((0,u.uX)(),(0,u.Wv)(x,{key:0,class:"black-border-table",style:{width:"100%"},data:k.value,border:"",stripe:""},{default:(0,u.k6)((()=>[(0,u.bF)(V,{prop:"è¨‚è³¼æ—¥æœŸ",label:"è¨‚è³¼æ—¥æœŸ",width:"100"}),(0,u.bF)(V,{prop:"å®¢æˆ¶ä»£è™Ÿ",label:"å®¢æˆ¶ä»£è™Ÿ",width:"100"}),(0,u.bF)(V,{prop:"å®¢æˆ¶ç°¡ç¨±",label:"å®¢æˆ¶ç°¡ç¨±",width:"110"}),(0,u.bF)(V,{prop:"å°ˆæ¡ˆåç¨±",label:"å°ˆæ¡ˆåç¨±",width:"340"}),(0,u.bF)(V,{prop:"å°ˆæ¡ˆç·¨è™Ÿ",label:"å°ˆæ¡ˆç·¨è™Ÿ",width:"140"}),(0,u.bF)(V,{prop:"è¨‚å–®ç‹€æ…‹",label:"è¨‚å–®ç‹€æ…‹",width:"100"}),(0,u.bF)(V,{prop:"è¨‚å–®è™Ÿç¢¼",label:"è¨‚å–®è™Ÿç¢¼",width:"125"}),(0,u.bF)(V,{prop:"åŽŸå¹£é‡‘é¡",label:"åŽŸå¹£é‡‘é¡",width:"100"},{default:(0,u.k6)((({row:e})=>[(0,u.eW)((0,L.v_)(o(e.åŽŸå¹£é‡‘é¡)),1)])),_:1}),(0,u.bF)(V,{prop:"ç™¼ç¥¨è™Ÿç¢¼",label:"ç™¼ç¥¨è™Ÿç¢¼",width:"120"}),(0,u.bF)(V,{prop:"æ¥­å‹™äººå“¡",label:"è² è²¬æ¥­å‹™",width:"100"}),(0,u.bF)(V,{prop:"å¸‚å ´äº¤æ˜“åˆ†é¡ž",label:"å¸‚å ´äº¤æ˜“åˆ†é¡ž",width:"110"}),(0,u.bF)(V,{prop:"ç”¢å“åˆ†é¡ž",label:"ç”¢å“åˆ†é¡ž",width:"130"},{default:(0,u.k6)((({row:e})=>[null===e.ç”¢å“åˆ†é¡ž||""!==e.ç”¢å“åˆ†é¡ž||e.isEditingProductCategory?null===e.ç”¢å“åˆ†é¡ž||""===e.ç”¢å“åˆ†é¡ž||e.isEditingProductCategory?((0,u.uX)(),(0,u.Wv)(f,{key:2,modelValue:e.ç”¢å“åˆ†é¡ž,"onUpdate:modelValue":a=>e.ç”¢å“åˆ†é¡ž=a,placeholder:"é¸æ“‡åˆ†é¡ž",size:"small",onChange:a=>{C(e,a),e.isEditingProductCategory=!1},onBlur:a=>e.isEditingProductCategory=!1},{default:(0,u.k6)((()=>[((0,u.uX)(),(0,u.CE)(u.FK,null,(0,u.pI)(n,(e=>(0,u.bF)(c,{key:e,label:e,value:e},null,8,["label","value"]))),64))])),_:2},1032,["modelValue","onUpdate:modelValue","onChange","onBlur"])):((0,u.uX)(),(0,u.CE)("span",{key:1,onDblclick:a=>e.isEditingProductCategory=!0,class:"nonempty-cell"},(0,L.v_)(e.ç”¢å“åˆ†é¡ž),41,EL)):((0,u.uX)(),(0,u.CE)("div",{key:0,class:"empty-cell",onDblclick:a=>e.isEditingProductCategory=!0},null,40,xL))])),_:1})])),_:1},8,["data"])),[[W,p.value]]),m.value?(0,u.bo)(((0,u.uX)(),(0,u.Wv)(x,{key:1,class:"black-border-table",style:{width:"100%","margin-bottom":"20px"},data:k.value,border:"",stripe:""},{default:(0,u.k6)((()=>[(0,u.bF)(V,{type:"expand"},{default:(0,u.k6)((({row:e})=>[(0,u.Lk)("div",AL,[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(T.value(e),(([e,a])=>((0,u.uX)(),(0,u.CE)("p",{key:e},[(0,u.Lk)("strong",null,(0,L.v_)(A[e]||e)+":",1),"åŽŸå¹£é‡‘é¡"===e?((0,u.uX)(),(0,u.CE)("span",TL,(0,L.v_)(o(a)),1)):((0,u.uX)(),(0,u.CE)("span",WL,(0,L.v_)(a),1))])))),128)),(0,u.Lk)("div",SL,[(0,u.bF)(f,{modelValue:e.ç”¢å“åˆ†é¡ž,"onUpdate:modelValue":a=>e.ç”¢å“åˆ†é¡ž=a,placeholder:"é¸æ“‡åˆ†é¡ž",size:"small",onChange:a=>C(e,a)},{default:(0,u.k6)((()=>[((0,u.uX)(),(0,u.CE)(u.FK,null,(0,u.pI)(n,(e=>(0,u.bF)(c,{key:e,label:e,value:e},null,8,["label","value"]))),64))])),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])])])])),_:1}),(0,u.bF)(V,{prop:"è¨‚è³¼æ—¥æœŸ",label:"è¨‚è³¼æ—¥æœŸ",width:"100"}),(0,u.bF)(V,{prop:"å®¢æˆ¶ç°¡ç¨±",label:"å®¢æˆ¶ç°¡ç¨±",width:"110"}),(0,u.bF)(V,{prop:"å°ˆæ¡ˆåç¨±",label:"å°ˆæ¡ˆåç¨±",width:"auto"})])),_:1},8,["data"])),[[W,p.value]]):(0,u.Q3)("",!0),(0,u.Lk)("div",{ref_key:"wrapper",ref:I,class:"drag-wrapper",style:(0,L.Tr)({overflowY:m.value?"auto":"visible",maxHeight:m.value?"70rem":"none"})},null,4)])),_:1},8,["modelValue","width","style"])}}};const $L=(0,ie.A)(UL,[["__scopeId","data-v-f0683d62"]]);var NL=$L;const XL={class:"list-customer-info"},KL={class:"block"},ML={key:0},PL={style:{"text-align":"center"}},OL={style:{position:"relative"}},zL={style:{padding:"10px"}},BL={key:0},jL={key:1},YL={key:2},QL={key:3},HL={key:4},qL={key:5},JL={style:{"margin-top":"10px"}},GL={style:{position:"relative"}},ZL={key:1},eR={key:2},aR={key:3};var lR={__name:"ListCustomerInfo",setup(e){const a=e=>"number"!==typeof e?e:e.toLocaleString("en-US"),l=(0,S.k)(),o=(0,d.KR)([]),n=(0,d.KR)([]),r=(0,d.KR)(!1),s=(0,d.KR)(!1),i=(0,d.KR)(30),c=(0,d.KR)(null),p={edit:"ç·¨è¼¯",delete:"åˆªé™¤",orderSummary:"äº¤æ˜“ç´€éŒ„"},m={id:"åºè™Ÿ",customerId:"å®¢æˆ¶ID",customerName:"å®¢æˆ¶å§“å",fullCompanyName:"å…¬å¸å…¨å",shortName:"å®¢æˆ¶ç°¡ç¨±",companyAddress:"å…¬å¸åœ°å€",companyRegion:"å…¬å¸å€åŸŸ",contactName:"è¯çµ¡äººå§“å",customerType:"å®¢æˆ¶é¡žåž‹",email:"é›»å­éƒµä»¶",faxNum:"å‚³çœŸ",phoneExtension:"é›»è©±ï¼ˆåˆ†æ©Ÿï¼‰",mobilePhone:"æ‰‹æ©Ÿ",taxId:"çµ±ä¸€ç·¨è™Ÿ",createdDate:"å»ºç«‹æ—¥æœŸ",createdBy:"è² è²¬æ¥­å‹™",customerSource:"å®¢æˆ¶ä¾†æº",responsibleArea:"è² è²¬å€åŸŸ"},v=[{label:"å®¢æˆ¶ç°¡ç¨±",value:"shortName"},{label:"å®¢æˆ¶å§“å",value:"customerName"},{label:"å…¬å¸å…¨å",value:"fullCompanyName"},{label:"å…¬å¸åœ°å€",value:"companyAddress"},{label:"å…¬å¸å€åŸŸ",value:"companyRegion"},{label:"è¯çµ¡äººå§“å",value:"contactName"},{label:"å®¢æˆ¶é¡žåž‹",value:"customerType"},{label:"å®¢æˆ¶ä¾†æº",value:"customerSource"},{label:"è² è²¬å€åŸŸ",value:"responsibleArea"},{label:"è¨‚å–®æ—¥æœŸ",value:"createdDate"},{label:"å®¢æˆ¶é‡‘é¡",value:"customerClass"}],b=(0,d.KR)(v[0].value),g=(0,d.KR)(""),y=(0,u.EW)((()=>"customerClass"===b.value?"è«‹è¼¸å…¥é‡‘é¡":"createdDate"===b.value?"è«‹è¼¸å…¥æ—¥æœŸ (YYYY-MM-DD)":"è«‹è¼¸å…¥é—œéµå­—")),f=(0,d.KR)(10),h=(0,d.KR)(1),k=async()=>{try{const e=await OC.getAllCustomerForms();console.log(e.data),o.value=e.data.slice().sort(((e,a)=>new Date(a.createdDate)-new Date(e.createdDate)))}catch(e){console.error("å–å¾—å®¢æˆ¶æ¸…å–®å¤±æ•—ï¼š",e)}},_=(0,d.KR)([]),w=(0,d.KR)(!1),F=Object.keys(m).filter((e=>!["id","createdDate","createdBy"].includes(e)));function C(e,a){if("edit"!==e&&"delete"!==e||!a||ae(a))if(x.value=e,V.value={...a},"orderSummary"===e){if(N.value)return void D.nk.warning("è«‹é¸æ“‡äº¤æ˜“ç´€éŒ„æŸ¥è©¢çš„æ—¥æœŸå€é–“");E.value=!0}else R.value=!0;else D.nk.warning("æ‚¨åªèƒ½ç·¨è¼¯æˆ–åˆªé™¤è‡ªå·±å‰µå»ºçš„è³‡æ–™")}const R=(0,d.KR)(!1),V=(0,d.KR)({}),I=(0,u.EW)((()=>Object.keys(m).filter((e=>"id"!==e&&"hasCompletedDeal"!==e)))),x=(0,d.KR)(""),E=(0,d.KR)(!1),A=(0,d.KR)(!1),T=(0,d.KR)(""),W=(0,d.KR)([]),U=(0,d.KR)(!1),$=(0,d.KR)(""),N=(0,u.EW)((()=>!n.value||2!==n.value.length));function X(e,a){return`${e.customerId}_${e.id||e.index||Math.random()}_${a}`}function K(e,a=0){if(N.value)return void D.nk.warning("è«‹é¸æ“‡å®¢æˆ¶é‡‘é¡æŸ¥è©¢çš„æ—¥æœŸå€é–“");const l=X(e,a);$.value===l?($.value="",A.value=!1):(T.value=e.customerId,$.value=l,A.value=!0)}async function M(e,a){if(e&&!N.value){U.value=!0;try{const{formattedStart:l,formattedEnd:t}=P(a),o=await OC.getCustomerClass(e,l,t);console.log(o.data),W.value=Array.isArray(o.data)?o.data:[o.data]}catch(l){D.nk.error("è¼‰å…¥å®¢æˆ¶ç­‰ç´šå¤±æ•—: "+l.message),console.error(l),W.value=[]}finally{U.value=!1}}}function P(e){const[a,l]=e;return{formattedStart:a?ee(a):null,formattedEnd:l?ee(l):null}}async function O(){try{"edit"===x.value?(await OC.updateCustomer(V.value.id,V.value),D.nk.success("å®¢æˆ¶è³‡æ–™å·²æ›´æ–°")):(await OC.deleteCustomer(V.value.id),D.nk.success("å®¢æˆ¶è³‡æ–™å·²åˆªé™¤")),await k()}catch(e){console.error(e),D.nk.error("æ›´æ–°å¤±æ•—ï¼š"+(e.response?.data||e.message))}finally{R.value=!1}}const z=(0,u.EW)((()=>{const e=g.value.trim().toLowerCase();return e?"customerClass"===b.value?_.value:"createdDate"===b.value?o.value.filter((a=>{const l=q(a.createdDate);return l.toLowerCase().includes(e)})):o.value.filter((a=>{const l=a[b.value];return l&&l.toString().toLowerCase().includes(e)})):o.value})),B=(0,u.EW)((()=>{if(r.value)return z.value.slice(0,i.value);{const e=(h.value-1)*f.value;return z.value.slice(e,e+f.value)}})),j=()=>{if(r.value&&c.value){const{scrollTop:e,scrollHeight:a,clientHeight:l}=c.value;e+l>=a-50&&!s.value&&Y()}},Y=()=>{i.value<z.value.length&&(s.value=!0,setTimeout((()=>{i.value+=30,s.value=!1}),500))},Q=async()=>{if(r.value&&(i.value=30),"customerClass"===b.value){const a=parseFloat(g.value.trim());if(isNaN(a))return D.nk.warning("è«‹è¼¸å…¥æœ‰æ•ˆçš„æ•¸å­—é‡‘é¡"),void(_.value=[]);try{if(w.value=!0,N.value)return void D.nk.warning("è«‹é¸æ“‡å®¢æˆ¶é‡‘é¡æŸ¥è©¢çš„æ—¥æœŸå€é–“");const{formattedStart:e,formattedEnd:l}=P(n.value),t=await OC.getCustomerClassByAmount(a,e,l);_.value=Array.isArray(t.data)?t.data:[t.data],console.log(t.data)}catch(e){D.nk.error("è¼‰å…¥å®¢æˆ¶é‡‘é¡å¤±æ•—ï¼š"+e.message),console.error(e),_.value=[]}finally{w.value=!1}}else await k()},H=e=>{h.value=e},q=e=>{if(!e)return"";const a=new Date(e),l=a.getFullYear(),t=String(a.getMonth()+1).padStart(2,"0"),o=String(a.getDate()).padStart(2,"0");return`${l}/${t}/${o}`};(0,u.sV)((()=>{k(),or.on("customer-created",k);const e=new Date,a=new Date;a.setMonth(e.getMonth()-1);const l=new Date(a.getFullYear(),a.getMonth(),a.getDate(),0,0,0),t=new Date(e.getFullYear(),e.getMonth(),e.getDate(),23,59,59);n.value=[l,t],J.addEventListener("change",G),G(J),r.value&&c.value&&c.value.addEventListener("scroll",j)})),(0,u.hi)((()=>{or.off("customer-created",k),J.removeEventListener("change",G),c.value&&c.value.removeEventListener("scroll",j)})),(0,u.wB)(r,((e,a)=>{e!==a&&c.value&&(c.value.removeEventListener("scroll",j),e&&c.value.addEventListener("scroll",j))}));const J=window.matchMedia("(max-width: 768px)"),G=e=>{r.value=e.matches},Z=(0,u.EW)((()=>e=>Object.entries(e).filter((([e])=>"isShow"!==e&&"hasCompletedDeal"!==e))));function ee(e){const a=e.getFullYear(),l=String(e.getMonth()+1).padStart(2,"0"),t=String(e.getDate()).padStart(2,"0");return parseInt(`${a}${l}${t}`,10)}const ae=e=>e.createdBy===l.userId;return(e,l)=>{const o=(0,u.g2)("el-date-picker"),s=(0,u.g2)("el-option"),i=(0,u.g2)("el-select"),k=(0,u.g2)("el-input"),D=(0,u.g2)("el-button"),S=(0,u.g2)("el-text"),N=(0,u.g2)("el-pagination"),j=(0,u.g2)("el-table-column"),Y=(0,u.g2)("el-table"),J=(0,u.g2)("el-popover"),G=(0,u.g2)("el-result"),ee=(0,u.g2)("el-form-item"),le=(0,u.g2)("el-form"),te=(0,u.g2)("el-dialog"),oe=(0,u.gN)("loading");return(0,u.uX)(),(0,u.CE)("div",XL,[(0,u.Lk)("div",{class:"controls-bar w-full",style:(0,L.Tr)({padding:"1rem",display:"flex",marginTop:"1rem",flexDirection:r.value?"column":"row",alignItems:(r.value,"center"),borderColor:"black",borderWidth:"1px",gap:r.value?"10px":"0"})},[(0,u.Lk)("span",{style:(0,L.Tr)({marginRight:r.value?"0":"1rem"})}," é¸æ“‡æŸ¥è©¢æ—¥æœŸå€é–“ ",4),(0,u.Lk)("div",KL,[(0,u.bF)(o,{modelValue:n.value,"onUpdate:modelValue":l[0]||(l[0]=e=>n.value=e),type:"daterange","range-separator":"~","start-placeholder":"é–‹å§‹","end-placeholder":"çµæŸ",style:(0,L.Tr)({display:"flex",justifyContent:r.value?"center":"flex-start",width:r.value?"100%":"80%",margin:r.value?"0 auto":"0"})},null,8,["modelValue","style"])]),(0,u.Lk)("div",{class:"search-block",style:(0,L.Tr)({display:"flex",marginLeft:r.value?"0":"2rem",flexDirection:r.value?"column":"row",alignItems:(r.value,"center"),gap:"8px"})},[(0,u.bF)(i,{modelValue:b.value,"onUpdate:modelValue":l[1]||(l[1]=e=>b.value=e),placeholder:"é¸æ“‡æ¬„ä½",style:(0,L.Tr)({width:r.value?"100%":"9rem"})},{default:(0,u.k6)((()=>[((0,u.uX)(),(0,u.CE)(u.FK,null,(0,u.pI)(v,(e=>(0,u.bF)(s,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),64))])),_:1},8,["modelValue","style"]),"customerClass"===b.value?((0,u.uX)(),(0,u.CE)("span",ML," å¤§æ–¼ ")):(0,u.Q3)("",!0),(0,u.bF)(k,{modelValue:g.value,"onUpdate:modelValue":l[2]||(l[2]=e=>g.value=e),placeholder:y.value,clearable:"",onClear:Q,onKeyup:(0,t.jR)(Q,["enter"]),style:(0,L.Tr)({width:r.value?"100%":"200px"})},null,8,["modelValue","placeholder","style"]),(0,u.bF)(D,{type:"primary",style:(0,L.Tr)({display:"flex",justifyContent:r.value?"center":"flex-start"}),onClick:Q},{default:(0,u.k6)((()=>l[12]||(l[12]=[(0,u.eW)("æœå°‹")]))),_:1},8,["style"])],4),r.value?(0,u.Q3)("",!0):((0,u.uX)(),(0,u.CE)("div",{key:0,class:"pagination-block",style:(0,L.Tr)({display:"flex",alignItems:r.value?"flex-start":"center",marginLeft:r.value?"0":"2rem",flexDirection:r.value?"column":"row",gap:r.value?"10px":"0"})},[(0,u.bF)(S,{class:"mx-1",type:"info"},{default:(0,u.k6)((()=>l[13]||(l[13]=[(0,u.eW)("æ¯é é¡¯ç¤º")]))),_:1}),(0,u.bF)(i,{modelValue:f.value,"onUpdate:modelValue":l[3]||(l[3]=e=>f.value=e),placeholder:"",style:(0,L.Tr)({width:r.value?"100%":"4rem"}),size:"small"},{default:(0,u.k6)((()=>[((0,u.uX)(),(0,u.CE)(u.FK,null,(0,u.pI)([5,10,15,20,25,30],(e=>(0,u.bF)(s,{key:e,label:e,value:e},null,8,["label","value"]))),64))])),_:1},8,["modelValue","style"]),(0,u.bF)(S,{class:"mx-1",type:"info"},{default:(0,u.k6)((()=>l[14]||(l[14]=[(0,u.eW)("ç­†")]))),_:1}),(0,u.Lk)("div",{style:(0,L.Tr)({marginLeft:r.value?"0":"5rem"})},[(0,u.bF)(N,{background:"",layout:"prev, pager, next",total:z.value.length,"page-size":f.value,"current-page":h.value,"onUpdate:currentPage":l[4]||(l[4]=e=>h.value=e),onCurrentChange:H},null,8,["total","page-size","current-page"])],4)],4))],4),(0,u.Lk)("div",{ref_key:"wrapper",ref:c,class:"drag-wrapper",style:(0,L.Tr)({overflowY:r.value?"auto":"visible",maxHeight:r.value?"70rem":"none"})},[r.value||"customerClass"!==b.value?(0,u.Q3)("",!0):(0,u.bo)(((0,u.uX)(),(0,u.Wv)(Y,{key:0,data:_.value,stripe:"",border:"",style:{width:"110%","margin-bottom":"20px"}},{default:(0,u.k6)((()=>[(0,u.Q3)("",!0),(0,u.bF)(j,{prop:"customerShortName",label:"å®¢æˆ¶ç°¡ç¨±",width:"150"}),(0,u.bF)(j,{prop:"totalAmount",label:"å€é–“éŠ·å”®é¡",width:"150"},{default:(0,u.k6)((({row:e})=>[(0,u.eW)((0,L.v_)(a(e.totalAmount)),1)])),_:1}),(0,u.bF)(j,{prop:"customerClass",label:"å®¢æˆ¶ç­‰ç´š",width:"120"})])),_:1},8,["data"])),[[oe,w.value]]),r.value||"customerClass"===b.value?(0,u.Q3)("",!0):((0,u.uX)(),(0,u.Wv)(Y,{key:1,class:"black-border-table",data:B.value,stripe:"",border:""},{default:(0,u.k6)((()=>[(0,u.bF)(j,{label:"å»ºç«‹æ—¥æœŸ",prop:"createdDate",width:"105"},{default:(0,u.k6)((({row:e})=>[(0,u.eW)((0,L.v_)(q(e.createdDate)),1)])),_:1}),(0,u.bF)(j,{prop:"responsibleArea",label:"ç‡Ÿæ¥­å€åŸŸ",width:"115"}),(0,u.bF)(j,{prop:"createdBy",label:"æ¥­å‹™äººå“¡",width:"85"},{default:(0,u.k6)((({row:e})=>[(0,u.bF)(yl,{"employee-id":e.createdBy},null,8,["employee-id"])])),_:1}),(0,u.bF)(j,{label:"æ“ä½œ",width:"160"},{default:(0,u.k6)((({row:e})=>[(0,u.bF)(D,{type:"primary",size:"default",onClick:a=>C("edit",e),disabled:!ae(e)},{default:(0,u.k6)((()=>l[15]||(l[15]=[(0,u.eW)(" ç·¨è¼¯ ")]))),_:2},1032,["onClick","disabled"]),(0,u.bF)(D,{type:"danger",size:"default",onClick:a=>C("delete",e),disabled:!ae(e)},{default:(0,u.k6)((()=>l[16]||(l[16]=[(0,u.eW)(" åˆªé™¤ ")]))),_:2},1032,["onClick","disabled"])])),_:1}),(0,u.bF)(j,{label:"äº¤æ˜“ç´€éŒ„",width:"115"},{default:(0,u.k6)((({row:e})=>[(0,u.bF)(D,{type:"info",size:"default",onClick:a=>C("orderSummary",e)},{default:(0,u.k6)((()=>l[17]||(l[17]=[(0,u.eW)(" äº¤æ˜“ç´€éŒ„ ")]))),_:2},1032,["onClick"])])),_:1}),(0,u.bF)(j,{label:"å®¢æˆ¶ç­‰ç´š",width:"115"},{default:(0,u.k6)((({row:e})=>[(0,u.Lk)("div",PL,[(0,u.bF)(J,{placement:"right",width:"700",trigger:"click",visible:A.value&&$.value===X(e,1),onShow:l[5]||(l[5]=()=>M(T.value,n.value)),onHide:l[6]||(l[6]=()=>{A.value=!1,$.value=""})},{reference:(0,u.k6)((()=>[(0,u.bF)(D,{type:"info",size:"default",onClick:a=>K(e,1)},{default:(0,u.k6)((()=>l[18]||(l[18]=[(0,u.eW)(" å®¢æˆ¶ç­‰ç´š ")]))),_:2},1032,["onClick"])])),default:(0,u.k6)((()=>[(0,u.bF)(D,{type:"danger",style:{height:"2rem",width:"2rem",position:"absolute",top:"5px",right:"5px",cursor:"pointer","z-index":"1000"},size:"default",onClick:a=>K(e,1),icon:"Close"},null,8,["onClick"]),(0,u.Lk)("div",OL,[(0,u.bo)(((0,u.uX)(),(0,u.Wv)(Y,{class:"popover-table-background",data:W.value,border:"",style:{width:"95%"}},{default:(0,u.k6)((()=>[(0,u.bF)(j,{prop:"å®¢æˆ¶ç°¡ç¨±",label:"å®¢æˆ¶ç°¡ç¨±",width:"150"}),(0,u.bF)(j,{prop:"å€é–“éŠ·å”®é¡",label:"å€é–“éŠ·å”®é¡",width:"200"},{default:(0,u.k6)((({row:e})=>[(0,u.eW)((0,L.v_)(a(e.å€é–“éŠ·å”®é¡)),1)])),_:2},1024),(0,u.bF)(j,{prop:"ç­‰ç´šå€é–“",label:"ç­‰ç´šå€é–“",width:"150"}),(0,u.bF)(j,{prop:"å®¢æˆ¶ç­‰ç´š",label:"å®¢æˆ¶ç­‰ç´š",width:"150"})])),_:2},1032,["data"])),[[oe,U.value]])])])),_:2},1032,["visible"])])])),_:1}),(0,u.bF)(j,{prop:"customerId",label:"å®¢æˆ¶ID",width:"90"}),(0,u.bF)(j,{prop:"customerSource",label:"å®¢æˆ¶ä¾†æº",width:"90"}),(0,u.bF)(j,{prop:"customerType",label:"å®¢æˆ¶é¡žåž‹",width:"110"}),(0,u.bF)(j,{prop:"fullCompanyName",label:"å…¬å¸å…¨å",width:"250"}),(0,u.bF)(j,{prop:"customerName",label:"å®¢æˆ¶å§“å",width:"90"}),(0,u.bF)(j,{prop:"shortName",label:"å…¬å¸ç°¡ç¨±",width:"120"}),(0,u.bF)(j,{prop:"companyAddress",label:"å…¬å¸åœ°å€",width:"250"}),(0,u.bF)(j,{prop:"taxId",label:"çµ±ä¸€ç·¨è™Ÿ",width:"100"}),(0,u.bF)(j,{prop:"companyRegion",label:"å…¬å¸å€åŸŸ",width:"120"}),(0,u.bF)(j,{prop:"contactName",label:"è¯çµ¡äººå§“å",width:"120"}),(0,u.bF)(j,{prop:"email",label:"é›»å­éƒµä»¶",width:"200"}),(0,u.bF)(j,{prop:"phoneExtension",label:"é›»è©±(åˆ†æ©Ÿ)",width:"120"}),(0,u.bF)(j,{prop:"mobilePhone",label:"æ‰‹æ©Ÿ",width:"130"}),(0,u.bF)(j,{prop:"faxNum",label:"å‚³çœŸ",width:"120"})])),_:1},8,["data"])),r.value?((0,u.uX)(),(0,u.Wv)(Y,{key:2,class:"RWD_List_Table",data:B.value,stripe:"",border:"",style:{width:"100%","margin-bottom":"20px","margin-right":"1rem 0rem 0rem 0rem"}},{default:(0,u.k6)((()=>[(0,u.bF)(j,{type:"expand"},{default:(0,u.k6)((({row:e})=>[(0,u.Lk)("div",zL,[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(Z.value(e),(([e,l])=>((0,u.uX)(),(0,u.CE)("p",{key:e},[m[e]?((0,u.uX)(),(0,u.CE)("strong",BL,(0,L.v_)(m[e])+":",1)):((0,u.uX)(),(0,u.CE)("span",jL,[(0,u.Lk)("strong",null,(0,L.v_)(e)+":",1)])),"createdDate"===e?((0,u.uX)(),(0,u.CE)("span",YL,(0,L.v_)(q(l)),1)):"createdBy"===e?((0,u.uX)(),(0,u.CE)("span",QL,[(0,u.bF)(yl,{"employee-id":l},null,8,["employee-id"])])):"totalAmount"===e?((0,u.uX)(),(0,u.CE)("span",HL,(0,L.v_)(a(l)),1)):((0,u.uX)(),(0,u.CE)("span",qL,(0,L.v_)(l),1))])))),128)),(0,u.Lk)("div",JL,[(0,u.bF)(D,{type:"primary",size:"default",onClick:a=>C("edit",e),disabled:!ae(e)},{default:(0,u.k6)((()=>l[19]||(l[19]=[(0,u.eW)(" ç·¨è¼¯ ")]))),_:2},1032,["onClick","disabled"]),(0,u.bF)(D,{type:"danger",size:"default",onClick:a=>C("delete",e),disabled:!ae(e)},{default:(0,u.k6)((()=>l[20]||(l[20]=[(0,u.eW)(" åˆªé™¤ ")]))),_:2},1032,["onClick","disabled"]),(0,u.bF)(D,{type:"info",size:"default",onClick:a=>C("orderSummary",e)},{default:(0,u.k6)((()=>l[21]||(l[21]=[(0,u.eW)(" äº¤æ˜“ç´€éŒ„ ")]))),_:2},1032,["onClick"]),(0,u.bF)(J,{placement:"right",width:"700",trigger:"click",visible:A.value&&$.value===X(e,2),onShow:l[7]||(l[7]=()=>M(T.value,n.value)),onHide:l[8]||(l[8]=()=>{A.value=!1,$.value=""})},{reference:(0,u.k6)((()=>[(0,u.bF)(D,{type:"info",size:"default",onClick:a=>K(e,2)},{default:(0,u.k6)((()=>l[22]||(l[22]=[(0,u.eW)(" å®¢æˆ¶ç­‰ç´š ")]))),_:2},1032,["onClick"])])),default:(0,u.k6)((()=>[(0,u.bF)(D,{type:"danger",style:{height:"2rem",width:"2rem",position:"absolute",top:"5px",right:"5px",cursor:"pointer","z-index":"1000"},size:"default",onClick:a=>K(e,2),icon:"Close"},null,8,["onClick"]),(0,u.Lk)("div",GL,[(0,u.bo)(((0,u.uX)(),(0,u.Wv)(Y,{class:"popover-table-background",data:W.value,border:"",style:{width:"95%"}},{default:(0,u.k6)((()=>[(0,u.bF)(j,{prop:"å®¢æˆ¶ç°¡ç¨±",label:"å®¢æˆ¶ç°¡ç¨±",width:"150"}),(0,u.bF)(j,{prop:"å€é–“éŠ·å”®é¡",label:"å€é–“éŠ·å”®é¡",width:"200"},{default:(0,u.k6)((({row:e})=>[(0,u.eW)((0,L.v_)(a(e.å€é–“éŠ·å”®é¡)),1)])),_:2},1024),(0,u.bF)(j,{prop:"ç­‰ç´šå€é–“",label:"ç­‰ç´šå€é–“",width:"150"}),(0,u.bF)(j,{prop:"å®¢æˆ¶ç­‰ç´š",label:"å®¢æˆ¶ç­‰ç´š",width:"150"})])),_:2},1032,["data"])),[[oe,U.value]])])])),_:2},1032,["visible"])])])])),_:1}),(0,u.bF)(j,{prop:"customerName",label:"å®¢æˆ¶å§“å",width:"120"}),(0,u.bF)(j,{prop:"shortName",label:"å®¢æˆ¶ç°¡ç¨±",width:"120"}),(0,u.bF)(j,{prop:"mobilePhone",label:"æ‰‹æ©Ÿ",width:"130"})])),_:1},8,["data"])):(0,u.Q3)("",!0)],4),(0,u.bF)(te,{title:p[x.value]+" å®¢æˆ¶",modelValue:R.value,"onUpdate:modelValue":l[10]||(l[10]=e=>R.value=e),width:"600px",top:"3vh"},{footer:(0,u.k6)((()=>[(0,u.bF)(D,{onClick:l[9]||(l[9]=e=>R.value=!1)},{default:(0,u.k6)((()=>l[23]||(l[23]=[(0,u.eW)("å–æ¶ˆ")]))),_:1}),"edit"===x.value?((0,u.uX)(),(0,u.Wv)(D,{key:0,type:"primary",onClick:O},{default:(0,u.k6)((()=>l[24]||(l[24]=[(0,u.eW)(" ç¢ºèªå„²å­˜ ")]))),_:1})):((0,u.uX)(),(0,u.Wv)(D,{key:1,type:"danger",onClick:O},{default:(0,u.k6)((()=>l[25]||(l[25]=[(0,u.eW)(" ç¢ºèªåˆªé™¤ ")]))),_:1}))])),default:(0,u.k6)((()=>["delete"===x.value?((0,u.uX)(),(0,u.Wv)(G,{key:0,icon:"error",title:"åˆªé™¤è­¦å‘Š","sub-title":"æ­¤æ“ä½œç„¡æ³•å¾©åŽŸï¼Œè«‹ç¢ºèªæ˜¯å¦è¦åˆªé™¤é€™ç­†è³‡æ–™",style:{"padding-top":"0"}})):((0,u.uX)(),(0,u.Wv)(G,{key:1,icon:"warning",title:"æ“ä½œæé†’","sub-title":"è«‹ç¢ºèªä¸‹åˆ—å®¢æˆ¶è³‡æ–™æ˜¯å¦æ­£ç¢º",style:{"padding-top":"0"}})),(0,u.bF)(le,{model:V.value,"label-width":"120px"},{default:(0,u.k6)((()=>[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(I.value,(e=>((0,u.uX)(),(0,u.Wv)(ee,{key:e,label:m[e]||e,style:{"margin-bottom":"0"}},{default:(0,u.k6)((()=>["edit"===x.value&&(0,d.R1)(F).includes(e)?((0,u.uX)(),(0,u.Wv)(k,{key:0,modelValue:V.value[e],"onUpdate:modelValue":a=>V.value[e]=a,disabled:"customerId"===e},null,8,["modelValue","onUpdate:modelValue","disabled"])):"createdDate"===e?((0,u.uX)(),(0,u.CE)("span",ZL,(0,L.v_)(q(V.value[e])),1)):"createdBy"===e?((0,u.uX)(),(0,u.CE)("span",eR,[(0,u.bF)(yl,{"employee-id":V.value[e]},null,8,["employee-id"])])):((0,u.uX)(),(0,u.CE)("span",aR,(0,L.v_)(V.value[e]),1))])),_:2},1032,["label"])))),128))])),_:1},8,["model"])])),_:1},8,["title","modelValue"]),(0,u.bF)(NL,{visible:E.value,"onUpdate:visible":l[11]||(l[11]=e=>E.value=e),"customer-id":V.value.customerId,"fullCompany-name":V.value.fullCompanyName,"get-formatted-date-range":P(n.value).formattedStart+"_"+P(n.value).formattedEnd},null,8,["visible","customer-id","fullCompany-name","get-formatted-date-range"])])}}};const tR=(0,ie.A)(lR,[["__scopeId","data-v-6d292e6a"]]);var oR=tR;const nR={class:"ml-6"},rR={class:"ml-6",style:{"padding-right":"1rem"}};var sR={__name:"CustomerInfo",setup(e){return(e,a)=>((0,u.uX)(),(0,u.CE)(u.FK,null,[(0,u.Lk)("div",nR,[(0,u.bF)(VL)]),(0,u.Lk)("div",rR,[(0,u.bF)(oR)])],64))}};const uR=sR;var iR=uR;function dR(){const e=(0,d.KR)([]),a=(0,d.KR)(!0),l=(0,d.KR)(null),t=async()=>{try{const a=await OC.getSalesEmployeeData();e.value=a.data,console.log("è² è²¬æ¥­å‹™è³‡æ–™ï¼š",a.data)}catch(t){l.value=t,console.error("å–å¾—è² è²¬æ¥­å‹™è³‡æ–™å¤±æ•—ï¼š",t)}finally{a.value=!1}};return(0,u.sV)(t),{salesEmployees:e,loading:a,error:l,fetchSalesEmployeeData:t}}const cR={class:"fill-customer-tracking"};var pR={__name:"Fill_CustomerTracking",emits:["formSubmitted"],setup(e,{emit:a}){const l=a,t=(0,d.KR)({fillDate:(new Date).toISOString().split("T")[0],salesperson:"",customerSource:"",customerSourceOther:"",customerType:"",customerTypeOther:"",customerName:"",contactPerson:"",contactPhone:""}),o={fillDate:[{required:!0,message:"è«‹é¸æ“‡å¡«å¯«æ—¥æœŸ",trigger:"change"}],salesperson:[{required:!0,message:"è«‹é¸æ“‡è² è²¬æ¥­å‹™",trigger:"change"}],customerSource:[{required:!0,message:"è«‹é¸æ“‡å®¢æˆ¶ä¾†æº",trigger:"change"}],customerSourceOther:[{validator:(e,a)=>{if("å…¶ä»–"===t.value.customerSource&&!a)return new Error("è«‹è¼¸å…¥å…¶ä»–å®¢æˆ¶ä¾†æº")},trigger:"blur"}],customerType:[{required:!0,message:"è«‹é¸æ“‡å®¢æˆ¶é¡žåž‹",trigger:"change"}],customerTypeOther:[{validator:(e,a)=>{if("å…¶ä»–"===t.value.customerType&&!a)return new Error("è«‹è¼¸å…¥å…¶ä»–å®¢æˆ¶é¡žåž‹")},trigger:"blur"}],customerName:[{required:!0,message:"è«‹è¼¸å…¥å®¢æˆ¶åç¨±",trigger:"blur"}],contactPerson:[{required:!0,message:"è«‹è¼¸å…¥è¯çµ¡äºº",trigger:"blur"}],contactPhone:[{required:!0,message:"è«‹è¼¸å…¥è¯çµ¡é›»è©±",trigger:"blur"},{pattern:/^[0-9\-#]+$/,message:"è¯çµ¡é›»è©±æ ¼å¼ä¸æ­£ç¢º",trigger:"blur"}]},n=(0,d.KR)(),r=()=>{n.value.validate((async e=>{if(e)try{const e={...t.value};"å…¶ä»–"===e.customerSource&&(e.customerSource=e.customerSourceOther),"å…¶ä»–"===e.customerType&&(e.customerType=e.customerTypeOther),await OC.createCustomerTracking(e),D.nk.success("å®¢æˆ¶è¿½è¹¤è³‡æ–™æäº¤æˆåŠŸï¼"),t.value={fillDate:(new Date).toISOString().split("T")[0],salesperson:"",customerSource:"",customerSourceOther:"",customerType:"",customerTypeOther:"",customerName:"",contactPerson:"",contactPhone:""},n.value.clearValidate(),l("formSubmitted")}catch(a){console.error("æäº¤å®¢æˆ¶è¿½è¹¤è³‡æ–™å¤±æ•—ï¼š",a),D.nk.error("æäº¤å®¢æˆ¶è¿½è¹¤è³‡æ–™å¤±æ•—ï¼")}}))},{salesEmployees:s,fetchSalesEmployeeData:i}=dR(),c=e=>e.getTime()>Date.now();return(0,u.sV)((async()=>{await i()})),(e,a)=>{const l=(0,u.g2)("el-date-picker"),i=(0,u.g2)("el-form-item"),p=(0,u.g2)("el-col"),m=(0,u.g2)("el-option"),v=(0,u.g2)("el-select"),b=(0,u.g2)("el-input"),g=(0,u.g2)("el-button"),y=(0,u.g2)("el-row"),f=(0,u.g2)("el-form");return(0,u.uX)(),(0,u.CE)("div",cR,[(0,u.bF)(f,{model:t.value,"label-width":"4.5rem",rules:o,ref_key:"formRef",ref:n},{default:(0,u.k6)((()=>[(0,u.bF)(y,{gutter:20},{default:(0,u.k6)((()=>[(0,u.bF)(p,{span:6},{default:(0,u.k6)((()=>[(0,u.bF)(i,{label:"å¡«å¯«æ—¥æœŸ","label-width":"5rem",prop:"fillDate"},{default:(0,u.k6)((()=>[(0,u.bF)(l,{modelValue:t.value.fillDate,"onUpdate:modelValue":a[0]||(a[0]=e=>t.value.fillDate=e),type:"date",placeholder:"é¸æ“‡æ—¥æœŸ",style:{width:"100%"},"value-format":"YYYY-MM-DD","disabled-date":c},null,8,["modelValue"])])),_:1})])),_:1}),(0,u.bF)(p,{span:6},{default:(0,u.k6)((()=>[(0,u.bF)(i,{label:"è² è²¬æ¥­å‹™","label-width":"5rem",prop:"salesperson"},{default:(0,u.k6)((()=>[(0,u.bF)(v,{modelValue:t.value.salesperson,"onUpdate:modelValue":a[1]||(a[1]=e=>t.value.salesperson=e),placeholder:"è«‹é¸æ“‡è² è²¬æ¥­å‹™",style:{width:"100%"}},{default:(0,u.k6)((()=>[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)((0,d.R1)(s),(e=>((0,u.uX)(),(0,u.Wv)(m,{key:e.id,label:e.titleName+" - "+e.name,value:e.name},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1}),(0,u.bF)(p,{span:6},{default:(0,u.k6)((()=>[(0,u.bF)(i,{label:"å®¢æˆ¶ä¾†æº","label-width":"5rem",prop:"customerSource"},{default:(0,u.k6)((()=>[(0,u.bF)(v,{modelValue:t.value.customerSource,"onUpdate:modelValue":a[2]||(a[2]=e=>t.value.customerSource=e),placeholder:"è«‹é¸æ“‡å®¢æˆ¶ä¾†æº",style:{width:"100%"}},{default:(0,u.k6)((()=>[(0,u.bF)(m,{label:"é™Œé–‹",value:"é™Œé–‹"}),(0,u.bF)(m,{label:"å±•è¦½",value:"å±•è¦½"}),(0,u.bF)(m,{label:"å°ˆæ¡ˆ",value:"å°ˆæ¡ˆ"}),(0,u.bF)(m,{label:"å…¶ä»–",value:"å…¶ä»–"})])),_:1},8,["modelValue"]),"å…¶ä»–"===t.value.customerSource?((0,u.uX)(),(0,u.Wv)(b,{key:0,modelValue:t.value.customerSourceOther,"onUpdate:modelValue":a[3]||(a[3]=e=>t.value.customerSourceOther=e),placeholder:"è«‹è¼¸å…¥å…¶ä»–å®¢æˆ¶ä¾†æº",style:{"margin-top":"5px",width:"100%"}},null,8,["modelValue"])):(0,u.Q3)("",!0)])),_:1})])),_:1}),(0,u.bF)(p,{span:6},{default:(0,u.k6)((()=>[(0,u.bF)(i,{label:"å®¢æˆ¶é¡žåž‹","label-width":"5rem",prop:"customerType"},{default:(0,u.k6)((()=>[(0,u.bF)(v,{modelValue:t.value.customerType,"onUpdate:modelValue":a[4]||(a[4]=e=>t.value.customerType=e),placeholder:"è«‹é¸æ“‡å®¢æˆ¶é¡žåž‹",style:{width:"100%"}},{default:(0,u.k6)((()=>[(0,u.bF)(m,{label:"ç³»çµ±æ•´åˆå•†",value:"ç³»çµ±æ•´åˆå•†"}),(0,u.bF)(m,{label:"è¨­å‚™å» å•†",value:"è¨­å‚™å» å•†"}),(0,u.bF)(m,{label:"æ°´é›»å» å•†",value:"æ°´é›»å» å•†"}),(0,u.bF)(m,{label:"å¼±é›»å» å•†",value:"å¼±é›»å» å•†"}),(0,u.bF)(m,{label:"å»ºç¯‰å¸«äº‹å‹™æ‰€",value:"å»ºç¯‰å¸«äº‹å‹™æ‰€"}),(0,u.bF)(m,{label:"å®¤å…§è¨­è¨ˆå…¬å¸",value:"å®¤å…§è¨­è¨ˆå…¬å¸"}),(0,u.bF)(m,{label:"å»ºè¨­ç‡Ÿé€ å…¬å¸",value:"å»ºè¨­ç‡Ÿé€ å…¬å¸"}),(0,u.bF)(m,{label:"æ©Ÿé›»å·¥ç¨‹å…¬å¸",value:"æ©Ÿé›»å·¥ç¨‹å…¬å¸"}),(0,u.bF)(m,{label:"ç‰©æ¥­ç®¡ç†å…¬å¸",value:"ç‰©æ¥­ç®¡ç†å…¬å¸"}),(0,u.bF)(m,{label:"ç®¡ç†é¡§å•å…¬å¸",value:"ç®¡ç†é¡§å•å…¬å¸"}),(0,u.bF)(m,{label:"ä¼æ¥­",value:"ä¼æ¥­"}),(0,u.bF)(m,{label:"å­¸æ ¡",value:"å­¸æ ¡"}),(0,u.bF)(m,{label:"é†«é™¢",value:"é†«é™¢"}),(0,u.bF)(m,{label:"å…¬å®¶æ©Ÿé—œ",value:"å…¬å®¶æ©Ÿé—œ"}),(0,u.bF)(m,{label:"å…¶ä»–",value:"å…¶ä»–"})])),_:1},8,["modelValue"]),"å…¶ä»–"===t.value.customerType?((0,u.uX)(),(0,u.Wv)(b,{key:0,modelValue:t.value.customerTypeOther,"onUpdate:modelValue":a[5]||(a[5]=e=>t.value.customerTypeOther=e),placeholder:"è«‹è¼¸å…¥å…¶ä»–å®¢æˆ¶é¡žåž‹",style:{"margin-top":"5px",width:"100%"}},null,8,["modelValue"])):(0,u.Q3)("",!0)])),_:1})])),_:1}),(0,u.bF)(p,{span:6},{default:(0,u.k6)((()=>[(0,u.bF)(i,{label:"å®¢æˆ¶åç¨±","label-width":"5rem",prop:"customerName"},{default:(0,u.k6)((()=>[(0,u.bF)(b,{modelValue:t.value.customerName,"onUpdate:modelValue":a[6]||(a[6]=e=>t.value.customerName=e),style:{width:"100%"}},null,8,["modelValue"])])),_:1})])),_:1}),(0,u.bF)(p,{span:6},{default:(0,u.k6)((()=>[(0,u.bF)(i,{label:"è¯çµ¡äºº","label-width":"5rem",prop:"contactPerson"},{default:(0,u.k6)((()=>[(0,u.bF)(b,{modelValue:t.value.contactPerson,"onUpdate:modelValue":a[7]||(a[7]=e=>t.value.contactPerson=e),style:{width:"100%"}},null,8,["modelValue"])])),_:1})])),_:1}),(0,u.bF)(p,{span:6},{default:(0,u.k6)((()=>[(0,u.bF)(i,{label:"è¯çµ¡é›»è©±","label-width":"5rem",prop:"contactPhone"},{default:(0,u.k6)((()=>[(0,u.bF)(b,{modelValue:t.value.contactPhone,"onUpdate:modelValue":a[8]||(a[8]=e=>t.value.contactPhone=e),style:{width:"100%"}},null,8,["modelValue"])])),_:1})])),_:1}),(0,u.bF)(p,{span:6},{default:(0,u.k6)((()=>[(0,u.bF)(i,null,{default:(0,u.k6)((()=>[(0,u.bF)(g,{type:"primary",onClick:r,style:{width:"50%"}},{default:(0,u.k6)((()=>a[9]||(a[9]=[(0,u.eW)("æäº¤")]))),_:1})])),_:1})])),_:1})])),_:1})])),_:1},8,["model"])])}}};const mR=(0,ie.A)(pR,[["__scopeId","data-v-296cc7d6"]]);var vR=mR;const bR={class:"list-customer-info",style:{"margin-left":"3rem","margin-right":"2rem"}},gR={ref:"wrapper",class:"drag-wrapper"},yR={class:"controls-bar mb-4 w-full",style:{padding:"1rem",display:"flex","align-items":"center","border-color":"black","border-width":"1px"}},fR={class:"date-range-block",style:{display:"flex","align-items":"center","margin-left":"1rem"}},hR={class:"block"},kR={class:"search-block",style:{display:"flex","margin-left":"2rem","align-items":"center",gap:"8px"}},_R={class:"pagination-block",style:{display:"flex","align-items":"center","margin-left":"1rem"}},wR={style:{"margin-left":"5rem"}},FR={key:1},CR={key:0},DR={key:0},LR={key:0},RR={key:1},VR={key:0},IR={key:1},xR={key:0},ER={key:0},AR={key:0};var TR={__name:"List_CustomerTracking",setup(e,{expose:a}){const l=(0,d.KR)([]),o=(0,d.KR)(""),n=(0,d.KR)("customerName"),r=(0,d.KR)(null),s=(0,d.KR)([]),i=[{label:"å®¢æˆ¶åç¨±",value:"customerName"},{label:"è² è²¬æ¥­å‹™",value:"salesPerson"},{label:"å®¢æˆ¶ä¾†æº",value:"customerSource"},{label:"å®¢æˆ¶é¡žåž‹",value:"customerType"},{label:"è¯çµ¡äºº",value:"contactPerson"},{label:"è¯çµ¡é›»è©±",value:"contactPhone"}],c=(0,u.EW)((()=>"fillDate"===n.value?"è«‹è¼¸å…¥æ—¥æœŸ (YYYY-MM-DD)":"è«‹è¼¸å…¥é—œéµå­—")),p=(0,d.KR)(10),m=(0,d.KR)(1),v=async()=>{try{const e=await OC.getAllCustomerTracking();l.value=e.data.sort(((e,a)=>new Date(a.fillDate)-new Date(e.fillDate)))}catch(e){console.error("å–å¾—å®¢æˆ¶è¿½è¹¤è³‡æ–™å¤±æ•—ï¼š",e)}},b=(0,u.EW)((()=>{const e=l.value,a=o.value.trim().toLowerCase(),[t,r]=s.value||[];return e.filter((e=>{if(!t||!r)return!0;const a=new Date(e.fillDate),l=new Date(t);l.setHours(0,0,0,0);const o=new Date(r);return o.setHours(23,59,59,999),a>=l&&a<=o})).filter((e=>{if(!a)return!0;const l=e[n.value];return"fillDate"===n.value?F(e.fillDate).toLowerCase().includes(a):l&&l.toString().toLowerCase().includes(a)}))})),g=e=>{r.value=e.id},y=async()=>{r.value=null},f=async e=>{try{if("å…¶ä»–"===e.customerSource&&!e.customerSourceOther)return void D.nk.error("è«‹å¡«å¯«å®¢æˆ¶ä¾†æºçš„ã€Œå…¶ä»–ã€å…§å®¹");if("å…¶ä»–"===e.customerType&&!e.customerTypeOther)return void D.nk.error("è«‹å¡«å¯«å®¢æˆ¶é¡žåž‹çš„ã€Œå…¶ä»–ã€å…§å®¹");const a={...e};a.fillDate instanceof Date&&(a.fillDate=a.fillDate.toISOString().split("T")[0]),"å…¶ä»–"===a.customerSource&&a.customerSourceOther&&(a.customerSource=a.customerSourceOther),"å…¶ä»–"===a.customerType&&a.customerTypeOther&&(a.customerType=a.customerTypeOther),await OC.updateCustomerTracking(e.id,a),D.nk.success("æ›´æ–°æˆåŠŸ"),r.value=null,await v()}catch(a){D.nk.error("æ›´æ–°å¤±æ•—"),console.error("æ›´æ–°å®¢æˆ¶è¿½è¹¤è³‡æ–™å¤±æ•—ï¼š",a)}},h=e=>{Sa.s.confirm(`ç¢ºå®šè¦åˆªé™¤ã€Œ${e.customerName}ã€é€™ç­†è³‡æ–™å—Žï¼Ÿ`,"åˆªé™¤ç¢ºèª",{type:"warning"}).then((async()=>{try{await OC.deleteCustomerTracking(e.id),D.nk.success("åˆªé™¤æˆåŠŸ"),l.value=l.value.filter((a=>a.id!==e.id))}catch(a){D.nk.error("åˆªé™¤å¤±æ•—")}})).catch((()=>{}))},k=(0,u.EW)((()=>{const e=(m.value-1)*p.value;return b.value.slice(e,e+p.value)})),_=()=>{m.value=1},w=e=>{m.value=e},F=e=>e?new Date(e).toLocaleString("zh-TW",{timeZone:"Asia/Taipei",year:"numeric",month:"2-digit",day:"2-digit"}):"",{salesEmployees:C,fetchSalesEmployeeData:R}=dR(),V=async()=>{await v()};return(0,u.sV)((async()=>{await v(),or.on("caseTrackingAdded",V),await R();const e=new Date,a=new Date;a.setMonth(e.getMonth()-1);const l=new Date(a.getFullYear(),a.getMonth(),a.getDate(),0,0,0),t=new Date(e.getFullYear(),e.getMonth(),e.getDate(),23,59,59);s.value=[l,t]})),a({loadCustomerTracking:v}),(e,a)=>{const l=(0,u.g2)("el-date-picker"),v=(0,u.g2)("el-option"),D=(0,u.g2)("el-select"),R=(0,u.g2)("el-input"),V=(0,u.g2)("el-button"),I=(0,u.g2)("el-text"),x=(0,u.g2)("el-pagination"),E=(0,u.g2)("el-table-column"),A=(0,u.g2)("el-table");return(0,u.uX)(),(0,u.CE)("div",bR,[(0,u.Lk)("div",gR,[(0,u.Lk)("div",yR,[(0,u.Lk)("div",fR,[a[6]||(a[6]=(0,u.Lk)("span",{style:{"margin-right":"1rem"}}," é¸æ“‡æŸ¥è©¢æ—¥æœŸå€é–“",-1)),(0,u.Lk)("div",hR,[(0,u.bF)(l,{modelValue:s.value,"onUpdate:modelValue":a[0]||(a[0]=e=>s.value=e),type:"daterange","range-separator":"~","start-placeholder":"é–‹å§‹","end-placeholder":"çµæŸ",style:{width:"17rem"}},null,8,["modelValue"])])]),(0,u.Lk)("div",kR,[(0,u.bF)(D,{modelValue:n.value,"onUpdate:modelValue":a[1]||(a[1]=e=>n.value=e),placeholder:"é¸æ“‡æ¬„ä½",style:{width:"9rem"}},{default:(0,u.k6)((()=>[((0,u.uX)(),(0,u.CE)(u.FK,null,(0,u.pI)(i,(e=>(0,u.bF)(v,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),64))])),_:1},8,["modelValue"]),(0,u.bF)(R,{modelValue:o.value,"onUpdate:modelValue":a[2]||(a[2]=e=>o.value=e),placeholder:c.value,clearable:"",onClear:_,onKeyup:(0,t.jR)(_,["enter"]),style:{width:"200px"}},null,8,["modelValue","placeholder"]),(0,u.bF)(V,{type:"primary",onClick:_},{default:(0,u.k6)((()=>a[7]||(a[7]=[(0,u.eW)("æœå°‹")]))),_:1})]),(0,u.Lk)("div",_R,[(0,u.bF)(I,{class:"mx-1",type:"info"},{default:(0,u.k6)((()=>a[8]||(a[8]=[(0,u.eW)("æ¯é é¡¯ç¤º")]))),_:1}),(0,u.bF)(D,{modelValue:p.value,"onUpdate:modelValue":a[3]||(a[3]=e=>p.value=e),placeholder:"",style:{width:"4rem"},size:"small"},{default:(0,u.k6)((()=>[((0,u.uX)(),(0,u.CE)(u.FK,null,(0,u.pI)([5,10,15,20,25,30],(e=>(0,u.bF)(v,{key:e,label:e,value:e},null,8,["label","value"]))),64))])),_:1},8,["modelValue"]),(0,u.bF)(I,{class:"mx-1",type:"info"},{default:(0,u.k6)((()=>a[9]||(a[9]=[(0,u.eW)("ç­†")]))),_:1}),(0,u.Lk)("div",wR,[(0,u.bF)(x,{background:"",layout:"prev, pager, next",total:b.value.length,"page-size":p.value,"current-page":m.value,"onUpdate:currentPage":a[4]||(a[4]=e=>m.value=e),onCurrentChange:w},null,8,["total","page-size","current-page"])])])]),(0,u.bF)(A,{class:"black-border-table",data:k.value,stripe:"",border:""},{default:(0,u.k6)((()=>[(0,u.bF)(E,{label:"æ“ä½œ",width:"150",fixed:"left"},{default:(0,u.k6)((({row:e})=>[r.value!==e.id?((0,u.uX)(),(0,u.Wv)(V,{key:0,type:"primary",size:"small",onClick:a=>g(e)},{default:(0,u.k6)((()=>a[10]||(a[10]=[(0,u.eW)("ç·¨è¼¯")]))),_:2},1032,["onClick"])):((0,u.uX)(),(0,u.CE)("div",FR,[(0,u.bF)(V,{type:"success",size:"small",onClick:a=>f(e)},{default:(0,u.k6)((()=>a[11]||(a[11]=[(0,u.eW)(" å®Œæˆ ")]))),_:2},1032,["onClick"]),(0,u.bF)(V,{type:"info",size:"small",onClick:a[5]||(a[5]=e=>y())},{default:(0,u.k6)((()=>a[12]||(a[12]=[(0,u.eW)(" å–æ¶ˆ ")]))),_:1})])),r.value!==e.id?((0,u.uX)(),(0,u.Wv)(V,{key:2,type:"danger",size:"small",onClick:a=>h(e)},{default:(0,u.k6)((()=>a[13]||(a[13]=[(0,u.eW)("åˆªé™¤")]))),_:2},1032,["onClick"])):(0,u.Q3)("",!0)])),_:1}),(0,u.bF)(E,{prop:"fillDate",label:"å¡«å¯«æ—¥æœŸ",width:"140"},{default:(0,u.k6)((({row:e})=>[r.value!==e.id?((0,u.uX)(),(0,u.CE)("span",CR,(0,L.v_)(F(e.fillDate)),1)):((0,u.uX)(),(0,u.Wv)(l,{key:1,style:{width:"7rem"},modelValue:e.fillDate,"onUpdate:modelValue":a=>e.fillDate=a,type:"date",placeholder:"é¸æ“‡æ—¥æœŸ",size:"small"},null,8,["modelValue","onUpdate:modelValue"]))])),_:1}),(0,u.bF)(E,{prop:"salesPerson",label:"è² è²¬æ¥­å‹™",width:"130"},{default:(0,u.k6)((({row:e})=>[r.value!==e.id?((0,u.uX)(),(0,u.CE)("span",DR,(0,L.v_)(e.salesPerson),1)):((0,u.uX)(),(0,u.Wv)(D,{key:1,modelValue:e.salesPerson,"onUpdate:modelValue":a=>e.salesPerson=a,placeholder:"è«‹é¸æ“‡è² è²¬æ¥­å‹™",size:"small"},{default:(0,u.k6)((()=>[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)((0,d.R1)(C),(e=>((0,u.uX)(),(0,u.Wv)(v,{key:e.id,label:e.titleName+" - "+e.name,value:e.name},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue"]))])),_:1}),(0,u.bF)(E,{prop:"customerSource",label:"å®¢æˆ¶ä¾†æº",width:"120"},{default:(0,u.k6)((({row:e})=>[r.value!==e.id?((0,u.uX)(),(0,u.CE)("span",LR,(0,L.v_)(e.customerSource),1)):((0,u.uX)(),(0,u.CE)("div",RR,[(0,u.bF)(D,{modelValue:e.customerSource,"onUpdate:modelValue":a=>e.customerSource=a,placeholder:"è«‹é¸æ“‡å®¢æˆ¶ä¾†æº",size:"small"},{default:(0,u.k6)((()=>[(0,u.bF)(v,{label:"é™Œé–‹",value:"é™Œé–‹"}),(0,u.bF)(v,{label:"å±•è¦½",value:"å±•è¦½"}),(0,u.bF)(v,{label:"å°ˆæ¡ˆ",value:"å°ˆæ¡ˆ"}),(0,u.bF)(v,{label:"å…¶ä»–",value:"å…¶ä»–"})])),_:2},1032,["modelValue","onUpdate:modelValue"]),"å…¶ä»–"===e.customerSource?((0,u.uX)(),(0,u.Wv)(R,{key:0,modelValue:e.customerSourceOther,"onUpdate:modelValue":a=>e.customerSourceOther=a,placeholder:"è«‹è¼¸å…¥å…¶ä»–å®¢æˆ¶ä¾†æº",style:{"margin-top":"5px"},size:"small"},null,8,["modelValue","onUpdate:modelValue"])):(0,u.Q3)("",!0)]))])),_:1}),(0,u.bF)(E,{prop:"customerType",label:"å®¢æˆ¶é¡žåž‹",width:"120"},{default:(0,u.k6)((({row:e})=>[r.value!==e.id?((0,u.uX)(),(0,u.CE)("span",VR,(0,L.v_)(e.customerType),1)):((0,u.uX)(),(0,u.CE)("div",IR,[(0,u.bF)(D,{modelValue:e.customerType,"onUpdate:modelValue":a=>e.customerType=a,placeholder:"è«‹é¸æ“‡å®¢æˆ¶é¡žåž‹",size:"small"},{default:(0,u.k6)((()=>[(0,u.bF)(v,{label:"ç³»çµ±æ•´åˆå•†",value:"ç³»çµ±æ•´åˆå•†"}),(0,u.bF)(v,{label:"è¨­å‚™å» å•†",value:"è¨­å‚™å» å•†"}),(0,u.bF)(v,{label:"æ°´é›»å» å•†",value:"æ°´é›»å» å•†"}),(0,u.bF)(v,{label:"å¼±é›»å» å•†",value:"å¼±é›»å» å•†"}),(0,u.bF)(v,{label:"å»ºç¯‰å¸«äº‹å‹™æ‰€",value:"å»ºç¯‰å¸«äº‹å‹™æ‰€"}),(0,u.bF)(v,{label:"å®¤å…§è¨­è¨ˆå…¬å¸",value:"å®¤å…§è¨­è¨ˆå…¬å¸"}),(0,u.bF)(v,{label:"å»ºè¨­ç‡Ÿé€ å…¬å¸",value:"å»ºè¨­ç‡Ÿé€ å…¬å¸"}),(0,u.bF)(v,{label:"æ©Ÿé›»å·¥ç¨‹å…¬å¸",value:"æ©Ÿé›»å·¥ç¨‹å…¬å¸"}),(0,u.bF)(v,{label:"ç‰©æ¥­ç®¡ç†å…¬å¸",value:"ç‰©æ¥­ç®¡ç†å…¬å¸"}),(0,u.bF)(v,{label:"ç®¡ç†é¡§å•å…¬å¸",value:"ç®¡ç†é¡§å•å…¬å¸"}),(0,u.bF)(v,{label:"ä¼æ¥­",value:"ä¼æ¥­"}),(0,u.bF)(v,{label:"å­¸æ ¡",value:"å­¸æ ¡"}),(0,u.bF)(v,{label:"é†«é™¢",value:"é†«é™¢"}),(0,u.bF)(v,{label:"å…¬å®¶æ©Ÿé—œ",value:"å…¬å®¶æ©Ÿé—œ"}),(0,u.bF)(v,{label:"å…¶ä»–",value:"å…¶ä»–"})])),_:2},1032,["modelValue","onUpdate:modelValue"]),"å…¶ä»–"===e.customerType?((0,u.uX)(),(0,u.Wv)(R,{key:0,modelValue:e.customerTypeOther,"onUpdate:modelValue":a=>e.customerTypeOther=a,placeholder:"è«‹è¼¸å…¥å…¶ä»–å®¢æˆ¶é¡žåž‹",style:{"margin-top":"5px"},size:"small"},null,8,["modelValue","onUpdate:modelValue"])):(0,u.Q3)("",!0)]))])),_:1}),(0,u.bF)(E,{prop:"customerName",label:"å®¢æˆ¶åç¨±",width:"150"},{default:(0,u.k6)((({row:e})=>[r.value!==e.id?((0,u.uX)(),(0,u.CE)("span",xR,(0,L.v_)(e.customerName),1)):((0,u.uX)(),(0,u.Wv)(R,{key:1,modelValue:e.customerName,"onUpdate:modelValue":a=>e.customerName=a,size:"small"},null,8,["modelValue","onUpdate:modelValue"]))])),_:1}),(0,u.bF)(E,{prop:"contactPerson",label:"è¯çµ¡äºº",width:"120"},{default:(0,u.k6)((({row:e})=>[r.value!==e.id?((0,u.uX)(),(0,u.CE)("span",ER,(0,L.v_)(e.contactPerson),1)):((0,u.uX)(),(0,u.Wv)(R,{key:1,modelValue:e.contactPerson,"onUpdate:modelValue":a=>e.contactPerson=a,size:"small"},null,8,["modelValue","onUpdate:modelValue"]))])),_:1}),(0,u.bF)(E,{prop:"contactPhone",label:"è¯çµ¡é›»è©±",width:"150"},{default:(0,u.k6)((({row:e})=>[r.value!==e.id?((0,u.uX)(),(0,u.CE)("span",AR,(0,L.v_)(e.contactPhone),1)):((0,u.uX)(),(0,u.Wv)(R,{key:1,modelValue:e.contactPhone,"onUpdate:modelValue":a=>e.contactPhone=a,size:"small"},null,8,["modelValue","onUpdate:modelValue"]))])),_:1})])),_:1},8,["data"])],512)])}}};const WR=(0,ie.A)(TR,[["__scopeId","data-v-c0606064"]]);var SR=WR;const UR={class:"ml-6 mt-7"},$R={class:"ml-6",style:{"padding-top":"3rem","padding-right":"1rem"}};var NR={__name:"CustomerTracking",setup(e){const a=(0,d.KR)(null),l=()=>{a.value&&a.value.loadCustomerTracking&&a.value.loadCustomerTracking()};return(e,t)=>((0,u.uX)(),(0,u.CE)(u.FK,null,[(0,u.Lk)("div",UR,[(0,u.bF)(vR,{onFormSubmitted:l})]),(0,u.Lk)("div",$R,[(0,u.bF)(SR,{ref_key:"listCustomerTrackingRef",ref:a},null,512)])],64))}};const XR=NR;var KR=XR;let MR;function PR(e){MR=e}const OR=()=>MR,zR="/Sales";var BR={querySales(e,a={page:1,pageSize:50}){const l={page:a.page,pageSize:a.pageSize};return OR().post(`${zR}/query?page=${l.page}&pageSize=${l.pageSize}`,e)},getCustomers(e={}){return OR().get(`${zR}/customers`,{params:e})},getProjects(e={}){return OR().get(`${zR}/projects`,{params:e})}};const jR={class:"sales-query-container"},YR={class:"card-header"},QR={key:0,class:"result-count"},HR={key:0,class:"no-data"},qR={key:1,class:"pagination-container"};var JR={__name:"SalesQuery",setup(e){const a=(0,d.KR)(),l=(0,d.Kh)({billNo:"",customerName:"",projectName:""}),t={},o=(0,d.KR)([]),n=(0,d.KR)(!1),r=(0,d.KR)(!1),s=(0,d.Kh)({page:1,pageSize:50,totalCount:0,totalPages:0,hasNextPage:!1,hasPreviousPage:!1}),i=async(e=!0)=>{if(l.billNo||l.customerName||l.projectName)try{n.value=!0,r.value=!0,e&&(s.page=1);const a={billNo:l.billNo||null,customerName:l.customerName||null,projectName:l.projectName||null},t={page:s.page,pageSize:s.pageSize},u=await BR.querySales(a,t);if(console.log("API Response:",u.data),u.data&&"object"===typeof u.data)if(Object.prototype.hasOwnProperty.call(u.data,"totalCount")||Object.prototype.hasOwnProperty.call(u.data,"page")){const e=Array.isArray(u.data.data)?u.data.data:[];o.value=e,s.totalCount=u.data.totalCount||0,s.totalPages=u.data.totalPages||1,s.hasNextPage=u.data.hasNextPage||!1,s.hasPreviousPage=u.data.hasPreviousPage||!1,console.log("âœ… æˆåŠŸè™•ç†æ··åˆæ ¼å¼ API å›žæ‡‰"),console.log("åˆ†é è³‡è¨Š:",{page:s.page,pageSize:s.pageSize,totalCount:s.totalCount,totalPages:s.totalPages,dataLength:o.value.length}),0===o.value.length?D.nk.info("æŸ¥ç„¡ç¬¦åˆæ¢ä»¶çš„è³‡æ–™"):D.nk.success(`æŸ¥è©¢æˆåŠŸï¼Œå…±æ‰¾åˆ° ${s.totalCount} ç­†è³‡æ–™`)}else if(void 0!==u.data.Data){const e=Array.isArray(u.data.Data)?u.data.Data:[];o.value=e,s.totalCount=u.data.TotalCount||0,s.totalPages=u.data.TotalPages||1,s.hasNextPage=u.data.HasNextPage||!1,s.hasPreviousPage=u.data.HasPreviousPage||!1,0===o.value.length?D.nk.info("æŸ¥ç„¡ç¬¦åˆæ¢ä»¶çš„è³‡æ–™"):D.nk.success(`æŸ¥è©¢æˆåŠŸï¼Œå…±æ‰¾åˆ° ${s.totalCount} ç­†è³‡æ–™`)}else console.error("æœªé æœŸçš„ API å›žæ‡‰æ ¼å¼:",u.data),o.value=[],s.totalCount=0,s.totalPages=1,s.hasNextPage=!1,s.hasPreviousPage=!1,D.nk.warning("API å›žæ‡‰æ ¼å¼ç•°å¸¸ï¼Œè«‹æª¢æŸ¥å¾Œç«¯æœå‹™");else Array.isArray(u.data)?(o.value=u.data,s.totalCount=u.data.length,s.totalPages=Math.ceil(u.data.length/s.pageSize),s.hasNextPage=s.page<s.totalPages,s.hasPreviousPage=s.page>1,0===o.value.length?D.nk.info("æŸ¥ç„¡ç¬¦åˆæ¢ä»¶çš„è³‡æ–™"):D.nk.success(`æŸ¥è©¢æˆåŠŸï¼Œå…±æ‰¾åˆ° ${s.totalCount} ç­†è³‡æ–™`)):(console.error("æœªé æœŸçš„ API å›žæ‡‰æ ¼å¼:",u.data),o.value=[],s.totalCount=0,s.totalPages=1,s.hasNextPage=!1,s.hasPreviousPage=!1,D.nk.warning("API å›žæ‡‰æ ¼å¼ç•°å¸¸ï¼Œè«‹æª¢æŸ¥å¾Œç«¯æœå‹™"))}catch(a){console.error("æŸ¥è©¢å¤±æ•—:",a),D.nk.error("æŸ¥è©¢å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦"),o.value=[],s.totalCount=0,s.totalPages=1,s.hasNextPage=!1,s.hasPreviousPage=!1}finally{n.value=!1}else D.nk.warning("è«‹è‡³å°‘å¡«å¯«ä¸€å€‹æŸ¥è©¢æ¢ä»¶")},c=()=>{a.value?.resetFields(),o.value=[],r.value=!1,s.page=1,s.pageSize=50,s.totalCount=0,s.totalPages=0,s.hasNextPage=!1,s.hasPreviousPage=!1},p=e=>{console.log("åˆ†é å¤§å°æ”¹è®Š:",e),s.pageSize=e,s.page=1,i(!1)},m=e=>{console.log("ç•¶å‰é æ”¹è®Š:",e),s.page=e,i(!1)},v=()=>{if(0!==o.value.length)try{const e=o.value.map((e=>({"éŠ·è²¨å–®è™Ÿç¢¼":e.éŠ·è²¨å–®è™Ÿç¢¼,"éŠ·è²¨æ—¥æœŸ":b(e.éŠ·è²¨æ—¥æœŸ),"å®¢æˆ¶åç¨±":e.å®¢æˆ¶åç¨±,"ç”¢å“ç·¨è™Ÿ":e.ç”¢å“ç·¨è™Ÿ,"å“åè¦æ ¼":e.å“åè¦æ ¼,"æ•¸é‡":e.æ•¸é‡,"å–®åƒ¹":e.å–®åƒ¹,"é‡‘é¡":e.é‡‘é¡,"å«ç¨…é‡‘é¡":e.å«ç¨…é‡‘é¡,"æ‰€å±¬å°ˆæ¡ˆ":e.æ‰€å±¬å°ˆæ¡ˆ,"æ¥­å‹™äººå“¡":e.æ¥­å‹™äººå“¡,"è¨‚å–®è™Ÿç¢¼":e.è¨‚å–®è™Ÿç¢¼}))),a=zg.Wp.json_to_sheet(e),l=zg.Wp.book_new();zg.Wp.book_append_sheet(l,a,"éŠ·è²¨æŸ¥è©¢çµæžœ");const t=`éŠ·è²¨æŸ¥è©¢çµæžœ_${(new Date).toISOString().slice(0,10)}.xlsx`;zg._h(l,t),D.nk.success("åŒ¯å‡ºæˆåŠŸ")}catch(e){console.error("åŒ¯å‡ºå¤±æ•—:",e),D.nk.error("åŒ¯å‡ºå¤±æ•—")}else D.nk.warning("æ²’æœ‰è³‡æ–™å¯ä»¥åŒ¯å‡º")},b=e=>{if(!e)return"";const a=e.toString();return 8===a.length?`${a.slice(0,4)}-${a.slice(4,6)}-${a.slice(6,8)}`:a},g=e=>null===e||void 0===e?"":Number(e).toLocaleString(),y=e=>null===e||void 0===e?"":`NT$ ${Number(e).toLocaleString()}`,f=()=>{if(0!==o.value.length)try{const e=h(),a=window.open("","_blank");a.document.write(e),a.document.close(),a.onload=()=>{a.print(),a.close()},D.nk.success("åˆ—å°è¦–çª—å·²é–‹å•Ÿ")}catch(e){console.error("åˆ—å°å¤±æ•—:",e),D.nk.error("åˆ—å°å¤±æ•—")}else D.nk.warning("æ²’æœ‰è³‡æ–™å¯ä»¥åˆ—å°")},h=()=>{const e=(new Date).toLocaleDateString("zh-TW"),a=(new Date).toLocaleTimeString("zh-TW");let t=`\n        <!DOCTYPE html>\n        <html>\n        <head>\n          <meta charset="UTF-8">\n          <title>éŠ·è²¨æŸ¥è©¢çµæžœ</title>\n          <style>\n            @page {\n              size: A4 landscape;\n              margin: 15mm;\n            }\n            body { \n              font-family: 'Microsoft JhengHei', Arial, sans-serif; \n              margin: 10px; \n              font-size: 10px;\n              line-height: 1.3;\n            }\n            .header { \n              text-align: center; \n              margin-bottom: 15px; \n              border-bottom: 2px solid #333;\n              padding-bottom: 8px;\n            }\n            .header h1 { \n              margin: 0; \n              font-size: 16px; \n              color: #333;\n            }\n            .print-info { \n              text-align: right; \n              margin-bottom: 10px; \n              font-size: 9px;\n              color: #666;\n            }\n            .query-conditions {\n              margin-bottom: 10px;\n              padding: 8px;\n              background-color: #f5f5f5;\n              border-radius: 4px;\n              font-size: 9px;\n            }\n            .query-conditions h3 {\n              margin: 0 0 8px 0;\n              font-size: 12px;\n            }\n            .condition-item {\n              display: inline-block;\n              margin-right: 15px;\n              margin-bottom: 3px;\n            }\n            table { \n              width: 100%; \n              border-collapse: collapse; \n              margin-bottom: 15px;\n              table-layout: fixed;\n            }\n            th, td { \n              border: 1px solid #ddd; \n              padding: 4px; \n              text-align: left;\n              font-size: 9px;\n              word-wrap: break-word;\n              overflow: hidden;\n            }\n            th { \n              background-color: #f2f2f2; \n              font-weight: bold;\n              text-align: center;\n              font-size: 10px;\n            }\n            /* è¨­å®šå„æ¬„ä½å¯¬åº¦ */\n            .col-date { width: 7%; }\n            .col-customer { width: 11%; }\n            .col-product-code { width: 7%; }\n            .col-product-name { width: 13%; }\n            .col-quantity { width: 5%; }\n            .col-price { width: 7%; }\n            .col-amount { width: 8%; }\n            .col-tax-amount { width: 8%; }\n            .col-project { width: 11%; }\n            .col-order { width: 8%; }\n            .col-sales { width: 7%; }\n            \n            .number { text-align: right; }\n            .center { text-align: center; }\n            .summary {\n              margin-top: 10px;\n              text-align: right;\n              font-weight: bold;\n              font-size: 11px;\n            }\n            @media print {\n              body { \n                margin: 0; \n                -webkit-print-color-adjust: exact;\n                print-color-adjust: exact;\n              }\n              .no-print { display: none; }\n              @page {\n                size: A4 landscape;\n                margin: 10mm;\n              }\n            }\n          </style>\n        </head>\n        <body>\n          <div class="header">\n            <h1>æ­£èˆªè³‡è¨Š - éŠ·è²¨æŸ¥è©¢çµæžœ</h1>\n          </div>\n          \n          <div class="print-info">\n            åˆ—å°æ—¥æœŸï¼š${e} ${a}\n          </div>\n          \n          <div class="query-conditions">\n            <h3>æŸ¥è©¢æ¢ä»¶ï¼š</h3>\n            ${l.billNo?`<span class="condition-item">éŠ·è²¨å–®è™Ÿç¢¼ï¼š${l.billNo}</span>`:""}\n            ${l.customerName?`<span class="condition-item">å®¢æˆ¶åç¨±ï¼š${l.customerName}</span>`:""}\n            ${l.projectName?`<span class="condition-item">æ‰€å±¬å°ˆæ¡ˆï¼š${l.projectName}</span>`:""}\n          </div>\n          \n          <table>\n            <thead>\n              <tr>\n                <th class="col-date">éŠ·è²¨æ—¥æœŸ</th>\n                <th class="col-customer">å®¢æˆ¶åç¨±</th>\n                <th class="col-product-code">ç”¢å“ç·¨è™Ÿ</th>\n                <th class="col-product-name">å“åè¦æ ¼</th>\n                <th class="col-quantity">æ•¸é‡</th>\n                <th class="col-price">å–®åƒ¹</th>\n                <th class="col-amount">é‡‘é¡</th>\n                <th class="col-tax-amount">å«ç¨…é‡‘é¡</th>\n                <th class="col-project">æ‰€å±¬å°ˆæ¡ˆ</th>\n                <th class="col-order">è¨‚å–®è™Ÿç¢¼</th>\n                <th class="col-sales">æ¥­å‹™äººå“¡</th>\n              </tr>\n            </thead>\n            <tbody>\n      `;o.value.forEach((e=>{t+=`\n          <tr>\n            <td class="col-date center">${b(e.éŠ·è²¨æ—¥æœŸ)}</td>\n            <td class="col-customer">${e.å®¢æˆ¶åç¨±||""}</td>\n            <td class="col-product-code center">${e.ç”¢å“ç·¨è™Ÿ||""}</td>\n            <td class="col-product-name">${e.å“åè¦æ ¼||""}</td>\n            <td class="col-quantity number">${g(e.æ•¸é‡)}</td>\n            <td class="col-price number">${y(e.å–®åƒ¹)}</td>\n            <td class="col-amount number">${y(e.é‡‘é¡)}</td>\n            <td class="col-tax-amount number">${y(e.å«ç¨…é‡‘é¡)}</td>\n            <td class="col-project">${e.æ‰€å±¬å°ˆæ¡ˆ||""}</td>\n            <td class="col-order center">${e.è¨‚å–®è™Ÿç¢¼||""}</td>\n            <td class="col-sales center">${e.æ¥­å‹™äººå“¡||""}</td>\n          </tr>\n        `}));const n=o.value.reduce(((e,a)=>e+(Number(a.é‡‘é¡)||0)),0),r=o.value.reduce(((e,a)=>e+(Number(a.å«ç¨…é‡‘é¡)||0)),0);return t+=`\n            </tbody>\n          </table>\n          \n          <div class="summary">\n            <div>ç¸½ç­†æ•¸ï¼š${o.value.length} ç­†</div>\n            <div>é‡‘é¡ç¸½è¨ˆï¼š${y(n)}</div>\n            <div>å«ç¨…é‡‘é¡ç¸½è¨ˆï¼š${y(r)}</div>\n          </div>\n        </body>\n        </html>\n      `,t};return(0,u.sV)((()=>{console.log("SalesQuery çµ„ä»¶å·²æŽ›è¼‰"),console.log("queryForm åˆå§‹å€¼:",l),console.log("salesData åˆå§‹å€¼:",o.value);const e=document.querySelector(".el-form");e?console.log("âœ“ Element Plus è¡¨å–®å…ƒç´ å·²æ­£ç¢ºæ¸²æŸ“"):console.error("âœ— Element Plus è¡¨å–®å…ƒç´ æœªæ‰¾åˆ°ï¼Œå¯èƒ½å­˜åœ¨æ¨£å¼å•é¡Œ")})),(e,h)=>{const k=(0,u.g2)("el-input"),_=(0,u.g2)("el-form-item"),w=(0,u.g2)("el-col"),F=(0,u.g2)("el-row"),C=(0,u.g2)("el-button"),D=(0,u.g2)("el-form"),R=(0,u.g2)("el-card"),V=(0,u.g2)("el-table-column"),I=(0,u.g2)("el-table"),x=(0,u.g2)("el-empty"),E=(0,u.g2)("el-pagination"),A=(0,u.g2)("el-config-provider"),T=(0,u.gN)("loading");return(0,u.uX)(),(0,u.Wv)(A,{locale:(0,d.R1)(ht.A)},{default:(0,u.k6)((()=>[(0,u.Lk)("div",jR,[h[10]||(h[10]=(0,u.Lk)("div",{class:"page-header"},[(0,u.Lk)("h2",null,"æ­£èˆªè³‡è¨Š - éŠ·è²¨æŸ¥è©¢")],-1)),(0,u.bF)(R,{class:"query-card",shadow:"hover"},{header:(0,u.k6)((()=>h[4]||(h[4]=[(0,u.Lk)("div",{class:"card-header"},[(0,u.Lk)("span",null,"æŸ¥è©¢æ¢ä»¶")],-1)]))),default:(0,u.k6)((()=>[(0,u.bF)(D,{model:l,rules:t,ref_key:"queryFormRef",ref:a,"label-width":"120px",class:"query-form"},{default:(0,u.k6)((()=>[(0,u.bF)(F,{gutter:20},{default:(0,u.k6)((()=>[(0,u.bF)(w,{span:8},{default:(0,u.k6)((()=>[(0,u.bF)(_,{label:"å®¢æˆ¶åç¨±",prop:"customerName"},{default:(0,u.k6)((()=>[(0,u.bF)(k,{modelValue:l.customerName,"onUpdate:modelValue":h[0]||(h[0]=e=>l.customerName=e),placeholder:"è«‹è¼¸å…¥å®¢æˆ¶åç¨±",clearable:"",style:{width:"100%"}},null,8,["modelValue"])])),_:1})])),_:1}),(0,u.bF)(w,{span:8},{default:(0,u.k6)((()=>[(0,u.bF)(_,{label:"æ‰€å±¬å°ˆæ¡ˆ",prop:"projectName"},{default:(0,u.k6)((()=>[(0,u.bF)(k,{modelValue:l.projectName,"onUpdate:modelValue":h[1]||(h[1]=e=>l.projectName=e),placeholder:"è«‹è¼¸å…¥æ‰€å±¬å°ˆæ¡ˆ",clearable:"",style:{width:"100%"}},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),(0,u.bF)(F,null,{default:(0,u.k6)((()=>[(0,u.bF)(w,{span:24,class:"button-group"},{default:(0,u.k6)((()=>[(0,u.bF)(C,{type:"primary",onClick:i,loading:n.value,icon:"Search"},{default:(0,u.k6)((()=>h[5]||(h[5]=[(0,u.eW)(" æŸ¥è©¢ ")]))),_:1},8,["loading"]),(0,u.bF)(C,{onClick:c,icon:"Refresh"},{default:(0,u.k6)((()=>h[6]||(h[6]=[(0,u.eW)(" é‡ç½® ")]))),_:1}),(0,u.bF)(C,{type:"success",onClick:v,disabled:!o.value.length,icon:"Download"},{default:(0,u.k6)((()=>h[7]||(h[7]=[(0,u.eW)(" åŒ¯å‡ºExcel ")]))),_:1},8,["disabled"]),(0,u.bF)(C,{type:"primary",onClick:f,disabled:!o.value.length,icon:(0,d.R1)(J.Printer),style:{"margin-left":"10px"}},{default:(0,u.k6)((()=>h[8]||(h[8]=[(0,u.eW)(" åˆ—å° ")]))),_:1},8,["disabled","icon"])])),_:1})])),_:1})])),_:1},8,["model"])])),_:1}),o.value.length>0||r.value?((0,u.uX)(),(0,u.Wv)(R,{key:0,class:"result-card",shadow:"hover"},{header:(0,u.k6)((()=>[(0,u.Lk)("div",YR,[h[9]||(h[9]=(0,u.Lk)("span",null,"æŸ¥è©¢çµæžœ",-1)),s.totalCount>0?((0,u.uX)(),(0,u.CE)("span",QR," å…±æ‰¾åˆ° "+(0,L.v_)(s.totalCount)+" ç­†è³‡æ–™ï¼Œç›®å‰é¡¯ç¤ºç¬¬ "+(0,L.v_)(s.page)+" é  ",1)):(0,u.Q3)("",!0)])])),default:(0,u.k6)((()=>[(0,u.bo)(((0,u.uX)(),(0,u.Wv)(I,{data:Array.isArray(o.value)?o.value:[],style:{width:"100%"},stripe:"",border:"",height:"500","default-sort":{prop:"éŠ·è²¨æ—¥æœŸ",order:"descending"}},{default:(0,u.k6)((()=>[(0,u.Q3)("",!0),(0,u.bF)(V,{prop:"éŠ·è²¨æ—¥æœŸ",label:"éŠ·è²¨æ—¥æœŸ",width:"130",sortable:""},{default:(0,u.k6)((e=>[(0,u.eW)((0,L.v_)(b(e.row.éŠ·è²¨æ—¥æœŸ)),1)])),_:1}),(0,u.bF)(V,{prop:"å®¢æˆ¶åç¨±",label:"å®¢æˆ¶åç¨±",width:"220","show-overflow-tooltip":"",sortable:""}),(0,u.bF)(V,{prop:"ç”¢å“ç·¨è™Ÿ",label:"ç”¢å“ç·¨è™Ÿ",width:"170",sortable:""}),(0,u.bF)(V,{prop:"å“åè¦æ ¼",label:"å“åè¦æ ¼",width:"300","show-overflow-tooltip":""}),(0,u.bF)(V,{prop:"æ•¸é‡",label:"æ•¸é‡",width:"80",align:"right"},{default:(0,u.k6)((e=>[(0,u.eW)((0,L.v_)(g(e.row.æ•¸é‡)),1)])),_:1}),(0,u.bF)(V,{prop:"å–®åƒ¹",label:"å–®åƒ¹",width:"130",align:"right",sortable:""},{default:(0,u.k6)((e=>[(0,u.eW)((0,L.v_)(y(e.row.å–®åƒ¹)),1)])),_:1}),(0,u.bF)(V,{prop:"é‡‘é¡",label:"é‡‘é¡",width:"130",align:"right",sortable:""},{default:(0,u.k6)((e=>[(0,u.eW)((0,L.v_)(y(e.row.é‡‘é¡)),1)])),_:1}),(0,u.bF)(V,{prop:"å«ç¨…é‡‘é¡",label:"å«ç¨…é‡‘é¡",width:"120",align:"right",sortable:""},{default:(0,u.k6)((e=>[(0,u.eW)((0,L.v_)(y(e.row.å«ç¨…é‡‘é¡)),1)])),_:1}),(0,u.bF)(V,{prop:"æ‰€å±¬å°ˆæ¡ˆ",label:"æ‰€å±¬å°ˆæ¡ˆ",width:"300","show-overflow-tooltip":""}),(0,u.bF)(V,{prop:"æ¥­å‹™äººå“¡",label:"æ¥­å‹™äººå“¡",width:"100"}),(0,u.bF)(V,{prop:"è¨‚å–®è™Ÿç¢¼",label:"è¨‚å–®è™Ÿç¢¼",width:"120",sortable:""}),(0,u.Q3)("",!0)])),_:1},8,["data"])),[[T,n.value]]),0===o.value.length&&r.value&&!n.value?((0,u.uX)(),(0,u.CE)("div",HR,[(0,u.bF)(x,{description:"æŸ¥ç„¡è³‡æ–™"})])):(0,u.Q3)("",!0),s.totalCount>0?((0,u.uX)(),(0,u.CE)("div",qR,[(0,u.bF)(E,{"current-page":s.page,"onUpdate:currentPage":h[2]||(h[2]=e=>s.page=e),"page-size":s.pageSize,"onUpdate:pageSize":h[3]||(h[3]=e=>s.pageSize=e),"page-sizes":[10,20,50,100,200],total:s.totalCount,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:p,onCurrentChange:m},null,8,["current-page","page-size","total"])])):(0,u.Q3)("",!0)])),_:1})):(0,u.Q3)("",!0)])])),_:1},8,["locale"])}}};const GR=(0,ie.A)(JR,[["__scopeId","data-v-1f4cee8f"]]);var ZR=GR;const eV={style:{"margin-top":"3rem","text-align":"center"}},aV={style:{"margin-bottom":"20px"}};var lV={__name:"ColdCallingReport",setup(e){const a=(0,d.KR)(null),l=(0,d.KR)([]),t=(0,d.KR)("å…¨ç‡Ÿæ¥­å€"),o=(0,d.KR)([]),n=(0,d.KR)([]),r=async()=>{try{const e=e=>{if(!e)return null;const a=new Date(e),l=a.getFullYear(),t=(a.getMonth()+1).toString().padStart(2,"0"),o=a.getDate().toString().padStart(2,"0");return`${l}-${t}-${o}`},l=a.value?e(a.value[0]):null,t=a.value?e(a.value[1]):null,r=await OC.getColdCallingReport(l,t);console.log("Cold Calling å ±å‘Šæ•¸æ“š:",r.data),n.value=r.data||[];const s=[...new Set(n.value.map((e=>e.salesRepBusinessAreaName)))].filter(Boolean);o.value=s,i()}catch(e){console.error("ç²å–é™Œé–‹å ±è¡¨å¤±æ•—ï¼š",e)}},s=e=>{console.log("ç‡Ÿæ¥­å€ç¯©é¸è®Šæ›´:",e),t.value=e,i()},i=()=>{if(console.log("é–‹å§‹ç¯©é¸ï¼Œé¸ä¸­çš„ç‡Ÿæ¥­å€:",t.value),console.log("æ‰€æœ‰ç‡Ÿæ¥­å€é¸é …:",o.value),"å…¨ç‡Ÿæ¥­å€"===t.value)return l.value=n.value,void console.log("é¡¯ç¤ºå…¨ç‡Ÿæ¥­å€æ•¸æ“šï¼Œæ•¸æ“šç­†æ•¸:",l.value.length);const e=n.value.filter((e=>e.salesRepBusinessAreaName===t.value));console.log("ç¯©é¸å¾Œçš„æ•¸æ“šç­†æ•¸:",e.length),l.value=e,console.log("ç¯©é¸å®Œæˆï¼Œç•¶å‰é¡¯ç¤ºæ•¸æ“šç­†æ•¸:",l.value.length)};return(0,u.sV)((async()=>{const e=new Date,l=new Date;l.setDate(e.getDate()-7),a.value=[l,e],await r()})),(e,n)=>{const i=(0,u.g2)("el-date-picker"),d=(0,u.g2)("el-radio-button"),c=(0,u.g2)("el-radio-group"),p=(0,u.g2)("el-table-column"),m=(0,u.g2)("el-table");return(0,u.uX)(),(0,u.CE)("div",eV,[(0,u.bF)(i,{modelValue:a.value,"onUpdate:modelValue":n[0]||(n[0]=e=>a.value=e),type:"daterange","range-separator":"~",size:"large","start-placeholder":"é–‹å§‹æ—¥æœŸ","end-placeholder":"çµæŸæ—¥æœŸ",style:{width:"25rem","margin-bottom":"20px","font-size":"1rem"},onChange:r},null,8,["modelValue"]),(0,u.Lk)("div",aV,[(0,u.bF)(c,{modelValue:t.value,"onUpdate:modelValue":n[1]||(n[1]=e=>t.value=e),size:"large",onChange:s},{default:(0,u.k6)((()=>[(0,u.bF)(d,{value:"å…¨ç‡Ÿæ¥­å€"},{default:(0,u.k6)((()=>n[2]||(n[2]=[(0,u.eW)("å…¨ç‡Ÿæ¥­å€")]))),_:1}),((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(o.value,(e=>((0,u.uX)(),(0,u.Wv)(d,{key:e,value:e},{default:(0,u.k6)((()=>[(0,u.eW)((0,L.v_)(e),1)])),_:2},1032,["value"])))),128))])),_:1},8,["modelValue"])]),(0,u.bF)(m,{data:l.value,style:{width:"100%","max-width":"38rem",margin:"0 auto"}},{default:(0,u.k6)((()=>[(0,u.Q3)("",!0),(0,u.bF)(p,{prop:"salesRepName",label:"äººå“¡",width:"130",align:"center"}),(0,u.bF)(p,{prop:"countOfColdCallingCustomers",label:"é™Œé–‹å®¢æˆ¶æ•¸",width:"155",align:"center"}),(0,u.bF)(p,{prop:"countOfSuccessfulDeals",label:"æˆåŠŸæˆäº¤æ•¸",width:"130",align:"center"}),(0,u.bF)(p,{prop:"countOfContactAttempts",label:"æ‹œè¨ª/è¯ç¹«ç´€éŒ„æ¬¡æ•¸",width:"190",align:"center"})])),_:1},8,["data"])])}}};const tV=lV;var oV=tV,nV=l(64418),rV=l(77962);const sV=(0,lr.A)();var uV=sV;const iV={class:"fill-customer-tracking"};var dV={__name:"FillCustomerReport",setup(e){const a=(0,S.k)(),l=(0,d.KR)(null),t=(0,d.KR)([]),o=(0,d.Kh)({CustomerID:"",CustomerName:"",ContactDate:(new Date).toISOString().split("T")[0],ContactDescription:""}),n=(0,d.Kh)({CustomerID:[{required:!0,message:"è«‹è¼¸å…¥å®¢æˆ¶ID",trigger:"blur"}],CustomerName:[{required:!0,message:"è«‹è¼¸å…¥å®¢æˆ¶åç¨±",trigger:"blur"}],ContactDate:[{required:!0,message:"è«‹é¸æ“‡è¯çµ¡æ—¥æœŸ",trigger:"change"}],ContactDescription:[{required:!0,message:"è«‹è¼¸å…¥è¯çµ¡æè¿°",trigger:"blur"}]}),r=async()=>{l.value&&l.value.validate((async e=>{if(!e)return!1;try{const e={CustomerID:o.CustomerID,CustomerName:o.CustomerName,ContactDate:o.ContactDate,ContactDescription:o.ContactDescription,createdByUserId:a.userId,createdByUserName:a.userName};console.log("submitForm: ",e),await OC.addCustomerReport(e),D.nk.success("å®¢æˆ¶è¯çµ¡å ±å‘Šæäº¤æˆåŠŸï¼"),uV.emit("customerReportAdded"),s()}catch(l){console.error("æäº¤å®¢æˆ¶è¯çµ¡å ±å‘Šå¤±æ•—:",l),D.nk.error("æäº¤å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦ã€‚")}}))},s=()=>{l.value&&(l.value.resetFields(),o.ContactDate=(new Date).toISOString().split("T")[0],o.CustomerID="",o.CustomerName="")},i=e=>e.getTime()>Date.now(),c=(e,a)=>{const l=e?t.value.filter(p(e)):t.value;a(l)},p=e=>a=>a.fullCompanyName.toLowerCase().includes(e.toLowerCase())||a.customerName.toLowerCase().includes(e.toLowerCase())||a.customerId.toLowerCase().includes(e.toLowerCase()),m=e=>{o.CustomerName=e.fullCompanyName,o.CustomerID=e.customerId};return(0,u.sV)((async()=>{try{const e=await OC.getCustomerReport_CustomerReadModels();t.value=e.data}catch(e){console.error("å–å¾—å®¢æˆ¶è®€å–æ¨¡åž‹å¤±æ•—:",e),D.nk.error("å–å¾—å®¢æˆ¶è®€å–æ¨¡åž‹å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦ã€‚")}})),(e,a)=>{(0,u.g2)("el-å…¬å¸å…¨å");return(0,u.uX)(),(0,u.CE)("div",iV,[(0,u.bF)((0,d.R1)(Ot.US),{model:o,"label-width":"4.5rem",rules:n,ref_key:"formRef",ref:l},{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(nV.S2),{gutter:20},{default:(0,u.k6)((()=>[(0,u.Q3)("",!0),(0,u.bF)((0,d.R1)(rV.uD),{span:12},{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(Ot.xE),{label:"å…¬å¸å…¨å","label-width":"5rem",prop:"CustomerName"},{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(tt.s9),{modelValue:o.CustomerName,"onUpdate:modelValue":a[1]||(a[1]=e=>o.CustomerName=e),"fetch-suggestions":c,"trigger-on-focus":!1,clearable:"",class:"inline-input w-50",placeholder:"è«‹è¼¸å…¥å…¬å¸å…¨å",onSelect:m,"value-key":"fullCompanyName",style:{width:"100%"}},null,8,["modelValue"])])),_:1})])),_:1}),(0,u.bF)((0,d.R1)(rV.uD),{span:12},{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(Ot.xE),{label:"è¯çµ¡æ—¥æœŸ","label-width":"5rem",prop:"ContactDate"},{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(jt.MG),{modelValue:o.ContactDate,"onUpdate:modelValue":a[2]||(a[2]=e=>o.ContactDate=e),type:"date",placeholder:"é¸æ“‡æ—¥æœŸ",style:{width:"100%"},"value-format":"YYYY-MM-DD","disabled-date":i},null,8,["modelValue"])])),_:1})])),_:1}),(0,u.bF)((0,d.R1)(rV.uD),{span:24},{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(Ot.xE),{label:"è¯çµ¡æè¿°","label-width":"5rem",prop:"ContactDescription"},{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(gt.WK),{modelValue:o.ContactDescription,"onUpdate:modelValue":a[3]||(a[3]=e=>o.ContactDescription=e),type:"textarea",style:{width:"100%"}},null,8,["modelValue"])])),_:1})])),_:1}),(0,u.bF)((0,d.R1)(rV.uD),{span:24,style:{"text-align":"center"}},{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(Bt.S2),{type:"primary",onClick:r,style:{width:"100px"}},{default:(0,u.k6)((()=>a[4]||(a[4]=[(0,u.eW)("æäº¤")]))),_:1})])),_:1})])),_:1})])),_:1},8,["model","rules"])])}}};const cV=(0,ie.A)(dV,[["__scopeId","data-v-5c1532fa"]]);var pV=cV,mV=l(92248),vV=l(42565);const bV={key:0},gV={key:0},yV={key:0},fV=["infinite-scroll-disabled"],hV={style:{padding:"10px"}},kV={key:0},_V={key:1},wV={key:2},FV={key:0},CV={key:1},DV={key:3},LV={style:{"margin-top":"10px",display:"flex",gap:"8px"}},RV={key:1,class:"load-more"},VV={key:2,class:"load-more"};var IV={__name:"ListCustomerReport",setup(e){const a=(0,d.KR)([]),l=(0,d.KR)([]),o=(0,d.KR)("customerName"),n=(0,d.KR)(""),r=(0,d.KR)(10),s=(0,d.KR)(1),i=(0,d.KR)(null),c=(0,d.KR)(!1),p=(0,d.KR)(!1),m=(0,d.KR)(30),v=(0,u.EW)((()=>{if(!a.value)return[];const e=a.value.reduce(((e,a)=>{const l=a.customerName;return e[l]||(e[l]=[]),e[l].push(a),e}),{});return Object.values(e).map((e=>e.sort(((e,a)=>new Date(a.contactDate)-new Date(e.contactDate)))[0]))})),b=(0,d.KR)(null),g=(0,d.KR)(null),y=(0,d.KR)([]),f=(0,d.KR)(!1),h=(0,d.KR)([]),k={id:"ID",customerID:"å®¢æˆ¶ID",customerName:"å…¬å¸å…¨å",contactDate:"è¯çµ¡æ—¥æœŸ",contactDescription:"è¯çµ¡æè¿°"},_=[{label:"å…¬å¸å…¨å",value:"customerName"}],w=(0,u.EW)((()=>{let e=v.value;if(l.value&&2===l.value.length){const[a,t]=l.value;e=e.filter((e=>{const l=new Date(e.contactDate);return l>=a&&l<=t}))}return n.value&&o.value&&(e=e.filter((e=>{const a=e[o.value];return a&&a.toString().toLowerCase().includes(n.value.toLowerCase())}))),e})),F=(0,u.EW)((()=>{if(c.value)return w.value.slice(0,m.value);{const e=(s.value-1)*r.value;return w.value.slice(e,e+r.value)}})),C=async()=>{try{const e=await OC.getCustomerReport(),l=(0,S.k)();console.log(e.data),"é™³æ”¿é”"===l.userName||"å‘‚æ˜€ç¥"===l.userName||"é™³æ”¿é”"===l.userName||"æž—å¥‰æ¨Ÿ"===l.userName||"éƒ­æ¬½èª "===l.userName||"vincent"===l.userName?a.value=e.data:a.value=e.data.filter((e=>e.createdByUserId===l.userId))}catch(e){console.error("å–å¾—å®¢æˆ¶å ±å‘Šå¤±æ•—:",e),D.nk.error("å–å¾—å®¢æˆ¶å ±å‘Šå¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦ã€‚")}},R=()=>{c.value?m.value=30:s.value=1},V=()=>{n.value="",R()},I=e=>{s.value=e},x=e=>{c.value&&!y.value.includes(e.id)&&y.value.push(e.id);const l=a.value.find((a=>a.id===e.id));if(l){const t=JSON.parse(JSON.stringify(l));a.value=a.value.map((a=>a.id===e.id?t:a)),e.editing=!0,i.value=e.id,c.value&&g.value&&g.value.toggleRowExpansion(e,!0)}},E=async e=>{try{const a={...e};delete a.id,delete a.editing,await OC.updateCustomerReport(e.id,a),D.nk.success("å®¢æˆ¶å ±å‘Šå·²æ›´æ–°"),e.editing=!1,i.value=null,await C()}catch(a){console.error(a),D.nk.error("æ›´æ–°å¤±æ•—ï¼š"+(a.response?.data||a.message))}},A=e=>{Sa.s.confirm("ç¢ºå®šæ˜¯å¦åˆªé™¤è©²è³‡æ–™ï¼Ÿ","åˆªé™¤ç¢ºèª",{type:"warning"}).then((async()=>{try{await OC.deleteCustomerReport(e.id),D.nk.success("å®¢æˆ¶å ±å‘Šå·²åˆªé™¤"),a.value=a.value.filter((a=>a.id!==e.id))}catch(l){D.nk.error("åˆªé™¤å¤±æ•—")}})).catch((()=>{}))},T=e=>{e.editing=!1,i.value=null,c.value&&g.value&&e&&g.value.toggleRowExpansion(e,!0),C()},W=e=>e?new Date(e).toLocaleDateString("zh-TW"):"",U=()=>{const e=b.value;if(!e||p.value)return;const{scrollTop:a,scrollHeight:l,clientHeight:t}=e;a+t>=l-50&&N()},$=(0,u.EW)((()=>e=>Object.entries(e).filter((([e])=>"id"!==e&&"editing"!==e)))),N=()=>{m.value<w.value.length&&(p.value=!0,setTimeout((()=>{m.value+=30,p.value=!1}),500))},X=window.matchMedia("(max-width: 768px)"),K=e=>{c.value=e.matches},M=e=>{const l=e.customerName,t=a.value.filter((e=>e.customerName===l)).sort(((e,a)=>new Date(a.contactDate)-new Date(e.contactDate)));h.value=t,f.value=!0};return(0,u.sV)((()=>{C(),X.addEventListener("change",K),K(X),uV.on("customerReportAdded",C)})),(0,u.hi)((()=>{X.removeEventListener("change",K),b.value&&b.value.removeEventListener("scroll",U),uV.off("customerReportAdded",C)})),(0,u.wB)(c,(async e=>{await(0,u.dY)(),e&&b.value?b.value.addEventListener("scroll",U):b.value&&b.value.removeEventListener("scroll",U)})),(e,a)=>{const l=(0,u.g2)("el-pagination"),i=(0,u.gN)("infinite-scroll");return(0,u.uX)(),(0,u.CE)("div",{class:"wrap",style:(0,L.Tr)({width:c.value?"23rem":"90%",margin:c.value?"0rem 2rem 0rem 1rem":"0rem 2rem 0rem 2rem"})},[(0,u.Lk)("div",{ref_key:"wrapper",ref:b,class:"controls-bar w-full",style:(0,L.Tr)({margin:c.value?"1rem 1rem 1rem 0rem":"1rem 0rem 1rem 0rem",padding:c.value?"1rem 1rem 1rem 1rem":"1rem",display:"flex",alignItems:(c.value,"center"),border:"1px solid black",flexDirection:c.value?"column":"row",gap:c.value?"10px":"0"})},[(0,u.Lk)("div",{class:"search-block",style:(0,L.Tr)({display:"flex",marginLeft:c.value?"0":"2rem",flexDirection:c.value?"column":"row",alignItems:(c.value,"center"),gap:"8px"})},[(0,u.bF)((0,d.R1)(mV.AV),{modelValue:o.value,"onUpdate:modelValue":a[0]||(a[0]=e=>o.value=e),placeholder:"é¸æ“‡æ¬„ä½",style:(0,L.Tr)({width:c.value?"100%":"9rem"}),onChange:V},{default:(0,u.k6)((()=>[((0,u.uX)(),(0,u.CE)(u.FK,null,(0,u.pI)(_,(e=>(0,u.bF)((0,d.R1)(mV.P9),{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),64))])),_:1},8,["modelValue","style"]),(0,u.bF)((0,d.R1)(gt.WK),{modelValue:n.value,"onUpdate:modelValue":a[1]||(a[1]=e=>n.value=e),placeholder:"è«‹è¼¸å…¥é—œéµå­—",clearable:"",onClear:R,onKeyup:(0,t.jR)(R,["enter"]),style:(0,L.Tr)({width:c.value?"100%":"200px"})},null,8,["modelValue","style"]),(0,u.bF)((0,d.R1)(Bt.S2),{type:"primary",style:(0,L.Tr)({display:"flex",justifyContent:c.value?"center":"flex-start"}),onClick:R},{default:(0,u.k6)((()=>a[5]||(a[5]=[(0,u.eW)("æœå°‹")]))),_:1},8,["style"])],4),c.value?(0,u.Q3)("",!0):((0,u.uX)(),(0,u.CE)("div",{key:0,class:"pagination-block",style:(0,L.Tr)({display:"flex",alignItems:c.value?"flex-start":"center",marginLeft:c.value?"0":"2rem",flexDirection:c.value?"column":"row",gap:c.value?"10px":"0"})},[(0,u.bF)((0,d.R1)(Xi.$g),{class:"mx-1",type:"info"},{default:(0,u.k6)((()=>a[6]||(a[6]=[(0,u.eW)("æ¯é é¡¯ç¤º")]))),_:1}),(0,u.bF)((0,d.R1)(mV.AV),{modelValue:r.value,"onUpdate:modelValue":a[2]||(a[2]=e=>r.value=e),placeholder:"",style:(0,L.Tr)({width:c.value?"100%":"4rem"}),size:"small"},{default:(0,u.k6)((()=>[((0,u.uX)(),(0,u.CE)(u.FK,null,(0,u.pI)([5,10,15,20,25,30],(e=>(0,u.bF)((0,d.R1)(mV.P9),{key:e,label:e,value:e},null,8,["label","value"]))),64))])),_:1},8,["modelValue","style"]),(0,u.bF)((0,d.R1)(Xi.$g),{class:"mx-1",type:"info"},{default:(0,u.k6)((()=>a[7]||(a[7]=[(0,u.eW)("ç­†")]))),_:1}),(0,u.Lk)("div",{style:(0,L.Tr)({marginLeft:c.value?"0":"1rem"})},[(0,u.bF)(l,{background:"",layout:"prev, pager, next",total:w.value.length,"page-size":r.value,"current-page":s.value,"onUpdate:currentPage":a[3]||(a[3]=e=>s.value=e),onCurrentChange:I},null,8,["total","page-size","current-page"])],4)],4))],4),c.value?(0,u.Q3)("",!0):((0,u.uX)(),(0,u.Wv)((0,d.R1)(vV.Up),{key:0,class:"list-customer-report",data:F.value,style:{width:"100%"},onRowClick:M},{default:(0,u.k6)((()=>[(0,u.Q3)("",!0),(0,u.Q3)("",!0),(0,u.Q3)("",!0),(0,u.bF)((0,d.R1)(vV.o8),{prop:"customerName",label:"å…¬å¸å…¨å"},{default:(0,u.k6)((({row:e})=>[e.editing?((0,u.uX)(),(0,u.Wv)((0,d.R1)(gt.WK),{key:1,modelValue:e.customerName,"onUpdate:modelValue":a=>e.customerName=a},null,8,["modelValue","onUpdate:modelValue"])):((0,u.uX)(),(0,u.CE)("span",bV,(0,L.v_)(e.customerName),1))])),_:1}),(0,u.bF)((0,d.R1)(vV.o8),{prop:"contactDate",label:"è¯çµ¡æ—¥æœŸ",width:"180"},{default:(0,u.k6)((({row:e})=>[e.editing?((0,u.uX)(),(0,u.Wv)((0,d.R1)(jt.MG),{key:1,modelValue:e.contactDate,"onUpdate:modelValue":a=>e.contactDate=a,type:"date",placeholder:"é¸æ“‡æ—¥æœŸ","value-format":"YYYY-MM-DD"},null,8,["modelValue","onUpdate:modelValue"])):((0,u.uX)(),(0,u.CE)("span",gV,(0,L.v_)(W(e.contactDate)),1))])),_:1}),(0,u.Q3)("",!0),(0,u.bF)((0,d.R1)(vV.o8),{prop:"createdByUserName",label:"å»ºç«‹äººå“¡",width:"180"},{default:(0,u.k6)((({row:e})=>[(0,u.Lk)("span",null,(0,L.v_)(e.createdByUserName),1)])),_:1}),(0,u.bF)((0,d.R1)(vV.o8),{prop:"contactDescription",label:"è¯çµ¡æè¿°"},{default:(0,u.k6)((({row:e})=>[e.editing?((0,u.uX)(),(0,u.Wv)((0,d.R1)(gt.WK),{key:1,modelValue:e.contactDescription,"onUpdate:modelValue":a=>e.contactDescription=a,type:"textarea"},null,8,["modelValue","onUpdate:modelValue"])):((0,u.uX)(),(0,u.CE)("span",yV,(0,L.v_)(e.contactDescription),1))])),_:1})])),_:1},8,["data"])),(0,u.bo)(((0,u.uX)(),(0,u.CE)("div",{class:"table-wrapper",ref:"rwdTableWrapper","infinite-scroll-disabled":e.loading||e.noMore,"infinite-scroll-distance":"50",style:{height:"400px","overflow-y":"auto"}},[c.value?((0,u.uX)(),(0,u.Wv)((0,d.R1)(vV.Up),{key:0,class:"RWD_List_Table",style:(0,L.Tr)({width:c.value?"auto":"20rem"}),data:F.value,stripe:"",border:"",ref_key:"rwdTableRef",ref:g,"row-key":"id","expand-row-keys":y.value,onRowClick:M},{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(vV.o8),{type:"expand"},{default:(0,u.k6)((({row:e})=>[(0,u.Lk)("div",hV,[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)($.value(e),(([a,l])=>((0,u.uX)(),(0,u.CE)("div",{key:a,style:{"margin-bottom":"8px"}},[k[a]?((0,u.uX)(),(0,u.CE)("strong",kV,(0,L.v_)(k[a])+":",1)):((0,u.uX)(),(0,u.CE)("span",_V,[(0,u.Lk)("strong",null,(0,L.v_)(a)+":",1)])),e.editing?((0,u.uX)(),(0,u.CE)("span",DV,["customerID"===a?((0,u.uX)(),(0,u.Wv)((0,d.R1)(gt.WK),{key:0,modelValue:e.customerID,"onUpdate:modelValue":a=>e.customerID=a,size:"small"},null,8,["modelValue","onUpdate:modelValue"])):"customerName"===a?((0,u.uX)(),(0,u.Wv)((0,d.R1)(gt.WK),{key:1,modelValue:e.customerName,"onUpdate:modelValue":a=>e.customerName=a,size:"small"},null,8,["modelValue","onUpdate:modelValue"])):"contactDate"===a?((0,u.uX)(),(0,u.Wv)((0,d.R1)(jt.MG),{key:2,modelValue:e.contactDate,"onUpdate:modelValue":a=>e.contactDate=a,type:"date",placeholder:"é¸æ“‡æ—¥æœŸ",size:"small","value-format":"YYYY-MM-DD"},null,8,["modelValue","onUpdate:modelValue"])):"contactDescription"===a?((0,u.uX)(),(0,u.Wv)((0,d.R1)(gt.WK),{key:3,modelValue:e.contactDescription,"onUpdate:modelValue":a=>e.contactDescription=a,type:"textarea",size:"small"},null,8,["modelValue","onUpdate:modelValue"])):(0,u.Q3)("",!0)])):((0,u.uX)(),(0,u.CE)("span",wV,["ContactDate"===a?((0,u.uX)(),(0,u.CE)("span",FV,(0,L.v_)(W(l)),1)):((0,u.uX)(),(0,u.CE)("span",CV,(0,L.v_)(l),1))]))])))),128)),(0,u.Lk)("div",LV,[e.editing?((0,u.uX)(),(0,u.CE)(u.FK,{key:1},[(0,u.bF)((0,d.R1)(Bt.S2),{type:"success",size:"small",onClick:a=>E(e)},{default:(0,u.k6)((()=>a[13]||(a[13]=[(0,u.eW)("å„²å­˜")]))),_:2},1032,["onClick"]),(0,u.bF)((0,d.R1)(Bt.S2),{type:"info",size:"small",onClick:a=>T(e)},{default:(0,u.k6)((()=>a[14]||(a[14]=[(0,u.eW)("å–æ¶ˆ")]))),_:2},1032,["onClick"])],64)):((0,u.uX)(),(0,u.CE)(u.FK,{key:0},[(0,u.bF)((0,d.R1)(Bt.S2),{type:"primary",size:"small",onClick:a=>x(e)},{default:(0,u.k6)((()=>a[11]||(a[11]=[(0,u.eW)("ç·¨è¼¯")]))),_:2},1032,["onClick"]),(0,u.bF)((0,d.R1)(Bt.S2),{type:"danger",size:"small",onClick:a=>A(e)},{default:(0,u.k6)((()=>a[12]||(a[12]=[(0,u.eW)("åˆªé™¤")]))),_:2},1032,["onClick"])],64))])])])),_:1}),(0,u.bF)((0,d.R1)(vV.o8),{prop:"contactDate",label:"è¯çµ¡æ—¥æœŸ",width:"110"},{default:(0,u.k6)((({row:e})=>[(0,u.Lk)("span",null,(0,L.v_)(W(e.contactDate)),1)])),_:1}),(0,u.bF)((0,d.R1)(vV.o8),{prop:"customerName",label:"å…¬å¸å…¨å",width:"220"}),(0,u.bF)((0,d.R1)(vV.o8),{prop:"contactDescription",label:"è¯çµ¡æè¿°",width:"150"})])),_:1},8,["style","data","expand-row-keys"])):(0,u.Q3)("",!0),e.loading?((0,u.uX)(),(0,u.CE)("div",RV,"è¼‰å…¥ä¸­â€¦")):(0,u.Q3)("",!0),!e.loading&&e.noMore?((0,u.uX)(),(0,u.CE)("div",VV,"æ²’æœ‰æ›´å¤šè³‡æ–™")):(0,u.Q3)("",!0)],8,fV)),[[i,N]]),(0,u.bF)((0,d.R1)(ft.kZ),{modelValue:f.value,"onUpdate:modelValue":a[4]||(a[4]=e=>f.value=e),title:"è©³ç´°è³‡æ–™",width:"80%"},{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(vV.Up),{data:h.value,style:{width:"100%"}},{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(vV.o8),{prop:"customerName",label:"å…¬å¸å…¨å"}),(0,u.bF)((0,d.R1)(vV.o8),{prop:"contactDate",label:"è¯çµ¡æ—¥æœŸ",width:"180"},{default:(0,u.k6)((({row:e})=>[(0,u.Lk)("span",null,(0,L.v_)(W(e.contactDate)),1)])),_:1}),(0,u.bF)((0,d.R1)(vV.o8),{prop:"createdByUserName",label:"å»ºç«‹äººå“¡",width:"180"}),(0,u.bF)((0,d.R1)(vV.o8),{prop:"contactDescription",label:"è¯çµ¡æè¿°"})])),_:1},8,["data"])])),_:1},8,["modelValue"])],4)}}};const xV=(0,ie.A)(IV,[["__scopeId","data-v-3fccba9f"]]);var EV=xV;const AV={style:{display:"flex","flex-direction":"column","align-items":"center"}};var TV={__name:"CustomerReport",setup(e){return(e,a)=>((0,u.uX)(),(0,u.CE)("div",AV,[(0,u.bF)(pV),(0,u.bF)(EV)]))}};const WV=TV;var SV=WV;const UV=[{label:"é ç®—è¦åŠƒä¸­",value:"é ç®—è¦åŠƒä¸­"},{label:"ç™¼åŒ…è©¢åƒ¹ä¸­",value:"ç™¼åŒ…è©¢åƒ¹ä¸­"},{label:"å ±åƒ¹è­°åƒ¹ä¸­",value:"å ±åƒ¹è­°åƒ¹ä¸­"},{label:"æ¡ˆä»¶é€å¯©ä¸­",value:"æ¡ˆä»¶é€å¯©ä¸­"},{label:"åˆç´„å·²å®Œæˆ",value:"åˆç´„å·²å®Œæˆ"},{label:"å·¥ç¨‹é€²è¡Œä¸­",value:"å·¥ç¨‹é€²è¡Œä¸­"},{label:"æ¡ˆä»¶å·²å®Œæˆ",value:"æ¡ˆä»¶å·²å®Œæˆ"}],$V=[{label:"é›²ç«¯å„²å€¼ç³»çµ±",value:"é›²ç«¯å„²å€¼ç³»çµ±"},{label:"æ™ºæ…§ç…§æ˜Žç³»çµ±",value:"æ™ºæ…§ç…§æ˜Žç³»çµ±"},{label:"STEMSèƒ½æºç®¡ç†ç³»çµ±",value:"STEMSèƒ½æºç®¡ç†ç³»çµ±"},{label:"é›»å‹•è»Šå……é›»è¨ˆè²»ç®¡ç†ç³»çµ±",value:"é›»å‹•è»Šå……é›»è¨ˆè²»ç®¡ç†ç³»çµ±"},{label:"æ ¡åœ’EMSç³»çµ±",value:"æ ¡åœ’EMSç³»çµ±"},{label:"éœ€é‡æŽ§åˆ¶ç³»çµ±",value:"éœ€é‡æŽ§åˆ¶ç³»çµ±"},{label:"è®€è¡¨è¨ˆè²»ç³»çµ±",value:"è®€è¡¨è¨ˆè²»ç³»çµ±"},{label:"ç„¡",value:"ç„¡"}];var NV={__name:"Fill_CaseTracking",emits:["caseTrackingSubmitted"],setup(e,{emit:a}){const l=(0,S.k)(),t=a,o=(0,d.KR)(null),n=(0,d.KR)({Id:null,FillDate:null,CaseName:"",CoopUnit:"",DeviceUsageCategory:[],SystemType:[],DeviceList:"",EstimatedAmount:null,EstimatedDeliveryDate:null,CaseProgress:""}),r={Id:[{required:!0,message:"è«‹è¼¸å…¥æ¡ˆä»¶ç·¨è™Ÿ",trigger:"blur"}],FillDate:[{required:!0,message:"è«‹é¸æ“‡å¡«å¯«æ—¥æœŸ",trigger:"change"}],CaseName:[{required:!0,message:"è«‹è¼¸å…¥æ¡ˆå",trigger:"blur"}],CoopUnit:[{required:!0,message:"è«‹è¼¸å…¥é…åˆå–®ä½",trigger:"blur"}],DeviceUsageCategory:[{type:"array",required:!0,message:"è«‹é¸æ“‡è¨­å‚™æ‡‰ç”¨é¡žåž‹",trigger:"change"}],SystemType:[{type:"array",required:!0,message:"è«‹é¸æ“‡ç³»çµ±é¡žåž‹",trigger:"change"}],DeviceList:[{required:!0,message:"è«‹è¼¸å…¥è¨­å‚™æ¸…å–®",trigger:"blur"}],EstimatedAmount:[{required:!0,message:"è«‹è¼¸å…¥é ä¼°é‡‘é¡",trigger:"blur"}],CaseProgress:[{required:!0,message:"è«‹è¼¸å…¥æ¡ˆä»¶é€²åº¦",trigger:"blur"}]},s=()=>{o.value.validate((async e=>{if(e)try{const e={...n.value};Array.isArray(e.DeviceUsageCategory)&&(e.DeviceUsageCategory=e.DeviceUsageCategory.join(",")),Array.isArray(e.SystemType)&&(e.SystemType=e.SystemType.join(",")),delete e.Id,e.salesRepID=l.userId,await OC.createCaseTracking(e),D.nk.success("æ¡ˆä»¶è¿½è¹¤è³‡æ–™å·²æˆåŠŸé€å‡ºï¼"),o.value.resetFields(),n.value.FillDate=Vg()().format("YYYY-MM-DD"),t("caseTrackingSubmitted"),or.emit("caseTrackingAdded",{customerId:n.value.customerId,caseId:n.value.Id,caseName:n.value.CaseName,timestamp:new Date}),console.log("å·²ç™¼å°„å…¨å±€äº‹ä»¶ caseTrackingAdded")}catch(a){console.error("é€å‡ºæ¡ˆä»¶è¿½è¹¤è³‡æ–™æ™‚ç™¼ç”ŸéŒ¯èª¤:",a),D.nk.error("é€å‡ºæ¡ˆä»¶è¿½è¹¤è³‡æ–™å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦ã€‚")}else D.nk.error("è«‹æª¢æŸ¥å¿…å¡«æ¬„ä½")}))},i=(0,d.KR)([]),c=async()=>{try{const e=await OC.getDeviceUsageCategories();i.value=e.data}catch(e){console.error("å–å¾—è¨­å‚™æ‡‰ç”¨é¡žåž‹è³‡æ–™å¤±æ•—:",e),D.nk.error("å–å¾—è¨­å‚™æ‡‰ç”¨é¡žåž‹è³‡æ–™å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦ã€‚")}};(0,u.sV)((()=>{c(),n.value.FillDate=Vg()().format("YYYY-MM-DD")}));const p=e=>e.getTime()>Date.now(),m=(0,d.KR)(!1),v=window.matchMedia("(max-width: 768px)"),b=e=>{m.value=e.matches};return(0,u.sV)((()=>{v.addEventListener("change",b),b(v)})),(0,u.hi)((()=>{v.removeEventListener("change",b)})),(e,a)=>{const t=(0,u.g2)("el-date-picker"),c=(0,u.g2)("el-form-item"),v=(0,u.g2)("el-col"),b=(0,u.g2)("el-input"),g=(0,u.g2)("el-option"),y=(0,u.g2)("el-select"),f=(0,u.g2)("el-button"),h=(0,u.g2)("el-row"),k=(0,u.g2)("el-form");return(0,u.uX)(),(0,u.CE)("div",{class:"fill-case-tracking",style:(0,L.Tr)({margin:m.value?"3rem 3rem 0rem 1rem":"5rem 3rem 0rem 3rem",width:m.value?"23rem":"auto",padding:m.value?"1rem 1rem 1rem 0rem":"1rem"})},[(0,u.bF)(k,{model:n.value,"label-width":m.value?"auto":"15rem",rules:r,ref_key:"formRef",ref:o},{default:(0,u.k6)((()=>[(0,u.bF)(h,{gutter:m.value?0:20},{default:(0,u.k6)((()=>[(0,u.bF)(v,{span:m.value?24:6},{default:(0,u.k6)((()=>[(0,u.bF)(c,{label:"å¡«å¯«æ—¥æœŸ","label-width":m.value?"7rem":"120px",prop:"FillDate"},{default:(0,u.k6)((()=>[(0,u.bF)(t,{modelValue:n.value.FillDate,"onUpdate:modelValue":a[0]||(a[0]=e=>n.value.FillDate=e),type:"date",placeholder:"é¸æ“‡æ—¥æœŸ","value-format":"YYYY-MM-DD",style:(0,L.Tr)({width:(m.value,"100%")}),"disabled-date":p},null,8,["modelValue","style"])])),_:1},8,["label-width"])])),_:1},8,["span"]),(0,u.bF)(v,{span:m.value?24:6},{default:(0,u.k6)((()=>[(0,u.bF)(c,{label:"æ¡ˆå","label-width":m.value?"7rem":"120px",prop:"CaseName"},{default:(0,u.k6)((()=>[(0,u.bF)(b,{modelValue:n.value.CaseName,"onUpdate:modelValue":a[1]||(a[1]=e=>n.value.CaseName=e),style:(0,L.Tr)({width:(m.value,"100%")})},null,8,["modelValue","style"])])),_:1},8,["label-width"])])),_:1},8,["span"]),(0,u.bF)(v,{span:m.value?24:6},{default:(0,u.k6)((()=>[(0,u.bF)(c,{label:"é…åˆå–®ä½","label-width":m.value?"7rem":"120px",prop:"CoopUnit"},{default:(0,u.k6)((()=>[(0,u.bF)(b,{modelValue:n.value.CoopUnit,"onUpdate:modelValue":a[2]||(a[2]=e=>n.value.CoopUnit=e),style:(0,L.Tr)({width:(m.value,"100%")})},null,8,["modelValue","style"])])),_:1},8,["label-width"])])),_:1},8,["span"]),(0,u.bF)(v,{span:m.value?24:6},{default:(0,u.k6)((()=>[(0,u.bF)(c,{label:"è¨­å‚™æ‡‰ç”¨é¡žåž‹","label-width":m.value?"7rem":"120px",prop:"DeviceUsageCategory"},{default:(0,u.k6)((()=>[(0,u.bF)(y,{modelValue:n.value.DeviceUsageCategory,"onUpdate:modelValue":a[3]||(a[3]=e=>n.value.DeviceUsageCategory=e),multiple:"",placeholder:"è«‹é¸æ“‡è¨­å‚™æ‡‰ç”¨é¡žåž‹",style:(0,L.Tr)({width:(m.value,"100%")})},{default:(0,u.k6)((()=>[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(i.value,(e=>((0,u.uX)(),(0,u.Wv)(g,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue","style"])])),_:1},8,["label-width"])])),_:1},8,["span"]),(0,u.bF)(v,{span:m.value?24:6},{default:(0,u.k6)((()=>[(0,u.bF)(c,{label:"ç³»çµ±é¡žåž‹","label-width":m.value?"7rem":"120px",prop:"SystemType"},{default:(0,u.k6)((()=>[(0,u.bF)(y,{modelValue:n.value.SystemType,"onUpdate:modelValue":a[4]||(a[4]=e=>n.value.SystemType=e),multiple:"",placeholder:"è«‹é¸æ“‡ç³»çµ±é¡žåž‹",style:(0,L.Tr)({width:(m.value,"100%")})},{default:(0,u.k6)((()=>[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)((0,d.R1)($V),(e=>((0,u.uX)(),(0,u.Wv)(g,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue","style"])])),_:1},8,["label-width"])])),_:1},8,["span"]),(0,u.bF)(v,{span:m.value?24:6},{default:(0,u.k6)((()=>[(0,u.bF)(c,{label:"è¨­å‚™æ¸…å–®","label-width":m.value?"7rem":"120px",prop:"DeviceList"},{default:(0,u.k6)((()=>[(0,u.bF)(b,{modelValue:n.value.DeviceList,"onUpdate:modelValue":a[5]||(a[5]=e=>n.value.DeviceList=e),type:"textarea",style:(0,L.Tr)({width:(m.value,"100%")})},null,8,["modelValue","style"])])),_:1},8,["label-width"])])),_:1},8,["span"]),(0,u.bF)(v,{span:m.value?24:6},{default:(0,u.k6)((()=>[(0,u.bF)(c,{label:"é ä¼°é‡‘é¡(NT$)","label-width":m.value?"7rem":"120px",prop:"EstimatedAmount"},{default:(0,u.k6)((()=>[(0,u.bF)(b,{modelValue:n.value.EstimatedAmount,"onUpdate:modelValue":a[6]||(a[6]=e=>n.value.EstimatedAmount=e),placeholder:"è«‹è¼¸å…¥é ä¼°é‡‘é¡",style:(0,L.Tr)({width:(m.value,"100%")})},null,8,["modelValue","style"])])),_:1},8,["label-width"])])),_:1},8,["span"]),(0,u.bF)(v,{span:m.value?24:6},{default:(0,u.k6)((()=>[(0,u.bF)(c,{label:"é è¨ˆäº¤è²¨æ—¥","label-width":m.value?"7rem":"120px",prop:"EstimatedDeliveryDate"},{default:(0,u.k6)((()=>[(0,u.bF)(t,{modelValue:n.value.EstimatedDeliveryDate,"onUpdate:modelValue":a[7]||(a[7]=e=>n.value.EstimatedDeliveryDate=e),type:"date",placeholder:"é¸æ“‡æ—¥æœŸ","value-format":"YYYY-MM-DD",style:(0,L.Tr)({width:(m.value,"100%")})},null,8,["modelValue","style"])])),_:1},8,["label-width"])])),_:1},8,["span"]),(0,u.bF)(v,{span:m.value?24:6},{default:(0,u.k6)((()=>[(0,u.bF)(c,{label:"æ¡ˆä»¶é€²åº¦","label-width":m.value?"7rem":"120px",prop:"CaseProgress"},{default:(0,u.k6)((()=>[(0,u.bF)(y,{modelValue:n.value.CaseProgress,"onUpdate:modelValue":a[8]||(a[8]=e=>n.value.CaseProgress=e),placeholder:"è«‹é¸æ“‡æ¡ˆä»¶é€²åº¦",style:(0,L.Tr)({width:(m.value,"100%")})},{default:(0,u.k6)((()=>[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)((0,d.R1)(UV),(e=>((0,u.uX)(),(0,u.Wv)(g,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue","style"])])),_:1},8,["label-width"])])),_:1},8,["span"]),(0,u.bF)(v,{span:m.value?24:6},{default:(0,u.k6)((()=>[(0,u.bF)(c,{label:"è² è²¬æ¥­å‹™","label-width":m.value?"7rem":"120px"},{default:(0,u.k6)((()=>[(0,u.bF)(yl,{"employee-id":(0,d.R1)(l).userId},null,8,["employee-id"])])),_:1},8,["label-width"])])),_:1},8,["span"]),(0,u.bF)(v,{span:m.value?24:6,style:(0,L.Tr)({display:"flex",justifyContent:m.value?"center":"flex-start"})},{default:(0,u.k6)((()=>[(0,u.bF)(f,{type:"primary",onClick:s,style:(0,L.Tr)({width:(m.value,"50%")})},{default:(0,u.k6)((()=>a[9]||(a[9]=[(0,u.eW)(" é€å‡º ")]))),_:1},8,["style"])])),_:1},8,["span","style"])])),_:1},8,["gutter"])])),_:1},8,["model","label-width"])],4)}}};const XV=(0,ie.A)(NV,[["__scopeId","data-v-6328ba72"]]);var KV=XV;const MV={class:"block"},PV={class:"btn-totalEstimatedAmount ml-3"},OV={key:0},zV={key:1},BV={key:2},jV={key:0},YV={key:0},QV={key:0},HV={key:0},qV={key:0},JV={key:0},GV={key:0},ZV={key:0},eI={key:0},aI={key:1},lI={key:2},tI={key:0},oI={key:0},nI={key:0},rI={key:0},sI=["infinite-scroll-disabled"],uI={style:{padding:"10px"}},iI={key:0},dI={key:1},cI={key:2},pI={key:0},mI={key:1},vI={key:2},bI={key:3},gI={key:4},yI={key:5},fI={key:6},hI={key:7},kI={key:8},_I={key:3},wI={style:{"margin-top":"10px",display:"flex",gap:"8px"}},FI={key:1,class:"load-more"},CI={key:2,class:"load-more"},DI={class:"card flex justify-center"},LI={style:{"text-align":"center"}};var RI={__name:"List_CaseTracking",setup(e,{expose:a}){const l=(0,S.k)(),o=(0,d.KR)([]),n=(0,d.KR)(!1),r=(0,u.EW)((()=>C.value.reduce(((e,a)=>{const l=Number(a.estimatedAmount);return isNaN(l)?e:e+l}),0))),s=(0,d.KR)([]),i=(0,d.KR)([]),c=(0,d.KR)(""),p=(0,d.KR)(""),m=(0,d.KR)(10),v=(0,d.KR)(1),b=(0,d.KR)(null),g=(0,d.KR)(null),y=(0,d.KR)(!1),f=(0,d.KR)(!1),h=(0,d.KR)(30),k=(0,d.KR)(null),_=(0,d.KR)(null),w={id:"ID",fillDate:"å¡«å¯«æ—¥æœŸ",salesRepID:"è² è²¬æ¥­å‹™",caseName:"æ¡ˆå",coopUnit:"é…åˆå–®ä½",deviceUsageCategory:"è¨­å‚™æ‡‰ç”¨é¡žåž‹",systemType:"ç³»çµ±é¡žåž‹",deviceList:"è¨­å‚™æ¸…å–®",estimatedAmount:"é ä¼°é‡‘é¡",estimatedDeliveryDate:"é è¨ˆäº¤è²¨æ—¥",caseProgress:"æ¡ˆä»¶é€²åº¦",fxRate:"åŒ¯çŽ‡",originalAmount:"æˆäº¤é‡‘é¡(åŽŸå¹£)",localAmount:"æˆäº¤é‡‘é¡(æœ¬å¹£)"},F=[{label:"æ¡ˆå",value:"caseName"},{label:"é…åˆå–®ä½",value:"coopUnit"},{label:"è¨­å‚™æ‡‰ç”¨é¡žåž‹",value:"deviceUsageCategory"},{label:"ç³»çµ±é¡žåž‹",value:"systemType"},{label:"æ¡ˆä»¶é€²åº¦",value:"caseProgress"},{label:"é ä¼°é‡‘é¡",value:"estimatedAmount"},{label:"é è¨ˆäº¤è²¨æ—¥",value:"estimatedDeliveryDate"}],C=(0,u.EW)((()=>{let e=s.value;if(i.value&&2===i.value.length){const[a,l]=i.value;e=e.filter((e=>{const t=new Date(e.fillDate);return t>=a&&t<=l}))}return p.value&&(e=e.filter((e=>{const a=e[c.value];if("estimatedAmount"===c.value)return a&&a.toString().toLowerCase().includes(p.value.toLowerCase());if("deviceUsageCategory"===c.value){if(!p.value?.length)return!0;const e=Array.isArray(a)?a:"string"===typeof a?a.split(","):[];return p.value.some((a=>e.includes(a)))}if("caseProgress"===c.value){if(!p.value?.length)return!0;const e=Array.isArray(a)?a:"string"===typeof a?a.split(","):[];return p.value.some((a=>e.includes(a)))}if("systemType"===c.value){if(!p.value?.length)return!0;const e=Array.isArray(a)?a:"string"===typeof a?a.split(","):[];return p.value.some((a=>e.includes(a)))}if("estimatedDeliveryDate"===c.value){if(!p.value||2!==p.value.length)return!0;const[e,l]=p.value,t=new Date(a),o=new Date(e),n=new Date(l);return t>=o&&t<=n}{const e=p.value.toLowerCase();return a&&a.toString().toLowerCase().includes(e)}}))),e})),R=(0,u.EW)((()=>{if(y.value)return C.value.slice(0,h.value);{const e=(v.value-1)*m.value;return C.value.slice(e,e+m.value)}})),V=async()=>{try{const e=await OC.getAllCaseTracking();s.value=e.data,console.log(e.data)}catch(e){console.error("å–å¾—æ¡ˆä»¶è¿½è¹¤æ¸…å–®å¤±æ•—ï¼š",e)}};a({loadCases:V});const x=()=>{y.value?h.value=30:v.value=1},E=()=>{"deviceUsageCategory"===c.value||"systemType"===c.value||"caseProgress"===c.value||"estimatedDeliveryDate"===c.value?p.value=[]:p.value="",x()},A=e=>{v.value=e},T=e=>e.salesRepID===l.userId,W=e=>{if(!T(e))return void D.nk.warning("æ‚¨åªèƒ½ç·¨è¼¯è‡ªå·±å‰µå»ºçš„è³‡æ–™");y.value&&!o.value.includes(e.id)&&o.value.push(e.id);const a=s.value.find((a=>a.id===e.id));if(a){const l=JSON.parse(JSON.stringify(a));"string"===typeof l.deviceUsageCategory&&l.deviceUsageCategory?l.deviceUsageCategory=l.deviceUsageCategory.split(","):l.deviceUsageCategory=[],"string"===typeof l.systemType&&l.systemType?l.systemType=l.systemType.split(","):l.systemType=[],"string"===typeof l.caseProgress&&l.caseProgress?l.caseProgress=l.caseProgress.split(","):l.caseProgress=[],s.value=s.value.map((a=>a.id===e.id?l:a)),b.value=e.id,g.value=!1,y.value&&_.value&&_.value.toggleRowExpansion(e,!0)}},U=e=>{if(!T(e))return void D.nk.warning("æ‚¨åªèƒ½ç·¨è¼¯è‡ªå·±å‰µå»ºçš„è³‡æ–™");const a=s.value.find((a=>a.id===e.id));if(a){const l=JSON.parse(JSON.stringify(a));s.value=s.value.map((a=>a.id===e.id?l:a)),b.value=e.id,g.value=!0,y.value&&_.value&&_.value.toggleRowExpansion(e,!0)}},$=e=>{b.value=null,g.value=!1,y.value&&_.value&&e&&_.value.toggleRowExpansion(e,!0)},N=async e=>{try{const a={...e};if(g.value){const l=s.value.find((a=>a.id===e.id));a.FXRate=null===e.FXRate||""===e.FXRate?0:e.FXRate,a.originalAmount=null===e.originalAmount||""===e.originalAmount?0:e.originalAmount,a.localAmount=null===e.localAmount||""===e.localAmount?0:e.localAmount;for(const e in l)["FXRate","originalAmount","localAmount","id","isShow"].includes(e)||(a[e]=l[e])}else Array.isArray(a.deviceUsageCategory)&&(a.deviceUsageCategory=a.deviceUsageCategory.join(",")),Array.isArray(a.systemType)&&(a.systemType=a.systemType.join(",")),Array.isArray(a.caseProgress)&&(a.caseProgress=a.caseProgress.join(","));delete a.id,delete a.isShow,g.value?(await OC.updateFXRateAndOriginalAmount(e.id,a),D.nk.success("æˆäº¤é‡‘é¡å·²æ›´æ–°")):(await OC.updateCaseTracking(e.id,a),D.nk.success("æ¡ˆä»¶è³‡æ–™å·²æ›´æ–°")),b.value=null,g.value=!1,await V()}catch(a){console.error(a),D.nk.error("æ›´æ–°å¤±æ•—ï¼š"+(a.response?.data||a.message))}},X=e=>{T(e)?Sa.s.confirm("ç¢ºå®šæ˜¯å¦åˆªé™¤è©²è³‡æ–™ï¼Ÿ","åˆªé™¤ç¢ºèª",{type:"warning"}).then((async()=>{try{await OC.deleteCaseTracking(e.id),D.nk.success("æ¡ˆä»¶è³‡æ–™å·²åˆªé™¤"),s.value=s.value.filter((a=>a.id!==e.id))}catch(a){D.nk.error("åˆªé™¤å¤±æ•—")}})).catch((()=>{})):D.nk.warning("æ‚¨åªèƒ½åˆªé™¤è‡ªå·±å‰µå»ºçš„è³‡æ–™")},K=e=>e?new Date(e).toLocaleDateString("zh-TW"):"",M=e=>{if(null===e||void 0===e||""===e)return 0;const a=String(e).replace(/[,\s]/g,""),l=Number(a);return isNaN(l)?0:l.toLocaleString("en-US")},P=(0,d.KR)([]),O=e=>{if(!e)return"";let a;if("string"===typeof e)a=e.split(",");else{if(!Array.isArray(e))return"";a=e}const l=a.map((e=>{const a=P.value.find((a=>a.id===e));return a?a.name:e}));return l.join(", ")},z=e=>{if(!e)return"";let a;if("string"===typeof e)a=e.split(",");else{if(!Array.isArray(e))return"";a=e}const l=a.map((e=>{const a=UV.find((a=>a.value===e));return a?a.label:e}));return l.join(", ")},B=e=>{if(!e)return"";let a;if("string"===typeof e)a=e.split(",");else{if(!Array.isArray(e))return"";a=e}const l=a.map((e=>{const a=$V.find((a=>a.value===e));return a?a.label:e}));return l.join(", ")},j=async()=>{try{const e=await OC.getDeviceUsageCategories();P.value=e.data}catch(e){console.error("å–å¾—è¨­å‚™æ‡‰ç”¨é¡žåž‹è³‡æ–™å¤±æ•—:",e),D.nk.error("å–å¾—è¨­å‚™æ‡‰ç”¨é¡žåž‹è³‡æ–™å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦ã€‚")}};(0,u.sV)((()=>{V(),j();const e=new Date,a=new Date;a.setMonth(e.getMonth()-1);const l=new Date(a.getFullYear(),a.getMonth(),a.getDate(),0,0,0),t=new Date(e.getFullYear(),e.getMonth(),e.getDate(),23,59,59);i.value=[l,t]}));const Y=e=>e.getTime()>Date.now(),Q=()=>{const e=k.value;if(!e||f.value)return;const{scrollTop:a,scrollHeight:l,clientHeight:t}=e;a+t>=l-50&&q()},H=(0,u.EW)((()=>e=>Object.entries(e).filter((([e])=>"id"!==e&&"isShow"!==e)))),q=()=>{h.value<C.value.length&&(f.value=!0,setTimeout((()=>{h.value+=30,f.value=!1}),500))},J=window.matchMedia("(max-width: 768px)"),G=e=>{y.value=e.matches};return(0,u.sV)((()=>{J.addEventListener("change",G),G(J)})),(0,u.hi)((()=>{J.removeEventListener("change",G)})),(0,u.wB)(y,(async e=>{await(0,u.dY)(),e&&k.value?k.value.addEventListener("scroll",Q):k.value&&k.value.removeEventListener("scroll",Q)})),(0,u.hi)((()=>{k.value&&k.value.removeEventListener("scroll",Q)})),(e,a)=>{const l=(0,u.g2)("el-date-picker"),s=(0,u.g2)("el-option"),f=(0,u.g2)("el-select"),h=(0,u.g2)("el-input"),D=(0,u.g2)("el-button"),V=(0,u.g2)("el-text"),S=(0,u.g2)("el-pagination"),j=(0,u.g2)("el-table-column"),Q=(0,u.g2)("el-table"),J=(0,u.gN)("infinite-scroll");return(0,u.uX)(),(0,u.CE)(u.FK,null,[(0,u.Lk)("div",{class:"wrap",style:(0,L.Tr)({width:y.value?"23rem":"auto",margin:y.value?"0rem 2rem 0rem 1rem":"0rem 2rem 0rem 3rem"})},[(0,u.Lk)("div",{ref_key:"wrapper",ref:k,class:"controls-bar w-full",style:(0,L.Tr)({margin:y.value?"1rem 1rem 1rem 0rem":"1rem 0rem 1rem 0rem",padding:y.value?"1rem 1rem 1rem 1rem":"1rem",display:"flex",alignItems:(y.value,"center"),border:"1px solid black",flexDirection:y.value?"column":"row",gap:y.value?"10px":"0"})},[(0,u.Lk)("span",{style:(0,L.Tr)({marginRight:y.value?"0":"1rem"})},"é¸æ“‡å¡«å¯«æ—¥æœŸå€é–“",4),(0,u.Lk)("div",MV,[(0,u.bF)(l,{modelValue:i.value,"onUpdate:modelValue":a[0]||(a[0]=e=>i.value=e),type:"daterange","range-separator":"~","start-placeholder":"é–‹å§‹","end-placeholder":"çµæŸ",style:(0,L.Tr)({width:y.value?"100%":"14rem"}),"disabled-date":Y},null,8,["modelValue","style"])]),(0,u.Lk)("div",{class:"search-block",style:(0,L.Tr)({display:"flex",marginLeft:y.value?"0":"2rem",flexDirection:y.value?"column":"row",alignItems:(y.value,"center"),gap:"8px"})},[(0,u.bF)(f,{modelValue:c.value,"onUpdate:modelValue":a[1]||(a[1]=e=>c.value=e),placeholder:"é¸æ“‡æ¬„ä½",style:(0,L.Tr)({width:y.value?"100%":"9rem"}),onChange:E},{default:(0,u.k6)((()=>[((0,u.uX)(),(0,u.CE)(u.FK,null,(0,u.pI)(F,(e=>(0,u.bF)(s,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),64))])),_:1},8,["modelValue","style"]),"estimatedAmount"!==c.value&&"deviceUsageCategory"!==c.value&&"caseProgress"!==c.value&&"systemType"!==c.value&&"estimatedDeliveryDate"!==c.value?((0,u.uX)(),(0,u.Wv)(h,{key:0,modelValue:p.value,"onUpdate:modelValue":a[2]||(a[2]=e=>p.value=e),placeholder:"è«‹è¼¸å…¥é—œéµå­—",clearable:"",onClear:x,onKeyup:(0,t.jR)(x,["enter"]),style:(0,L.Tr)({width:y.value?"100%":"200px"})},null,8,["modelValue","style"])):"estimatedAmount"===c.value?((0,u.uX)(),(0,u.Wv)(h,{key:1,modelValue:p.value,"onUpdate:modelValue":a[3]||(a[3]=e=>p.value=e),placeholder:"è«‹è¼¸å…¥é ä¼°é‡‘é¡",clearable:"",onClear:x,onKeyup:(0,t.jR)(x,["enter"]),style:(0,L.Tr)({width:y.value?"100%":"200px"}),type:"number"},null,8,["modelValue","style"])):"deviceUsageCategory"===c.value?((0,u.uX)(),(0,u.Wv)(f,{key:2,modelValue:p.value,"onUpdate:modelValue":a[4]||(a[4]=e=>p.value=e),multiple:"",placeholder:"è«‹é¸æ“‡è¨­å‚™æ‡‰ç”¨é¡žåž‹",clearable:"",onClear:x,onChange:x,style:(0,L.Tr)({width:y.value?"100%":"200px"})},{default:(0,u.k6)((()=>[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(P.value,(e=>((0,u.uX)(),(0,u.Wv)(s,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue","style"])):"caseProgress"===c.value?((0,u.uX)(),(0,u.Wv)(f,{key:3,modelValue:p.value,"onUpdate:modelValue":a[5]||(a[5]=e=>p.value=e),multiple:"",placeholder:"è«‹é¸æ“‡æ¡ˆä»¶é€²åº¦",clearable:"",onClear:x,onChange:x,style:(0,L.Tr)({width:y.value?"100%":"200px"})},{default:(0,u.k6)((()=>[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)((0,d.R1)(UV),(e=>((0,u.uX)(),(0,u.Wv)(s,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue","style"])):"systemType"===c.value?((0,u.uX)(),(0,u.Wv)(f,{key:4,modelValue:p.value,"onUpdate:modelValue":a[6]||(a[6]=e=>p.value=e),multiple:"",placeholder:"è«‹é¸æ“‡ç³»çµ±é¡žåž‹",clearable:"",onClear:x,onChange:x,style:(0,L.Tr)({width:y.value?"100%":"200px"})},{default:(0,u.k6)((()=>[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)((0,d.R1)($V),(e=>((0,u.uX)(),(0,u.Wv)(s,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue","style"])):"estimatedDeliveryDate"===c.value?((0,u.uX)(),(0,u.Wv)(l,{key:5,modelValue:p.value,"onUpdate:modelValue":a[7]||(a[7]=e=>p.value=e),type:"daterange","range-separator":"~","start-placeholder":"é–‹å§‹","end-placeholder":"çµæŸ",clearable:"",onClear:x,onChange:x,style:(0,L.Tr)({width:y.value?"100%":"14rem"}),"value-format":"YYYY-MM-DD"},null,8,["modelValue","style"])):(0,u.Q3)("",!0),(0,u.bF)(D,{type:"primary",style:(0,L.Tr)({display:"flex",justifyContent:y.value?"center":"flex-start"}),onClick:x},{default:(0,u.k6)((()=>a[16]||(a[16]=[(0,u.eW)("æœå°‹")]))),_:1},8,["style"])],4),(0,u.Lk)("div",PV,[(0,u.bF)(D,{type:"info",style:(0,L.Tr)({display:"flex",justifyContent:y.value?"center":"flex-start"}),onClick:a[8]||(a[8]=e=>n.value=!0)},{default:(0,u.k6)((()=>a[17]||(a[17]=[(0,u.eW)(" é ä¼°é‡‘é¡åŠ ç¸½ ")]))),_:1},8,["style"])]),y.value?(0,u.Q3)("",!0):((0,u.uX)(),(0,u.CE)("div",{key:0,class:"pagination-block",style:(0,L.Tr)({display:"flex",alignItems:y.value?"flex-start":"center",marginLeft:y.value?"0":"2rem",flexDirection:y.value?"column":"row",gap:y.value?"10px":"0"})},[(0,u.bF)(V,{class:"mx-1",type:"info"},{default:(0,u.k6)((()=>a[18]||(a[18]=[(0,u.eW)("æ¯é é¡¯ç¤º")]))),_:1}),(0,u.bF)(f,{modelValue:m.value,"onUpdate:modelValue":a[9]||(a[9]=e=>m.value=e),placeholder:"",style:(0,L.Tr)({width:y.value?"100%":"4rem"}),size:"small"},{default:(0,u.k6)((()=>[((0,u.uX)(),(0,u.CE)(u.FK,null,(0,u.pI)([5,10,15,20,25,30],(e=>(0,u.bF)(s,{key:e,label:e,value:e},null,8,["label","value"]))),64))])),_:1},8,["modelValue","style"]),(0,u.bF)(V,{class:"mx-1",type:"info"},{default:(0,u.k6)((()=>a[19]||(a[19]=[(0,u.eW)("ç­†")]))),_:1}),(0,u.Lk)("div",{style:(0,L.Tr)({marginLeft:y.value?"0":"1rem"})},[(0,u.bF)(S,{background:"",layout:"prev, pager, next",total:C.value.length,"page-size":m.value,"current-page":v.value,"onUpdate:currentPage":a[10]||(a[10]=e=>v.value=e),onCurrentChange:A},null,8,["total","page-size","current-page"])],4)],4))],4),y.value?(0,u.Q3)("",!0):((0,u.uX)(),(0,u.Wv)(Q,{key:0,class:"list-case-tracking",data:R.value,style:{width:"100%"}},{default:(0,u.k6)((()=>[(0,u.bF)(j,{label:"æ“ä½œ",width:"140"},{default:(0,u.k6)((({row:e})=>[b.value!==e.id?((0,u.uX)(),(0,u.CE)("div",OV,[(0,u.bF)(D,{type:"primary",size:"small",onClick:a=>W(e),disabled:!T(e)},{default:(0,u.k6)((()=>a[20]||(a[20]=[(0,u.eW)(" ç·¨è¼¯ ")]))),_:2},1032,["onClick","disabled"]),(0,u.bF)(D,{type:"danger",size:"small",onClick:a=>X(e),disabled:!T(e)},{default:(0,u.k6)((()=>a[21]||(a[21]=[(0,u.eW)(" åˆªé™¤ ")]))),_:2},1032,["onClick","disabled"])])):g.value?((0,u.uX)(),(0,u.CE)("div",BV,[(0,u.bF)(D,{type:"primary",size:"small",disabled:""},{default:(0,u.k6)((()=>a[24]||(a[24]=[(0,u.eW)("ç·¨è¼¯")]))),_:1}),(0,u.bF)(D,{type:"danger",size:"small",disabled:""},{default:(0,u.k6)((()=>a[25]||(a[25]=[(0,u.eW)("åˆªé™¤")]))),_:1})])):((0,u.uX)(),(0,u.CE)("div",zV,[(0,u.bF)(D,{type:"success",size:"small",onClick:a=>N(e)},{default:(0,u.k6)((()=>a[22]||(a[22]=[(0,u.eW)("å®Œæˆ")]))),_:2},1032,["onClick"]),(0,u.bF)(D,{type:"info",size:"small",onClick:a[11]||(a[11]=e=>$())},{default:(0,u.k6)((()=>a[23]||(a[23]=[(0,u.eW)("å–æ¶ˆ")]))),_:1})]))])),_:1}),(0,u.Q3)("",!0),(0,u.bF)(j,{prop:"fillDate",label:"å¡«å¯«æ—¥æœŸ",width:"110"},{default:(0,u.k6)((({row:e})=>[b.value!==e.id||g.value?((0,u.uX)(),(0,u.CE)("span",jV,(0,L.v_)(K(e.fillDate)),1)):((0,u.uX)(),(0,u.Wv)(l,{key:1,modelValue:e.fillDate,"onUpdate:modelValue":a=>e.fillDate=a,type:"date",placeholder:"é¸æ“‡æ—¥æœŸ",size:"small","value-format":"YYYY-MM-DD",disabled:g.value},null,8,["modelValue","onUpdate:modelValue","disabled"]))])),_:1}),(0,u.bF)(j,{prop:"salesRepID",label:"è² è²¬æ¥­å‹™",width:"100"},{default:(0,u.k6)((({row:e})=>[(0,u.bF)(yl,{"employee-id":e.salesRepID},null,8,["employee-id"])])),_:1}),(0,u.bF)(j,{prop:"caseName",label:"æ¡ˆå",width:"150"},{default:(0,u.k6)((({row:e})=>[b.value!==e.id||g.value?((0,u.uX)(),(0,u.CE)("span",YV,(0,L.v_)(e.caseName),1)):((0,u.uX)(),(0,u.Wv)(h,{key:1,modelValue:e.caseName,"onUpdate:modelValue":a=>e.caseName=a,size:"small",disabled:g.value},null,8,["modelValue","onUpdate:modelValue","disabled"]))])),_:1}),(0,u.bF)(j,{prop:"coopUnit",label:"é…åˆå–®ä½",width:"120"},{default:(0,u.k6)((({row:e})=>[b.value!==e.id||g.value?((0,u.uX)(),(0,u.CE)("span",QV,(0,L.v_)(e.coopUnit),1)):((0,u.uX)(),(0,u.Wv)(h,{key:1,modelValue:e.coopUnit,"onUpdate:modelValue":a=>e.coopUnit=a,size:"small",disabled:g.value},null,8,["modelValue","onUpdate:modelValue","disabled"]))])),_:1}),(0,u.bF)(j,{prop:"deviceUsageCategory",label:"è¨­å‚™æ‡‰ç”¨é¡žåž‹",width:"200"},{default:(0,u.k6)((({row:e})=>[b.value!==e.id||g.value?((0,u.uX)(),(0,u.CE)("span",HV,(0,L.v_)(O(e.deviceUsageCategory)),1)):((0,u.uX)(),(0,u.Wv)(f,{key:1,modelValue:e.deviceUsageCategory,"onUpdate:modelValue":a=>e.deviceUsageCategory=a,multiple:"",placeholder:"è«‹é¸æ“‡è¨­å‚™æ‡‰ç”¨é¡žåž‹",size:"small",style:{width:"100%"},disabled:g.value},{default:(0,u.k6)((()=>[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(P.value,(e=>((0,u.uX)(),(0,u.Wv)(s,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue","disabled"]))])),_:1}),(0,u.bF)(j,{prop:"systemType",label:"ç³»çµ±é¡žåž‹",width:"200"},{default:(0,u.k6)((({row:e})=>[b.value!==e.id||g.value?((0,u.uX)(),(0,u.CE)("span",qV,(0,L.v_)(B(e.systemType)),1)):((0,u.uX)(),(0,u.Wv)(f,{key:1,modelValue:e.systemType,"onUpdate:modelValue":a=>e.systemType=a,multiple:"",placeholder:"è«‹é¸æ“‡ç³»çµ±é¡žåž‹",size:"small",style:{width:"100%"},disabled:g.value},{default:(0,u.k6)((()=>[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)((0,d.R1)($V),(e=>((0,u.uX)(),(0,u.Wv)(s,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue","disabled"]))])),_:1}),(0,u.bF)(j,{prop:"deviceList",label:"è¨­å‚™æ¸…å–®",width:"150"},{default:(0,u.k6)((({row:e})=>[b.value!==e.id||g.value?((0,u.uX)(),(0,u.CE)("span",JV,(0,L.v_)(e.deviceList),1)):((0,u.uX)(),(0,u.Wv)(h,{key:1,modelValue:e.deviceList,"onUpdate:modelValue":a=>e.deviceList=a,size:"small",disabled:g.value},null,8,["modelValue","onUpdate:modelValue","disabled"]))])),_:1}),(0,u.bF)(j,{prop:"estimatedAmount",label:"é ä¼°é‡‘é¡",width:"120"},{default:(0,u.k6)((({row:e})=>[b.value!==e.id||g.value?((0,u.uX)(),(0,u.CE)("span",GV,(0,L.v_)(M(e.estimatedAmount)),1)):((0,u.uX)(),(0,u.Wv)(h,{key:1,modelValue:e.estimatedAmount,"onUpdate:modelValue":a=>e.estimatedAmount=a,size:"small",style:{width:"100%"},disabled:g.value},null,8,["modelValue","onUpdate:modelValue","disabled"]))])),_:1}),(0,u.bF)(j,{prop:"caseProgress",label:"æ¡ˆä»¶é€²åº¦",width:"140"},{default:(0,u.k6)((({row:e})=>[b.value!==e.id||g.value?((0,u.uX)(),(0,u.CE)("span",ZV,(0,L.v_)(z(e.caseProgress)),1)):((0,u.uX)(),(0,u.Wv)(f,{key:1,modelValue:e.caseProgress,"onUpdate:modelValue":a=>e.caseProgress=a,placeholder:"è«‹é¸æ“‡æ¡ˆä»¶é€²åº¦",size:"small",style:{width:"100%"},disabled:g.value},{default:(0,u.k6)((()=>[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)((0,d.R1)(UV),(e=>((0,u.uX)(),(0,u.Wv)(s,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue","disabled"]))])),_:1}),(0,u.bF)(j,{label:"æˆäº¤é‡‘é¡ç·¨è¼¯",width:"140"},{default:(0,u.k6)((({row:e})=>[b.value!==e.id?((0,u.uX)(),(0,u.CE)("div",eI,[(0,u.bF)(D,{type:"warning",size:"small",onClick:a=>U(e),disabled:!T(e)},{default:(0,u.k6)((()=>a[26]||(a[26]=[(0,u.eW)(" æˆäº¤é‡‘é¡ç·¨è¼¯ ")]))),_:2},1032,["onClick","disabled"])])):g.value?((0,u.uX)(),(0,u.CE)("div",aI,[(0,u.bF)(D,{type:"success",size:"small",onClick:a=>N(e)},{default:(0,u.k6)((()=>a[27]||(a[27]=[(0,u.eW)("å®Œæˆ")]))),_:2},1032,["onClick"]),(0,u.bF)(D,{type:"info",size:"small",onClick:a[12]||(a[12]=e=>$())},{default:(0,u.k6)((()=>a[28]||(a[28]=[(0,u.eW)("å–æ¶ˆ")]))),_:1})])):((0,u.uX)(),(0,u.CE)("div",lI,[(0,u.bF)(D,{type:"warning",size:"small",disabled:""},{default:(0,u.k6)((()=>a[29]||(a[29]=[(0,u.eW)("æˆäº¤é‡‘é¡ç·¨è¼¯")]))),_:1})]))])),_:1}),(0,u.bF)(j,{prop:"fxRate",label:"åŒ¯çŽ‡",width:"80"},{default:(0,u.k6)((({row:e})=>[b.value===e.id&&g.value?((0,u.uX)(),(0,u.Wv)(h,{key:1,modelValue:e.fxRate,"onUpdate:modelValue":a=>e.fxRate=a,size:"small"},null,8,["modelValue","onUpdate:modelValue"])):((0,u.uX)(),(0,u.CE)("span",tI,(0,L.v_)(e.fxRate),1))])),_:1}),(0,u.bF)(j,{prop:"originalAmount",label:"æˆäº¤é‡‘é¡/æœªç¨…(åŽŸå¹£)",width:"170"},{default:(0,u.k6)((({row:e})=>[b.value===e.id&&g.value?((0,u.uX)(),(0,u.Wv)(h,{key:1,modelValue:e.originalAmount,"onUpdate:modelValue":a=>e.originalAmount=a,size:"small"},null,8,["modelValue","onUpdate:modelValue"])):((0,u.uX)(),(0,u.CE)("span",oI,(0,L.v_)(M(e.originalAmount)),1))])),_:1}),(0,u.bF)(j,{prop:"LocalAmount",label:"æˆäº¤é‡‘é¡/æœªç¨…(æœ¬å¹£)",width:"170"},{default:(0,u.k6)((({row:e})=>[b.value===e.id&&g.value?(0,u.Q3)("",!0):((0,u.uX)(),(0,u.CE)("span",nI,(0,L.v_)(M(e.localAmount)),1))])),_:1}),(0,u.bF)(j,{prop:"estimatedDeliveryDate",label:"é è¨ˆäº¤è²¨æ—¥",width:"120"},{default:(0,u.k6)((({row:e})=>[b.value!==e.id||g.value?((0,u.uX)(),(0,u.CE)("span",rI,(0,L.v_)(K(e.estimatedDeliveryDate)),1)):((0,u.uX)(),(0,u.Wv)(l,{key:1,modelValue:e.estimatedDeliveryDate,"onUpdate:modelValue":a=>e.estimatedDeliveryDate=a,type:"date",placeholder:"é¸æ“‡æ—¥æœŸ",size:"small",disabled:g.value},null,8,["modelValue","onUpdate:modelValue","disabled"]))])),_:1})])),_:1},8,["data"])),(0,u.bo)(((0,u.uX)(),(0,u.CE)("div",{class:"table-wrapper",ref:"rwdTableWrapper","infinite-scroll-disabled":e.loading||e.noMore,"infinite-scroll-distance":"50",style:{height:"400px","overflow-y":"auto"}},[y.value?((0,u.uX)(),(0,u.Wv)(Q,{key:0,class:"RWD_List_Table",style:(0,L.Tr)({width:y.value?"auto":"20rem"}),data:R.value,stripe:"",border:"",ref_key:"rwdTableRef",ref:_,"row-key":"id","expand-row-keys":o.value},{default:(0,u.k6)((()=>[(0,u.bF)(j,{type:"expand"},{default:(0,u.k6)((({row:e})=>[(0,u.Lk)("div",uI,[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(H.value(e),(([a,t])=>((0,u.uX)(),(0,u.CE)("div",{key:a,style:{"margin-bottom":"8px"}},[w[a]?((0,u.uX)(),(0,u.CE)("strong",iI,(0,L.v_)(w[a])+":",1)):((0,u.uX)(),(0,u.CE)("span",dI,[(0,u.Lk)("strong",null,(0,L.v_)(a)+":",1)])),b.value!==e.id||g.value&&!["fxRate","originalAmount","localAmount"].includes(a)?((0,u.uX)(),(0,u.CE)("span",cI,["fillDate"===a?((0,u.uX)(),(0,u.CE)("span",pI,(0,L.v_)(K(t)),1)):"salesRepID"===a?((0,u.uX)(),(0,u.CE)("span",mI,[(0,u.bF)(yl,{"employee-id":t},null,8,["employee-id"])])):"deviceUsageCategory"===a?((0,u.uX)(),(0,u.CE)("span",vI,(0,L.v_)(O(t)),1)):"systemType"===a?((0,u.uX)(),(0,u.CE)("span",bI,(0,L.v_)(B(t)),1)):"estimatedDeliveryDate"===a?((0,u.uX)(),(0,u.CE)("span",gI,(0,L.v_)(K(t)),1)):"caseProgress"===a?((0,u.uX)(),(0,u.CE)("span",yI,(0,L.v_)(z(t)),1)):"originalAmount"===a?((0,u.uX)(),(0,u.CE)("span",fI,(0,L.v_)(M(t)),1)):"localAmount"===a?((0,u.uX)(),(0,u.CE)("span",hI,(0,L.v_)(M(t)),1)):((0,u.uX)(),(0,u.CE)("span",kI,(0,L.v_)(t),1))])):((0,u.uX)(),(0,u.CE)("span",_I,["fillDate"===a?((0,u.uX)(),(0,u.Wv)(l,{key:0,modelValue:e.fillDate,"onUpdate:modelValue":a=>e.fillDate=a,type:"date",placeholder:"é¸æ“‡æ—¥æœŸ",size:"small","value-format":"YYYY-MM-DD",disabled:g.value},null,8,["modelValue","onUpdate:modelValue","disabled"])):"caseName"===a?((0,u.uX)(),(0,u.Wv)(h,{key:1,modelValue:e.caseName,"onUpdate:modelValue":a=>e.caseName=a,size:"small",disabled:g.value},null,8,["modelValue","onUpdate:modelValue","disabled"])):"coopUnit"===a?((0,u.uX)(),(0,u.Wv)(h,{key:2,modelValue:e.coopUnit,"onUpdate:modelValue":a=>e.coopUnit=a,size:"small",disabled:g.value},null,8,["modelValue","onUpdate:modelValue","disabled"])):"deviceUsageCategory"===a?((0,u.uX)(),(0,u.Wv)(f,{key:3,modelValue:e.deviceUsageCategory,"onUpdate:modelValue":a=>e.deviceUsageCategory=a,multiple:"",placeholder:"è«‹é¸æ“‡è¨­å‚™æ‡‰ç”¨é¡žåž‹",size:"small",style:{width:"100%"},disabled:g.value},{default:(0,u.k6)((()=>[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(P.value,(e=>((0,u.uX)(),(0,u.Wv)(s,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue","disabled"])):"systemType"===a?((0,u.uX)(),(0,u.Wv)(f,{key:4,modelValue:e.systemType,"onUpdate:modelValue":a=>e.systemType=a,multiple:"",placeholder:"è«‹é¸æ“‡ç³»çµ±é¡žåž‹",size:"small",style:{width:"100%"},disabled:g.value},{default:(0,u.k6)((()=>[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)((0,d.R1)($V),(e=>((0,u.uX)(),(0,u.Wv)(s,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue","disabled"])):"deviceList"===a?((0,u.uX)(),(0,u.Wv)(h,{key:5,modelValue:e.deviceList,"onUpdate:modelValue":a=>e.deviceList=a,size:"small",disabled:g.value},null,8,["modelValue","onUpdate:modelValue","disabled"])):"estimatedAmount"===a?((0,u.uX)(),(0,u.Wv)(h,{key:6,modelValue:e.estimatedAmount,"onUpdate:modelValue":a=>e.estimatedAmount=a,size:"small",style:{width:"100%"},disabled:g.value,type:"number"},null,8,["modelValue","onUpdate:modelValue","disabled"])):"estimatedDeliveryDate"===a?((0,u.uX)(),(0,u.Wv)(l,{key:7,modelValue:e.estimatedDeliveryDate,"onUpdate:modelValue":a=>e.estimatedDeliveryDate=a,type:"date",placeholder:"é¸æ“‡æ—¥æœŸ",size:"small",disabled:g.value},null,8,["modelValue","onUpdate:modelValue","disabled"])):"caseProgress"===a?((0,u.uX)(),(0,u.Wv)(f,{key:8,modelValue:e.caseProgress,"onUpdate:modelValue":a=>e.caseProgress=a,placeholder:"è«‹é¸æ“‡æ¡ˆä»¶é€²åº¦",size:"small",style:{width:"100%"},disabled:g.value},{default:(0,u.k6)((()=>[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)((0,d.R1)(UV),(e=>((0,u.uX)(),(0,u.Wv)(s,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue","disabled"])):"fxRate"===a?((0,u.uX)(),(0,u.Wv)(h,{key:9,modelValue:e.fxRate,"onUpdate:modelValue":a=>e.fxRate=a,size:"small"},null,8,["modelValue","onUpdate:modelValue"])):"originalAmount"===a?((0,u.uX)(),(0,u.Wv)(h,{key:10,modelValue:e.originalAmount,"onUpdate:modelValue":a=>e.originalAmount=a,size:"small"},null,8,["modelValue","onUpdate:modelValue"])):(0,u.Q3)("",!0)]))])))),128)),(0,u.Lk)("div",wI,[b.value!==e.id?((0,u.uX)(),(0,u.CE)(u.FK,{key:0},[(0,u.bF)(D,{type:"primary",size:"small",onClick:a=>W(e)},{default:(0,u.k6)((()=>a[30]||(a[30]=[(0,u.eW)("ç·¨è¼¯")]))),_:2},1032,["onClick"]),(0,u.bF)(D,{type:"danger",size:"small",onClick:a=>X(e)},{default:(0,u.k6)((()=>a[31]||(a[31]=[(0,u.eW)("åˆªé™¤")]))),_:2},1032,["onClick"])],64)):b.value!==e.id||g.value?(0,u.Q3)("",!0):((0,u.uX)(),(0,u.CE)(u.FK,{key:1},[(0,u.bF)(D,{type:"success",size:"small",onClick:a=>N(e)},{default:(0,u.k6)((()=>a[32]||(a[32]=[(0,u.eW)("å®Œæˆ")]))),_:2},1032,["onClick"]),(0,u.bF)(D,{type:"info",size:"small",onClick:a[13]||(a[13]=e=>$())},{default:(0,u.k6)((()=>a[33]||(a[33]=[(0,u.eW)("å–æ¶ˆ")]))),_:1})],64)),b.value!==e.id?((0,u.uX)(),(0,u.Wv)(D,{key:2,type:"warning",size:"small",onClick:a=>U(e)},{default:(0,u.k6)((()=>a[34]||(a[34]=[(0,u.eW)("æˆäº¤é‡‘é¡ç·¨è¼¯")]))),_:2},1032,["onClick"])):b.value===e.id&&g.value?((0,u.uX)(),(0,u.CE)(u.FK,{key:3},[(0,u.bF)(D,{type:"success",size:"small",onClick:a=>N(e)},{default:(0,u.k6)((()=>a[35]||(a[35]=[(0,u.eW)("å®Œæˆ")]))),_:2},1032,["onClick"]),(0,u.bF)(D,{type:"info",size:"small",onClick:a[14]||(a[14]=e=>$())},{default:(0,u.k6)((()=>a[36]||(a[36]=[(0,u.eW)("å–æ¶ˆ")]))),_:1})],64)):(0,u.Q3)("",!0)])])])),_:1}),(0,u.Q3)("",!0),(0,u.bF)(j,{prop:"fillDate",label:"å¡«å¯«æ—¥æœŸ",width:"110"},{default:(0,u.k6)((({row:e})=>[(0,u.Lk)("span",null,(0,L.v_)(K(e.fillDate)),1)])),_:1}),(0,u.bF)(j,{prop:"salesRepID",label:"è² è²¬æ¥­å‹™",width:"100"},{default:(0,u.k6)((({row:e})=>[(0,u.bF)(yl,{"employee-id":e.salesRepID},null,8,["employee-id"])])),_:1}),(0,u.bF)(j,{prop:"caseName",label:"æ¡ˆå",width:"220"}),(0,u.bF)(j,{prop:"coopUnit",label:"é…åˆå–®ä½",width:"120"}),(0,u.bF)(j,{prop:"deviceUsageCategory",label:"è¨­å‚™æ‡‰ç”¨é¡žåž‹",width:"130"},{default:(0,u.k6)((({row:e})=>[(0,u.Lk)("span",null,(0,L.v_)(O(e.deviceUsageCategory)),1)])),_:1}),(0,u.bF)(j,{prop:"systemType",label:"ç³»çµ±é¡žåž‹",width:"130"},{default:(0,u.k6)((({row:e})=>[(0,u.Lk)("span",null,(0,L.v_)(B(e.systemType)),1)])),_:1}),(0,u.bF)(j,{prop:"deviceList",label:"è¨­å‚™æ¸…å–®",width:"150"}),(0,u.bF)(j,{prop:"estimatedAmount",label:"é ä¼°é‡‘é¡",width:"120"},{default:(0,u.k6)((({row:e})=>[(0,u.Lk)("span",null,(0,L.v_)(M(e.estimatedAmount)),1)])),_:1}),(0,u.bF)(j,{prop:"caseProgress",label:"æ¡ˆä»¶é€²åº¦",width:"140"},{default:(0,u.k6)((({row:e})=>[(0,u.Lk)("span",null,(0,L.v_)(z(e.caseProgress)),1)])),_:1}),(0,u.bF)(j,{prop:"fxRate",label:"åŒ¯çŽ‡",width:"80"}),(0,u.bF)(j,{prop:"originalAmount",label:"æˆäº¤é‡‘é¡(åŽŸå¹£)",width:"150"},{default:(0,u.k6)((({row:e})=>[(0,u.Lk)("span",null,(0,L.v_)(M(e.originalAmount)),1)])),_:1}),(0,u.bF)(j,{prop:"LocalAmount",label:"æˆäº¤é‡‘é¡(æœ¬å¹£)",width:"150"},{default:(0,u.k6)((({row:e})=>[(0,u.Lk)("span",null,(0,L.v_)(M(e.localAmount)),1)])),_:1}),(0,u.bF)(j,{prop:"estimatedDeliveryDate",label:"é è¨ˆäº¤è²¨æ—¥",width:"120"},{default:(0,u.k6)((({row:e})=>[(0,u.Lk)("span",null,(0,L.v_)(K(e.estimatedDeliveryDate)),1)])),_:1})])),_:1},8,["style","data","expand-row-keys"])):(0,u.Q3)("",!0),e.loading?((0,u.uX)(),(0,u.CE)("div",FI,"è¼‰å…¥ä¸­â€¦")):(0,u.Q3)("",!0),!e.loading&&e.noMore?((0,u.uX)(),(0,u.CE)("div",CI,"æ²’æœ‰æ›´å¤šè³‡æ–™")):(0,u.Q3)("",!0)],8,sI)),[[J,q]])],4),(0,u.Lk)("div",DI,[(0,u.bF)((0,d.R1)(I.A),{visible:n.value,"onUpdate:visible":a[15]||(a[15]=e=>n.value=e),header:"é ä¼°é‡‘é¡åŠ ç¸½",style:{width:"15rem"}},{default:(0,u.k6)((()=>[(0,u.Lk)("div",LI,[(0,u.bF)(V,{class:"mx-1",style:{"font-size":"1rem"},type:"primary",tag:"b"},{default:(0,u.k6)((()=>[(0,u.eW)((0,L.v_)(M(r.value)),1)])),_:1})])])),_:1},8,["visible"])])],64)}}};const VI=(0,ie.A)(RI,[["__scopeId","data-v-00012db3"]]);var II=VI;const xI={class:"ml-6"},EI={class:"ml-6",style:{"padding-right":"1rem"}};var AI={__name:"CaseTracking",setup(e){const a=(0,d.KR)(null),l=()=>{a.value&&a.value.loadCases()};return(e,t)=>((0,u.uX)(),(0,u.CE)(u.FK,null,[(0,u.Lk)("div",xI,[(0,u.bF)(KV,{onCaseTrackingSubmitted:l})]),(0,u.Lk)("div",EI,[(0,u.bF)(II,{ref_key:"listCaseTrackingRef",ref:a},null,512)])],64))}};const TI=AI;var WI=TI;const SI={class:"personal-leave-container"},UI={class:"card-header"},$I={class:"annual-leave-section mb-5"},NI={class:"card-header"},XI={class:"desktop-annual-leave-cards"},KI={class:"desktop-card-header"},MI={class:"year-info"},PI={class:"year-title"},OI={class:"hire-date-info"},zI={class:"usage-overview"},BI={class:"usage-rate-display"},jI={class:"desktop-card-content"},YI={class:"leave-days-section"},QI={class:"section-header"},HI={class:"days-grid"},qI={key:0,class:"day-item special"},JI={class:"day-value current-year-days"},GI={key:1,class:"day-item special"},ZI={class:"day-value six-months-days"},ex={class:"day-item total-hours-card"},ax={class:"day-value total-hours"},lx={class:"usage-section"},tx={class:"usage-grid"},ox={class:"usage-item used"},nx={class:"usage-info"},rx={class:"usage-value used-days"},sx={class:"usage-item used"},ux={class:"usage-info"},ix={class:"usage-value used-hours"},dx={class:"usage-item remaining"},cx={class:"usage-info"},px={class:"usage-item remaining"},mx={class:"usage-info"},vx={key:0,class:"empty-state"},bx={class:"mobile-cards annual-leave-mobile-cards"},gx={class:"mobile-card-header"},yx={class:"year-badge"},fx={class:"hire-date-mobile"},hx={class:"mobile-card-content"},kx={key:0,class:"mobile-card-row"},_x={class:"mobile-value-container"},wx={class:"mobile-value current-year-days-mobile"},Fx={key:0,class:"mobile-leave-period"},Cx={key:1,class:"mobile-card-row"},Dx={class:"mobile-value-container"},Lx={class:"mobile-value six-months-days-mobile"},Rx={key:0,class:"mobile-leave-period"},Vx={class:"mobile-card-row"},Ix={class:"mobile-value total-hours-mobile"},xx={class:"mobile-card-row"},Ex={class:"mobile-value used-days-mobile"},Ax={class:"mobile-card-row"},Tx={class:"mobile-value used-hours-mobile"},Wx={class:"mobile-card-row"},Sx={class:"mobile-card-row"},Ux={class:"mobile-card-row"},$x={class:"mobile-progress"},Nx={key:0,class:"annual-leave-reminder"},Xx={class:"monthly-leave-summary-section mb-5"},Kx={class:"card-header"},Mx={class:"month-selector"},Px={key:0,class:"monthly-summary-cards"},Ox={class:"monthly-summary-info"},zx={class:"monthly-summary-label"},Bx={class:"monthly-summary-value"},jx={key:1,class:"empty-state"},Yx={class:"mobile-cards"},Qx={class:"leave-type-name"},Hx={class:"leave-type-hours"},qx={class:"filter-section"},Jx={class:"filter-row"},Gx={class:"filter-item"},Zx={class:"filter-item"},eE={class:"filter-item"},aE={class:"card-header"},lE=["onClick"],tE={class:"record-row-header"},oE={class:"record-main-info"},nE={class:"request-id-section"},rE={class:"leave-type-section"},sE={class:"date-range-section"},uE={class:"date-range-text"},iE={class:"hours-section"},dE={class:"hours-text"},cE={class:"apply-date-section"},pE={class:"apply-date-text"},mE={key:0,class:"agent-section"},vE={class:"agent-value"},bE={key:1,class:"supervisor-section"},gE={class:"supervisor-value"},yE={key:2,class:"reason-section"},fE={class:"reason-value"},hE={key:0,class:"empty-state"},kE={class:"mobile-cards leave-records-mobile-cards"},_E={class:"mobile-card-header"},wE={class:"mobile-card-content"},FE={class:"mobile-card-row"},CE={class:"mobile-value date-range-mobile"},DE={class:"end-date"},LE={class:"mobile-card-row"},RE={class:"mobile-value leave-hours-mobile"},VE={class:"mobile-card-row"},IE={class:"mobile-label"},xE={class:"mobile-value monthly-hours-mobile"},EE={class:"hours-value"},AE={class:"month-label"},TE={key:0,class:"mobile-card-row"},WE={class:"mobile-value"},SE={key:1,class:"mobile-card-row"},UE={class:"mobile-value"},$E={key:2,class:"mobile-card-row"},NE={class:"mobile-value reason-mobile"},XE={class:"mobile-card-row"},KE={class:"mobile-value"},ME={key:2,class:"pagination-container"};var PE={__name:"PersonalLeave",setup(e){const a=(0,S.k)(),o=(0,d.KR)(!1),n=(0,d.KR)([]),r=(0,d.KR)(0),s=(0,d.KR)(1),i=(0,d.KR)(20),c=(0,d.KR)(!1),p=(0,d.KR)(null),m=new Date,v=`${m.getFullYear()}-${(m.getMonth()+1).toString().padStart(2,"0")}`,b=(0,d.KR)(v),g=(0,d.KR)(!1),y=(0,d.KR)([]),f=(0,d.KR)((new Date).getFullYear()),h=(0,d.KR)(!1),k=(0,d.KR)({}),_=(0,d.KR)((new Date).getFullYear()),w=(0,d.KR)(v),F=(0,d.KR)({}),C=(0,d.KR)(!1),R=(0,d.KR)(!1),V=(0,d.KR)([]),I=(0,d.KR)([]),x=(0,d.KR)(!1),E=(0,d.KR)(null),A=((0,u.EW)((()=>{const e=(new Date).getFullYear(),a=[];for(let l=e-5;l<=e+1;l++)a.push(l);return a})),(0,d.Kh)({startDate:"",endDate:"",leaveType:""})),T={AnnualLeave:"ç‰¹ä¼‘",SickLeave:"ç—…å‡",PersonalLeave:"äº‹å‡",MenstrualLeave:"ç”Ÿç†å‡",OfficialLeave:"å…¬å‡",WorkInjuryLeave:"å·¥å‚·å‡",FamilyCareLeave:"å®¶åº­ç…§é¡§å‡",MarriageLeave:"å©šå‡",MaternityLeave:"ç”¢å‡",PrenatalCheckupLeave:"ç”¢æª¢å‡",PaternityLeave:"é™ªç”¢å‡",FuneralLeave:"å–ªå‡",JobSeekingLeave:"è¬€è·å‡"},W={AnnualLeave:"success",SickLeave:"warning",PersonalLeave:"info",MenstrualLeave:"danger",OfficialLeave:"primary",WorkInjuryLeave:"warning",FamilyCareLeave:"info",MarriageLeave:"success",MaternityLeave:"danger",PrenatalCheckupLeave:"warning",PaternityLeave:"primary",FuneralLeave:"info",JobSeekingLeave:"warning"},U=async()=>{if(p.value){c.value=!0;try{const e=(await l.e(125).then(l.t.bind(l,52125,23))).default,a=window.innerWidth<=768,t={useCORS:!0,allowTaint:!0,scale:2,backgroundColor:"#ffffff",width:a?window.innerWidth-32:void 0,height:void 0,scrollX:0,scrollY:0},o=await e(p.value,t),n=new Date,r=n.toISOString().slice(0,19).replace(/[:-]/g,""),s=a?"Mobile":"Desktop",u=`è«‹å‡è¨˜éŒ„_${s}_${r}`,i=await Sa.s.confirm("è«‹é¸æ“‡åŒ¯å‡ºæ ¼å¼ï¼š","é¸æ“‡åŒ¯å‡ºæ ¼å¼",{distinguishCancelAndClose:!0,confirmButtonText:"JPG åœ–ç‰‡",cancelButtonText:"PDF æ–‡ä»¶",type:"info"}).catch((e=>{if("cancel"===e)return"pdf";throw e}));if("confirm"===i||!0===i){const e=document.createElement("a");e.download=`${u}.jpg`,e.href=o.toDataURL("image/jpeg",.9),e.click(),D.nk.success("JPG åœ–ç‰‡å·²ä¸‹è¼‰")}else if("pdf"===i){const{jsPDF:e}=await l.e(749).then(l.bind(l,11749)),t=o.toDataURL("image/jpeg",.9),n=o.width,r=o.height,s=a?210:297,i=a?297:210,d=Math.min(s/n,i/r),c=n*d,p=r*d,m=new e({orientation:a?"portrait":"landscape",unit:"mm",format:"a4"}),v=(s-c)/2,b=(i-p)/2;m.addImage(t,"JPEG",v,b,c,p),m.save(`${u}.pdf`),D.nk.success("PDF æ–‡ä»¶å·²ä¸‹è¼‰")}}catch(e){console.error("æˆªåœ–å¤±æ•—:",e),"cancel"!==e&&"close"!==e&&D.nk.error("æˆªåœ–å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦")}finally{c.value=!1}}else D.nk.error("æ‰¾ä¸åˆ°è¦æˆªåœ–çš„å…ƒç´ ")},$=async()=>{if(a.userId){o.value=!0;try{const e={userId:a.userId,page:s.value,pageSize:i.value,startDate:A.startDate,endDate:A.endDate,leaveType:A.leaveType},l=await Wa.getPersonalLeaveRecords(e),t=l.data.records||[],o=await Q(t);n.value=o,r.value=l.data.total||0,D.nk.success(`æŸ¥è©¢å®Œæˆï¼Œå…±æ‰¾åˆ° ${r.value} ç­†è¨˜éŒ„`)}catch(e){console.error("æŸ¥è©¢è«‹å‡è¨˜éŒ„å¤±æ•—:",e),D.nk.error("æŸ¥è©¢è«‹å‡è¨˜éŒ„å¤±æ•—: "+(e.response?.data?.message||e.message))}finally{o.value=!1}}else D.nk.error("ç„¡æ³•å–å¾—ä½¿ç”¨è€…è³‡è¨Š")},N=()=>{s.value=1,$()},X=e=>{if(e){const a=e.split("-")[0],l=e.split("-")[1];A.startDate=`${a}-${l}-01`;const t=new Date(a,l,0).getDate();A.endDate=`${a}-${l}-${t.toString().padStart(2,"0")}`,w.value=e}else A.startDate="",A.endDate="",w.value="";$(),Z()},K=()=>{s.value=1},M=e=>{i.value=e,s.value=1,$()},P=e=>{s.value=e,$()},O=e=>T[e]||e,z=e=>W[e]||"info",B=e=>{if(!e)return"";const a=new Date(e);return a.toLocaleDateString("zh-TW")},j=e=>e?e.substring(0,5):"",Y=(e,a)=>{const l=e||(a||0)/60;return l%1===0?`${l}`:`${l.toFixed(1)}`},Q=async e=>{const l=[],t=new Date,o=t.getFullYear(),n=t.getMonth()+1,r={};for(const u of e)try{const e=u.leaveType;if(!(e in r)){const l={userId:a.userId,page:1,pageSize:1e3,startDate:`${o}-${n.toString().padStart(2,"0")}-01`,endDate:`${o}-${n.toString().padStart(2,"0")}-31`,leaveType:e},t=await Wa.getPersonalLeaveRecords(l),s=t.data.records||[];let u=0;s.forEach((e=>{const a=e.leaveTotalInUnitsOfHours||0,l=e.leaveTotalInUnitsOfMinutes||0;u+=a+l/60})),r[e]=parseFloat(u.toFixed(1))}l.push({...u,monthlyAccumulatedHours:r[e]})}catch(s){console.error("è¨ˆç®—ç•¶æœˆç´¯è¨ˆæ™‚æ•¸å¤±æ•—:",s),l.push({...u,monthlyAccumulatedHours:0})}return l},H=()=>{const e=new Date,a=e.getMonth()+1;return`${a}æœˆ`},q=()=>{const e=new Date,a=e.getMonth()+1;return`${a}æœˆç´¯è¨ˆç¸½æ™‚æ•¸`},G=async()=>{h.value=!0;try{const l={};for(const[t,o]of Object.entries(T))try{const e={userId:a.userId,page:1,pageSize:1e3,startDate:`${_.value}-01-01`,endDate:`${_.value}-12-31`,leaveType:t},o=await Wa.getPersonalLeaveRecords(e),n=o.data.records||[],r=n.filter((e=>e.leaveType!==t));r.length;const s=n.filter((e=>e.leaveType===t));let u=0;s.forEach((e=>{const a=e.leaveTotalInUnitsOfHours||0,l=e.leaveTotalInUnitsOfMinutes||0,t=a+l/60;u+=t})),l[t]=parseFloat(u.toFixed(1))}catch(e){console.error(`âŒ è¨ˆç®— ${o} å¹´åº¦ç´¯è¨ˆæ™‚æ•¸å¤±æ•—:`,e),l[t]=0}k.value=JSON.parse(JSON.stringify(l))}catch(e){console.error("âŒ è¨ˆç®—å¹´åº¦å‡åˆ¥ç´¯è¨ˆæ™‚æ•¸å¤±æ•—:",e),D.nk.error("è¨ˆç®—å¹´åº¦å‡åˆ¥ç´¯è¨ˆæ™‚æ•¸å¤±æ•—: "+(e.response?.data?.message||e.message)),k.value={}}finally{h.value=!1}},Z=async()=>{const e=w.value||b.value;C.value=!0;try{const t={};if(!e)return void(F.value={});const o=e.split("-")[0],n=e.split("-")[1],r=`${o}-${n}-01`,s=new Date(o,n,0).getDate(),u=`${o}-${n}-${s.toString().padStart(2,"0")}`;for(const[e,i]of Object.entries(T))try{const l={userId:a.userId,page:1,pageSize:1e3,startDate:r,endDate:u,leaveType:e},o=await Wa.getPersonalLeaveRecords(l),n=o.data.records||[],s=n.filter((a=>a.leaveType!==e));s.length;const i=n.filter((a=>a.leaveType===e));let d=0;i.forEach((e=>{const a=e.leaveTotalInUnitsOfHours||0,l=a;d+=l})),t[e]=parseFloat(d.toFixed(1))}catch(l){console.error(`âŒ è¨ˆç®— ${i} æœˆä»½ç´¯è¨ˆæ™‚æ•¸å¤±æ•—:`,l),t[e]=0}F.value=JSON.parse(JSON.stringify(t))}catch(l){console.error("âŒ è¨ˆç®—æœˆä»½å‡åˆ¥ç´¯è¨ˆæ™‚æ•¸å¤±æ•—:",l),D.nk.error("è¨ˆç®—æœˆä»½å‡åˆ¥ç´¯è¨ˆæ™‚æ•¸å¤±æ•—: "+(l.response?.data?.message||l.message)),F.value={}}finally{C.value=!1}},ee=()=>{w.value=b.value,Z()},ae=e=>{if(!e)return"";const[a,l]=e.split("-");return`${a}å¹´${l}æœˆ`},le=async()=>{g.value=!0;try{const e=await ja.getEmployeeData(),l=e.data,t=l.find((e=>e.id===a.userId));if(!t)throw new Error(`æ‰¾ä¸åˆ°å“¡å·¥IDç‚º ${a.userId} çš„è³‡æ–™`);if(!t.startDate)throw new Error(`å“¡å·¥ ${a.userId} çš„åˆ°è·æ—¥æœŸæœªè¨­å®šï¼Œè«‹è¯ç¹«ç®¡ç†å“¡æ›´æ–°å“¡å·¥è³‡æ–™`);const o=new Date,n=new Date(t.startDate),r=n.getFullYear(),s=o.getFullYear();let u;u=r===s?s+1:s;const i=new Date(u,0,1).toISOString(),d=new Date(u,n.getMonth(),n.getDate()).toISOString(),c=new Date(u,0,1,0,0,0).toISOString(),p={hireDate:t.startDate,leaveSystemType:2,calculationDate:c,customYearStartDate:i,anniversaryDate:d},m=await Lg.calculateSpecialLeave(p),v=m.data.specialLeaveDays,b=8*v,g={userId:a.userId,page:1,pageSize:1e3,startDate:`${s}-01-01`,endDate:`${s}-12-31`,leaveType:"AnnualLeave"},f=await Wa.getPersonalLeaveRecords(g),h=f.data.records||[],k=h.filter((e=>"AnnualLeave"===e.leaveType)),_=k.reduce(((e,a)=>(console.log("total:",e,"record",a),e+(a.leaveTotalInUnitsOfMinutes||0)/60)),0),w=Math.max(0,b-_),F=b>0?Math.round(_/b*100):0,C=(_/8).toFixed(1),D=(w/8).toFixed(1),L=m.data.hireDate||"-",R=v.toFixed(1);y.value=[{year:s.value,hireDate:L,currentYearDays:R,sixMonthsToAnniversaryDays:m.data.sixMonthsToAnniversaryDays,totalHours:b.toFixed(1),usedDays:C,usedHours:_.toFixed(1),remainingDays:D,remainingHours:w.toFixed(1),usageRate:F,calculationFormula:`æ”¿åºœè©¦ç®—é‚è¼¯: ${m.data.calculationFormula}`,sixMonthsCalculationFormula:m.data.sixMonthsCalculationFormula,sixMonthsLeaveStartDate:m.data.sixMonthsLeaveStartDate,sixMonthsLeaveEndDate:m.data.sixMonthsLeaveEndDate}]}catch(e){console.error("è¨ˆç®—ç‰¹ä¼‘æ™‚æ•¸å¤±æ•—:",e),D.nk.error("è¨ˆç®—ç‰¹ä¼‘æ™‚æ•¸å¤±æ•—: "+(e.response?.data?.message||e.message)),y.value=[]}finally{g.value=!1}},te=()=>{le()},oe=(e,a="LR")=>{E.value={documentID:e,documentTypeID:a},x.value=!0},ne=()=>{x.value=!1,E.value=null},re=e=>{const a=parseFloat(e);return a<=8?"remaining-hours-low":a<=24?"remaining-hours-medium":"remaining-hours-high"},se=e=>{const a=parseFloat(e);return a<=1?"remaining-days-low":a<=3?"remaining-days-medium":"remaining-days-high"},ue=e=>e>=80?"#f56c6c":e>=60?"#e6a23c":"#67c23a",ie=e=>{if(!e)return{totalMonths:0,years:0,months:0,days:0};const a=new Date(e),l=new Date;let t=12*(l.getFullYear()-a.getFullYear());t+=l.getMonth()-a.getMonth(),l.getDate()<a.getDate()&&t--;const o=Math.floor(t/12),n=t%12;let r=new Date(a);r.setFullYear(r.getFullYear()+o),r.setMonth(r.getMonth()+n);const s=l.getTime()-r.getTime(),u=Math.floor(s/864e5);return{totalMonths:t,years:o,months:n,days:u}},de=e=>{if(!e?.hireDate)return!1;const a=new Date(e.hireDate),l=(new Date).getFullYear(),t=new Date(l,0,1),o=new Date(l,11,31,23,59,59,999),n=12*(t.getFullYear()-a.getFullYear())+(t.getMonth()-a.getMonth())-(t.getDate()<a.getDate()?1:0);if(n>=12)return!0;const r=ie(e.hireDate),s=new Date(l-1,11,31,23,59,59,999),u=pe(e.hireDate,s),i=u>0&&u<6&&r.totalMonths>=6;if(i)return!0;if(r.years<1)return!1;const d=new Date(a);return d.setMonth(d.getMonth()+6),d>=t&&d<=o},ce=e=>{if(!e?.hireDate)return!1;const a=new Date,l=a.getFullYear(),t=new Date(l-1,11,31,23,59,59,999),o=ie(e.hireDate),n=pe(e.hireDate,t),r=n>0&&n<6&&o.totalMonths>=6;return!r&&(!(o.years>0)&&o.totalMonths<12)},pe=(e,a)=>{const l=new Date(e);l.setHours(0,0,0,0);const t=new Date(a);t.setHours(0,0,0,0);let o=12*(t.getFullYear()-l.getFullYear())+(t.getMonth()-l.getMonth());return t.getDate()<l.getDate()&&(o-=1),Math.max(0,o)},me=e=>{if(!e.hireDate)return"0";const a=ie(e.hireDate);return a.totalMonths<6?"0":null!==e.sixMonthsToAnniversaryDays&&void 0!==e.sixMonthsToAnniversaryDays?parseFloat(e.sixMonthsToAnniversaryDays).toFixed(1):"0"},ve=()=>{if(0===y.value.length)return{type:null};const e=y.value[0],a=parseFloat(e.remainingHours),l=e.usageRate,t=new Date,o=new Date(f.value,11,31),n=Math.max(0,Math.ceil((o-t)/2592e6));return a<=8?{type:"error",title:"ç‰¹ä¼‘æ™‚æ•¸ä¸è¶³è­¦å‘Š",description:`æ‚¨çš„ç‰¹ä¼‘æ™‚æ•¸åƒ…å‰© ${a} å°æ™‚ï¼Œå»ºè­°ç›¡å¿«å®‰æŽ’ä¼‘å‡ï¼`}:n<=2&&a>24?{type:"warning",title:"ç‰¹ä¼‘æ™‚æ•¸æé†’",description:`è·é›¢å¹´åº•åƒ…å‰© ${n} å€‹æœˆï¼Œæ‚¨é‚„æœ‰ ${a} å°æ™‚ç‰¹ä¼‘æœªä½¿ç”¨ï¼Œè«‹æ³¨æ„å®‰æŽ’ä¼‘å‡ã€‚`}:l>=80?{type:"success",title:"ç‰¹ä¼‘ä½¿ç”¨è‰¯å¥½",description:`æ‚¨å·²ä½¿ç”¨ ${l}% çš„ç‰¹ä¼‘æ™‚æ•¸ï¼Œä¼‘å‡å®‰æŽ’è‰¯å¥½ï¼`}:{type:null}},be=((0,u.EW)((()=>Array.isArray(V.value)?V.value.filter((e=>"AnnualLeave"!==e.LeaveTypeCode&&null!==e.MaxHoursPerYear&&e.MaxHoursPerYear>0)):[])),e=>{if(!e)return"";const a=new Date(e),l=a.getFullYear(),t=String(a.getMonth()+1).padStart(2,"0"),o=String(a.getDate()).padStart(2,"0");return`${l}å¹´${t}æœˆ${o}æ—¥`}),ge=e=>{if(!e||!e.currentYearDays||"-"===e.currentYearDays)return null;const a=(new Date).getFullYear()+1,l=`${a}-01-01`,t=`${a}-12-31`;return`${be(l)}ï½ž${be(t)}`},ye=e=>{if(!e||!e.sixMonthsToAnniversaryDays||"-"===e.sixMonthsToAnniversaryDays)return null;if(e.hireDate){const a=new Date(e.hireDate),l=a.getFullYear(),t=new Date(a);t.setMonth(t.getMonth()+6);const o=`${l}-12-31`,n=t.toISOString().split("T")[0];return`${be(n)}ï½ž${be(o)}`}return null},fe=async()=>{try{V.value=[{LeaveTypeCode:"SickLeave",LeaveTypeName:"ç—…å‡",MaxHoursPerYear:240},{LeaveTypeCode:"PersonalLeave",LeaveTypeName:"äº‹å‡",MaxHoursPerYear:112},{LeaveTypeCode:"MenstrualLeave",LeaveTypeName:"ç”Ÿç†å‡",MaxHoursPerYear:24},{LeaveTypeCode:"FamilyCareLeave",LeaveTypeName:"å®¶åº­ç…§é¡§å‡",MaxHoursPerYear:56},{LeaveTypeCode:"FuneralLeave",LeaveTypeName:"å–ªå‡",MaxHoursPerYear:64},{LeaveTypeCode:"MarriageLeave",LeaveTypeName:"å©šå‡",MaxHoursPerYear:64},{LeaveTypeCode:"MaternityLeave",LeaveTypeName:"ç”¢å‡",MaxHoursPerYear:448},{LeaveTypeCode:"PrenatalCheckupLeave",LeaveTypeName:"ç”¢æª¢å‡",MaxHoursPerYear:56},{LeaveTypeCode:"PaternityLeave",LeaveTypeName:"é™ªç”¢å‡",MaxHoursPerYear:56}]}catch(e){console.error("ç²å–å‡åˆ¥è¦å‰‡å¤±æ•—:",e),V.value=[]}},he=async()=>{try{I.value=[{LeaveType:"PersonalLeave",ApplyDate:"2025-08-25T00:00:00",LeaveTotalInUnitsOfHours:8},{LeaveType:"PersonalLeave",ApplyDate:"2025-08-25T00:00:00",LeaveTotalInUnitsOfHours:8},{LeaveType:"SickLeave",ApplyDate:"2025-08-25T00:00:00",LeaveTotalInUnitsOfHours:8}]}catch(e){console.error("ç²å–ç”¨æˆ¶è«‹å‡è¨˜éŒ„å¤±æ•—:",e),I.value=[]}},ke=async()=>{R.value=!0;try{await Promise.all([fe(),he()])}finally{R.value=!1}};return(0,u.sV)((()=>{X(b.value),le(),ke(),G(),Z()})),(e,a)=>{const l=(0,u.g2)("el-icon"),m=(0,u.g2)("el-button"),v=(0,u.g2)("el-progress"),h=(0,u.g2)("el-empty"),k=(0,u.g2)("el-alert"),_=(0,u.g2)("el-card"),w=(0,u.g2)("el-option"),D=(0,u.g2)("el-select"),R=(0,u.g2)("el-date-picker"),V=(0,u.g2)("el-form"),I=(0,u.g2)("el-link"),W=(0,u.g2)("el-tag"),S=(0,u.g2)("el-pagination"),Q=(0,u.g2)("el-config-provider"),G=(0,u.gN)("loading");return(0,u.uX)(),(0,u.Wv)(Q,{locale:(0,d.R1)(ht.A)},{default:(0,u.k6)((()=>[(0,u.Lk)("div",SI,[(0,u.bF)(_,{class:"box-card"},{header:(0,u.k6)((()=>[(0,u.Lk)("div",UI,[a[6]||(a[6]=(0,u.Lk)("span",null,"å€‹äººè«‹å‡è¨˜éŒ„",-1)),(0,u.bF)(m,{type:"primary",onClick:N,loading:o.value,size:"small"},{default:(0,u.k6)((()=>[(0,u.bF)(l,null,{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.Refresh))])),_:1}),a[5]||(a[5]=(0,u.eW)(" é‡æ–°æ•´ç† "))])),_:1},8,["loading"])])])),default:(0,u.k6)((()=>[(0,u.Lk)("div",$I,[(0,u.bF)(_,{class:"annual-leave-card"},{header:(0,u.k6)((()=>[(0,u.Lk)("div",NI,[(0,u.Lk)("span",null,(0,L.v_)(f.value)+" å¹´åº¦ç‰¹ä¼‘æ™‚æ•¸çµ±è¨ˆ (æ­·å¹´åˆ¶)",1),(0,u.bF)(m,{type:"primary",onClick:te,loading:g.value,size:"small"},{default:(0,u.k6)((()=>[(0,u.bF)(l,null,{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.Refresh))])),_:1}),a[7]||(a[7]=(0,u.eW)(" é‡æ–°è¨ˆç®— "))])),_:1},8,["loading"])])])),default:(0,u.k6)((()=>[(0,u.bo)(((0,u.uX)(),(0,u.CE)("div",XI,[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(y.value,(e=>((0,u.uX)(),(0,u.CE)("div",{key:e.year,class:"desktop-annual-leave-card"},[(0,u.Lk)("div",KI,[(0,u.Lk)("div",MI,[(0,u.Lk)("h3",PI,(0,L.v_)(e.year)+" å¹´åº¦ç‰¹ä¼‘çµ±è¨ˆ",1),(0,u.Lk)("p",OI,"åˆ°è·æ—¥ï¼š"+(0,L.v_)(B(e.hireDate)||"-"),1)]),(0,u.Lk)("div",zI,[(0,u.Lk)("div",BI,[a[8]||(a[8]=(0,u.Lk)("span",{class:"rate-label"},"ä½¿ç”¨çŽ‡",-1)),(0,u.bF)(v,{percentage:e.usageRate,color:ue(e.usageRate),"stroke-width":12,width:80,type:"circle"},null,8,["percentage","color"])])])]),(0,u.Lk)("div",jI,[(0,u.Lk)("div",YI,[(0,u.Lk)("div",QI,[a[10]||(a[10]=(0,u.Lk)("h4",{class:"section-title"},"ç‰¹ä¼‘å¤©æ•¸æ˜Žç´°",-1)),(0,u.bF)(m,{type:"primary",onClick:te,loading:g.value,size:"small",class:"refresh-btn"},{default:(0,u.k6)((()=>[(0,u.bF)(l,null,{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.Refresh))])),_:1}),a[9]||(a[9]=(0,u.eW)(" é‡æ–°å–å¾— "))])),_:1},8,["loading"])]),(0,u.Lk)("div",HI,[de(e)?((0,u.uX)(),(0,u.CE)("div",qI,[a[11]||(a[11]=(0,u.Lk)("div",{class:"day-label"},"çµ¦å‡æ—¥æœŸç•¶å¹´åº¦ä¹‹ç‰¹ä¼‘æ—¥æ•¸",-1)),(0,u.Lk)("div",JI,(0,L.v_)(e.currentYearDays||"-")+" å¤©",1),(0,u.Q3)("",!0)])):(0,u.Q3)("",!0),ce(e)?((0,u.uX)(),(0,u.CE)("div",GI,[a[12]||(a[12]=(0,u.Lk)("div",{class:"day-label"},"å…­å€‹æœˆä»¥ä¸Šè‡³ç´„å®šçµ¦å‡æ—¥æœŸä¹‹ç‰¹ä¼‘æ—¥æ•¸",-1)),(0,u.Lk)("div",ZI,(0,L.v_)(me(e))+" å¤©",1),(0,u.Q3)("",!0)])):(0,u.Q3)("",!0),(0,u.Lk)("div",ex,[a[13]||(a[13]=(0,u.Lk)("div",{class:"day-label"},"å…¨å¹´ç‰¹ä¼‘æ™‚æ•¸",-1)),(0,u.Lk)("div",ax,(0,L.v_)(e.totalHours)+" å°æ™‚",1)])])]),(0,u.Lk)("div",lx,[a[22]||(a[22]=(0,u.Lk)("h4",{class:"section-title"},"ä½¿ç”¨ç‹€æ³",-1)),(0,u.Lk)("div",tx,[(0,u.Lk)("div",ox,[a[15]||(a[15]=(0,u.Lk)("div",{class:"usage-icon"},"ðŸ“…",-1)),(0,u.Lk)("div",nx,[a[14]||(a[14]=(0,u.Lk)("div",{class:"usage-label"},"å·²ä¼‘å¤©æ•¸",-1)),(0,u.Lk)("div",rx,(0,L.v_)(e.usedDays)+" å¤©",1)])]),(0,u.Lk)("div",sx,[a[17]||(a[17]=(0,u.Lk)("div",{class:"usage-icon"},"â°",-1)),(0,u.Lk)("div",ux,[a[16]||(a[16]=(0,u.Lk)("div",{class:"usage-label"},"å·²ä¼‘æ™‚æ•¸",-1)),(0,u.Lk)("div",ix,(0,L.v_)(e.usedHours)+" å°æ™‚",1)])]),(0,u.Lk)("div",dx,[a[19]||(a[19]=(0,u.Lk)("div",{class:"usage-icon"},"ðŸ–ï¸",-1)),(0,u.Lk)("div",cx,[a[18]||(a[18]=(0,u.Lk)("div",{class:"usage-label"},"å‰©é¤˜å¤©æ•¸",-1)),(0,u.Lk)("div",{class:(0,L.C4)(["usage-value",se(e.remainingDays)])},(0,L.v_)(e.remainingDays)+" å¤©",3)])]),(0,u.Lk)("div",px,[a[21]||(a[21]=(0,u.Lk)("div",{class:"usage-icon"},"â³",-1)),(0,u.Lk)("div",mx,[a[20]||(a[20]=(0,u.Lk)("div",{class:"usage-label"},"å‰©é¤˜æ™‚æ•¸",-1)),(0,u.Lk)("div",{class:(0,L.C4)(["usage-value",re(e.remainingHours)])},(0,L.v_)(e.remainingHours)+" å°æ™‚",3)])])])])])])))),128)),0===y.value.length?((0,u.uX)(),(0,u.CE)("div",vx,[(0,u.bF)(h,{description:"æŸ¥ç„¡ç‰¹ä¼‘è³‡æ–™"})])):(0,u.Q3)("",!0)])),[[G,g.value]]),(0,u.bo)(((0,u.uX)(),(0,u.CE)("div",bx,[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(y.value,(e=>((0,u.uX)(),(0,u.CE)("div",{key:e.year,class:"annual-leave-mobile-card"},[(0,u.Lk)("div",gx,[(0,u.Lk)("span",yx,(0,L.v_)(e.year)+" å¹´åº¦",1),(0,u.Lk)("span",fx,"åˆ°è·æ—¥ï¼š"+(0,L.v_)(B(e.hireDate)||"-"),1)]),(0,u.Lk)("div",hx,[de(e)?((0,u.uX)(),(0,u.CE)("div",kx,[a[23]||(a[23]=(0,u.Lk)("span",{class:"mobile-label"},"çµ¦å‡æ—¥æœŸç•¶å¹´åº¦ä¹‹ç‰¹ä¼‘æ—¥æ•¸",-1)),(0,u.Lk)("div",_x,[(0,u.Lk)("span",wx,(0,L.v_)(e.currentYearDays||"-")+" å¤©",1),ge(e)?((0,u.uX)(),(0,u.CE)("div",Fx," è«‹ä¼‘æœŸé–“: "+(0,L.v_)(ge(e)),1)):(0,u.Q3)("",!0)])])):(0,u.Q3)("",!0),ce(e)?((0,u.uX)(),(0,u.CE)("div",Cx,[a[24]||(a[24]=(0,u.Lk)("span",{class:"mobile-label"},"å…­å€‹æœˆä»¥ä¸Šè‡³ç´„å®šçµ¦å‡æ—¥æœŸä¹‹ç‰¹ä¼‘æ—¥æ•¸",-1)),(0,u.Lk)("div",Dx,[(0,u.Lk)("span",Lx,(0,L.v_)(me(e))+" å¤©",1),ye(e)?((0,u.uX)(),(0,u.CE)("div",Rx," è«‹ä¼‘æœŸé–“: "+(0,L.v_)(ye(e)),1)):(0,u.Q3)("",!0)])])):(0,u.Q3)("",!0),(0,u.Lk)("div",Vx,[a[25]||(a[25]=(0,u.Lk)("span",{class:"mobile-label"},"å…¨å¹´ç‰¹ä¼‘æ™‚æ•¸",-1)),(0,u.Lk)("span",Ix,(0,L.v_)(e.totalHours)+" å°æ™‚",1)]),(0,u.Lk)("div",xx,[a[26]||(a[26]=(0,u.Lk)("span",{class:"mobile-label"},"å·²ä¼‘ç‰¹ä¼‘å¤©æ•¸",-1)),(0,u.Lk)("span",Ex,(0,L.v_)(e.usedDays)+" å¤©",1)]),(0,u.Lk)("div",Ax,[a[27]||(a[27]=(0,u.Lk)("span",{class:"mobile-label"},"å·²ä¼‘ç‰¹ä¼‘æ™‚æ•¸",-1)),(0,u.Lk)("span",Tx,(0,L.v_)(e.usedHours)+" å°æ™‚",1)]),(0,u.Lk)("div",Wx,[a[28]||(a[28]=(0,u.Lk)("span",{class:"mobile-label"},"å‰©é¤˜ç‰¹ä¼‘å¤©æ•¸",-1)),(0,u.Lk)("span",{class:(0,L.C4)(["mobile-value",se(e.remainingDays)])},(0,L.v_)(e.remainingDays)+" å¤©",3)]),(0,u.Lk)("div",Sx,[a[29]||(a[29]=(0,u.Lk)("span",{class:"mobile-label"},"å‰©é¤˜ç‰¹ä¼‘æ™‚æ•¸",-1)),(0,u.Lk)("span",{class:(0,L.C4)(["mobile-value",re(e.remainingHours)])},(0,L.v_)(e.remainingHours)+" å°æ™‚",3)]),(0,u.Lk)("div",Ux,[a[30]||(a[30]=(0,u.Lk)("span",{class:"mobile-label"},"ä½¿ç”¨çŽ‡",-1)),(0,u.Lk)("div",$x,[(0,u.bF)(v,{percentage:e.usageRate,color:ue(e.usageRate),"stroke-width":6},null,8,["percentage","color"])])])])])))),128))])),[[G,g.value]]),y.value.length>0?((0,u.uX)(),(0,u.CE)("div",Nx,[ve().type?((0,u.uX)(),(0,u.Wv)(k,{key:0,title:ve().title,description:ve().description,type:ve().type,closable:!1,"show-icon":""},null,8,["title","description","type"])):(0,u.Q3)("",!0)])):(0,u.Q3)("",!0)])),_:1})]),(0,u.Q3)("",!0),(0,u.Q3)("",!0),(0,u.Lk)("div",Xx,[(0,u.bF)(_,{class:"monthly-leave-summary-card"},{header:(0,u.k6)((()=>[(0,u.Lk)("div",Kx,[(0,u.Lk)("span",null,(0,L.v_)(ae(b.value))+" æœˆä»½å‡åˆ¥ç´¯è¨ˆæ™‚æ•¸çµ±è¨ˆ",1),(0,u.Lk)("div",Mx,[(0,u.bF)(m,{type:"primary",onClick:ee,loading:C.value,size:"small"},{default:(0,u.k6)((()=>[(0,u.bF)(l,null,{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.Refresh))])),_:1}),a[34]||(a[34]=(0,u.eW)(" é‡æ–°è¨ˆç®— "))])),_:1},8,["loading"])])])])),default:(0,u.k6)((()=>[Object.keys(F.value).length>0?(0,u.bo)(((0,u.uX)(),(0,u.CE)("div",Px,[((0,u.uX)(),(0,u.CE)(u.FK,null,(0,u.pI)(T,((e,l)=>(0,u.Lk)("div",{key:l,class:"monthly-summary-card-item"},[a[35]||(a[35]=(0,u.Lk)("div",{class:"monthly-summary-icon"},"ðŸ“…",-1)),(0,u.Lk)("div",Ox,[(0,u.Lk)("div",zx,(0,L.v_)(e),1),(0,u.Lk)("div",Bx,(0,L.v_)((F.value[l]||0).toFixed(1))+" å°æ™‚",1)])]))),64))])),[[G,C.value]]):C.value?(0,u.Q3)("",!0):((0,u.uX)(),(0,u.CE)("div",jx,[(0,u.bF)(h,{description:"æŸ¥ç„¡æœˆä»½å‡åˆ¥çµ±è¨ˆè³‡æ–™"})])),(0,u.bo)(((0,u.uX)(),(0,u.CE)("div",Yx,[((0,u.uX)(),(0,u.CE)(u.FK,null,(0,u.pI)(T,((e,a)=>(0,u.Lk)("div",{key:a,class:"leave-type-card"},[(0,u.Lk)("div",Qx,(0,L.v_)(e),1),(0,u.Lk)("div",Hx,(0,L.v_)((F.value[a]||0).toFixed(1))+" å°æ™‚",1)]))),64))])),[[G,C.value]])])),_:1})]),(0,u.Lk)("div",qx,[(0,u.bF)(V,{model:A,class:"filter-form"},{default:(0,u.k6)((()=>[(0,u.Lk)("div",Jx,[(0,u.Lk)("div",Gx,[a[36]||(a[36]=(0,u.Lk)("label",{class:"filter-label"},"æŸ¥è©¢æœˆä»½",-1)),(0,u.bF)(R,{modelValue:b.value,"onUpdate:modelValue":a[1]||(a[1]=e=>b.value=e),type:"month",placeholder:"è«‹é¸æ“‡æœˆä»½",format:"YYYYå¹´MMæœˆ","value-format":"YYYY-MM",onChange:X,size:"large",class:"date-picker"},null,8,["modelValue"])]),(0,u.Lk)("div",Zx,[a[37]||(a[37]=(0,u.Lk)("label",{class:"filter-label"},"å‡åˆ¥",-1)),(0,u.bF)(D,{modelValue:A.leaveType,"onUpdate:modelValue":a[2]||(a[2]=e=>A.leaveType=e),placeholder:"è«‹é¸æ“‡å‡åˆ¥",onChange:K,size:"default",class:"leave-type-select"},{default:(0,u.k6)((()=>[(0,u.bF)(w,{label:"å…¨éƒ¨",value:""}),(0,u.bF)(w,{label:"ç‰¹ä¼‘",value:"AnnualLeave"}),(0,u.bF)(w,{label:"ç—…å‡",value:"SickLeave"}),(0,u.bF)(w,{label:"äº‹å‡",value:"PersonalLeave"}),(0,u.bF)(w,{label:"ç”Ÿç†å‡",value:"MenstrualLeave"}),(0,u.bF)(w,{label:"å…¬å‡",value:"OfficialLeave"}),(0,u.bF)(w,{label:"å·¥å‚·å‡",value:"WorkInjuryLeave"}),(0,u.bF)(w,{label:"å®¶åº­ç…§é¡§å‡",value:"FamilyCareLeave"}),(0,u.bF)(w,{label:"å©šå‡",value:"MarriageLeave"}),(0,u.bF)(w,{label:"ç”¢å‡",value:"MaternityLeave"}),(0,u.bF)(w,{label:"ç”¢æª¢å‡",value:"PrenatalCheckupLeave"}),(0,u.bF)(w,{label:"é™ªç”¢å‡",value:"PaternityLeave"}),(0,u.bF)(w,{label:"å–ªå‡",value:"FuneralLeave"}),(0,u.bF)(w,{label:"è¬€è·å‡",value:"JobSeekingLeave"})])),_:1},8,["modelValue"])]),(0,u.Lk)("div",eE,[(0,u.bF)(m,{type:"primary",onClick:$,loading:o.value,size:"default",class:"query-button"},{default:(0,u.k6)((()=>a[38]||(a[38]=[(0,u.eW)(" æŸ¥è©¢ ")]))),_:1},8,["loading"])])])])),_:1},8,["model"])]),(0,u.bF)(_,{class:"leave-records-card"},{header:(0,u.k6)((()=>[(0,u.Lk)("div",aE,[a[40]||(a[40]=(0,u.Lk)("span",null,"è«‹å‡è¨˜éŒ„",-1)),n.value.length>0?((0,u.uX)(),(0,u.Wv)(m,{key:0,type:"success",onClick:U,loading:c.value,size:"small"},{default:(0,u.k6)((()=>[(0,u.bF)(l,null,{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.Camera))])),_:1}),a[39]||(a[39]=(0,u.eW)(" åŒ¯å‡ºæˆªåœ– "))])),_:1},8,["loading"])):(0,u.Q3)("",!0)])])),default:(0,u.k6)((()=>[(0,u.bo)(((0,u.uX)(),(0,u.CE)("div",{ref_key:"leaveRecordsRef",ref:p,class:"desktop-leave-records-list"},[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(n.value,(e=>((0,u.uX)(),(0,u.CE)("div",{key:e.leaveRequestID,class:"desktop-leave-record-row",onClick:(0,t.D$)((a=>oe(e.leaveRequestID)),["stop"]),title:"é»žæ“Šä»¥æŸ¥çœ‹å–®æ“šè©³æƒ…"},[(0,u.Lk)("div",tE,[(0,u.Lk)("div",oE,[(0,u.Lk)("div",nE,[(0,u.bF)(I,{class:"request-id-value request-id-link",type:"primary",underline:!1},{default:(0,u.k6)((()=>[(0,u.eW)((0,L.v_)(e.leaveRequestID),1)])),_:2},1024)]),(0,u.Lk)("div",rE,[(0,u.bF)(W,{type:z(e.leaveType),size:"default"},{default:(0,u.k6)((()=>[(0,u.eW)((0,L.v_)(O(e.leaveType)),1)])),_:2},1032,["type"])]),(0,u.Lk)("div",sE,[(0,u.Lk)("span",uE,(0,L.v_)(B(e.leaveStartDate))+" "+(0,L.v_)(j(e.leaveStartTime))+" è‡³ "+(0,L.v_)(B(e.leaveEndDate))+" "+(0,L.v_)(j(e.leaveEndTime)),1)]),(0,u.Lk)("div",iE,[(0,u.Lk)("span",dE,(0,L.v_)(Y(e.leaveTotalInUnitsOfHours,e.leaveTotalInUnitsOfMinutes)),1)]),(0,u.Lk)("div",cE,[(0,u.Lk)("span",pE,(0,L.v_)(B(e.applyDate)),1)]),e.agentEmployeeName?((0,u.uX)(),(0,u.CE)("div",mE,[a[41]||(a[41]=(0,u.Lk)("span",{class:"agent-label"},"è·å‹™ä»£ç†äººï¼š",-1)),(0,u.Lk)("span",vE,(0,L.v_)(e.agentEmployeeName),1)])):(0,u.Q3)("",!0),e.supervisorName?((0,u.uX)(),(0,u.CE)("div",bE,[a[42]||(a[42]=(0,u.Lk)("span",{class:"supervisor-label"},"å–®ä½ä¸»ç®¡ï¼š",-1)),(0,u.Lk)("span",gE,(0,L.v_)(e.supervisorName),1)])):(0,u.Q3)("",!0),e.reason?((0,u.uX)(),(0,u.CE)("div",yE,[a[43]||(a[43]=(0,u.Lk)("span",{class:"reason-label"},"è«‹å‡äº‹ç”±ï¼š",-1)),(0,u.Lk)("span",fE,(0,L.v_)(e.reason),1)])):(0,u.Q3)("",!0)])])],8,lE)))),128)),0===n.value.length?((0,u.uX)(),(0,u.CE)("div",hE,[(0,u.bF)(h,{description:"æŸ¥ç„¡è«‹å‡è¨˜éŒ„"})])):(0,u.Q3)("",!0)])),[[G,o.value]]),(0,u.bo)(((0,u.uX)(),(0,u.CE)("div",kE,[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(n.value,(e=>((0,u.uX)(),(0,u.CE)("div",{key:e.leaveRequestID,class:"leave-record-mobile-card"},[(0,u.Lk)("div",_E,[(0,u.bF)(I,{class:"request-id-badge request-id-link-mobile",type:"primary",underline:!1,onClick:a=>oe(e.leaveRequestID)},{default:(0,u.k6)((()=>[(0,u.eW)((0,L.v_)(e.leaveRequestID),1)])),_:2},1032,["onClick"]),(0,u.bF)(W,{type:z(e.leaveType),size:"small"},{default:(0,u.k6)((()=>[(0,u.eW)((0,L.v_)(O(e.leaveType)),1)])),_:2},1032,["type"])]),(0,u.Lk)("div",wE,[(0,u.Lk)("div",FE,[a[44]||(a[44]=(0,u.Lk)("span",{class:"mobile-label"},"è«‹å‡èµ·è¿„æ—¥æœŸ",-1)),(0,u.Lk)("div",CE,[(0,u.Lk)("div",null,(0,L.v_)(B(e.leaveStartDate))+" "+(0,L.v_)(j(e.leaveStartTime)),1),(0,u.Lk)("div",DE,"è‡³ "+(0,L.v_)(B(e.leaveEndDate))+" "+(0,L.v_)(j(e.leaveEndTime)),1)])]),(0,u.Lk)("div",LE,[a[45]||(a[45]=(0,u.Lk)("span",{class:"mobile-label"},"è«‹å‡æ™‚æ•¸",-1)),(0,u.Lk)("span",RE,(0,L.v_)(Y(e.leaveTotalInUnitsOfHours,e.leaveTotalInUnitsOfMinutes)),1)]),(0,u.Lk)("div",VE,[(0,u.Lk)("span",IE,(0,L.v_)(q()),1),(0,u.Lk)("div",xE,[(0,u.Lk)("span",EE,(0,L.v_)(e.monthlyAccumulatedHours||0),1),a[46]||(a[46]=(0,u.Lk)("span",{class:"hours-unit"},"å°æ™‚",-1)),(0,u.Lk)("span",AE,(0,L.v_)(H()),1)])]),e.agentEmployeeName?((0,u.uX)(),(0,u.CE)("div",TE,[a[47]||(a[47]=(0,u.Lk)("span",{class:"mobile-label"},"è·å‹™ä»£ç†äºº",-1)),(0,u.Lk)("span",WE,(0,L.v_)(e.agentEmployeeName),1)])):(0,u.Q3)("",!0),e.supervisorName?((0,u.uX)(),(0,u.CE)("div",SE,[a[48]||(a[48]=(0,u.Lk)("span",{class:"mobile-label"},"å–®ä½ä¸»ç®¡",-1)),(0,u.Lk)("span",UE,(0,L.v_)(e.supervisorName),1)])):(0,u.Q3)("",!0),e.reason?((0,u.uX)(),(0,u.CE)("div",$E,[a[49]||(a[49]=(0,u.Lk)("span",{class:"mobile-label"},"è«‹å‡äº‹ç”±",-1)),(0,u.Lk)("span",NE,(0,L.v_)(e.reason),1)])):(0,u.Q3)("",!0),(0,u.Lk)("div",XE,[a[50]||(a[50]=(0,u.Lk)("span",{class:"mobile-label"},"ç”³è«‹æ—¥æœŸ",-1)),(0,u.Lk)("span",KE,(0,L.v_)(B(e.applyDate)),1)])])])))),128))])),[[G,o.value]])])),_:1}),r.value>0?((0,u.uX)(),(0,u.CE)("div",ME,[(0,u.bF)(S,{"current-page":s.value,"onUpdate:currentPage":a[3]||(a[3]=e=>s.value=e),"page-size":i.value,"onUpdate:pageSize":a[4]||(a[4]=e=>i.value=e),"page-sizes":[10,20,50,100],total:r.value,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:M,onCurrentChange:P},null,8,["current-page","page-size","total"])])):(0,u.Q3)("",!0),(0,u.bF)(en,{visible:x.value,doc:E.value,onClose:ne,"lock-scroll":!0,"append-to-body":!0,center:!0,class:"centered-dialog"},null,8,["visible","doc"])])),_:1})])])),_:1},8,["locale"])}}};const OE=(0,ie.A)(PE,[["__scopeId","data-v-fcf474ba"]]);var zE=OE;const BE={class:"attendance-container mt-5"},jE={class:"content-wrapper"},YE={class:"left-panel"},QE={class:"card-header"},HE={class:"attendance-content"},qE={class:"right-panel"},JE={class:"card-header"},GE={class:"leave-content"};var ZE={__name:"PersonalAttendanceRecord",setup(e){const a=(0,S.k)();return(e,l)=>{const t=(0,u.g2)("el-icon"),o=(0,u.g2)("el-card");return(0,u.uX)(),(0,u.CE)("div",BE,[(0,u.Lk)("div",jE,[(0,u.Lk)("div",YE,[(0,u.bF)(o,{class:"panel-card attendance-card"},{header:(0,u.k6)((()=>[(0,u.Lk)("div",QE,[(0,u.bF)(t,{class:"header-icon"},{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.Calendar))])),_:1}),l[0]||(l[0]=(0,u.Lk)("span",null,"å‡ºå‹¤è¨˜éŒ„",-1))])])),default:(0,u.k6)((()=>[(0,u.Lk)("div",HE,[(0,u.bF)($n,{selectedUser:(0,d.R1)(a),personalMode:!0},null,8,["selectedUser"])])])),_:1})]),(0,u.Lk)("div",qE,[(0,u.bF)(o,{class:"panel-card leave-card"},{header:(0,u.k6)((()=>[(0,u.Lk)("div",JE,[(0,u.bF)(t,{class:"header-icon"},{default:(0,u.k6)((()=>[(0,u.bF)((0,d.R1)(J.DocumentCopy))])),_:1}),l[1]||(l[1]=(0,u.Lk)("span",null,"è«‹å‡è¨˜éŒ„",-1))])])),default:(0,u.k6)((()=>[(0,u.Lk)("div",GE,[(0,u.bF)(zE)])])),_:1})])])])}}};const eA=(0,ie.A)(ZE,[["__scopeId","data-v-a8cb05f0"]]);var aA=eA;const lA={class:"daily-attendance-record mt-5",style:{"margin-left":"5rem"}},tA={class:"header-section"};var oA={__name:"DailyAttendanceRecord",setup(e){const a=(0,d.KR)(""),l=(0,d.KR)([]),t=(0,d.KR)(!1),o=(0,d.KR)({employeeId:"",employeeName:"",date:""}),n=(0,u.EW)((()=>{let e=l.value;return o.value.employeeId&&(e=e.filter((e=>e["å·¥è™Ÿ"]&&e["å·¥è™Ÿ"].includes(o.value.employeeId)))),o.value.employeeName&&(e=e.filter((e=>e["å§“å"]&&e["å§“å"].includes(o.value.employeeName)))),o.value.date&&(e=e.filter((e=>e["æ—¥æœŸ"]&&e["æ—¥æœŸ"].includes(o.value.date)))),e})),r=()=>{const e=new Date,l=e.getFullYear(),t=String(e.getMonth()+1).padStart(2,"0"),o=String(e.getDate()).padStart(2,"0");a.value=`${l}-${t}-${o}`},s=async()=>{t.value=!0;try{const e=a.value?new Date(a.value).toISOString().slice(0,10):"",{data:t}=await Wa.getAllAttendanceRecords(e);l.value=t}catch(e){console.error("å–å¾—è€ƒå‹¤è³‡æ–™å¤±æ•—:",e)}finally{t.value=!1}},i=e=>{const a=e.getFullYear(),l=String(e.getMonth()+1).padStart(2,"0"),t=String(e.getDate()).padStart(2,"0");return`${a}-${l}-${t}`},c=()=>{if(a.value){const e=new Date(a.value);e.setDate(e.getDate()-1),a.value=i(e),s()}},p=()=>{if(a.value){const e=new Date(a.value);e.setDate(e.getDate()+1),a.value=i(e),s()}};return(0,u.sV)((()=>{r(),s()})),(e,l)=>{const o=(0,u.g2)("el-button"),r=(0,u.g2)("el-date-picker"),i=(0,u.g2)("el-table-column"),m=(0,u.g2)("el-table"),v=(0,u.g2)("el-config-provider"),b=(0,u.gN)("loading");return(0,u.uX)(),(0,u.Wv)(v,{locale:(0,d.R1)(ht.A)},{default:(0,u.k6)((()=>[(0,u.Lk)("div",lA,[(0,u.Lk)("div",tA,[(0,u.bF)(o,{icon:(0,d.R1)(J.ArrowLeft),circle:"",onClick:c,disabled:!a.value},null,8,["icon","disabled"]),(0,u.bF)(r,{modelValue:a.value,"onUpdate:modelValue":l[0]||(l[0]=e=>a.value=e),type:"date",placeholder:"é¸æ“‡æ—¥æœŸ","value-format":"YYYY-MM-DD",onChange:s,style:{"font-size":"2rem",width:"16rem"}},null,8,["modelValue"]),(0,u.bF)(o,{icon:(0,d.R1)(J.ArrowRight),circle:"",onClick:p,disabled:!a.value},null,8,["icon","disabled"])]),(0,u.bo)(((0,u.uX)(),(0,u.Wv)(m,{data:n.value,style:{width:"18.5rem"},border:""},{default:(0,u.k6)((()=>[(0,u.Q3)("",!0),(0,u.bF)(i,{prop:"å§“å",label:"å§“å",width:"100",height:"40"}),(0,u.Q3)("",!0),(0,u.bF)(i,{prop:"ä¸Šç­",label:"ä¸Šç­",width:"100"}),(0,u.bF)(i,{prop:"ä¸‹ç­",label:"ä¸‹ç­",width:"100"})])),_:1},8,["data"])),[[b,t.value]])])])),_:1},8,["locale"])}}};const nA=(0,ie.A)(oA,[["__scopeId","data-v-94d8beee"]]);var rA=nA;const sA={class:"layout"};var uA={__name:"Layout_LeaveRequestForm",setup(e){return(e,a)=>((0,u.uX)(),(0,u.CE)("div",sA,[(0,u.bF)(Mt,{layout:!0})]))}};const iA=(0,ie.A)(uA,[["__scopeId","data-v-4a380a06"]]);var dA=iA;const cA=[{path:"/login",name:"Login",component:om},{path:"/board",name:"Board",component:Su,meta:{boardPermission:!0}},{path:"/home",name:"Home",component:ns,children:[{path:"/EventsAndStatistics",name:"EventsAndStatistics",children:[{path:"/MacForm",name:"MacForm",component:Kr},{path:"/ComputerInventory",name:"ComputerInventory",component:fp,meta:{noAuth:!0}}]},{path:"/Finance",name:"Finance",children:[{path:"/SalarySlip",name:"SalarySlip",component:Lb,meta:{accountPermission:!0}},{path:"/PersonalAttendanceRecord",name:"PersonalAttendanceRecord",component:aA,meta:{noAuth:!1}},{path:"/DailyAttendanceRecord",name:"DailyAttendanceRecord",component:rA,meta:{accountPermission:!0}},{path:"/PersonalInformation",name:"PersonalInformation",component:qs,meta:{noAuth:!1}},{path:"/SalaryStructure",name:"SalaryStructure",component:ug,meta:{accountPermission:!0}},{path:"/MealAllowanceSummary",name:"MealAllowanceSummary",component:_g,meta:{accountPermission:!0}},{path:"/AnnualLeaveSummary",name:"AnnualLeaveSummary",component:Og,meta:{accountPermission:!0}},{path:"/OvertimePageInfo",name:"OvertimePageInfo",component:ny,meta:{accountPermission:!0}},{path:"/LeavePageInfo",name:"LeavePageInfo",component:_y,meta:{accountPermission:!0}}]},{path:"/CustomerCastegory",name:"CustomerCastegory",children:[{path:"/CustomerInfo",name:"CustomerInfo",component:iR,meta:{salesPermission:!0}},{path:"/CustomerTracking",name:"CustomerTracking",component:KR,meta:{salesPermission:!0}}]},{path:"/SalesCategory",name:"SalesCategory",children:[{path:"/SalesQuery",name:"SalesQuery",component:ZR,meta:{salesPermission:!0}}]},{path:"/CaseCastegory",name:"CaseCastegory",children:[{path:"/CaseTracking",name:"CaseTracking",component:WI,meta:{sales_manufaction_research_Manager_Permission:!0}}]},{path:"/PerformanceManagement",name:"PerformanceManagement",children:[{path:"/PerformanceReport",name:"PerformanceReport",component:cD,meta:{RO0006Permission:!0}},{path:"/PersonalGoals",name:"PersonalGoals",component:AD,meta:{salesPermission:!1}},{path:"/PerformanceDashboard",name:"PerformanceDashboard",component:DL,meta:{DAE_Hight_Level_Team_Permission:!0}}]},{path:"/ColdCallingManagement",name:"ColdCallingManagement",children:[{path:"/CustomerReport",name:"CustomerReport",component:SV,meta:{salesPermission:!0}},{path:"/ColdCallingReport",name:"ColdCallingReport",component:oV,meta:{salesPermission:!0}}]},{path:"/Workflow",name:"Workflow",children:[{path:"/CorrectionForm",name:"CorrectionForm",component:vt},{path:"/LeaveRequestForm",name:"LeaveRequestForm",component:dA},{path:"/AttendanceRecord",name:"AttendanceRecord",component:$n,meta:{isDev:!0}},{path:"/OvertimeRequestForm",name:"OvertimeRequestForm",component:Eo},{path:"/LeaveCancellationForm",name:"LeaveCancellationForm",component:Ko},{path:"/List_WF_Personal",name:"List_WF_Personal",component:e_}]},{path:"/Administration",name:"Administration",meta:{isDev:!0},children:[{path:"/Dpt_System",name:"Dpt_System",component:Hp,meta:{isDev:!0}}]},{path:"/DAEHistory",name:"DAEHistory",component:lu},{path:"/PrimeChart",name:"PrimeChart",component:Wi,meta:{isDev:!0}},{path:"/orgChart",name:"orgChart",component:Su},{path:"/editDptFuncList_Form",name:"editDptFuncList_Form",component:Ni,meta:{isDev:!0}},{path:"/userManagement",name:"userManagement",component:Iu,meta:{isDev:!0}},{path:"/securityMail",name:"SecurityMail",component:lc,meta:{isDev:!0}},{path:"/bulletin",name:"BulletinBoard",component:rc,meta:{isDev:!0}},{path:"/login_delay",name:"login_delay",component:cc,meta:{isDev:!0}},{path:"/employeeRegistration",name:"employeeRegistration",component:Fu,meta:{isDev:!0}},{path:"/editDptFuncList",name:"editDptFuncList",component:Vc,meta:{isDev:!0}},{path:"/SystemManagement",name:"SystemManagement",children:[{path:"/sys_MacForm",name:"sys_MacForm",component:Cy,meta:{misPermission:!0}},{path:"/sys_ComputerInventory",name:"sys_ComputerInventory",component:Ry,meta:{misPermission:!0}},{path:"/sys_DAE_Data_Management",name:"sys_DAE_Data_Management",component:Lk,meta:{misPermission:!0}},{path:"/sys_WF_Management",name:"sys_WF_Management",component:t_,meta:{misPermission:!0}},{path:"/FormTemplateManagement",name:"FormTemplateManagement",component:Mw,meta:{misPermission:!0}},{path:"/FormDesigner",name:"FormDesigner",component:IF,meta:{misPermission:!0}},{path:"/FormDesigner/:id",name:"FormDesignerEdit",component:IF,meta:{misPermission:!0}},{path:"/DeviceHostManagement",name:"DeviceHostManagement",component:NC,meta:{requiresAuth:!0,permissions:["IT"]}}]}]},{path:"/form/fill/:id",name:"FormFill",component:()=>Promise.resolve().then(l.bind(l,29043)),meta:{requiresAuth:!0}},{path:"/",redirect:"/home"}],pA=(0,C.aE)({history:(0,C.Bt)("/"),routes:cA});pA.beforeEach(((e,a,l)=>{if(e.meta.isDev){const e=(0,i.n)(),a=e.user.permissions||[];if(!a.includes("dev"))return D.nk.warning("è©²é é¢å°šæœªé–‹ç™¼ï¼Œæš«æ™‚ç„¡æ³•è¨ªå•"),void l(!1);l()}else l()})),pA.beforeEach(((e,a,l)=>{const t=(0,i.n)(),o=m().get("userId");if(e.meta.accountPermission){const e=t.user.permissions||[];if(!e.includes("æœƒè¨ˆå°ˆç”¨æ¬Šé™")&&!e.includes("dev"))return D.nk.info("ç„¡é€²å…¥æ¬Šé™!"),void l(!1)}if(e.meta.DAE_Hight_Level_Team_Permission){const e=t.user.permissions||[];if(console.log(e),!e.includes("DAE_Hight_Level_Team_Permission")&&!e.includes("dev"))return D.nk.info("ç„¡é€²å…¥æ¬Šé™!"),void l(!1)}if(e.meta.salesPermission){const e=t.user.permissions||[];if(console.log("permissions:",e),!e.includes("æ¥­å‹™å°ˆç”¨æ¬Šé™")&&!e.includes("æ¥­å‹™å”ç†å°ˆç”¨æ¬Šé™")&&!e.includes("åœ‹å¤–æ¥­å‹™å°ˆç”¨æ¬Šé™")&&!e.includes("dev"))return D.nk.info("ç„¡é€²å…¥æ¬Šé™!"),void l(!1)}if(e.meta.RO0006Permission){const e=t.user.permissions||[];if(!e.includes("æ¥­å‹™å”ç†å°ˆç”¨æ¬Šé™")&&!e.includes("dev"))return D.nk.info("ç„¡é€²å…¥æ¬Šé™!"),void l(!1)}if(e.meta.sales_manufaction_research_Manager_Permission){const e=t.user.permissions||[];if(!e.includes("æ¥­å‹™å°ˆç”¨æ¬Šé™")&&!e.includes("dev")&&!e.includes("è£½é€ ç¶“ç†å°ˆç”¨æ¬Šé™")&&!e.includes("ç ”ç™¼ç¶“ç†å°ˆç”¨æ¬Šé™"))return D.nk.info("ç„¡é€²å…¥æ¬Šé™!"),void l(!1)}if(e.meta.boardPermission){const e=t.user.roles||[];if(!e.includes("RO9999"))return D.nk.info("ç„¡é€²å…¥æ¬Šé™!"),void l(!1)}if(e.meta.misPermission){const e=t.user.permissions||[];if(!e.includes("sys")&&!e.includes("sys_North"))return D.nk.info("ç„¡é€²å…¥æ¬Šé™!"),void l(!1)}e.meta.noAuth,"Login"===e.name||o?l():l({name:"Login"})}));var mA=pA,vA=l(90486),bA=l(84235),gA=l(25771),yA=l.n(gA),fA={absenteeism:"æ› è·",attendanceRecords:"è€ƒå‹¤è³‡æ–™",attendanceDate:"æœˆä»½",attendanceStatistics:"è€ƒå‹¤çµ±è¨ˆ",employeeName:"å“¡å·¥",employeeNameSearch:"è«‹è¼¸å…¥å“¡å·¥åç¨±æœå°‹",lateText:"é²åˆ° {delay} åˆ†é˜",Date:"æ—¥æœŸ",employee:"å“¡å·¥",Attendance:"Attendance",ClockIn:"ä¸Šç­",ClockOut:"ä¸‹ç­",minutes:"åˆ†é˜",leaveTypes:{annualUsed:"ç‰¹ä¼‘(å·²ä¼‘)",annualRemaining:"ç‰¹ä¼‘(å‰©é¤˜)",personal:"äº‹å‡",official:"å…¬å‡",menstrual:"ç”Ÿç†å‡",family:"å®¶åº­ç…§é¡§å‡",bereavement:"å–ªå‡",maternity:"ç”¢å‡",parental:"è‚²å¬°å‡",marriage:"å©šå‡",workInjury:"å…¬å‚·ç—…å‡",paternity:"é™ªç”¢å‡"},overtime:"åŠ ç­",lateWithinThreeMinutes:"é²åˆ°3åˆ†é˜ä»¥å…§",lateBeyondThreeMinutes:"é²åˆ°è¶…éŽ3åˆ†é˜",totalMinutesLate:"é²åˆ°",records:"ç­†æ•¸",accumulatedMinutesAfterFourth:"ç¬¬4ç­†é–‹å§‹ç´¯åŠ çš„ç¸½æ•¸",unit:{hour:"å°æ™‚"},holiday:{"é–‹åœ‹ç´€å¿µæ—¥":"é–‹åœ‹ç´€å¿µæ—¥","å°å¹´å¤œ":"å°å¹´å¤œ","è¾²æ›†é™¤å¤•":"è¾²æ›†é™¤å¤•","æ˜¥ç¯€":"æ˜¥ç¯€","è£œè¡Œä¸Šç­":"è£œè¡Œä¸Šç­","å’Œå¹³ç´€å¿µæ—¥":"å’Œå¹³ç´€å¿µæ—¥","è£œå‡":"è£œå‡","å…’ç«¥ç¯€åŠæ°‘æ—æŽƒå¢“ç¯€":"å…’ç«¥ç¯€åŠæ°‘æ—æŽƒå¢“ç¯€","ç«¯åˆç¯€":"ç«¯åˆç¯€","ä¸­ç§‹ç¯€":"ä¸­ç§‹ç¯€","åœ‹æ…¶æ—¥":"åœ‹æ…¶æ—¥"}},hA={absenteeism:"Absenteeism",attendanceRecords:"Attendance Records",attendanceDate:"Date",attendanceStatistics:"Attendance Statistics",employeeName:"Employee",employeeNameSearch:"search",employee:"employee",lateText:"{delay} minutes late",Date:"Date",ClockIn:"Clock In",ClockOut:"Clock Out",Attendance:"Attendance",minutes:"minutes",leaveTypes:{annualUsed:"Annual Leave (Used)",annualRemaining:"Annual Leave (Remaining)",personal:"Personal Leave",official:"Official Leave",menstrual:"Menstrual Leave",family:"Family Care Leave",bereavement:"Bereavement Leave",maternity:"Maternity Leave",parental:"Parental Leave",marriage:"Marriage Leave",workInjury:"Work Injury Leave",paternity:"Paternity Leave"},overtime:"Overtime",lateWithinThreeMinutes:"Late within 3 minutes",lateBeyondThreeMinutes:"Late beyond 3 minutes",totalMinutesLate:"Total minutes late",records:"Records",accumulatedMinutesAfterFourth:"Accumulated minutes after the 4th record",unit:{hour:"hours"},holiday:{"é–‹åœ‹ç´€å¿µæ—¥":"Founding Day","å°å¹´å¤œ":"Little New Year's Eve","è¾²æ›†é™¤å¤•":"Lunar New Year's Eve","æ˜¥ç¯€":"Chinese New Year","è£œè¡Œä¸Šç­":"Make-up Workday","å’Œå¹³ç´€å¿µæ—¥":"Peace Memorial Day","è£œå‡":"Compensatory Holiday","å…’ç«¥ç¯€åŠæ°‘æ—æŽƒå¢“ç¯€":"Children's Day and Tomb-Sweeping Day","ç«¯åˆç¯€":"Dragon Boat Festival","ä¸­ç§‹ç¯€":"Mid-Autumn Festival","åœ‹æ…¶æ—¥":"National Day"}};l(35068);let kA;function _A(e){kA=e}let wA;function FA(e){wA=e}let CA;function DA(e){CA=e}var LA=l(46587),RA=l.n(LA),VA=(l(39967),l(13034));const IA={"zh-TW":fA,"en-US":hA},xA=(0,O.hU)({legacy:!1,locale:"zh-TW",fallbackLocale:"en-US",messages:IA,missingWarn:!1,fallbackWarn:!1}),EA=r.A.create({baseURL:"/api/"}),AA=(0,t.Ef)(y),TA=(0,o.Ey)();AA.config.globalProperties.$axios=EA,AA.provide("$axios",EA),_A(EA),FA(EA),DA(EA),(0,W.B)(EA),Mi(EA),$a(EA),Bn(EA),Oa(EA),Ea(EA),Fv(EA),il(EA),KC(EA),(0,F_.e)(EA),Fg(EA),PR(EA),window.$=window.jQuery=RA();for(const[WA,SA]of Object.entries(J))AA.component(WA,SA);TA.use(n.A),AA.use(s.A),AA.use(h.A),AA.use(xA),AA.use(yA()),AA.use(_.y87,{plugins:{Loading:_.Rhj}}),AA.use(f.Ay,{theme:{preset:k.A,options:{prefix:"p",darkModeSelector:"light",cssLayer:!1}}}),AA.directive("focus",{mounted(e){e.focus()}}),AA.component("Toast",A.A),AA.component("ConfirmDialog",bA.A),AA.directive("badge",F.A),AA.use(m()),AA.use(TA),AA.use(vA.A),AA.use(mA),AA.use(h.A,{locale:VA.A}),AA.use(w.A),AA.config.errorHandler=function(e,a,l){const t=e.stack||e.message||e,o=a.$options.name||a.$options._componentTag||"åŒ¿åç»„ä»¶",n=l||"N/A";console.error(`éŒ¯èª¤: ${t}\nç»„ä»¶: ${o}\nVue ç”Ÿå‘½å‘¨æœŸä¿¡æ¯: ${n}`),alert(`éŒ¯èª¤: ${t}\nç»„ä»¶: ${o}\nè¨Šæ¯: ${n}`)},AA.mount("#app")},11826:function(e,a,l){l.d(a,{D:function(){return c},N:function(){return i},stopOnlineHub:function(){return p}});l(98992),l(54520);var t=l(51645),o=l(20652),n=l(24570),r=l.n(n);const s="https://eip.dae.tw/onlineHub/".replace(/\/+$/,"");let u=null;async function i(){if(s){u=(new t.$).withUrl(s).withAutomaticReconnect().build(),u.on("UpdateOnlineCount",(()=>{})),u.onreconnected((async()=>{await d()})),u.on("UpdateOnlineUsers",(e=>{const a=e.filter((e=>"æœªçŸ¥ç”¨æˆ¶"!==e.userId&&"æœªè¨»å†Šç”¨æˆ¶"!==e.userName&&""!==e.userId&&""!==e.userName)),l=a.length,t=document.getElementById("onlineCount");t&&(t.innerText=l),window.dispatchEvent(new CustomEvent("registeredUsersUpdated",{detail:{users:a,count:l}}))}));try{await u.start(),await d()}catch(e){console.error("SignalR é€£ç·šå¤±æ•—:",e)}}else console.error("è«‹å…ˆåœ¨ .env.development æˆ– .env.production è£¡è¨­å®š VUE_APP_SIGNALR_URL")}async function d(){try{const a=r().get("userId")||"",l=r().get("userName")||"",t=r().get("departmentId")||"",n=r().get("departmentName")||"",s=r().get("titleId")||"",i=r().get("titleName")||"",d=r().get("email")||"",c=localStorage.getItem("auth");let p=[],m=[];if(c)try{const e=JSON.parse(c);p=e.user?.roles||[],m=e.user?.permissions||[]}catch(e){console.warn("è§£æž auth è³‡æ–™å¤±æ•—:",e)}a&&u&&u.state===o.j.Connected?await u.invoke("RegisterUser",a,l,t,n,s,i,d,p,m):console.warn("SignalR é€£ç·šæœªå»ºç«‹æˆ–ç”¨æˆ¶è³‡è¨Šä¸å®Œæ•´:",{userId:a,connectionState:u?.state})}catch(a){console.error("è¨»å†Šä½¿ç”¨è€…è³‡è¨Šå¤±æ•—:",a)}}async function c(){u&&u.state===o.j.Connected?await d():console.warn("SignalR é€£ç·šæœªå»ºç«‹ï¼Œç„¡æ³•è¨»å†Šç”¨æˆ¶")}function p(){return u?.stop()}},82860:function(e,a,l){var t=l(94373),o=l(20014);const n=t.A.create({baseURL:"/api/"});n.interceptors.request.use((e=>{const a=(0,o.n)();return a.token&&(e.headers.Authorization=`Bearer ${a.token}`),e}),(e=>Promise.reject(e))),a.A=n},54117:function(e,a,l){l.d(a,{e:function(){return n}});l(44114),l(98992),l(3949);var t=l(82860);let o=t.A;function n(e){o=e}const r="FormTemplate",s={getFormTemplates(){return o.get(`${r}/FormTemplates`)},getFormTemplate(e){return o.get(`${r}/FormTemplate/${e}`)},createFormTemplate(e){return o.post(`${r}/CreateFormTemplate`,e)},updateFormTemplate(e,a){return o.put(`${r}/UpdateFormTemplate/${e}`,a)},deleteFormTemplate(e){return o.delete(`${r}/DeleteFormTemplate/${e}`)},searchFormTemplates(e){return o.get(`${r}/SearchFormTemplates`,{params:{searchTerm:e}})},publishFormTemplate(e){return o.patch(`${r}/PublishFormTemplate/${e}`)},closeFormTemplate(e){return o.patch(`${r}/CloseFormTemplate/${e}`)},copyFormTemplate(e){return o.post(`${r}/CopyFormTemplate/${e}`)},getFormAnalytics(e){return o.get(`${r}/FormAnalytics/${e}`)},getFormFieldStats(e){return o.get(`${r}/FormFieldStats/${e}`)},getFormResponses(e={}){return o.get(`${r}/FormResponse`,{params:e})},getFormResponse(e){return o.get(`${r}/FormResponse/${e}`)},submitFormResponse(e){return o.post(`${r}/FormResponse`,e)},updateFormResponseStatus(e,a){return o.patch(`${r}/FormResponse/${e}/status`,{status:a})},deleteFormResponse(e){return o.delete(`${r}/FormResponse/${e}`)},getFormStatistics(e){return o.get(`${r}/FormResponse/statistics/${e}`)},exportFormResponses(e,a="excel"){return o.get(`${r}/FormResponse/export/${e}`,{params:{format:a},responseType:"blob"})},uploadFile(e){return o.post(`${r}/File/upload`,e,{headers:{"Content-Type":"multipart/form-data"}})},downloadFile(e){return o.get(`${r}/File/download/${e}`,{responseType:"blob"})},validateFormData(e,a){const l=[];return a.forEach((a=>{const t=e[a.id];if(!a.required||t&&""!==t.toString().trim()){if(t&&a.validation){const e=a.validation,o=t.toString();if(e.minLength&&o.length<e.minLength&&l.push(`${a.label} æœ€å°‘éœ€è¦ ${e.minLength} å€‹å­—å…ƒ`),e.maxLength&&o.length>e.maxLength&&l.push(`${a.label} æœ€å¤šåªèƒ½ ${e.maxLength} å€‹å­—å…ƒ`),"number"===a.type){const t=parseFloat(o);isNaN(t)?l.push(`${a.label} å¿…é ˆæ˜¯æœ‰æ•ˆçš„æ•¸å­—`):(void 0!==e.min&&t<e.min&&l.push(`${a.label} ä¸èƒ½å°æ–¼ ${e.min}`),void 0!==e.max&&t>e.max&&l.push(`${a.label} ä¸èƒ½å¤§æ–¼ ${e.max}`))}if(e.pattern){const t=new RegExp(e.pattern);t.test(o)||l.push(e.customMessage||`${a.label} æ ¼å¼ä¸æ­£ç¢º`)}}}else l.push(`${a.label} ç‚ºå¿…å¡«æ¬„ä½`)})),{isValid:0===l.length,errors:l}},formatDate(e){return e?new Date(e).toLocaleString("zh-TW"):""},generateId(){return Date.now().toString(36)+Math.random().toString(36).substr(2)}};a.A=s},79802:function(e,a,l){l.d(a,{B:function(){return i}});var t=l(20014),o=l(64783),n=l(35068),r=l(24570),s=l.n(r);let u;function i(e){u=e}const d=()=>(0,o.k)(),c=()=>u,p="EIP";a.A={login_JWT(e){return c().post(`${p}/loginJWT`,e).then((e=>{localStorage.setItem("token",e.token);const a=e.data.token;localStorage.setItem("token",a);const l=(0,n.s)(a),t="24h";return s().set("userId",l.sub,t,"/"),s().set("userName",l.userName,t,"/"),s().set("departmentId",l.departmentId,t,"/"),s().set("departmentName",l.departmentName,t,"/"),s().set("titleId",l.titleId,t,"/"),s().set("titleName",l.titleName,t,"/"),s().set("userTitle",l.titleName,t,"/"),s().set("dpt_title_Id",l.dpt_title_Id,t,"/"),s().set("email",l.email,t,"/"),console.log(e.data),console.log("decodedToken.userName: "+l.userName),"Login Success"})).catch((e=>{throw console.error("Login JWT error:",e),e}))},refresh_JWT(e){return c().get(`${p}/refreshJWT/${e}`).then((e=>{const a=(0,t.n)(),l=e.data.token;localStorage.setItem("token",l),a.setToken("token",l);const o=(0,n.s)(l);console.log("Decoded refreshed JWT:",o),s().set("userId",o.sub,"1h","/"),s().set("userName",o.userName,"1h","/"),s().set("departmentId",o.departmentId,"1h","/"),s().set("departmentName",o.departmentName,"1h","/"),s().set("titleId",o.titleId,"1h","/"),s().set("titleName",o.titleName,"1h","/"),s().set("dpt_title_Id",o.dpt_title_Id,"1h","/"),s().set("email",o.email,"1h","/");const r=d();return r.setUserInfo(o.username,o.departmentId,o.departmentName,o.sub,o.dpt_title_Id),e.data})).catch((e=>{throw console.error("Error refreshing JWT:",e),e}))},Login(e){return c().get(`/${p}/Login/${e}`)},login_EIP(e){return c().post(`/${p}/loginEIP/`,e)},autoLogin(e){return c().post(`/${p}/autoLogin/${e}`)},firstLoginInputPassword(e){return c().post(`/${p}/firstLoginInputPassword/`,e)},getDptsList(){return c().get(`/${p}/getDptsList/`)},getTitlesList(){return c().get(`/${p}/getTitlesList/`)},submitRegForm(e){return c().post(`${p}/submitRegForm`,e,{headers:{"Content-Type":"application/json"}})},getUsersList(){return c().get(`${p}/getUsersList`,{headers:{"Content-Type":"application/json"}})},updateUsers(e){return c().patch(`${p}/updateUsers`,e,{headers:{"Content-Type":"application/json"}})},getIP(){return c().get(`${p}/checkIP`,{headers:{"Content-Type":"application/json"}})},punch(e,a){return c().post(`/${p}/punch/${e}`,a,{headers:{"Content-Type":"application/json"}})},getEmployeeDataByID(e){return c().get(`${p}/getPersonalInformation/${e}`,{headers:{"Content-Type":"application/json"}})},editEmployeeData(e,a){return c().put(`${p}/updatePersonalInformation/${e}`,a,{headers:{"Content-Type":"application/json"}})},editPassword(e,a){return c().put(`${p}/updatePersonalPassword/${e}`,a,{headers:{"Content-Type":"application/json"}})},getAuditEvents(e){return c().get(`${p}/events`,{params:e,headers:{"Content-Type":"application/json"}})},getOnlineUsers(){return c().get(`${p}/getOnlineUsers`,{headers:{"Content-Type":"application/json"}})},getPresenceOnlineUsers(){return c().get("/api/presence/online",{headers:{"Content-Type":"application/json"}})},getPresenceHistory(e={}){return c().get("/api/presence/history",{params:e,headers:{"Content-Type":"application/json"}})},disconnectPresence(e){return c().post("/api/presence/disconnect",{connectionId:e},{headers:{"Content-Type":"application/json"}})},uploadProfileImage(e,a){const l=new FormData;return l.append("file",a),l.append("userId",e),c().post(`${p}/uploadProfileImage`,l,{headers:{"Content-Type":"multipart/form-data"}})},deleteProfileImage(e){return c().delete(`${p}/deleteProfileImage/${e}`,{headers:{"Content-Type":"application/json"}})}}},98815:function(e,a,l){l.d(a,{aZ:function(){return g},lG:function(){return d},stopPresenceHub:function(){return b}});var t=l(51645),o=l(20652),n=l(24570),r=l.n(n);const s="https://eip.dae.tw/onlineHub/".replace(/\/+$/,"")+"/hubs/presence";let u=null,i=null;async function d(){u=(new t.$).withUrl(s).withAutomaticReconnect().build(),u.onreconnected((async()=>{console.log("PresenceHub é‡æ–°é€£ç·šæˆåŠŸï¼Œé‡æ–°è¨»å†Šç”¨æˆ¶"),await c()}));try{await u.start(),console.log("PresenceHub é€£ç·šå»ºç«‹æˆåŠŸ:",s),await c(),p()}catch(e){console.error("PresenceHub é€£ç·šå¤±æ•—:",e)}}async function c(){try{if(!u||u.state!==o.j.Connected)return void console.warn("PresenceHub é€£ç·šæœªå»ºç«‹ï¼Œç„¡æ³•è¨»å†Šç”¨æˆ¶");const a=r().get("userId")||"",l=r().get("userName")||"",t=r().get("departmentId")||"",n=r().get("departmentName")||"",s=r().get("titleId")||"",i=r().get("titleName")||"",d=r().get("email")||"",c=localStorage.getItem("auth");let p=[],m=[];if(c)try{const e=JSON.parse(c);p=e.user?.roles||[],m=e.user?.permissions||[]}catch(e){console.warn("è§£æž auth è³‡æ–™å¤±æ•—:",e)}a&&await u.invoke("RegisterUserInfo",a,l,t,n,s,i,d,p,m)}catch(a){console.error("PresenceHub è¨»å†Šä½¿ç”¨è€…è³‡è¨Šå¤±æ•—:",a)}}function p(){i&&clearInterval(i),i=setInterval((()=>{u&&u.state===o.j.Connected&&u.invoke("Heartbeat").catch((e=>{console.error("å¿ƒè·³ç™¼é€å¤±æ•—:",e)}))}),3e4)}function m(){i&&(clearInterval(i),i=null)}async function v(){try{m(),u&&u.connectionId&&await fetch("/api/presence/disconnect",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({connectionId:u.connectionId})}),u&&await u.stop()}catch(e){console.error("æ‰‹å‹•æ–·ç·šå¤±æ•—:",e)}}async function b(){await v(),u=null}async function g(){u&&u.state===o.j.Connected?await c():console.warn("PresenceHub é€£ç·šæœªå»ºç«‹ï¼Œç„¡æ³•é‡æ–°è¨»å†Šç”¨æˆ¶")}window.addEventListener("beforeunload",(()=>{if(u&&u.connectionId){const e=JSON.stringify({connectionId:u.connectionId});navigator.sendBeacon("/api/presence/disconnect",new Blob([e],{type:"application/json"}))}})),document.addEventListener("visibilitychange",(()=>{if("hidden"===document.visibilityState&&u&&u.connectionId){const e=JSON.stringify({connectionId:u.connectionId});navigator.sendBeacon("/api/presence/disconnect",new Blob([e],{type:"application/json"}))}})),window.addEventListener("pagehide",(()=>{if(u&&u.connectionId){const e=JSON.stringify({connectionId:u.connectionId});navigator.sendBeacon("/api/presence/disconnect",new Blob([e],{type:"application/json"}))}}))},20014:function(e,a,l){l.d(a,{n:function(){return d}});var t=l(92261),o=l(24570),n=l.n(o),r=l(35068),s=l(79802),u=l(11826),i=l(98815);const d=(0,t.nY)("auth",{state:()=>({token:null,user:{userId:null,userName:null,departmentId:null,departmentName:null,departmentIds:[],departmentNames:[],titleId:null,titleName:null,dpt_title_Id:null,email:null,roles:[],permissions:[],areaInfo:{},managers:[],subDepartments:[]},isLogin:!1}),actions:{setToken(e){this.token=e,localStorage.setItem("token",e)},setUser(e){this.user=e},decode(e){const a=(0,r.s)(e),l=null,t=a.managers?JSON.parse(a.managers):[],o=a.subDepartments?JSON.parse(a.subDepartments):[],s=a.arr_departmentIds?JSON.parse(a.arr_departmentIds):[],u=a.arr_departmentNames?JSON.parse(a.arr_departmentNames):[];return n().set("userId",a.sub,l,"/"),n().set("userName",a.userName,l,"/"),n().set("departmentId",a.departmentId,l,"/"),n().set("departmentName",a.departmentName,l,"/"),n().set("departmentIds",JSON.stringify(s),l,"/"),n().set("departmentNames",JSON.stringify(u),l,"/"),n().set("titleId",a.titleId,l,"/"),n().set("titleName",a.titleName,l,"/"),n().set("dpt_title_Id",a.dpt_title_Id,l,"/"),n().set("email",a.email,l,"/"),n().set("roles",JSON.stringify(a.roles||[]),l,"/"),n().set("permissions",JSON.stringify(a.permissions||[]),l,"/"),n().set("areaInfo",JSON.stringify(a.areaInfo?JSON.parse(a.areaInfo):{}),l,"/"),n().set("managers",JSON.stringify(t),l,"/"),n().set("subDepartments",JSON.stringify(o),l,"/"),this.setUser({userId:a.sub,userName:a.userName,departmentId:a.departmentId,departmentName:a.departmentName,departmentIds:s,departmentNames:u,titleId:a.titleId,titleName:a.titleName,dpt_title_Id:a.dpt_title_Id,email:a.email,roles:a.roles||[],permissions:a.permissions||[],areaInfo:a.areaInfo?JSON.parse(a.areaInfo):{},managers:t,subDepartments:o}),this.isLogin=!0,a},async login_EIP(e){const a=await s.A.login_EIP(e);return a.data&&a.data.token&&(this.setToken(a.data.token),this.decode(a.data.token),setTimeout((async()=>{try{await(0,u.D)(),await(0,i.aZ)()}catch(e){console.error("ç™»å…¥å¾Œè¨»å†Š SignalR å¤±æ•—:",e)}}),1e3)),a},async autoLogin(){const e=n().get("userId");if(!e)return;const a=await s.A.autoLogin(e);a.data&&a.data.token&&(this.setToken(a.data.token),this.decode(a.data.token),this.isLogin=!0,setTimeout((async()=>{try{await(0,u.D)(),await(0,i.aZ)()}catch(e){console.error("è‡ªå‹•ç™»å…¥å¾Œè¨»å†Š SignalR å¤±æ•—:",e)}}),1e3))}},persist:{enabled:!0,strategies:[{key:"auth",storage:localStorage}]}})},64783:function(e,a,l){l.d(a,{k:function(){return r}});var t=l(92261),o=l(24570),n=l.n(o);const r=(0,t.nY)("user",{state:()=>({userId:n().get("userId")||"",userName:n().get("userName")||"",userDeptId:n().get("departmentId")||"",userDeptName:n().get("departmentName")||"",dpt_title_Id:n().get("dpt_title_Id")||""}),actions:{setUserInfo(e,a,l,t,o){this.userName=e,this.userDeptId=a,this.userDeptName=l,this.userId=t,this.dpt_title_Id=o},clearUserInfo(){this.userName="",this.userDeptId="",this.userDeptName="",this.userId="",this.dpt_title_Id="",n().remove("userId"),n().remove("userName"),n().remove("departmentId"),n().remove("departmentName"),n().remove("titleId"),n().remove("titleName"),n().remove("dpt_title_Id"),n().remove("email")},checkCookies(){return!!n().get("userId")||(this.clearUserInfo(),!1)}},persist:!0})},29043:function(e,a,l){l.r(a),l.d(a,{default:function(){return S}});l(44114),l(98992),l(54520),l(72577),l(3949),l(81454),l(37550);var t=l(56768),o=l(24232),n=l(45130),r=l(90144),s=l(81387),u=l(51219),i=l(12933),d=l(57477),c=l(54117),p=l(20014);const m={class:"form-fill-page"},v={key:0,class:"loading-container"},b={key:1,class:"error-container"},g={key:2,class:"form-container"},y={class:"form-header"},f={class:"form-title"},h={key:0,class:"form-description"},k={class:"form-info"},_={key:1,class:"deadline"},w={key:0,class:"progress-bar"},F={class:"progress-text"},C={class:"form-fields"},D={class:"field-label-wrapper"},L={class:"field-label"},R={key:0,class:"required-mark"},V={key:0,class:"help-text"},I={key:9,class:"field-error-message"},x={class:"form-actions"},E={class:"success-content"};var A={__name:"FormFillPage",props:{templateId:{type:String,required:!0}},setup(e){const a=e,l=(0,s.lq)(),A=(0,s.rd)(),T=(0,p.n)(),W=(0,r.KR)(!0),S=(0,r.KR)(!1),U=(0,r.KR)(!1),$=(0,r.KR)(null),N=(0,r.KR)(null),X=(0,r.KR)(null),K=(0,r.Kh)({formTemplateId:"",submittedBy:"",responses:{},attachments:[]}),M=(0,r.KR)({}),P=(0,r.KR)({}),O=(0,t.EW)((()=>!!$.value?.settings?.endDate&&new Date>new Date($.value.settings.endDate))),z=(0,t.EW)((()=>$.value?.fields?$.value.fields.filter((e=>Z(e))).sort(((e,a)=>(e.order||0)-(a.order||0))):[])),B=(0,t.EW)((()=>z.value.length)),j=(0,t.EW)((()=>Object.keys(K.responses).filter((e=>null!==K.responses[e]&&void 0!==K.responses[e]&&""!==K.responses[e])).length)),Y=(0,t.EW)((()=>0===B.value?0:Math.round(j.value/B.value*100))),Q=(0,t.EW)((()=>`${(void 0).VITE_API_BASE_URL}/api/FormResponse/upload`)),H=(0,t.EW)((()=>({Authorization:`Bearer ${T.token}`}))),q=async()=>{try{if(W.value=!0,a.templateData)$.value=a.templateData;else{const e=a.templateId||l.params.id,t=await c.A.getFormTemplate(e);$.value=t.data}J(),G()}catch(e){console.error("è¼‰å…¥è¡¨å–®ç¯„æœ¬å¤±æ•—:",e),u.nk.error("è¼‰å…¥è¡¨å–®å¤±æ•—")}finally{W.value=!1}},J=()=>{K.formTemplateId=$.value.id,K.submittedBy=T.user?.id||"",$.value.fields.forEach((e=>{if(void 0!==e.defaultValue)K.responses[e.id]=e.defaultValue;else switch(e.type){case"checkbox":K.responses[e.id]=[];break;case"number":K.responses[e.id]=null;break;default:K.responses[e.id]=""}}))},G=()=>{const e={};$.value.fields.forEach((a=>{const l=[];a.required&&l.push({required:!0,message:`${a.label}ç‚ºå¿…å¡«æ¬„ä½`,trigger:["blur","change"]}),(a.validation?.minLength||a.validation?.maxLength)&&l.push({min:a.validation.minLength||0,max:a.validation.maxLength||1/0,message:`${a.label}é•·åº¦æ‡‰åœ¨ ${a.validation.minLength||0} åˆ° ${a.validation.maxLength||"ç„¡é™åˆ¶"} å­—å…ƒä¹‹é–“`,trigger:"blur"}),"number"!==a.type||void 0===a.validation?.min&&void 0===a.validation?.max||l.push({type:"number",min:a.validation.min,max:a.validation.max,message:`${a.label}æ‡‰åœ¨ ${a.validation.min||"ç„¡é™åˆ¶"} åˆ° ${a.validation.max||"ç„¡é™åˆ¶"} ä¹‹é–“`,trigger:"change"}),"email"===a.type&&l.push({type:"email",message:"è«‹è¼¸å…¥æ­£ç¢ºçš„é›»å­éƒµä»¶æ ¼å¼",trigger:"blur"}),a.validation?.pattern&&l.push({pattern:new RegExp(a.validation.pattern),message:a.validation.customMessage||`${a.label}æ ¼å¼ä¸æ­£ç¢º`,trigger:"blur"}),l.length>0&&(e[`responses.${a.id}`]=l)})),P.value=e},Z=e=>{if(!e.conditional)return!0;const a=$.value.fields.find((a=>a.id===e.conditional.dependsOn));if(!a)return!0;const l=K.responses[e.conditional.dependsOn],t=e.conditional.value;switch(e.conditional.condition){case"equals":return l===t;case"not_equals":return l!==t;case"contains":return String(l).includes(t);case"not_empty":return null!==l&&void 0!==l&&""!==l;case"empty":return null===l||void 0===l||""===l;default:return!0}},ee=e=>{const a=K.responses[e.id];let l=null;if(e.required&&(!a||Array.isArray(a)&&0===a.length)&&(l=`${e.label}ç‚ºå¿…å¡«æ¬„ä½`),a&&e.validation?.minLength&&String(a).length<e.validation.minLength&&(l=`${e.label}é•·åº¦ä¸èƒ½å°‘æ–¼ ${e.validation.minLength} å­—å…ƒ`),a&&e.validation?.maxLength&&String(a).length>e.validation.maxLength&&(l=`${e.label}é•·åº¦ä¸èƒ½è¶…éŽ ${e.validation.maxLength} å­—å…ƒ`),"number"===e.type&&null!==a&&void 0!==a&&(void 0!==e.validation?.min&&a<e.validation.min&&(l=`${e.label}ä¸èƒ½å°æ–¼ ${e.validation.min}`),void 0!==e.validation?.max&&a>e.validation.max&&(l=`${e.label}ä¸èƒ½å¤§æ–¼ ${e.validation.max}`)),"email"===e.type&&a){const e=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;e.test(a)||(l="è«‹è¼¸å…¥æ­£ç¢ºçš„é›»å­éƒµä»¶æ ¼å¼")}if(e.validation?.pattern&&a){const t=new RegExp(e.validation.pattern);t.test(a)||(l=e.validation.customMessage||`${e.label}æ ¼å¼ä¸æ­£ç¢º`)}return l?M.value[e.id]=l:delete M.value[e.id],!l},ae=e=>{delete M.value[e.id]},le=e=>K.attachments.filter((a=>a.fieldId===e)).map((e=>({name:e.originalName,url:e.filePath}))),te=e=>{const a=e.size/1024/1024<10;return a||u.nk.error("æª”æ¡ˆå¤§å°ä¸èƒ½è¶…éŽ 10MB"),a},oe=(e,a)=>{e.success?(K.attachments.push({fieldId:a.id,fileName:e.data.fileName,originalName:e.data.originalName,filePath:e.data.filePath,fileSize:e.data.fileSize,mimeType:e.data.mimeType}),u.nk.success("æª”æ¡ˆä¸Šå‚³æˆåŠŸ")):u.nk.error("æª”æ¡ˆä¸Šå‚³å¤±æ•—")},ne=e=>{console.error("æª”æ¡ˆä¸Šå‚³éŒ¯èª¤:",e),u.nk.error("æª”æ¡ˆä¸Šå‚³å¤±æ•—")},re=async()=>{try{let e=!1;if(z.value.forEach((a=>{ee(a)||(e=!0)})),e)return void u.nk.error("è«‹ä¿®æ­£è¡¨å–®ä¸­çš„éŒ¯èª¤");$.value.settings,S.value=!0;const a={formTemplateId:K.formTemplateId,submittedBy:K.submittedBy,responses:K.responses,attachments:K.attachments,metadata:{userAgent:navigator.userAgent,timestamp:(new Date).toISOString()}};await c.A.submitFormResponse(a),U.value=!0}catch(e){console.error("æäº¤è¡¨å–®å¤±æ•—:",e),u.nk.error("æäº¤å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦")}finally{S.value=!1}},se=async()=>{if(Object.keys(K.responses).some((e=>K.responses[e])))try{await i.s.confirm("æ‚¨æœ‰æœªä¿å­˜çš„è®Šæ›´ï¼Œç¢ºå®šè¦é›¢é–‹å—Žï¼Ÿ","ç¢ºèªé›¢é–‹",{confirmButtonText:"ç¢ºå®š",cancelButtonText:"å–æ¶ˆ",type:"warning"}),A.go(-1)}catch{}else A.go(-1)},ue=()=>{U.value=!1,$.value.settings?.redirectUrl?window.location.href=$.value.settings.redirectUrl:A.push("/")},ie=e=>{const a={hr:"äººäº‹è¡¨å–®",finance:"è²¡å‹™è¡¨å–®",purchase:"æŽ¡è³¼è¡¨å–®",other:"å…¶ä»–"};return a[e]||e},de=e=>new Date(e).toLocaleString("zh-TW");return(0,t.sV)((()=>{q()})),(0,t.wB)((()=>l.params.id),(e=>{e&&q()})),(e,a)=>{const l=(0,t.g2)("el-skeleton"),s=(0,t.g2)("el-button"),u=(0,t.g2)("el-result"),i=(0,t.g2)("el-tag"),c=(0,t.g2)("el-progress"),p=(0,t.g2)("el-tooltip"),A=(0,t.g2)("el-input"),T=(0,t.g2)("el-option"),q=(0,t.g2)("el-select"),J=(0,t.g2)("el-radio"),G=(0,t.g2)("el-radio-group"),Z=(0,t.g2)("el-checkbox"),ce=(0,t.g2)("el-checkbox-group"),pe=(0,t.g2)("el-date-picker"),me=(0,t.g2)("el-input-number"),ve=(0,t.g2)("el-upload"),be=(0,t.g2)("el-form-item"),ge=(0,t.g2)("el-form"),ye=(0,t.g2)("el-dialog");return(0,t.uX)(),(0,t.CE)("div",m,[W.value?((0,t.uX)(),(0,t.CE)("div",v,[(0,t.bF)(l,{rows:8,animated:""})])):!$.value||O.value?((0,t.uX)(),(0,t.CE)("div",b,[(0,t.bF)(u,{icon:"warning",title:$.value?"è¡¨å–®å·²éŽæœŸ":"è¡¨å–®ä¸å­˜åœ¨","sub-title":$.value?"æ­¤è¡¨å–®çš„å¡«å¯«æœŸé™å·²éŽ":"æ‚¨è¨ªå•çš„è¡¨å–®å¯èƒ½å·²è¢«åˆªé™¤æˆ–ä¸å­˜åœ¨"},{extra:(0,t.k6)((()=>[(0,t.bF)(s,{type:"primary",onClick:a[0]||(a[0]=a=>e.$router.go(-1))},{default:(0,t.k6)((()=>a[2]||(a[2]=[(0,t.eW)("è¿”å›žä¸Šé ")]))),_:1})])),_:1},8,["title","sub-title"])])):((0,t.uX)(),(0,t.CE)("div",g,[(0,t.Lk)("div",y,[(0,t.Lk)("h1",f,(0,o.v_)($.value.title),1),$.value.description?((0,t.uX)(),(0,t.CE)("p",h,(0,o.v_)($.value.description),1)):(0,t.Q3)("",!0),(0,t.Lk)("div",k,[$.value.category?((0,t.uX)(),(0,t.Wv)(i,{key:0,type:"info",size:"small"},{default:(0,t.k6)((()=>[(0,t.eW)((0,o.v_)(ie($.value.category)),1)])),_:1})):(0,t.Q3)("",!0),$.value.settings?.endDate?((0,t.uX)(),(0,t.CE)("span",_," æˆªæ­¢æ™‚é–“: "+(0,o.v_)(de($.value.settings.endDate)),1)):(0,t.Q3)("",!0)])]),$.value.settings?.showProgressBar?((0,t.uX)(),(0,t.CE)("div",w,[(0,t.bF)(c,{percentage:Y.value,"show-text":!1,"stroke-width":6},null,8,["percentage"]),(0,t.Lk)("span",F,(0,o.v_)(j.value)+"/"+(0,o.v_)(B.value),1)])):(0,t.Q3)("",!0),(0,t.bF)(ge,{ref_key:"formRef",ref:N,model:K,rules:P.value,"label-position":"top",class:"dynamic-form",onSubmit:(0,n.D$)(re,["prevent"])},{default:(0,t.k6)((()=>[(0,t.Lk)("div",C,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(z.value,(e=>((0,t.uX)(),(0,t.CE)("div",{key:e.id,class:(0,o.C4)(["form-field",{"field-error":M.value[e.id]}]),style:(0,o.Tr)({width:e.width})},[(0,t.Lk)("div",D,[(0,t.Lk)("label",L,[(0,t.eW)((0,o.v_)(e.label)+" ",1),e.required?((0,t.uX)(),(0,t.CE)("span",R,"*")):(0,t.Q3)("",!0)]),e.helpText?((0,t.uX)(),(0,t.CE)("span",V,[(0,t.bF)(p,{content:e.helpText,placement:"top"},{default:(0,t.k6)((()=>a[3]||(a[3]=[(0,t.Lk)("i",{class:"pi pi-question-circle"},null,-1)]))),_:2},1032,["content"])])):(0,t.Q3)("",!0)]),(0,t.bF)(be,{prop:`responses.${e.id}`,class:"field-item"},{default:(0,t.k6)((()=>["text"===e.type?((0,t.uX)(),(0,t.Wv)(A,{key:0,modelValue:K.responses[e.id],"onUpdate:modelValue":a=>K.responses[e.id]=a,placeholder:e.placeholder,maxlength:e.validation?.maxLength,"show-word-limit":"",onBlur:a=>ee(e)},null,8,["modelValue","onUpdate:modelValue","placeholder","maxlength","onBlur"])):"textarea"===e.type?((0,t.uX)(),(0,t.Wv)(A,{key:1,modelValue:K.responses[e.id],"onUpdate:modelValue":a=>K.responses[e.id]=a,type:"textarea",placeholder:e.placeholder,rows:4,maxlength:e.validation?.maxLength,"show-word-limit":"",onBlur:a=>ee(e)},null,8,["modelValue","onUpdate:modelValue","placeholder","maxlength","onBlur"])):"select"===e.type?((0,t.uX)(),(0,t.Wv)(q,{key:2,modelValue:K.responses[e.id],"onUpdate:modelValue":a=>K.responses[e.id]=a,placeholder:e.placeholder||"è«‹é¸æ“‡",style:{width:"100%"},onChange:a=>ae(e)},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(e.options,(e=>((0,t.uX)(),(0,t.Wv)(T,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","onChange"])):"radio"===e.type?((0,t.uX)(),(0,t.Wv)(G,{key:3,modelValue:K.responses[e.id],"onUpdate:modelValue":a=>K.responses[e.id]=a,onChange:a=>ae(e)},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(e.options,(e=>((0,t.uX)(),(0,t.Wv)(J,{key:e.value,label:e.value,class:"radio-option"},{default:(0,t.k6)((()=>[(0,t.eW)((0,o.v_)(e.label),1)])),_:2},1032,["label"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])):"checkbox"===e.type?((0,t.uX)(),(0,t.Wv)(ce,{key:4,modelValue:K.responses[e.id],"onUpdate:modelValue":a=>K.responses[e.id]=a,onChange:a=>ae(e)},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(e.options,(e=>((0,t.uX)(),(0,t.Wv)(Z,{key:e.value,label:e.value,class:"checkbox-option"},{default:(0,t.k6)((()=>[(0,t.eW)((0,o.v_)(e.label),1)])),_:2},1032,["label"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])):"date"===e.type?((0,t.uX)(),(0,t.Wv)(pe,{key:5,modelValue:K.responses[e.id],"onUpdate:modelValue":a=>K.responses[e.id]=a,type:"date",placeholder:e.placeholder||"è«‹é¸æ“‡æ—¥æœŸ",style:{width:"100%"},format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",onChange:a=>ae(e)},null,8,["modelValue","onUpdate:modelValue","placeholder","onChange"])):"number"===e.type?((0,t.uX)(),(0,t.Wv)(me,{key:6,modelValue:K.responses[e.id],"onUpdate:modelValue":a=>K.responses[e.id]=a,placeholder:e.placeholder,min:e.validation?.min,max:e.validation?.max,style:{width:"100%"},onChange:a=>ae(e)},null,8,["modelValue","onUpdate:modelValue","placeholder","min","max","onChange"])):"email"===e.type?((0,t.uX)(),(0,t.Wv)(A,{key:7,modelValue:K.responses[e.id],"onUpdate:modelValue":a=>K.responses[e.id]=a,placeholder:e.placeholder||"è«‹è¼¸å…¥é›»å­éƒµä»¶",onBlur:a=>ee(e)},null,8,["modelValue","onUpdate:modelValue","placeholder","onBlur"])):"file"===e.type?((0,t.uX)(),(0,t.Wv)(ve,{key:8,ref_for:!0,ref_key:"uploadRef",ref:X,action:Q.value,headers:H.value,data:{fieldId:e.id},"on-success":a=>oe(a,e),"on-error":ne,"before-upload":te,"file-list":le(e.id),multiple:"",class:"file-upload"},{tip:(0,t.k6)((()=>a[5]||(a[5]=[(0,t.Lk)("div",{class:"upload-tip"}," æ”¯æ´å¸¸è¦‹æª”æ¡ˆæ ¼å¼ï¼Œå–®æª”æœ€å¤§ 10MB ",-1)]))),default:(0,t.k6)((()=>[(0,t.bF)(s,{type:"primary",icon:(0,r.R1)(d.Upload)},{default:(0,t.k6)((()=>a[4]||(a[4]=[(0,t.eW)(" é¸æ“‡æª”æ¡ˆ ")]))),_:1},8,["icon"])])),_:2},1032,["action","headers","data","on-success","file-list"])):(0,t.Q3)("",!0),M.value[e.id]?((0,t.uX)(),(0,t.CE)("div",I,(0,o.v_)(M.value[e.id]),1)):(0,t.Q3)("",!0)])),_:2},1032,["prop"])],6)))),128))]),(0,t.Lk)("div",x,[(0,t.bF)(s,{onClick:se,size:"large"},{default:(0,t.k6)((()=>a[6]||(a[6]=[(0,t.eW)(" å–æ¶ˆ ")]))),_:1}),(0,t.bF)(s,{type:"primary",onClick:re,loading:S.value,size:"large"},{default:(0,t.k6)((()=>[(0,t.eW)((0,o.v_)($.value.settings?.submitButtonText||"æäº¤è¡¨å–®"),1)])),_:1},8,["loading"])])])),_:1},8,["model","rules"])])),(0,t.bF)(ye,{modelValue:U.value,"onUpdate:modelValue":a[1]||(a[1]=e=>U.value=e),title:"æäº¤æˆåŠŸ",width:"400px","close-on-click-modal":!1,"show-close":!1},{footer:(0,t.k6)((()=>[(0,t.bF)(s,{type:"primary",onClick:ue},{default:(0,t.k6)((()=>a[7]||(a[7]=[(0,t.eW)(" ç¢ºå®š ")]))),_:1})])),default:(0,t.k6)((()=>[(0,t.Lk)("div",E,[(0,t.bF)(u,{icon:"success",title:$.value?.settings?.successMessage||"è¡¨å–®æäº¤æˆåŠŸï¼"},null,8,["title"])])])),_:1},8,["modelValue"])])}}},T=l(71241);const W=(0,T.A)(A,[["__scopeId","data-v-65f1f46c"]]);var S=W},75659:function(e,a,l){e.exports=l.p+"img/MacAddresså¡«å¯«æ³¨æ„äº‹é ….1780d9cb.jpg"}},a={};function l(t){var o=a[t];if(void 0!==o)return o.exports;var n=a[t]={exports:{}};return e[t].call(n.exports,n,n.exports,l),n.exports}l.m=e,function(){var e=[];l.O=function(a,t,o,n){if(!t){var r=1/0;for(d=0;d<e.length;d++){t=e[d][0],o=e[d][1],n=e[d][2];for(var s=!0,u=0;u<t.length;u++)(!1&n||r>=n)&&Object.keys(l.O).every((function(e){return l.O[e](t[u])}))?t.splice(u--,1):(s=!1,n<r&&(r=n));if(s){e.splice(d--,1);var i=o();void 0!==i&&(a=i)}}return a}n=n||0;for(var d=e.length;d>0&&e[d-1][2]>n;d--)e[d]=e[d-1];e[d]=[t,o,n]}}(),function(){l.n=function(e){var a=e&&e.__esModule?function(){return e["default"]}:function(){return e};return l.d(a,{a:a}),a}}(),function(){var e,a=Object.getPrototypeOf?function(e){return Object.getPrototypeOf(e)}:function(e){return e.__proto__};l.t=function(t,o){if(1&o&&(t=this(t)),8&o)return t;if("object"===typeof t&&t){if(4&o&&t.__esModule)return t;if(16&o&&"function"===typeof t.then)return t}var n=Object.create(null);l.r(n);var r={};e=e||[null,a({}),a([]),a(a)];for(var s=2&o&&t;"object"==typeof s&&!~e.indexOf(s);s=a(s))Object.getOwnPropertyNames(s).forEach((function(e){r[e]=function(){return t[e]}}));return r["default"]=function(){return t},l.d(n,r),n}}(),function(){l.d=function(e,a){for(var t in a)l.o(a,t)&&!l.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:a[t]})}}(),function(){l.f={},l.e=function(e){return Promise.all(Object.keys(l.f).reduce((function(a,t){return l.f[t](e,a),a}),[]))}}(),function(){l.u=function(e){return e+".js"}}(),function(){l.miniCssF=function(e){}}(),function(){l.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){l.o=function(e,a){return Object.prototype.hasOwnProperty.call(e,a)}}(),function(){var e={},a="my-vue3-project:";l.l=function(t,o,n,r){if(e[t])e[t].push(o);else{var s,u;if(void 0!==n)for(var i=document.getElementsByTagName("script"),d=0;d<i.length;d++){var c=i[d];if(c.getAttribute("src")==t||c.getAttribute("data-webpack")==a+n){s=c;break}}s||(u=!0,s=document.createElement("script"),s.charset="utf-8",s.timeout=120,l.nc&&s.setAttribute("nonce",l.nc),s.setAttribute("data-webpack",a+n),s.src=t),e[t]=[o];var p=function(a,l){s.onerror=s.onload=null,clearTimeout(m);var o=e[t];if(delete e[t],s.parentNode&&s.parentNode.removeChild(s),o&&o.forEach((function(e){return e(l)})),a)return a(l)},m=setTimeout(p.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=p.bind(null,s.onerror),s.onload=p.bind(null,s.onload),u&&document.head.appendChild(s)}}}(),function(){l.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){l.p="/"}(),function(){var e={524:0};l.f.j=function(a,t){var o=l.o(e,a)?e[a]:void 0;if(0!==o)if(o)t.push(o[2]);else{var n=new Promise((function(l,t){o=e[a]=[l,t]}));t.push(o[2]=n);var r=l.p+l.u(a),s=new Error,u=function(t){if(l.o(e,a)&&(o=e[a],0!==o&&(e[a]=void 0),o)){var n=t&&("load"===t.type?"missing":t.type),r=t&&t.target&&t.target.src;s.message="Loading chunk "+a+" failed.\n("+n+": "+r+")",s.name="ChunkLoadError",s.type=n,s.request=r,o[1](s)}};l.l(r,u,"chunk-"+a,a)}},l.O.j=function(a){return 0===e[a]};var a=function(a,t){var o,n,r=t[0],s=t[1],u=t[2],i=0;if(r.some((function(a){return 0!==e[a]}))){for(o in s)l.o(s,o)&&(l.m[o]=s[o]);if(u)var d=u(l)}for(a&&a(t);i<r.length;i++)n=r[i],l.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return l.O(d)},t=self["webpackChunkmy_vue3_project"]=self["webpackChunkmy_vue3_project"]||[];t.forEach(a.bind(null,0)),t.push=a.bind(null,t.push.bind(t))}();var t=l.O(void 0,[504],(function(){return l(83662)}));t=l.O(t)})();
//# sourceMappingURL=app.js.map